(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(o){if(o.ep)return;o.ep=!0;const u=i(o);fetch(o.href,u)}})();var Rs="top",_n="bottom",yn="right",Ms="left",qm="auto",lc=[Rs,_n,yn,Ms],rl="start",Fu="end",PC="clippingParents",av="viewport",vu="popper",LC="reference",l0=lc.reduce(function(t,e){return t.concat([e+"-"+rl,e+"-"+Fu])},[]),ov=[].concat(lc,[qm]).reduce(function(t,e){return t.concat([e,e+"-"+rl,e+"-"+Fu])},[]),NC="beforeRead",RC="read",MC="afterRead",UC="beforeMain",BC="main",FC="afterMain",$C="beforeWrite",jC="write",HC="afterWrite",VC=[NC,RC,MC,UC,BC,FC,$C,jC,HC];function Lr(t){return t?(t.nodeName||"").toLowerCase():null}function Ln(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function al(t){var e=Ln(t).Element;return t instanceof e||t instanceof Element}function An(t){var e=Ln(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function lv(t){if(typeof ShadowRoot>"u")return!1;var e=Ln(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function CL(t){var e=t.state;Object.keys(e.elements).forEach(function(i){var n=e.styles[i]||{},o=e.attributes[i]||{},u=e.elements[i];!An(u)||!Lr(u)||(Object.assign(u.style,n),Object.keys(o).forEach(function(c){var h=o[c];h===!1?u.removeAttribute(c):u.setAttribute(c,h===!0?"":h)}))})}function AL(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(n){var o=e.elements[n],u=e.attributes[n]||{},c=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:i[n]),h=c.reduce(function(m,v){return m[v]="",m},{});!An(o)||!Lr(o)||(Object.assign(o.style,h),Object.keys(u).forEach(function(m){o.removeAttribute(m)}))})}}const uv={name:"applyStyles",enabled:!0,phase:"write",fn:CL,effect:AL,requires:["computeStyles"]};function Ar(t){return t.split("-")[0]}var Qo=Math.max,am=Math.min,$u=Math.round;function u0(){var t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function qC(){return!/^((?!chrome|android).)*safari/i.test(u0())}function ju(t,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var n=t.getBoundingClientRect(),o=1,u=1;e&&An(t)&&(o=t.offsetWidth>0&&$u(n.width)/t.offsetWidth||1,u=t.offsetHeight>0&&$u(n.height)/t.offsetHeight||1);var c=al(t)?Ln(t):window,h=c.visualViewport,m=!qC()&&i,v=(n.left+(m&&h?h.offsetLeft:0))/o,T=(n.top+(m&&h?h.offsetTop:0))/u,O=n.width/o,R=n.height/u;return{width:O,height:R,top:T,right:v+O,bottom:T+R,left:v,x:v,y:T}}function cv(t){var e=ju(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function WC(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&lv(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function _a(t){return Ln(t).getComputedStyle(t)}function kL(t){return["table","td","th"].indexOf(Lr(t))>=0}function ro(t){return((al(t)?t.ownerDocument:t.document)||window.document).documentElement}function Wm(t){return Lr(t)==="html"?t:t.assignedSlot||t.parentNode||(lv(t)?t.host:null)||ro(t)}function NS(t){return!An(t)||_a(t).position==="fixed"?null:t.offsetParent}function IL(t){var e=/firefox/i.test(u0()),i=/Trident/i.test(u0());if(i&&An(t)){var n=_a(t);if(n.position==="fixed")return null}var o=Wm(t);for(lv(o)&&(o=o.host);An(o)&&["html","body"].indexOf(Lr(o))<0;){var u=_a(o);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||e&&u.willChange==="filter"||e&&u.filter&&u.filter!=="none")return o;o=o.parentNode}return null}function Ah(t){for(var e=Ln(t),i=NS(t);i&&kL(i)&&_a(i).position==="static";)i=NS(i);return i&&(Lr(i)==="html"||Lr(i)==="body"&&_a(i).position==="static")?e:i||IL(t)||e}function dv(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Qd(t,e,i){return Qo(t,am(e,i))}function OL(t,e,i){var n=Qd(t,e,i);return n>i?i:n}function GC(){return{top:0,right:0,bottom:0,left:0}}function zC(t){return Object.assign({},GC(),t)}function KC(t,e){return e.reduce(function(i,n){return i[n]=t,i},{})}var DL=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,zC(typeof e!="number"?e:KC(e,lc))};function PL(t){var e,i=t.state,n=t.name,o=t.options,u=i.elements.arrow,c=i.modifiersData.popperOffsets,h=Ar(i.placement),m=dv(h),v=[Ms,yn].indexOf(h)>=0,T=v?"height":"width";if(!(!u||!c)){var O=DL(o.padding,i),R=cv(u),M=m==="y"?Rs:Ms,z=m==="y"?_n:yn,j=i.rects.reference[T]+i.rects.reference[m]-c[m]-i.rects.popper[T],q=c[m]-i.rects.reference[m],W=Ah(u),ee=W?m==="y"?W.clientHeight||0:W.clientWidth||0:0,se=j/2-q/2,re=O[M],ie=ee-R[T]-O[z],ye=ee/2-R[T]/2+se,Pe=Qd(re,ye,ie),Ie=m;i.modifiersData[n]=(e={},e[Ie]=Pe,e.centerOffset=Pe-ye,e)}}function LL(t){var e=t.state,i=t.options,n=i.element,o=n===void 0?"[data-popper-arrow]":n;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||WC(e.elements.popper,o)&&(e.elements.arrow=o))}const XC={name:"arrow",enabled:!0,phase:"main",fn:PL,effect:LL,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Hu(t){return t.split("-")[1]}var NL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function RL(t){var e=t.x,i=t.y,n=window,o=n.devicePixelRatio||1;return{x:$u(e*o)/o||0,y:$u(i*o)/o||0}}function RS(t){var e,i=t.popper,n=t.popperRect,o=t.placement,u=t.variation,c=t.offsets,h=t.position,m=t.gpuAcceleration,v=t.adaptive,T=t.roundOffsets,O=t.isFixed,R=c.x,M=R===void 0?0:R,z=c.y,j=z===void 0?0:z,q=typeof T=="function"?T({x:M,y:j}):{x:M,y:j};M=q.x,j=q.y;var W=c.hasOwnProperty("x"),ee=c.hasOwnProperty("y"),se=Ms,re=Rs,ie=window;if(v){var ye=Ah(i),Pe="clientHeight",Ie="clientWidth";if(ye===Ln(i)&&(ye=ro(i),_a(ye).position!=="static"&&h==="absolute"&&(Pe="scrollHeight",Ie="scrollWidth")),ye=ye,o===Rs||(o===Ms||o===yn)&&u===Fu){re=_n;var Be=O&&ye===ie&&ie.visualViewport?ie.visualViewport.height:ye[Pe];j-=Be-n.height,j*=m?1:-1}if(o===Ms||(o===Rs||o===_n)&&u===Fu){se=yn;var Ve=O&&ye===ie&&ie.visualViewport?ie.visualViewport.width:ye[Ie];M-=Ve-n.width,M*=m?1:-1}}var We=Object.assign({position:h},v&&NL),it=T===!0?RL({x:M,y:j}):{x:M,y:j};if(M=it.x,j=it.y,m){var Le;return Object.assign({},We,(Le={},Le[re]=ee?"0":"",Le[se]=W?"0":"",Le.transform=(ie.devicePixelRatio||1)<=1?"translate("+M+"px, "+j+"px)":"translate3d("+M+"px, "+j+"px, 0)",Le))}return Object.assign({},We,(e={},e[re]=ee?j+"px":"",e[se]=W?M+"px":"",e.transform="",e))}function ML(t){var e=t.state,i=t.options,n=i.gpuAcceleration,o=n===void 0?!0:n,u=i.adaptive,c=u===void 0?!0:u,h=i.roundOffsets,m=h===void 0?!0:h,v={placement:Ar(e.placement),variation:Hu(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,RS(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,RS(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const hv={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ML,data:{}};var Cp={passive:!0};function UL(t){var e=t.state,i=t.instance,n=t.options,o=n.scroll,u=o===void 0?!0:o,c=n.resize,h=c===void 0?!0:c,m=Ln(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return u&&v.forEach(function(T){T.addEventListener("scroll",i.update,Cp)}),h&&m.addEventListener("resize",i.update,Cp),function(){u&&v.forEach(function(T){T.removeEventListener("scroll",i.update,Cp)}),h&&m.removeEventListener("resize",i.update,Cp)}}const fv={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:UL,data:{}};var BL={left:"right",right:"left",bottom:"top",top:"bottom"};function zp(t){return t.replace(/left|right|bottom|top/g,function(e){return BL[e]})}var FL={start:"end",end:"start"};function MS(t){return t.replace(/start|end/g,function(e){return FL[e]})}function pv(t){var e=Ln(t),i=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:i,scrollTop:n}}function mv(t){return ju(ro(t)).left+pv(t).scrollLeft}function $L(t,e){var i=Ln(t),n=ro(t),o=i.visualViewport,u=n.clientWidth,c=n.clientHeight,h=0,m=0;if(o){u=o.width,c=o.height;var v=qC();(v||!v&&e==="fixed")&&(h=o.offsetLeft,m=o.offsetTop)}return{width:u,height:c,x:h+mv(t),y:m}}function jL(t){var e,i=ro(t),n=pv(t),o=(e=t.ownerDocument)==null?void 0:e.body,u=Qo(i.scrollWidth,i.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=Qo(i.scrollHeight,i.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),h=-n.scrollLeft+mv(t),m=-n.scrollTop;return _a(o||i).direction==="rtl"&&(h+=Qo(i.clientWidth,o?o.clientWidth:0)-u),{width:u,height:c,x:h,y:m}}function gv(t){var e=_a(t),i=e.overflow,n=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+o+n)}function YC(t){return["html","body","#document"].indexOf(Lr(t))>=0?t.ownerDocument.body:An(t)&&gv(t)?t:YC(Wm(t))}function Jd(t,e){var i;e===void 0&&(e=[]);var n=YC(t),o=n===((i=t.ownerDocument)==null?void 0:i.body),u=Ln(n),c=o?[u].concat(u.visualViewport||[],gv(n)?n:[]):n,h=e.concat(c);return o?h:h.concat(Jd(Wm(c)))}function c0(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function HL(t,e){var i=ju(t,!1,e==="fixed");return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}function US(t,e,i){return e===av?c0($L(t,i)):al(e)?HL(e,i):c0(jL(ro(t)))}function VL(t){var e=Jd(Wm(t)),i=["absolute","fixed"].indexOf(_a(t).position)>=0,n=i&&An(t)?Ah(t):t;return al(n)?e.filter(function(o){return al(o)&&WC(o,n)&&Lr(o)!=="body"}):[]}function qL(t,e,i,n){var o=e==="clippingParents"?VL(t):[].concat(e),u=[].concat(o,[i]),c=u[0],h=u.reduce(function(m,v){var T=US(t,v,n);return m.top=Qo(T.top,m.top),m.right=am(T.right,m.right),m.bottom=am(T.bottom,m.bottom),m.left=Qo(T.left,m.left),m},US(t,c,n));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function QC(t){var e=t.reference,i=t.element,n=t.placement,o=n?Ar(n):null,u=n?Hu(n):null,c=e.x+e.width/2-i.width/2,h=e.y+e.height/2-i.height/2,m;switch(o){case Rs:m={x:c,y:e.y-i.height};break;case _n:m={x:c,y:e.y+e.height};break;case yn:m={x:e.x+e.width,y:h};break;case Ms:m={x:e.x-i.width,y:h};break;default:m={x:e.x,y:e.y}}var v=o?dv(o):null;if(v!=null){var T=v==="y"?"height":"width";switch(u){case rl:m[v]=m[v]-(e[T]/2-i[T]/2);break;case Fu:m[v]=m[v]+(e[T]/2-i[T]/2);break}}return m}function Vu(t,e){e===void 0&&(e={});var i=e,n=i.placement,o=n===void 0?t.placement:n,u=i.strategy,c=u===void 0?t.strategy:u,h=i.boundary,m=h===void 0?PC:h,v=i.rootBoundary,T=v===void 0?av:v,O=i.elementContext,R=O===void 0?vu:O,M=i.altBoundary,z=M===void 0?!1:M,j=i.padding,q=j===void 0?0:j,W=zC(typeof q!="number"?q:KC(q,lc)),ee=R===vu?LC:vu,se=t.rects.popper,re=t.elements[z?ee:R],ie=qL(al(re)?re:re.contextElement||ro(t.elements.popper),m,T,c),ye=ju(t.elements.reference),Pe=QC({reference:ye,element:se,strategy:"absolute",placement:o}),Ie=c0(Object.assign({},se,Pe)),Be=R===vu?Ie:ye,Ve={top:ie.top-Be.top+W.top,bottom:Be.bottom-ie.bottom+W.bottom,left:ie.left-Be.left+W.left,right:Be.right-ie.right+W.right},We=t.modifiersData.offset;if(R===vu&&We){var it=We[o];Object.keys(Ve).forEach(function(Le){var ct=[yn,_n].indexOf(Le)>=0?1:-1,Ht=[Rs,_n].indexOf(Le)>=0?"y":"x";Ve[Le]+=it[Ht]*ct})}return Ve}function WL(t,e){e===void 0&&(e={});var i=e,n=i.placement,o=i.boundary,u=i.rootBoundary,c=i.padding,h=i.flipVariations,m=i.allowedAutoPlacements,v=m===void 0?ov:m,T=Hu(n),O=T?h?l0:l0.filter(function(z){return Hu(z)===T}):lc,R=O.filter(function(z){return v.indexOf(z)>=0});R.length===0&&(R=O);var M=R.reduce(function(z,j){return z[j]=Vu(t,{placement:j,boundary:o,rootBoundary:u,padding:c})[Ar(j)],z},{});return Object.keys(M).sort(function(z,j){return M[z]-M[j]})}function GL(t){if(Ar(t)===qm)return[];var e=zp(t);return[MS(t),e,MS(e)]}function zL(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var o=i.mainAxis,u=o===void 0?!0:o,c=i.altAxis,h=c===void 0?!0:c,m=i.fallbackPlacements,v=i.padding,T=i.boundary,O=i.rootBoundary,R=i.altBoundary,M=i.flipVariations,z=M===void 0?!0:M,j=i.allowedAutoPlacements,q=e.options.placement,W=Ar(q),ee=W===q,se=m||(ee||!z?[zp(q)]:GL(q)),re=[q].concat(se).reduce(function(Qt,be){return Qt.concat(Ar(be)===qm?WL(e,{placement:be,boundary:T,rootBoundary:O,padding:v,flipVariations:z,allowedAutoPlacements:j}):be)},[]),ie=e.rects.reference,ye=e.rects.popper,Pe=new Map,Ie=!0,Be=re[0],Ve=0;Ve<re.length;Ve++){var We=re[Ve],it=Ar(We),Le=Hu(We)===rl,ct=[Rs,_n].indexOf(it)>=0,Ht=ct?"width":"height",Qe=Vu(e,{placement:We,boundary:T,rootBoundary:O,altBoundary:R,padding:v}),Ze=ct?Le?yn:Ms:Le?_n:Rs;ie[Ht]>ye[Ht]&&(Ze=zp(Ze));var _t=zp(Ze),Vt=[];if(u&&Vt.push(Qe[it]<=0),h&&Vt.push(Qe[Ze]<=0,Qe[_t]<=0),Vt.every(function(Qt){return Qt})){Be=We,Ie=!1;break}Pe.set(We,Vt)}if(Ie)for(var mi=z?3:1,ei=function(be){var He=re.find(function(Ue){var Xe=Pe.get(Ue);if(Xe)return Xe.slice(0,be).every(function(Ct){return Ct})});if(He)return Be=He,"break"},Ft=mi;Ft>0;Ft--){var Mt=ei(Ft);if(Mt==="break")break}e.placement!==Be&&(e.modifiersData[n]._skip=!0,e.placement=Be,e.reset=!0)}}const JC={name:"flip",enabled:!0,phase:"main",fn:zL,requiresIfExists:["offset"],data:{_skip:!1}};function BS(t,e,i){return i===void 0&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function FS(t){return[Rs,yn,_n,Ms].some(function(e){return t[e]>=0})}function KL(t){var e=t.state,i=t.name,n=e.rects.reference,o=e.rects.popper,u=e.modifiersData.preventOverflow,c=Vu(e,{elementContext:"reference"}),h=Vu(e,{altBoundary:!0}),m=BS(c,n),v=BS(h,o,u),T=FS(m),O=FS(v);e.modifiersData[i]={referenceClippingOffsets:m,popperEscapeOffsets:v,isReferenceHidden:T,hasPopperEscaped:O},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":T,"data-popper-escaped":O})}const ZC={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:KL};function XL(t,e,i){var n=Ar(t),o=[Ms,Rs].indexOf(n)>=0?-1:1,u=typeof i=="function"?i(Object.assign({},e,{placement:t})):i,c=u[0],h=u[1];return c=c||0,h=(h||0)*o,[Ms,yn].indexOf(n)>=0?{x:h,y:c}:{x:c,y:h}}function YL(t){var e=t.state,i=t.options,n=t.name,o=i.offset,u=o===void 0?[0,0]:o,c=ov.reduce(function(T,O){return T[O]=XL(O,e.rects,u),T},{}),h=c[e.placement],m=h.x,v=h.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=v),e.modifiersData[n]=c}const e1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:YL};function QL(t){var e=t.state,i=t.name;e.modifiersData[i]=QC({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const _v={name:"popperOffsets",enabled:!0,phase:"read",fn:QL,data:{}};function JL(t){return t==="x"?"y":"x"}function ZL(t){var e=t.state,i=t.options,n=t.name,o=i.mainAxis,u=o===void 0?!0:o,c=i.altAxis,h=c===void 0?!1:c,m=i.boundary,v=i.rootBoundary,T=i.altBoundary,O=i.padding,R=i.tether,M=R===void 0?!0:R,z=i.tetherOffset,j=z===void 0?0:z,q=Vu(e,{boundary:m,rootBoundary:v,padding:O,altBoundary:T}),W=Ar(e.placement),ee=Hu(e.placement),se=!ee,re=dv(W),ie=JL(re),ye=e.modifiersData.popperOffsets,Pe=e.rects.reference,Ie=e.rects.popper,Be=typeof j=="function"?j(Object.assign({},e.rects,{placement:e.placement})):j,Ve=typeof Be=="number"?{mainAxis:Be,altAxis:Be}:Object.assign({mainAxis:0,altAxis:0},Be),We=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,it={x:0,y:0};if(ye){if(u){var Le,ct=re==="y"?Rs:Ms,Ht=re==="y"?_n:yn,Qe=re==="y"?"height":"width",Ze=ye[re],_t=Ze+q[ct],Vt=Ze-q[Ht],mi=M?-Ie[Qe]/2:0,ei=ee===rl?Pe[Qe]:Ie[Qe],Ft=ee===rl?-Ie[Qe]:-Pe[Qe],Mt=e.elements.arrow,Qt=M&&Mt?cv(Mt):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:GC(),He=be[ct],Ue=be[Ht],Xe=Qd(0,Pe[Qe],Qt[Qe]),Ct=se?Pe[Qe]/2-mi-Xe-He-Ve.mainAxis:ei-Xe-He-Ve.mainAxis,Jt=se?-Pe[Qe]/2+mi+Xe+Ue+Ve.mainAxis:Ft+Xe+Ue+Ve.mainAxis,je=e.elements.arrow&&Ah(e.elements.arrow),X=je?re==="y"?je.clientTop||0:je.clientLeft||0:0,ne=(Le=We==null?void 0:We[re])!=null?Le:0,pe=Ze+Ct-ne-X,_e=Ze+Jt-ne,Ce=Qd(M?am(_t,pe):_t,Ze,M?Qo(Vt,_e):Vt);ye[re]=Ce,it[re]=Ce-Ze}if(h){var Re,Fe=re==="x"?Rs:Ms,Oe=re==="x"?_n:yn,Se=ye[ie],ke=ie==="y"?"height":"width",et=Se+q[Fe],Je=Se-q[Oe],tt=[Rs,Ms].indexOf(W)!==-1,rt=(Re=We==null?void 0:We[ie])!=null?Re:0,mt=tt?et:Se-Pe[ke]-Ie[ke]-rt+Ve.altAxis,Dt=tt?Se+Pe[ke]+Ie[ke]-rt-Ve.altAxis:Je,Pt=M&&tt?OL(mt,Se,Dt):Qd(M?mt:et,Se,M?Dt:Je);ye[ie]=Pt,it[ie]=Pt-Se}e.modifiersData[n]=it}}const t1={name:"preventOverflow",enabled:!0,phase:"main",fn:ZL,requiresIfExists:["offset"]};function eN(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function tN(t){return t===Ln(t)||!An(t)?pv(t):eN(t)}function iN(t){var e=t.getBoundingClientRect(),i=$u(e.width)/t.offsetWidth||1,n=$u(e.height)/t.offsetHeight||1;return i!==1||n!==1}function sN(t,e,i){i===void 0&&(i=!1);var n=An(e),o=An(e)&&iN(e),u=ro(e),c=ju(t,o,i),h={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(n||!n&&!i)&&((Lr(e)!=="body"||gv(u))&&(h=tN(e)),An(e)?(m=ju(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):u&&(m.x=mv(u))),{x:c.left+h.scrollLeft-m.x,y:c.top+h.scrollTop-m.y,width:c.width,height:c.height}}function nN(t){var e=new Map,i=new Set,n=[];t.forEach(function(u){e.set(u.name,u)});function o(u){i.add(u.name);var c=[].concat(u.requires||[],u.requiresIfExists||[]);c.forEach(function(h){if(!i.has(h)){var m=e.get(h);m&&o(m)}}),n.push(u)}return t.forEach(function(u){i.has(u.name)||o(u)}),n}function rN(t){var e=nN(t);return VC.reduce(function(i,n){return i.concat(e.filter(function(o){return o.phase===n}))},[])}function aN(t){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(t())})})),e}}function oN(t){var e=t.reduce(function(i,n){var o=i[n.name];return i[n.name]=o?Object.assign({},o,n,{options:Object.assign({},o.options,n.options),data:Object.assign({},o.data,n.data)}):n,i},{});return Object.keys(e).map(function(i){return e[i]})}var $S={placement:"bottom",modifiers:[],strategy:"absolute"};function jS(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Gm(t){t===void 0&&(t={});var e=t,i=e.defaultModifiers,n=i===void 0?[]:i,o=e.defaultOptions,u=o===void 0?$S:o;return function(h,m,v){v===void 0&&(v=u);var T={placement:"bottom",orderedModifiers:[],options:Object.assign({},$S,u),modifiersData:{},elements:{reference:h,popper:m},attributes:{},styles:{}},O=[],R=!1,M={state:T,setOptions:function(W){var ee=typeof W=="function"?W(T.options):W;j(),T.options=Object.assign({},u,T.options,ee),T.scrollParents={reference:al(h)?Jd(h):h.contextElement?Jd(h.contextElement):[],popper:Jd(m)};var se=rN(oN([].concat(n,T.options.modifiers)));return T.orderedModifiers=se.filter(function(re){return re.enabled}),z(),M.update()},forceUpdate:function(){if(!R){var W=T.elements,ee=W.reference,se=W.popper;if(jS(ee,se)){T.rects={reference:sN(ee,Ah(se),T.options.strategy==="fixed"),popper:cv(se)},T.reset=!1,T.placement=T.options.placement,T.orderedModifiers.forEach(function(Ve){return T.modifiersData[Ve.name]=Object.assign({},Ve.data)});for(var re=0;re<T.orderedModifiers.length;re++){if(T.reset===!0){T.reset=!1,re=-1;continue}var ie=T.orderedModifiers[re],ye=ie.fn,Pe=ie.options,Ie=Pe===void 0?{}:Pe,Be=ie.name;typeof ye=="function"&&(T=ye({state:T,options:Ie,name:Be,instance:M})||T)}}}},update:aN(function(){return new Promise(function(q){M.forceUpdate(),q(T)})}),destroy:function(){j(),R=!0}};if(!jS(h,m))return M;M.setOptions(v).then(function(q){!R&&v.onFirstUpdate&&v.onFirstUpdate(q)});function z(){T.orderedModifiers.forEach(function(q){var W=q.name,ee=q.options,se=ee===void 0?{}:ee,re=q.effect;if(typeof re=="function"){var ie=re({state:T,name:W,instance:M,options:se}),ye=function(){};O.push(ie||ye)}})}function j(){O.forEach(function(q){return q()}),O=[]}return M}}var lN=Gm(),uN=[fv,_v,hv,uv],cN=Gm({defaultModifiers:uN}),dN=[fv,_v,hv,uv,e1,JC,t1,XC,ZC],yv=Gm({defaultModifiers:dN});const i1=Object.freeze(Object.defineProperty({__proto__:null,afterMain:FC,afterRead:MC,afterWrite:HC,applyStyles:uv,arrow:XC,auto:qm,basePlacements:lc,beforeMain:UC,beforeRead:NC,beforeWrite:$C,bottom:_n,clippingParents:PC,computeStyles:hv,createPopper:yv,createPopperBase:lN,createPopperLite:cN,detectOverflow:Vu,end:Fu,eventListeners:fv,flip:JC,hide:ZC,left:Ms,main:BC,modifierPhases:VC,offset:e1,placements:ov,popper:vu,popperGenerator:Gm,popperOffsets:_v,preventOverflow:t1,read:RC,reference:LC,right:yn,start:rl,top:Rs,variationPlacements:l0,viewport:av,write:jC},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const hN=1e6,fN=1e3,d0="transitionend",pN=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),mN=t=>{do t+=Math.floor(Math.random()*hN);while(document.getElementById(t));return t},s1=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&i!=="#"?i.trim():null}return e},n1=t=>{const e=s1(t);return e&&document.querySelector(e)?e:null},ca=t=>{const e=s1(t);return e?document.querySelector(e):null},gN=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),o=Number.parseFloat(i);return!n&&!o?0:(e=e.split(",")[0],i=i.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(i))*fN)},r1=t=>{t.dispatchEvent(new Event(d0))},da=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),Qa=t=>da(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(t):null,uc=t=>{if(!da(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const n=t.closest("summary");if(n&&n.parentNode!==i||n===null)return!1}return e},Ja=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",a1=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?a1(t.parentNode):null},om=()=>{},kh=t=>{t.offsetHeight},o1=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_y=[],_N=t=>{document.readyState==="loading"?(_y.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of _y)e()}),_y.push(t)):t()},On=()=>document.documentElement.dir==="rtl",Nn=t=>{_N(()=>{const e=o1();if(e){const i=t.NAME,n=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=n,t.jQueryInterface)}})},oa=t=>{typeof t=="function"&&t()},l1=(t,e,i=!0)=>{if(!i){oa(t);return}const n=5,o=gN(e)+n;let u=!1;const c=({target:h})=>{h===e&&(u=!0,e.removeEventListener(d0,c),oa(t))};e.addEventListener(d0,c),setTimeout(()=>{u||r1(e)},o)},vv=(t,e,i,n)=>{const o=t.length;let u=t.indexOf(e);return u===-1?!i&&n?t[o-1]:t[0]:(u+=i?1:-1,n&&(u=(u+o)%o),t[Math.max(0,Math.min(u,o-1))])},yN=/[^.]*(?=\..*)\.|.*/,vN=/\..*/,TN=/::\d+$/,yy={};let HS=1;const u1={mouseenter:"mouseover",mouseleave:"mouseout"},bN=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function c1(t,e){return e&&`${e}::${HS++}`||t.uidEvent||HS++}function d1(t){const e=c1(t);return t.uidEvent=e,yy[e]=yy[e]||{},yy[e]}function EN(t,e){return function i(n){return Tv(n,{delegateTarget:t}),i.oneOff&&De.off(t,n.type,e),e.apply(t,[n])}}function SN(t,e,i){return function n(o){const u=t.querySelectorAll(e);for(let{target:c}=o;c&&c!==this;c=c.parentNode)for(const h of u)if(h===c)return Tv(o,{delegateTarget:c}),n.oneOff&&De.off(t,o.type,e,i),i.apply(c,[o])}}function h1(t,e,i=null){return Object.values(t).find(n=>n.callable===e&&n.delegationSelector===i)}function f1(t,e,i){const n=typeof e=="string",o=n?i:e||i;let u=p1(t);return bN.has(u)||(u=t),[n,o,u]}function VS(t,e,i,n,o){if(typeof e!="string"||!t)return;let[u,c,h]=f1(e,i,n);e in u1&&(c=(z=>function(j){if(!j.relatedTarget||j.relatedTarget!==j.delegateTarget&&!j.delegateTarget.contains(j.relatedTarget))return z.call(this,j)})(c));const m=d1(t),v=m[h]||(m[h]={}),T=h1(v,c,u?i:null);if(T){T.oneOff=T.oneOff&&o;return}const O=c1(c,e.replace(yN,"")),R=u?SN(t,i,c):EN(t,c);R.delegationSelector=u?i:null,R.callable=c,R.oneOff=o,R.uidEvent=O,v[O]=R,t.addEventListener(h,R,u)}function h0(t,e,i,n,o){const u=h1(e[i],n,o);u&&(t.removeEventListener(i,u,Boolean(o)),delete e[i][u.uidEvent])}function xN(t,e,i,n){const o=e[i]||{};for(const u of Object.keys(o))if(u.includes(n)){const c=o[u];h0(t,e,i,c.callable,c.delegationSelector)}}function p1(t){return t=t.replace(vN,""),u1[t]||t}const De={on(t,e,i,n){VS(t,e,i,n,!1)},one(t,e,i,n){VS(t,e,i,n,!0)},off(t,e,i,n){if(typeof e!="string"||!t)return;const[o,u,c]=f1(e,i,n),h=c!==e,m=d1(t),v=m[c]||{},T=e.startsWith(".");if(typeof u<"u"){if(!Object.keys(v).length)return;h0(t,m,c,u,o?i:null);return}if(T)for(const O of Object.keys(m))xN(t,m,O,e.slice(1));for(const O of Object.keys(v)){const R=O.replace(TN,"");if(!h||e.includes(R)){const M=v[O];h0(t,m,c,M.callable,M.delegationSelector)}}},trigger(t,e,i){if(typeof e!="string"||!t)return null;const n=o1(),o=p1(e),u=e!==o;let c=null,h=!0,m=!0,v=!1;u&&n&&(c=n.Event(e,i),n(t).trigger(c),h=!c.isPropagationStopped(),m=!c.isImmediatePropagationStopped(),v=c.isDefaultPrevented());let T=new Event(e,{bubbles:h,cancelable:!0});return T=Tv(T,i),v&&T.preventDefault(),m&&t.dispatchEvent(T),T.defaultPrevented&&c&&c.preventDefault(),T}};function Tv(t,e){for(const[i,n]of Object.entries(e||{}))try{t[i]=n}catch{Object.defineProperty(t,i,{configurable:!0,get(){return n}})}return t}const ja=new Map,vy={set(t,e,i){ja.has(t)||ja.set(t,new Map);const n=ja.get(t);if(!n.has(e)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(e,i)},get(t,e){return ja.has(t)&&ja.get(t).get(e)||null},remove(t,e){if(!ja.has(t))return;const i=ja.get(t);i.delete(e),i.size===0&&ja.delete(t)}};function qS(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function Ty(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ha={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${Ty(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${Ty(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of i){let o=n.replace(/^bs/,"");o=o.charAt(0).toLowerCase()+o.slice(1,o.length),e[o]=qS(t.dataset[n])}return e},getDataAttribute(t,e){return qS(t.getAttribute(`data-bs-${Ty(e)}`))}};let Ih=class{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,i){const n=da(i)?ha.getDataAttribute(i,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...da(i)?ha.getDataAttributes(i):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,i=this.constructor.DefaultType){for(const n of Object.keys(i)){const o=i[n],u=e[n],c=da(u)?"element":pN(u);if(!new RegExp(o).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${c}" but expected type "${o}".`)}}};const wN="5.2.3";class nr extends Ih{constructor(e,i){super(),e=Qa(e),e&&(this._element=e,this._config=this._getConfig(i),vy.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vy.remove(this._element,this.constructor.DATA_KEY),De.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,i,n=!0){l1(e,i,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vy.get(Qa(e),this.DATA_KEY)}static getOrCreateInstance(e,i={}){return this.getInstance(e)||new this(e,typeof i=="object"?i:null)}static get VERSION(){return wN}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const zm=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;De.on(document,i,`[data-bs-dismiss="${n}"]`,function(o){if(["A","AREA"].includes(this.tagName)&&o.preventDefault(),Ja(this))return;const u=ca(this)||this.closest(`.${n}`);t.getOrCreateInstance(u)[e]()})},CN="alert",AN="bs.alert",m1=`.${AN}`,kN=`close${m1}`,IN=`closed${m1}`,ON="fade",DN="show";class Km extends nr{static get NAME(){return CN}close(){if(De.trigger(this._element,kN).defaultPrevented)return;this._element.classList.remove(DN);const i=this._element.classList.contains(ON);this._queueCallback(()=>this._destroyElement(),this._element,i)}_destroyElement(){this._element.remove(),De.trigger(this._element,IN),this.dispose()}static jQueryInterface(e){return this.each(function(){const i=Km.getOrCreateInstance(this);if(typeof e=="string"){if(i[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);i[e](this)}})}}zm(Km,"close");Nn(Km);const PN="button",LN="bs.button",NN=`.${LN}`,RN=".data-api",MN="active",WS='[data-bs-toggle="button"]',UN=`click${NN}${RN}`;let g1=class _1 extends nr{static get NAME(){return PN}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(MN))}static jQueryInterface(e){return this.each(function(){const i=_1.getOrCreateInstance(this);e==="toggle"&&i[e]()})}};De.on(document,UN,WS,t=>{t.preventDefault();const e=t.target.closest(WS);g1.getOrCreateInstance(e).toggle()});Nn(g1);const It={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(i=>i.matches(e))},parents(t,e){const i=[];let n=t.parentNode.closest(e);for(;n;)i.push(n),n=n.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(i=>`${i}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(i=>!Ja(i)&&uc(i))}},BN="swipe",cc=".bs.swipe",FN=`touchstart${cc}`,$N=`touchmove${cc}`,jN=`touchend${cc}`,HN=`pointerdown${cc}`,VN=`pointerup${cc}`,qN="touch",WN="pen",GN="pointer-event",zN=40,KN={endCallback:null,leftCallback:null,rightCallback:null},XN={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class lm extends Ih{constructor(e,i){super(),this._element=e,!(!e||!lm.isSupported())&&(this._config=this._getConfig(i),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return KN}static get DefaultType(){return XN}static get NAME(){return BN}dispose(){De.off(this._element,cc)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),oa(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=zN)return;const i=e/this._deltaX;this._deltaX=0,i&&oa(i>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(De.on(this._element,HN,e=>this._start(e)),De.on(this._element,VN,e=>this._end(e)),this._element.classList.add(GN)):(De.on(this._element,FN,e=>this._start(e)),De.on(this._element,$N,e=>this._move(e)),De.on(this._element,jN,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===WN||e.pointerType===qN)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const YN="carousel",QN="bs.carousel",ao=`.${QN}`,y1=".data-api",JN="ArrowLeft",ZN="ArrowRight",eR=500,Nd="next",lu="prev",Tu="left",Kp="right",tR=`slide${ao}`,by=`slid${ao}`,iR=`keydown${ao}`,sR=`mouseenter${ao}`,nR=`mouseleave${ao}`,rR=`dragstart${ao}`,aR=`load${ao}${y1}`,oR=`click${ao}${y1}`,v1="carousel",Ap="active",lR="slide",uR="carousel-item-end",cR="carousel-item-start",dR="carousel-item-next",hR="carousel-item-prev",T1=".active",b1=".carousel-item",fR=T1+b1,pR=".carousel-item img",mR=".carousel-indicators",gR="[data-bs-slide], [data-bs-slide-to]",_R='[data-bs-ride="carousel"]',yR={[JN]:Kp,[ZN]:Tu},vR={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},TR={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Oh extends nr{constructor(e,i){super(e,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=It.findOne(mR,this._element),this._addEventListeners(),this._config.ride===v1&&this.cycle()}static get Default(){return vR}static get DefaultType(){return TR}static get NAME(){return YN}next(){this._slide(Nd)}nextWhenVisible(){!document.hidden&&uc(this._element)&&this.next()}prev(){this._slide(lu)}pause(){this._isSliding&&r1(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){De.one(this._element,by,()=>this.cycle());return}this.cycle()}}to(e){const i=this._getItems();if(e>i.length-1||e<0)return;if(this._isSliding){De.one(this._element,by,()=>this.to(e));return}const n=this._getItemIndex(this._getActive());if(n===e)return;const o=e>n?Nd:lu;this._slide(o,i[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&De.on(this._element,iR,e=>this._keydown(e)),this._config.pause==="hover"&&(De.on(this._element,sR,()=>this.pause()),De.on(this._element,nR,()=>this._maybeEnableCycle())),this._config.touch&&lm.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const n of It.find(pR,this._element))De.on(n,rR,o=>o.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(Tu)),rightCallback:()=>this._slide(this._directionToOrder(Kp)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),eR+this._config.interval))}};this._swipeHelper=new lm(this._element,i)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const i=yR[e.key];i&&(e.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const i=It.findOne(T1,this._indicatorsElement);i.classList.remove(Ap),i.removeAttribute("aria-current");const n=It.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(Ap),n.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const i=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(e,i=null){if(this._isSliding)return;const n=this._getActive(),o=e===Nd,u=i||vv(this._getItems(),n,o,this._config.wrap);if(u===n)return;const c=this._getItemIndex(u),h=M=>De.trigger(this._element,M,{relatedTarget:u,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:c});if(h(tR).defaultPrevented||!n||!u)return;const v=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=u;const T=o?cR:uR,O=o?dR:hR;u.classList.add(O),kh(u),n.classList.add(T),u.classList.add(T);const R=()=>{u.classList.remove(T,O),u.classList.add(Ap),n.classList.remove(Ap,O,T),this._isSliding=!1,h(by)};this._queueCallback(R,n,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(lR)}_getActive(){return It.findOne(fR,this._element)}_getItems(){return It.find(b1,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return On()?e===Tu?lu:Nd:e===Tu?Nd:lu}_orderToDirection(e){return On()?e===lu?Tu:Kp:e===lu?Kp:Tu}static jQueryInterface(e){return this.each(function(){const i=Oh.getOrCreateInstance(this,e);if(typeof e=="number"){i.to(e);return}if(typeof e=="string"){if(i[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);i[e]()}})}}De.on(document,oR,gR,function(t){const e=ca(this);if(!e||!e.classList.contains(v1))return;t.preventDefault();const i=Oh.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");if(n){i.to(n),i._maybeEnableCycle();return}if(ha.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()});De.on(window,aR,()=>{const t=It.find(_R);for(const e of t)Oh.getOrCreateInstance(e)});Nn(Oh);const bR="collapse",ER="bs.collapse",Dh=`.${ER}`,SR=".data-api",xR=`show${Dh}`,wR=`shown${Dh}`,CR=`hide${Dh}`,AR=`hidden${Dh}`,kR=`click${Dh}${SR}`,Ey="show",Su="collapse",kp="collapsing",IR="collapsed",OR=`:scope .${Su} .${Su}`,DR="collapse-horizontal",PR="width",LR="height",NR=".collapse.show, .collapse.collapsing",f0='[data-bs-toggle="collapse"]',RR={parent:null,toggle:!0},MR={parent:"(null|element)",toggle:"boolean"};class uh extends nr{constructor(e,i){super(e,i),this._isTransitioning=!1,this._triggerArray=[];const n=It.find(f0);for(const o of n){const u=n1(o),c=It.find(u).filter(h=>h===this._element);u!==null&&c.length&&this._triggerArray.push(o)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return RR}static get DefaultType(){return MR}static get NAME(){return bR}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(NR).filter(h=>h!==this._element).map(h=>uh.getOrCreateInstance(h,{toggle:!1}))),e.length&&e[0]._isTransitioning||De.trigger(this._element,xR).defaultPrevented)return;for(const h of e)h.hide();const n=this._getDimension();this._element.classList.remove(Su),this._element.classList.add(kp),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(kp),this._element.classList.add(Su,Ey),this._element.style[n]="",De.trigger(this._element,wR)},c=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback(o,this._element,!0),this._element.style[n]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||De.trigger(this._element,CR).defaultPrevented)return;const i=this._getDimension();this._element.style[i]=`${this._element.getBoundingClientRect()[i]}px`,kh(this._element),this._element.classList.add(kp),this._element.classList.remove(Su,Ey);for(const o of this._triggerArray){const u=ca(o);u&&!this._isShown(u)&&this._addAriaAndCollapsedClass([o],!1)}this._isTransitioning=!0;const n=()=>{this._isTransitioning=!1,this._element.classList.remove(kp),this._element.classList.add(Su),De.trigger(this._element,AR)};this._element.style[i]="",this._queueCallback(n,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ey)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=Qa(e.parent),e}_getDimension(){return this._element.classList.contains(DR)?PR:LR}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(f0);for(const i of e){const n=ca(i);n&&this._addAriaAndCollapsedClass([i],this._isShown(n))}}_getFirstLevelChildren(e){const i=It.find(OR,this._config.parent);return It.find(e,this._config.parent).filter(n=>!i.includes(n))}_addAriaAndCollapsedClass(e,i){if(e.length)for(const n of e)n.classList.toggle(IR,!i),n.setAttribute("aria-expanded",i)}static jQueryInterface(e){const i={};return typeof e=="string"&&/show|hide/.test(e)&&(i.toggle=!1),this.each(function(){const n=uh.getOrCreateInstance(this,i);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}De.on(document,kR,f0,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();const e=n1(this),i=It.find(e);for(const n of i)uh.getOrCreateInstance(n,{toggle:!1}).toggle()});Nn(uh);const GS="dropdown",UR="bs.dropdown",ul=`.${UR}`,bv=".data-api",BR="Escape",zS="Tab",FR="ArrowUp",KS="ArrowDown",$R=2,jR=`hide${ul}`,HR=`hidden${ul}`,VR=`show${ul}`,qR=`shown${ul}`,E1=`click${ul}${bv}`,S1=`keydown${ul}${bv}`,WR=`keyup${ul}${bv}`,bu="show",GR="dropup",zR="dropend",KR="dropstart",XR="dropup-center",YR="dropdown-center",zo='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',QR=`${zo}.${bu}`,Xp=".dropdown-menu",JR=".navbar",ZR=".navbar-nav",eM=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",tM=On()?"top-end":"top-start",iM=On()?"top-start":"top-end",sM=On()?"bottom-end":"bottom-start",nM=On()?"bottom-start":"bottom-end",rM=On()?"left-start":"right-start",aM=On()?"right-start":"left-start",oM="top",lM="bottom",uM={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},cM={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class kr extends nr{constructor(e,i){super(e,i),this._popper=null,this._parent=this._element.parentNode,this._menu=It.next(this._element,Xp)[0]||It.prev(this._element,Xp)[0]||It.findOne(Xp,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return uM}static get DefaultType(){return cM}static get NAME(){return GS}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ja(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!De.trigger(this._element,VR,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(ZR))for(const n of[].concat(...document.body.children))De.on(n,"mouseover",om);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(bu),this._element.classList.add(bu),De.trigger(this._element,qR,e)}}hide(){if(Ja(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!De.trigger(this._element,jR,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const n of[].concat(...document.body.children))De.off(n,"mouseover",om);this._popper&&this._popper.destroy(),this._menu.classList.remove(bu),this._element.classList.remove(bu),this._element.setAttribute("aria-expanded","false"),ha.removeDataAttribute(this._menu,"popper"),De.trigger(this._element,HR,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!da(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${GS.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof i1>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:da(this._config.reference)?e=Qa(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const i=this._getPopperConfig();this._popper=yv(e,this._menu,i)}_isShown(){return this._menu.classList.contains(bu)}_getPlacement(){const e=this._parent;if(e.classList.contains(zR))return rM;if(e.classList.contains(KR))return aM;if(e.classList.contains(XR))return oM;if(e.classList.contains(YR))return lM;const i=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(GR)?i?iM:tM:i?nM:sM}_detectNavbar(){return this._element.closest(JR)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(i=>Number.parseInt(i,10)):typeof e=="function"?i=>e(i,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ha.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...typeof this._config.popperConfig=="function"?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:i}){const n=It.find(eM,this._menu).filter(o=>uc(o));n.length&&vv(n,i,e===KS,!n.includes(i)).focus()}static jQueryInterface(e){return this.each(function(){const i=kr.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}static clearMenus(e){if(e.button===$R||e.type==="keyup"&&e.key!==zS)return;const i=It.find(QR);for(const n of i){const o=kr.getInstance(n);if(!o||o._config.autoClose===!1)continue;const u=e.composedPath(),c=u.includes(o._menu);if(u.includes(o._element)||o._config.autoClose==="inside"&&!c||o._config.autoClose==="outside"&&c||o._menu.contains(e.target)&&(e.type==="keyup"&&e.key===zS||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const h={relatedTarget:o._element};e.type==="click"&&(h.clickEvent=e),o._completeHide(h)}}static dataApiKeydownHandler(e){const i=/input|textarea/i.test(e.target.tagName),n=e.key===BR,o=[FR,KS].includes(e.key);if(!o&&!n||i&&!n)return;e.preventDefault();const u=this.matches(zo)?this:It.prev(this,zo)[0]||It.next(this,zo)[0]||It.findOne(zo,e.delegateTarget.parentNode),c=kr.getOrCreateInstance(u);if(o){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),u.focus())}}De.on(document,S1,zo,kr.dataApiKeydownHandler);De.on(document,S1,Xp,kr.dataApiKeydownHandler);De.on(document,E1,kr.clearMenus);De.on(document,WR,kr.clearMenus);De.on(document,E1,zo,function(t){t.preventDefault(),kr.getOrCreateInstance(this).toggle()});Nn(kr);const XS=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",YS=".sticky-top",Ip="padding-right",QS="margin-right";class p0{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ip,i=>i+e),this._setElementAttributes(XS,Ip,i=>i+e),this._setElementAttributes(YS,QS,i=>i-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ip),this._resetElementAttributes(XS,Ip),this._resetElementAttributes(YS,QS)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,i,n){const o=this.getWidth(),u=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+o)return;this._saveInitialAttribute(c,i);const h=window.getComputedStyle(c).getPropertyValue(i);c.style.setProperty(i,`${n(Number.parseFloat(h))}px`)};this._applyManipulationCallback(e,u)}_saveInitialAttribute(e,i){const n=e.style.getPropertyValue(i);n&&ha.setDataAttribute(e,i,n)}_resetElementAttributes(e,i){const n=o=>{const u=ha.getDataAttribute(o,i);if(u===null){o.style.removeProperty(i);return}ha.removeDataAttribute(o,i),o.style.setProperty(i,u)};this._applyManipulationCallback(e,n)}_applyManipulationCallback(e,i){if(da(e)){i(e);return}for(const n of It.find(e,this._element))i(n)}}const x1="backdrop",dM="fade",JS="show",ZS=`mousedown.bs.${x1}`,hM={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},fM={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class w1 extends Ih{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return hM}static get DefaultType(){return fM}static get NAME(){return x1}show(e){if(!this._config.isVisible){oa(e);return}this._append();const i=this._getElement();this._config.isAnimated&&kh(i),i.classList.add(JS),this._emulateAnimation(()=>{oa(e)})}hide(e){if(!this._config.isVisible){oa(e);return}this._getElement().classList.remove(JS),this._emulateAnimation(()=>{this.dispose(),oa(e)})}dispose(){this._isAppended&&(De.off(this._element,ZS),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(dM),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Qa(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),De.on(e,ZS,()=>{oa(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){l1(e,this._getElement(),this._config.isAnimated)}}const pM="focustrap",mM="bs.focustrap",um=`.${mM}`,gM=`focusin${um}`,_M=`keydown.tab${um}`,yM="Tab",vM="forward",ex="backward",TM={autofocus:!0,trapElement:null},bM={autofocus:"boolean",trapElement:"element"};class C1 extends Ih{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return TM}static get DefaultType(){return bM}static get NAME(){return pM}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),De.off(document,um),De.on(document,gM,e=>this._handleFocusin(e)),De.on(document,_M,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,De.off(document,um))}_handleFocusin(e){const{trapElement:i}=this._config;if(e.target===document||e.target===i||i.contains(e.target))return;const n=It.focusableChildren(i);n.length===0?i.focus():this._lastTabNavDirection===ex?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){e.key===yM&&(this._lastTabNavDirection=e.shiftKey?ex:vM)}}const EM="modal",SM="bs.modal",rr=`.${SM}`,xM=".data-api",wM="Escape",CM=`hide${rr}`,AM=`hidePrevented${rr}`,A1=`hidden${rr}`,k1=`show${rr}`,kM=`shown${rr}`,IM=`resize${rr}`,OM=`click.dismiss${rr}`,DM=`mousedown.dismiss${rr}`,PM=`keydown.dismiss${rr}`,LM=`click${rr}${xM}`,tx="modal-open",NM="fade",ix="show",Sy="modal-static",RM=".modal.show",MM=".modal-dialog",UM=".modal-body",BM='[data-bs-toggle="modal"]',FM={backdrop:!0,focus:!0,keyboard:!0},$M={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class qu extends nr{constructor(e,i){super(e,i),this._dialog=It.findOne(MM,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new p0,this._addEventListeners()}static get Default(){return FM}static get DefaultType(){return $M}static get NAME(){return EM}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||De.trigger(this._element,k1,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(tx),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||De.trigger(this._element,CM).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ix),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const e of[window,this._dialog])De.off(e,rr);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new w1({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new C1({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const i=It.findOne(UM,this._dialog);i&&(i.scrollTop=0),kh(this._element),this._element.classList.add(ix);const n=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,De.trigger(this._element,kM,{relatedTarget:e})};this._queueCallback(n,this._dialog,this._isAnimated())}_addEventListeners(){De.on(this._element,PM,e=>{if(e.key===wM){if(this._config.keyboard){e.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),De.on(window,IM,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),De.on(this._element,DM,e=>{De.one(this._element,OM,i=>{if(!(this._element!==e.target||this._element!==i.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(tx),this._resetAdjustments(),this._scrollBar.reset(),De.trigger(this._element,A1)})}_isAnimated(){return this._element.classList.contains(NM)}_triggerBackdropTransition(){if(De.trigger(this._element,AM).defaultPrevented)return;const i=this._element.scrollHeight>document.documentElement.clientHeight,n=this._element.style.overflowY;n==="hidden"||this._element.classList.contains(Sy)||(i||(this._element.style.overflowY="hidden"),this._element.classList.add(Sy),this._queueCallback(()=>{this._element.classList.remove(Sy),this._queueCallback(()=>{this._element.style.overflowY=n},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,i=this._scrollBar.getWidth(),n=i>0;if(n&&!e){const o=On()?"paddingLeft":"paddingRight";this._element.style[o]=`${i}px`}if(!n&&e){const o=On()?"paddingRight":"paddingLeft";this._element.style[o]=`${i}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,i){return this.each(function(){const n=qu.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e](i)}})}}De.on(document,LM,BM,function(t){const e=ca(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),De.one(e,k1,o=>{o.defaultPrevented||De.one(e,A1,()=>{uc(this)&&this.focus()})});const i=It.findOne(RM);i&&qu.getInstance(i).hide(),qu.getOrCreateInstance(e).toggle(this)});zm(qu);Nn(qu);const jM="offcanvas",HM="bs.offcanvas",xa=`.${HM}`,I1=".data-api",VM=`load${xa}${I1}`,qM="Escape",sx="show",nx="showing",rx="hiding",WM="offcanvas-backdrop",O1=".offcanvas.show",GM=`show${xa}`,zM=`shown${xa}`,KM=`hide${xa}`,ax=`hidePrevented${xa}`,D1=`hidden${xa}`,XM=`resize${xa}`,YM=`click${xa}${I1}`,QM=`keydown.dismiss${xa}`,JM='[data-bs-toggle="offcanvas"]',ZM={backdrop:!0,keyboard:!0,scroll:!1},e2={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Za extends nr{constructor(e,i){super(e,i),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return ZM}static get DefaultType(){return e2}static get NAME(){return jM}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||De.trigger(this._element,GM,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new p0().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(nx);const n=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(sx),this._element.classList.remove(nx),De.trigger(this._element,zM,{relatedTarget:e})};this._queueCallback(n,this._element,!0)}hide(){if(!this._isShown||De.trigger(this._element,KM).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(rx),this._backdrop.hide();const i=()=>{this._element.classList.remove(sx,rx),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new p0().reset(),De.trigger(this._element,D1)};this._queueCallback(i,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){De.trigger(this._element,ax);return}this.hide()},i=Boolean(this._config.backdrop);return new w1({className:WM,isVisible:i,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:i?e:null})}_initializeFocusTrap(){return new C1({trapElement:this._element})}_addEventListeners(){De.on(this._element,QM,e=>{if(e.key===qM){if(!this._config.keyboard){De.trigger(this._element,ax);return}this.hide()}})}static jQueryInterface(e){return this.each(function(){const i=Za.getOrCreateInstance(this,e);if(typeof e=="string"){if(i[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);i[e](this)}})}}De.on(document,YM,JM,function(t){const e=ca(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Ja(this))return;De.one(e,D1,()=>{uc(this)&&this.focus()});const i=It.findOne(O1);i&&i!==e&&Za.getInstance(i).hide(),Za.getOrCreateInstance(e).toggle(this)});De.on(window,VM,()=>{for(const t of It.find(O1))Za.getOrCreateInstance(t).show()});De.on(window,XM,()=>{for(const t of It.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&Za.getOrCreateInstance(t).hide()});zm(Za);Nn(Za);const t2=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),i2=/^aria-[\w-]*$/i,s2=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,n2=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,r2=(t,e)=>{const i=t.nodeName.toLowerCase();return e.includes(i)?t2.has(i)?Boolean(s2.test(t.nodeValue)||n2.test(t.nodeValue)):!0:e.filter(n=>n instanceof RegExp).some(n=>n.test(i))},P1={"*":["class","dir","id","lang","role",i2],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function a2(t,e,i){if(!t.length)return t;if(i&&typeof i=="function")return i(t);const o=new window.DOMParser().parseFromString(t,"text/html"),u=[].concat(...o.body.querySelectorAll("*"));for(const c of u){const h=c.nodeName.toLowerCase();if(!Object.keys(e).includes(h)){c.remove();continue}const m=[].concat(...c.attributes),v=[].concat(e["*"]||[],e[h]||[]);for(const T of m)r2(T,v)||c.removeAttribute(T.nodeName)}return o.body.innerHTML}const o2="TemplateFactory",l2={allowList:P1,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},u2={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},c2={entry:"(string|element|function|null)",selector:"(string|element)"};class d2 extends Ih{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return l2}static get DefaultType(){return u2}static get NAME(){return o2}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[o,u]of Object.entries(this._config.content))this._setContent(e,u,o);const i=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&i.classList.add(...n.split(" ")),i}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[i,n]of Object.entries(e))super._typeCheckConfig({selector:i,entry:n},c2)}_setContent(e,i,n){const o=It.findOne(n,e);if(o){if(i=this._resolvePossibleFunction(i),!i){o.remove();return}if(da(i)){this._putElementInTemplate(Qa(i),o);return}if(this._config.html){o.innerHTML=this._maybeSanitize(i);return}o.textContent=i}}_maybeSanitize(e){return this._config.sanitize?a2(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return typeof e=="function"?e(this):e}_putElementInTemplate(e,i){if(this._config.html){i.innerHTML="",i.append(e);return}i.textContent=e.textContent}}const h2="tooltip",f2=new Set(["sanitize","allowList","sanitizeFn"]),xy="fade",p2="modal",Op="show",m2=".tooltip-inner",ox=`.${p2}`,lx="hide.bs.modal",Rd="hover",wy="focus",g2="click",_2="manual",y2="hide",v2="hidden",T2="show",b2="shown",E2="inserted",S2="click",x2="focusin",w2="focusout",C2="mouseenter",A2="mouseleave",k2={AUTO:"auto",TOP:"top",RIGHT:On()?"left":"right",BOTTOM:"bottom",LEFT:On()?"right":"left"},I2={allowList:P1,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},O2={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class dc extends nr{constructor(e,i){if(typeof i1>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,i),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return I2}static get DefaultType(){return O2}static get NAME(){return h2}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),De.off(this._element.closest(ox),lx,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=De.trigger(this._element,this.constructor.eventName(T2)),n=(a1(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!n)return;this._disposePopper();const o=this._getTipElement();this._element.setAttribute("aria-describedby",o.getAttribute("id"));const{container:u}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(u.append(o),De.trigger(this._element,this.constructor.eventName(E2))),this._popper=this._createPopper(o),o.classList.add(Op),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))De.on(h,"mouseover",om);const c=()=>{De.trigger(this._element,this.constructor.eventName(b2)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||De.trigger(this._element,this.constructor.eventName(y2)).defaultPrevented)return;if(this._getTipElement().classList.remove(Op),"ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))De.off(o,"mouseover",om);this._activeTrigger[g2]=!1,this._activeTrigger[wy]=!1,this._activeTrigger[Rd]=!1,this._isHovered=null;const n=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),De.trigger(this._element,this.constructor.eventName(v2)))};this._queueCallback(n,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const i=this._getTemplateFactory(e).toHtml();if(!i)return null;i.classList.remove(xy,Op),i.classList.add(`bs-${this.constructor.NAME}-auto`);const n=mN(this.constructor.NAME).toString();return i.setAttribute("id",n),this._isAnimated()&&i.classList.add(xy),i}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new d2({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[m2]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(xy)}_isShown(){return this.tip&&this.tip.classList.contains(Op)}_createPopper(e){const i=typeof this._config.placement=="function"?this._config.placement.call(this,e,this._element):this._config.placement,n=k2[i.toUpperCase()];return yv(this._element,e,this._getPopperConfig(n))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(i=>Number.parseInt(i,10)):typeof e=="function"?i=>e(i,this._element):e}_resolvePossibleFunction(e){return typeof e=="function"?e.call(this._element):e}_getPopperConfig(e){const i={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:n=>{this._getTipElement().setAttribute("data-popper-placement",n.state.placement)}}]};return{...i,...typeof this._config.popperConfig=="function"?this._config.popperConfig(i):this._config.popperConfig}}_setListeners(){const e=this._config.trigger.split(" ");for(const i of e)if(i==="click")De.on(this._element,this.constructor.eventName(S2),this._config.selector,n=>{this._initializeOnDelegatedTarget(n).toggle()});else if(i!==_2){const n=i===Rd?this.constructor.eventName(C2):this.constructor.eventName(x2),o=i===Rd?this.constructor.eventName(A2):this.constructor.eventName(w2);De.on(this._element,n,this._config.selector,u=>{const c=this._initializeOnDelegatedTarget(u);c._activeTrigger[u.type==="focusin"?wy:Rd]=!0,c._enter()}),De.on(this._element,o,this._config.selector,u=>{const c=this._initializeOnDelegatedTarget(u);c._activeTrigger[u.type==="focusout"?wy:Rd]=c._element.contains(u.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},De.on(this._element.closest(ox),lx,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,i){clearTimeout(this._timeout),this._timeout=setTimeout(e,i)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const i=ha.getDataAttributes(this._element);for(const n of Object.keys(i))f2.has(n)&&delete i[n];return e={...i,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Qa(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const i in this._config)this.constructor.Default[i]!==this._config[i]&&(e[i]=this._config[i]);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const i=dc.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}}Nn(dc);const D2="popover",P2=".popover-header",L2=".popover-body",N2={...dc.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},R2={...dc.DefaultType,content:"(null|string|element|function)"};class Ev extends dc{static get Default(){return N2}static get DefaultType(){return R2}static get NAME(){return D2}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[P2]:this._getTitle(),[L2]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const i=Ev.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}}Nn(Ev);const M2="scrollspy",U2="bs.scrollspy",Sv=`.${U2}`,B2=".data-api",F2=`activate${Sv}`,ux=`click${Sv}`,$2=`load${Sv}${B2}`,j2="dropdown-item",uu="active",H2='[data-bs-spy="scroll"]',Cy="[href]",V2=".nav, .list-group",cx=".nav-link",q2=".nav-item",W2=".list-group-item",G2=`${cx}, ${q2} > ${cx}, ${W2}`,z2=".dropdown",K2=".dropdown-toggle",X2={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Y2={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Xm extends nr{constructor(e,i){super(e,i),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return X2}static get DefaultType(){return Y2}static get NAME(){return M2}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Qa(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(i=>Number.parseFloat(i))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(De.off(this._config.target,ux),De.on(this._config.target,ux,Cy,e=>{const i=this._observableSections.get(e.target.hash);if(i){e.preventDefault();const n=this._rootElement||window,o=i.offsetTop-this._element.offsetTop;if(n.scrollTo){n.scrollTo({top:o,behavior:"smooth"});return}n.scrollTop=o}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(i=>this._observerCallback(i),e)}_observerCallback(e){const i=c=>this._targetLinks.get(`#${c.target.id}`),n=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(i(c))},o=(this._rootElement||document.documentElement).scrollTop,u=o>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=o;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(i(c));continue}const h=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(u&&h){if(n(c),!o)return;continue}!u&&!h&&n(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=It.find(Cy,this._config.target);for(const i of e){if(!i.hash||Ja(i))continue;const n=It.findOne(i.hash,this._element);uc(n)&&(this._targetLinks.set(i.hash,i),this._observableSections.set(i.hash,n))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(uu),this._activateParents(e),De.trigger(this._element,F2,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(j2)){It.findOne(K2,e.closest(z2)).classList.add(uu);return}for(const i of It.parents(e,V2))for(const n of It.prev(i,G2))n.classList.add(uu)}_clearActiveClass(e){e.classList.remove(uu);const i=It.find(`${Cy}.${uu}`,e);for(const n of i)n.classList.remove(uu)}static jQueryInterface(e){return this.each(function(){const i=Xm.getOrCreateInstance(this,e);if(typeof e=="string"){if(i[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);i[e]()}})}}De.on(window,$2,()=>{for(const t of It.find(H2))Xm.getOrCreateInstance(t)});Nn(Xm);const Q2="tab",J2="bs.tab",cl=`.${J2}`,Z2=`hide${cl}`,eU=`hidden${cl}`,tU=`show${cl}`,iU=`shown${cl}`,sU=`click${cl}`,nU=`keydown${cl}`,rU=`load${cl}`,aU="ArrowLeft",dx="ArrowRight",oU="ArrowUp",hx="ArrowDown",Ko="active",fx="fade",Ay="show",lU="dropdown",uU=".dropdown-toggle",cU=".dropdown-menu",ky=":not(.dropdown-toggle)",dU='.list-group, .nav, [role="tablist"]',hU=".nav-item, .list-group-item",fU=`.nav-link${ky}, .list-group-item${ky}, [role="tab"]${ky}`,L1='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Iy=`${fU}, ${L1}`,pU=`.${Ko}[data-bs-toggle="tab"], .${Ko}[data-bs-toggle="pill"], .${Ko}[data-bs-toggle="list"]`;class Wu extends nr{constructor(e){super(e),this._parent=this._element.closest(dU),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),De.on(this._element,nU,i=>this._keydown(i)))}static get NAME(){return Q2}show(){const e=this._element;if(this._elemIsActive(e))return;const i=this._getActiveElem(),n=i?De.trigger(i,Z2,{relatedTarget:e}):null;De.trigger(e,tU,{relatedTarget:i}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(i,e),this._activate(e,i))}_activate(e,i){if(!e)return;e.classList.add(Ko),this._activate(ca(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ay);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),De.trigger(e,iU,{relatedTarget:i})};this._queueCallback(n,e,e.classList.contains(fx))}_deactivate(e,i){if(!e)return;e.classList.remove(Ko),e.blur(),this._deactivate(ca(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ay);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),De.trigger(e,eU,{relatedTarget:i})};this._queueCallback(n,e,e.classList.contains(fx))}_keydown(e){if(![aU,dx,oU,hx].includes(e.key))return;e.stopPropagation(),e.preventDefault();const i=[dx,hx].includes(e.key),n=vv(this._getChildren().filter(o=>!Ja(o)),e.target,i,!0);n&&(n.focus({preventScroll:!0}),Wu.getOrCreateInstance(n).show())}_getChildren(){return It.find(Iy,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,i){this._setAttributeIfNotExists(e,"role","tablist");for(const n of i)this._setInitialAttributesOnChild(n)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const i=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",i),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),i||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const i=ca(e);i&&(this._setAttributeIfNotExists(i,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(i,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,i){const n=this._getOuterElement(e);if(!n.classList.contains(lU))return;const o=(u,c)=>{const h=It.findOne(u,n);h&&h.classList.toggle(c,i)};o(uU,Ko),o(cU,Ay),n.setAttribute("aria-expanded",i)}_setAttributeIfNotExists(e,i,n){e.hasAttribute(i)||e.setAttribute(i,n)}_elemIsActive(e){return e.classList.contains(Ko)}_getInnerElement(e){return e.matches(Iy)?e:It.findOne(Iy,e)}_getOuterElement(e){return e.closest(hU)||e}static jQueryInterface(e){return this.each(function(){const i=Wu.getOrCreateInstance(this);if(typeof e=="string"){if(i[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);i[e]()}})}}De.on(document,sU,L1,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!Ja(this)&&Wu.getOrCreateInstance(this).show()});De.on(window,rU,()=>{for(const t of It.find(pU))Wu.getOrCreateInstance(t)});Nn(Wu);const mU="toast",gU="bs.toast",oo=`.${gU}`,_U=`mouseover${oo}`,yU=`mouseout${oo}`,vU=`focusin${oo}`,TU=`focusout${oo}`,bU=`hide${oo}`,EU=`hidden${oo}`,SU=`show${oo}`,xU=`shown${oo}`,wU="fade",px="hide",Dp="show",Pp="showing",CU={animation:"boolean",autohide:"boolean",delay:"number"},AU={animation:!0,autohide:!0,delay:5e3};class Ym extends nr{constructor(e,i){super(e,i),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return AU}static get DefaultType(){return CU}static get NAME(){return mU}show(){if(De.trigger(this._element,SU).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(wU);const i=()=>{this._element.classList.remove(Pp),De.trigger(this._element,xU),this._maybeScheduleHide()};this._element.classList.remove(px),kh(this._element),this._element.classList.add(Dp,Pp),this._queueCallback(i,this._element,this._config.animation)}hide(){if(!this.isShown()||De.trigger(this._element,bU).defaultPrevented)return;const i=()=>{this._element.classList.add(px),this._element.classList.remove(Pp,Dp),De.trigger(this._element,EU)};this._element.classList.add(Pp),this._queueCallback(i,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Dp),super.dispose()}isShown(){return this._element.classList.contains(Dp)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,i){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=i;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=i;break}}if(i){this._clearTimeout();return}const n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){De.on(this._element,_U,e=>this._onInteraction(e,!0)),De.on(this._element,yU,e=>this._onInteraction(e,!1)),De.on(this._element,vU,e=>this._onInteraction(e,!0)),De.on(this._element,TU,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const i=Ym.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e](this)}})}}zm(Ym);Nn(Ym);var Yn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N1(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function n(){if(this instanceof n){var o=[null];o.push.apply(o,arguments);var u=Function.bind.apply(e,o);return new u}return e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(i,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})}),i}var qd;typeof window<"u"?qd=window:typeof Yn<"u"?qd=Yn:typeof self<"u"?qd=self:qd={};var Z=qd;const kU={},IU=Object.freeze(Object.defineProperty({__proto__:null,default:kU},Symbol.toStringTag,{value:"Module"})),OU=N1(IU);var mx=typeof Yn<"u"?Yn:typeof window<"u"?window:{},DU=OU,Wd;typeof document<"u"?Wd=document:(Wd=mx["__GLOBAL_DOCUMENT_CACHE@4"],Wd||(Wd=mx["__GLOBAL_DOCUMENT_CACHE@4"]=DU));var $e=Wd,bt={},PU={get exports(){return bt},set exports(t){bt=t}};(function(t,e){function i(m){if(m&&typeof m=="object"){var v=m.which||m.keyCode||m.charCode;v&&(m=v)}if(typeof m=="number")return c[m];var T=String(m),O=n[T.toLowerCase()];if(O)return O;var O=o[T.toLowerCase()];if(O)return O;if(T.length===1)return T.charCodeAt(0)}i.isEventKey=function(v,T){if(v&&typeof v=="object"){var O=v.which||v.keyCode||v.charCode;if(O==null)return!1;if(typeof T=="string"){var R=n[T.toLowerCase()];if(R)return R===O;var R=o[T.toLowerCase()];if(R)return R===O}else if(typeof T=="number")return T===O;return!1}},e=t.exports=i;var n=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=e.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(u=97;u<123;u++)n[String.fromCharCode(u)]=u-32;for(var u=48;u<58;u++)n[u-48]=u;for(u=1;u<13;u++)n["f"+u]=u+111;for(u=0;u<10;u++)n["numpad "+u]=u+96;var c=e.names=e.title={};for(u in n)c[n[u]]=u;for(var h in o)n[h]=o[h]})(PU,bt);var LU=NU;function NU(t,e){var i,n=null;try{i=JSON.parse(t,e)}catch(o){n=o}return[n,i]}var ch={},RU={get exports(){return ch},set exports(t){ch=t}};function ya(){return ya=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},ya.apply(this,arguments)}const MU=Object.freeze(Object.defineProperty({__proto__:null,default:ya},Symbol.toStringTag,{value:"Module"})),UU=N1(MU);var BU=$U,FU=Object.prototype.toString;function $U(t){if(!t)return!1;var e=FU.call(t);return e==="[object Function]"||typeof t=="function"&&e!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}var jU=Z,HU=function(e,i){return i===void 0&&(i=!1),function(n,o,u){if(n){e(n);return}if(o.statusCode>=400&&o.statusCode<=599){var c=u;if(i)if(jU.TextDecoder){var h=VU(o.headers&&o.headers["content-type"]);try{c=new TextDecoder(h).decode(u)}catch{}}else c=String.fromCharCode.apply(null,new Uint8Array(u));e({cause:c});return}e(null,u)}};function VU(t){return t===void 0&&(t=""),t.toLowerCase().split(";").reduce(function(e,i){var n=i.split("="),o=n[0],u=n[1];return o.trim()==="charset"?u.trim():e},"utf-8")}var qU=HU,R1=Z,WU=UU,GU=BU;Ir.httpHandler=qU;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var zU=function(e){var i={};return e&&e.trim().split(`
`).forEach(function(n){var o=n.indexOf(":"),u=n.slice(0,o).trim().toLowerCase(),c=n.slice(o+1).trim();typeof i[u]>"u"?i[u]=c:Array.isArray(i[u])?i[u].push(c):i[u]=[i[u],c]}),i};RU.exports=Ir;ch.default=Ir;Ir.XMLHttpRequest=R1.XMLHttpRequest||QU;Ir.XDomainRequest="withCredentials"in new Ir.XMLHttpRequest?Ir.XMLHttpRequest:R1.XDomainRequest;KU(["get","put","post","patch","head","delete"],function(t){Ir[t==="delete"?"del":t]=function(e,i,n){return i=M1(e,i,n),i.method=t.toUpperCase(),U1(i)}});function KU(t,e){for(var i=0;i<t.length;i++)e(t[i])}function XU(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function M1(t,e,i){var n=t;return GU(e)?(i=e,typeof t=="string"&&(n={uri:t})):n=WU({},e,{uri:t}),n.callback=i,n}function Ir(t,e,i){return e=M1(t,e,i),U1(e)}function U1(t){if(typeof t.callback>"u")throw new Error("callback argument missing");var e=!1,i=function(se,re,ie){e||(e=!0,t.callback(se,re,ie))};function n(){h.readyState===4&&setTimeout(c,0)}function o(){var ee=void 0;if(h.response?ee=h.response:ee=h.responseText||YU(h),j)try{ee=JSON.parse(ee)}catch{}return ee}function u(ee){return clearTimeout(q),ee instanceof Error||(ee=new Error(""+(ee||"Unknown XMLHttpRequest Error"))),ee.statusCode=0,i(ee,W)}function c(){if(!v){var ee;clearTimeout(q),t.useXDR&&h.status===void 0?ee=200:ee=h.status===1223?204:h.status;var se=W,re=null;return ee!==0?(se={body:o(),statusCode:ee,method:O,headers:{},url:T,rawRequest:h},h.getAllResponseHeaders&&(se.headers=zU(h.getAllResponseHeaders()))):re=new Error("Internal XMLHttpRequest Error"),i(re,se,se.body)}}var h=t.xhr||null;h||(t.cors||t.useXDR?h=new Ir.XDomainRequest:h=new Ir.XMLHttpRequest);var m,v,T=h.url=t.uri||t.url,O=h.method=t.method||"GET",R=t.body||t.data,M=h.headers=t.headers||{},z=!!t.sync,j=!1,q,W={body:void 0,headers:{},statusCode:0,method:O,url:T,rawRequest:h};if("json"in t&&t.json!==!1&&(j=!0,M.accept||M.Accept||(M.Accept="application/json"),O!=="GET"&&O!=="HEAD"&&(M["content-type"]||M["Content-Type"]||(M["Content-Type"]="application/json"),R=JSON.stringify(t.json===!0?R:t.json))),h.onreadystatechange=n,h.onload=c,h.onerror=u,h.onprogress=function(){},h.onabort=function(){v=!0},h.ontimeout=u,h.open(O,T,!z,t.username,t.password),z||(h.withCredentials=!!t.withCredentials),!z&&t.timeout>0&&(q=setTimeout(function(){if(!v){v=!0,h.abort("timeout");var ee=new Error("XMLHttpRequest timeout");ee.code="ETIMEDOUT",u(ee)}},t.timeout)),h.setRequestHeader)for(m in M)M.hasOwnProperty(m)&&h.setRequestHeader(m,M[m]);else if(t.headers&&!XU(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&typeof t.beforeSend=="function"&&t.beforeSend(h),h.send(R||null),h}function YU(t){try{if(t.responseType==="document")return t.responseXML;var e=t.responseXML&&t.responseXML.documentElement.nodeName==="parsererror";if(t.responseType===""&&!e)return t.responseXML}catch{}return null}function QU(){}var cm={},JU={get exports(){return cm},set exports(t){cm=t}},gx=$e,xv=Object.create||function(){function t(){}return function(e){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function mn(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}mn.prototype=xv(Error.prototype);mn.prototype.constructor=mn;mn.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function wv(t){function e(n,o,u,c){return(n|0)*3600+(o|0)*60+(u|0)+(c|0)/1e3}var i=t.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function Zd(){this.values=xv(null)}Zd.prototype={set:function(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e),e>=0&&e<=100)?(this.set(t,e),!0):!1}};function Gd(t,e,i,n){var o=n?t.split(n):[t];for(var u in o)if(typeof o[u]=="string"){var c=o[u].split(i);if(c.length===2){var h=c[0].trim(),m=c[1].trim();e(h,m)}}}function ZU(t,e,i){var n=t;function o(){var h=wv(t);if(h===null)throw new mn(mn.Errors.BadTimeStamp,"Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),h}function u(h,m){var v=new Zd;Gd(h,function(T,O){switch(T){case"region":for(var R=i.length-1;R>=0;R--)if(i[R].id===O){v.set(T,i[R].region);break}break;case"vertical":v.alt(T,O,["rl","lr"]);break;case"line":var M=O.split(","),z=M[0];v.integer(T,z),v.percent(T,z)&&v.set("snapToLines",!1),v.alt(T,z,["auto"]),M.length===2&&v.alt("lineAlign",M[1],["start","center","end"]);break;case"position":M=O.split(","),v.percent(T,M[0]),M.length===2&&v.alt("positionAlign",M[1],["start","center","end"]);break;case"size":v.percent(T,O);break;case"align":v.alt(T,O,["start","center","end","left","right"]);break}},/:/,/\s/),m.region=v.get("region",null),m.vertical=v.get("vertical","");try{m.line=v.get("line","auto")}catch{}m.lineAlign=v.get("lineAlign","start"),m.snapToLines=v.get("snapToLines",!0),m.size=v.get("size",100);try{m.align=v.get("align","center")}catch{m.align=v.get("align","middle")}try{m.position=v.get("position","auto")}catch{m.position=v.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},m.align)}m.positionAlign=v.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},m.align)}function c(){t=t.replace(/^\s+/,"")}if(c(),e.startTime=o(),c(),t.substr(0,3)!=="-->")throw new mn(mn.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+n);t=t.substr(3),c(),e.endTime=o(),c(),u(t,e)}var Oy=gx.createElement&&gx.createElement("textarea"),eB={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},_x={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},tB={v:"title",lang:"lang"},yx={rt:"ruby"};function B1(t,e){function i(){if(!e)return null;function z(q){return e=e.substr(q.length),q}var j=e.match(/^([^<]*)(<[^>]*>?)?/);return z(j[1]?j[1]:j[2])}function n(z){return Oy.innerHTML=z,z=Oy.textContent,Oy.textContent="",z}function o(z,j){return!yx[j.localName]||yx[j.localName]===z.localName}function u(z,j){var q=eB[z];if(!q)return null;var W=t.document.createElement(q),ee=tB[z];return ee&&j&&(W[ee]=j.trim()),W}for(var c=t.document.createElement("div"),h=c,m,v=[];(m=i())!==null;){if(m[0]==="<"){if(m[1]==="/"){v.length&&v[v.length-1]===m.substr(2).replace(">","")&&(v.pop(),h=h.parentNode);continue}var T=wv(m.substr(1,m.length-2)),O;if(T){O=t.document.createProcessingInstruction("timestamp",T),h.appendChild(O);continue}var R=m.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!R||(O=u(R[1],R[3]),!O)||!o(h,O))continue;if(R[2]){var M=R[2].split(".");M.forEach(function(z){var j=/^bg_/.test(z),q=j?z.slice(3):z;if(_x.hasOwnProperty(q)){var W=j?"background-color":"color",ee=_x[q];O.style[W]=ee}}),O.className=M.join(" ")}v.push(R[1]),h.appendChild(O),h=O;continue}h.appendChild(t.document.createTextNode(n(m)))}return c}var vx=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function iB(t){for(var e=0;e<vx.length;e++){var i=vx[e];if(t>=i[0]&&t<=i[1])return!0}return!1}function sB(t){var e=[],i="",n;if(!t||!t.childNodes)return"ltr";function o(h,m){for(var v=m.childNodes.length-1;v>=0;v--)h.push(m.childNodes[v])}function u(h){if(!h||!h.length)return null;var m=h.pop(),v=m.textContent||m.innerText;if(v){var T=v.match(/^.*(\n|\r)/);return T?(h.length=0,T[0]):v}if(m.tagName==="ruby")return u(h);if(m.childNodes)return o(h,m),u(h)}for(o(e,t);i=u(e);)for(var c=0;c<i.length;c++)if(n=i.charCodeAt(c),iB(n))return"rtl";return"ltr"}function nB(t){if(typeof t.line=="number"&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,n=0,o=0;o<i.length&&i[o]!==e;o++)i[o].mode==="showing"&&n++;return++n*-1}function Qm(){}Qm.prototype.applyStyles=function(t,e){e=e||this.div;for(var i in t)t.hasOwnProperty(i)&&(e.style[i]=t[i])};Qm.prototype.formatStyle=function(t,e){return t===0?0:t+e};function dm(t,e,i){Qm.call(this),this.cue=e,this.cueDiv=B1(t,e.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=t.document.createElement("div"),n={direction:sB(this.cueDiv),writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:e.align==="middle"?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var o=0;switch(e.positionAlign){case"start":o=e.position;break;case"center":o=e.position-e.size/2;break;case"end":o=e.position-e.size;break}e.vertical===""?this.applyStyles({left:this.formatStyle(o,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(o,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(u){this.applyStyles({top:this.formatStyle(u.top,"px"),bottom:this.formatStyle(u.bottom,"px"),left:this.formatStyle(u.left,"px"),right:this.formatStyle(u.right,"px"),height:this.formatStyle(u.height,"px"),width:this.formatStyle(u.width,"px")})}}dm.prototype=xv(Qm.prototype);dm.prototype.constructor=dm;function Ds(t){var e,i,n,o;if(t.div){i=t.div.offsetHeight,n=t.div.offsetWidth,o=t.div.offsetTop;var u=(u=t.div.childNodes)&&(u=u[0])&&u.getClientRects&&u.getClientRects();t=t.div.getBoundingClientRect(),e=u?Math.max(u[0]&&u[0].height||0,t.height/u.length):0}this.left=t.left,this.right=t.right,this.top=t.top||o,this.height=t.height||i,this.bottom=t.bottom||o+(t.height||i),this.width=t.width||n,this.lineHeight=e!==void 0?e:t.lineHeight}Ds.prototype.move=function(t,e){switch(e=e!==void 0?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}};Ds.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top};Ds.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1};Ds.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right};Ds.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}};Ds.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),i=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),n=e*i;return n/(this.height*this.width)};Ds.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}};Ds.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,n=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var o={left:t.left,right:t.right,top:t.top||n,height:t.height||e,bottom:t.bottom||n+(t.height||e),width:t.width||i};return o};function rB(t,e,i,n){function o(q,W){for(var ee,se=new Ds(q),re=1,ie=0;ie<W.length;ie++){for(;q.overlapsOppositeAxis(i,W[ie])||q.within(i)&&q.overlapsAny(n);)q.move(W[ie]);if(q.within(i))return q;var ye=q.intersectPercentage(i);re>ye&&(ee=new Ds(q),re=ye),q=new Ds(se)}return ee||se}var u=new Ds(e),c=e.cue,h=nB(c),m=[];if(c.snapToLines){var v;switch(c.vertical){case"":m=["+y","-y"],v="height";break;case"rl":m=["+x","-x"],v="width";break;case"lr":m=["-x","+x"],v="width";break}var T=u.lineHeight,O=T*Math.round(h),R=i[v]+T,M=m[0];Math.abs(O)>R&&(O=O<0?-1:1,O*=Math.ceil(R/T)*T),h<0&&(O+=c.vertical===""?i.height:i.width,m=m.reverse()),u.move(M,O)}else{var z=u.lineHeight/i.height*100;switch(c.lineAlign){case"center":h-=z/2;break;case"end":h-=z;break}switch(c.vertical){case"":e.applyStyles({top:e.formatStyle(h,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(h,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(h,"%")});break}m=["+y","-x","+x","-y"],u=new Ds(e)}var j=o(u,m);e.move(j.toCSSCompatValues(i))}function hc(){}hc.StringDecoder=function(){return{decode:function(t){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};hc.convertCueToDOMTree=function(t,e){return!t||!e?null:B1(t,e)};var aB=.05,oB="sans-serif",lB="1.5%";hc.processCues=function(t,e,i){if(!t||!e||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var n=t.document.createElement("div");n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin=lB,i.appendChild(n);function o(T){for(var O=0;O<T.length;O++)if(T[O].hasBeenReset||!T[O].displayState)return!0;return!1}if(!o(e)){for(var u=0;u<e.length;u++)n.appendChild(e[u].displayState);return}var c=[],h=Ds.getSimpleBoxPosition(n),m=Math.round(h.height*aB*100)/100,v={font:m+"px "+oB};(function(){for(var T,O,R=0;R<e.length;R++)O=e[R],T=new dm(t,O,v),n.appendChild(T.div),rB(t,T,h,c),O.displayState=T.div,c.push(Ds.getSimpleBoxPosition(T))})()};hc.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]};hc.Parser.prototype={reportOrThrowError:function(t){if(t instanceof mn)this.onparsingerror&&this.onparsingerror(t);else throw t},parse:function(t){var e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){for(var T=e.buffer,O=0;O<T.length&&T[O]!=="\r"&&T[O]!==`
`;)++O;var R=T.substr(0,O);return T[O]==="\r"&&++O,T[O]===`
`&&++O,e.buffer=T.substr(O),R}function n(T){var O=new Zd;if(Gd(T,function(M,z){switch(M){case"id":O.set(M,z);break;case"width":O.percent(M,z);break;case"lines":O.integer(M,z);break;case"regionanchor":case"viewportanchor":var j=z.split(",");if(j.length!==2)break;var q=new Zd;if(q.percent("x",j[0]),q.percent("y",j[1]),!q.has("x")||!q.has("y"))break;O.set(M+"X",q.get("x")),O.set(M+"Y",q.get("y"));break;case"scroll":O.alt(M,z,["up"]);break}},/=/,/\s/),O.has("id")){var R=new(e.vttjs.VTTRegion||e.window.VTTRegion);R.width=O.get("width",100),R.lines=O.get("lines",3),R.regionAnchorX=O.get("regionanchorX",0),R.regionAnchorY=O.get("regionanchorY",100),R.viewportAnchorX=O.get("viewportanchorX",0),R.viewportAnchorY=O.get("viewportanchorY",100),R.scroll=O.get("scroll",""),e.onregion&&e.onregion(R),e.regionList.push({id:O.get("id"),region:R})}}function o(T){var O=new Zd;Gd(T,function(R,M){switch(R){case"MPEGT":O.integer(R+"S",M);break;case"LOCA":O.set(R+"L",wv(M));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:O.get("MPEGTS"),LOCAL:O.get("LOCAL")})}function u(T){T.match(/X-TIMESTAMP-MAP/)?Gd(T,function(O,R){switch(O){case"X-TIMESTAMP-MAP":o(R);break}},/=/):Gd(T,function(O,R){switch(O){case"Region":n(R);break}},/:/)}try{var c;if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;c=i();var h=c.match(/^WEBVTT([ \t].*)?$/);if(!h||!h[0])throw new mn(mn.Errors.BadSignature);e.state="HEADER"}for(var m=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(m?m=!1:c=i(),e.state){case"HEADER":/:/.test(c)?u(c):c||(e.state="ID");continue;case"NOTE":c||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(c)){e.state="NOTE";break}if(!c)continue;e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,"");try{e.cue.align="center"}catch{e.cue.align="middle"}if(e.state="CUE",c.indexOf("-->")===-1){e.cue.id=c;continue}case"CUE":try{ZU(c,e.cue,e.regionList)}catch(T){e.reportOrThrowError(T),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var v=c.indexOf("-->")!==-1;if(!c||v&&(m=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+=`
`),e.cue.text+=c.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":c||(e.state="ID");continue}}}catch(T){e.reportOrThrowError(T),e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL")throw new mn(mn.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var uB=hc,cB="auto",dB={"":1,lr:1,rl:1},hB={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function fB(t){if(typeof t!="string")return!1;var e=dB[t.toLowerCase()];return e?t.toLowerCase():!1}function Dy(t){if(typeof t!="string")return!1;var e=hB[t.toLowerCase()];return e?t.toLowerCase():!1}function F1(t,e,i){this.hasBeenReset=!1;var n="",o=!1,u=t,c=e,h=i,m=null,v="",T=!0,O="auto",R="start",M="auto",z="auto",j=100,q="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(W){n=""+W}},pauseOnExit:{enumerable:!0,get:function(){return o},set:function(W){o=!!W}},startTime:{enumerable:!0,get:function(){return u},set:function(W){if(typeof W!="number")throw new TypeError("Start time must be set to a number.");u=W,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return c},set:function(W){if(typeof W!="number")throw new TypeError("End time must be set to a number.");c=W,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return h},set:function(W){h=""+W,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return m},set:function(W){m=W,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return v},set:function(W){var ee=fB(W);if(ee===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");v=ee,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return T},set:function(W){T=!!W,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return O},set:function(W){if(typeof W!="number"&&W!==cB)throw new SyntaxError("Line: an invalid number or illegal string was specified.");O=W,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return R},set:function(W){var ee=Dy(W);ee?(R=ee,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return M},set:function(W){if(W<0||W>100)throw new Error("Position must be between 0 and 100.");M=W,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return z},set:function(W){var ee=Dy(W);ee?(z=ee,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return j},set:function(W){if(W<0||W>100)throw new Error("Size must be between 0 and 100.");j=W,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return q},set:function(W){var ee=Dy(W);if(!ee)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");q=ee,this.hasBeenReset=!0}}}),this.displayState=void 0}F1.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var pB=F1,mB={"":!0,up:!0};function gB(t){if(typeof t!="string")return!1;var e=mB[t.toLowerCase()];return e?t.toLowerCase():!1}function Md(t){return typeof t=="number"&&t>=0&&t<=100}function _B(){var t=100,e=3,i=0,n=100,o=0,u=100,c="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(h){if(!Md(h))throw new Error("Width must be between 0 and 100.");t=h}},lines:{enumerable:!0,get:function(){return e},set:function(h){if(typeof h!="number")throw new TypeError("Lines must be set to a number.");e=h}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(h){if(!Md(h))throw new Error("RegionAnchorX must be between 0 and 100.");n=h}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(h){if(!Md(h))throw new Error("RegionAnchorY must be between 0 and 100.");i=h}},viewportAnchorY:{enumerable:!0,get:function(){return u},set:function(h){if(!Md(h))throw new Error("ViewportAnchorY must be between 0 and 100.");u=h}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(h){if(!Md(h))throw new Error("ViewportAnchorX must be between 0 and 100.");o=h}},scroll:{enumerable:!0,get:function(){return c},set:function(h){var m=gB(h);m===!1?console.warn("Scroll: an invalid or illegal string was specified."):c=m}}})}var yB=_B,va=Z,dl=JU.exports={WebVTT:uB,VTTCue:pB,VTTRegion:yB};va.vttjs=dl;va.WebVTT=dl.WebVTT;var vB=dl.VTTCue,TB=dl.VTTRegion,bB=va.VTTCue,EB=va.VTTRegion;dl.shim=function(){va.VTTCue=vB,va.VTTRegion=TB};dl.restore=function(){va.VTTCue=bB,va.VTTRegion=EB};va.VTTCue||dl.shim();var m0={},SB={get exports(){return m0},set exports(t){m0=t}};(function(t,e){(function(i){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,h={buildAbsoluteURL:function(m,v,T){if(T=T||{},m=m.trim(),v=v.trim(),!v){if(!T.alwaysNormalize)return m;var O=h.parseURL(m);if(!O)throw new Error("Error trying to parse base URL.");return O.path=h.normalizePath(O.path),h.buildURLFromParts(O)}var R=h.parseURL(v);if(!R)throw new Error("Error trying to parse relative URL.");if(R.scheme)return T.alwaysNormalize?(R.path=h.normalizePath(R.path),h.buildURLFromParts(R)):v;var M=h.parseURL(m);if(!M)throw new Error("Error trying to parse base URL.");if(!M.netLoc&&M.path&&M.path[0]!=="/"){var z=o.exec(M.path);M.netLoc=z[1],M.path=z[2]}M.netLoc&&!M.path&&(M.path="/");var j={scheme:M.scheme,netLoc:R.netLoc,path:null,params:R.params,query:R.query,fragment:R.fragment};if(!R.netLoc&&(j.netLoc=M.netLoc,R.path[0]!=="/"))if(!R.path)j.path=M.path,R.params||(j.params=M.params,R.query||(j.query=M.query));else{var q=M.path,W=q.substring(0,q.lastIndexOf("/")+1)+R.path;j.path=h.normalizePath(W)}return j.path===null&&(j.path=T.alwaysNormalize?h.normalizePath(R.path):R.path),h.buildURLFromParts(j)},parseURL:function(m){var v=n.exec(m);return v?{scheme:v[1]||"",netLoc:v[2]||"",path:v[3]||"",params:v[4]||"",query:v[5]||"",fragment:v[6]||""}:null},normalizePath:function(m){for(m=m.split("").reverse().join("").replace(u,"");m.length!==(m=m.replace(c,"")).length;);return m.split("").reverse().join("")},buildURLFromParts:function(m){return m.scheme+m.netLoc+m.path+m.params+m.query+m.fragment}};t.exports=h})()})(SB);const hm=m0;var Tx="http://example.com",xB=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=Z.location&&Z.location.href||"");var n=typeof Z.URL=="function",o=/^\/\//.test(e),u=!Z.location&&!/\/\//i.test(e);if(n?e=new Z.URL(e,Z.location||Tx):/\/\//i.test(e)||(e=hm.buildAbsoluteURL(Z.location&&Z.location.href||"",e)),n){var c=new URL(i,e);return u?c.href.slice(Tx.length):o?c.href.slice(c.protocol.length):c.href}return hm.buildAbsoluteURL(e,i)},Cv=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(n,o){this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(o)},e.off=function(n,o){if(!this.listeners[n])return!1;var u=this.listeners[n].indexOf(o);return this.listeners[n]=this.listeners[n].slice(0),this.listeners[n].splice(u,1),u>-1},e.trigger=function(n){var o=this.listeners[n];if(o)if(arguments.length===2)for(var u=o.length,c=0;c<u;++c)o[c].call(this,arguments[1]);else for(var h=Array.prototype.slice.call(arguments,1),m=o.length,v=0;v<m;++v)o[v].apply(this,h)},e.dispose=function(){this.listeners={}},e.pipe=function(n){this.on("data",function(o){n.push(o)})},t}(),wB=function(e){return Z.atob?Z.atob(e):Buffer.from(e,"base64").toString("binary")};function CB(t){for(var e=wB(t),i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i}/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */class AB extends Cv{constructor(){super(),this.buffer=""}push(e){let i;for(this.buffer+=e,i=this.buffer.indexOf(`
`);i>-1;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}const kB=String.fromCharCode(9),Py=function(t){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},IB=function(){const t="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},Kn=function(t){const e={};if(!t)return e;const i=t.split(IB());let n=i.length,o;for(;n--;)i[n]!==""&&(o=/([^=]*)=(.*)/.exec(i[n]).slice(1),o[0]=o[0].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^['"](.*)['"]$/g,"$1"),e[o[0]]=o[1]);return e};class OB extends Cv{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let i,n;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((u,c)=>{const h=c(e);return h===e?u:u.concat([h])},[e]).forEach(u=>{for(let c=0;c<this.customParsers.length;c++)if(this.customParsers[c].call(this,u))return;if(u.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:u.slice(1)});return}if(u=u.replace("\r",""),i=/^#EXTM3U/.exec(u),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(u),i){n={type:"tag",tagType:"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),this.trigger("data",n);return}if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(u),i){n={type:"tag",tagType:"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),this.trigger("data",n);return}if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(u),i){n={type:"tag",tagType:"version"},i[1]&&(n.version=parseInt(i[1],10)),this.trigger("data",n);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(u),i){n={type:"tag",tagType:"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),this.trigger("data",n);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(u),i){n={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),this.trigger("data",n);return}if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(u),i){n={type:"tag",tagType:"playlist-type"},i[1]&&(n.playlistType=i[1]),this.trigger("data",n);return}if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(u),i){n=ya(Py(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",n);return}if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(u),i){n={type:"tag",tagType:"allow-cache"},i[1]&&(n.allowed=!/NO/.test(i[1])),this.trigger("data",n);return}if(i=/^#EXT-X-MAP:(.*)$/.exec(u),i){if(n={type:"tag",tagType:"map"},i[1]){const c=Kn(i[1]);c.URI&&(n.uri=c.URI),c.BYTERANGE&&(n.byterange=Py(c.BYTERANGE))}this.trigger("data",n);return}if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(u),i){if(n={type:"tag",tagType:"stream-inf"},i[1]){if(n.attributes=Kn(i[1]),n.attributes.RESOLUTION){const c=n.attributes.RESOLUTION.split("x"),h={};c[0]&&(h.width=parseInt(c[0],10)),c[1]&&(h.height=parseInt(c[1],10)),n.attributes.RESOLUTION=h}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["FRAME-RATE"]&&(n.attributes["FRAME-RATE"]=parseFloat(n.attributes["FRAME-RATE"])),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}this.trigger("data",n);return}if(i=/^#EXT-X-MEDIA:(.*)$/.exec(u),i){n={type:"tag",tagType:"media"},i[1]&&(n.attributes=Kn(i[1])),this.trigger("data",n);return}if(i=/^#EXT-X-ENDLIST/.exec(u),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(u),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(u),i){n={type:"tag",tagType:"program-date-time"},i[1]&&(n.dateTimeString=i[1],n.dateTimeObject=new Date(i[1])),this.trigger("data",n);return}if(i=/^#EXT-X-KEY:(.*)$/.exec(u),i){n={type:"tag",tagType:"key"},i[1]&&(n.attributes=Kn(i[1]),n.attributes.IV&&(n.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),this.trigger("data",n);return}if(i=/^#EXT-X-START:(.*)$/.exec(u),i){n={type:"tag",tagType:"start"},i[1]&&(n.attributes=Kn(i[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),this.trigger("data",n);return}if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(u),i){n={type:"tag",tagType:"cue-out-cont"},i[1]?n.data=i[1]:n.data="",this.trigger("data",n);return}if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(u),i){n={type:"tag",tagType:"cue-out"},i[1]?n.data=i[1]:n.data="",this.trigger("data",n);return}if(i=/^#EXT-X-CUE-IN:(.*)?$/.exec(u),i){n={type:"tag",tagType:"cue-in"},i[1]?n.data=i[1]:n.data="",this.trigger("data",n);return}if(i=/^#EXT-X-SKIP:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"skip"},n.attributes=Kn(i[1]),n.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(n.attributes["SKIPPED-SEGMENTS"]=parseInt(n.attributes["SKIPPED-SEGMENTS"],10)),n.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(n.attributes["RECENTLY-REMOVED-DATERANGES"]=n.attributes["RECENTLY-REMOVED-DATERANGES"].split(kB)),this.trigger("data",n);return}if(i=/^#EXT-X-PART:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"part"},n.attributes=Kn(i[1]),["DURATION"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=parseFloat(n.attributes[c]))}),["INDEPENDENT","GAP"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=/YES/.test(n.attributes[c]))}),n.attributes.hasOwnProperty("BYTERANGE")&&(n.attributes.byterange=Py(n.attributes.BYTERANGE)),this.trigger("data",n);return}if(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"server-control"},n.attributes=Kn(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=parseFloat(n.attributes[c]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=/YES/.test(n.attributes[c]))}),this.trigger("data",n);return}if(i=/^#EXT-X-PART-INF:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"part-inf"},n.attributes=Kn(i[1]),["PART-TARGET"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=parseFloat(n.attributes[c]))}),this.trigger("data",n);return}if(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"preload-hint"},n.attributes=Kn(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(c){if(n.attributes.hasOwnProperty(c)){n.attributes[c]=parseInt(n.attributes[c],10);const h=c==="BYTERANGE-LENGTH"?"length":"offset";n.attributes.byterange=n.attributes.byterange||{},n.attributes.byterange[h]=n.attributes[c],delete n.attributes[c]}}),this.trigger("data",n);return}if(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(u),i&&i[1]){n={type:"tag",tagType:"rendition-report"},n.attributes=Kn(i[1]),["LAST-MSN","LAST-PART"].forEach(function(c){n.attributes.hasOwnProperty(c)&&(n.attributes[c]=parseInt(n.attributes[c],10))}),this.trigger("data",n);return}this.trigger("data",{type:"tag",data:u.slice(4)})})}addParser({expression:e,customType:i,dataParser:n,segment:o}){typeof n!="function"&&(n=u=>u),this.customParsers.push(u=>{if(e.exec(u))return this.trigger("data",{type:"custom",data:n(u),customType:i,segment:o}),!0})}addTagMapper({expression:e,map:i}){const n=o=>e.test(o)?i(o):o;this.tagMappers.push(n)}}const DB=t=>t.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),cu=function(t){const e={};return Object.keys(t).forEach(function(i){e[DB(i)]=t[i]}),e},Ly=function(t){const{serverControl:e,targetDuration:i,partTargetDuration:n}=t;if(!e)return;const o="#EXT-X-SERVER-CONTROL",u="holdBack",c="partHoldBack",h=i&&i*3,m=n&&n*2;i&&!e.hasOwnProperty(u)&&(e[u]=h,this.trigger("info",{message:`${o} defaulting HOLD-BACK to targetDuration * 3 (${h}).`})),h&&e[u]<h&&(this.trigger("warn",{message:`${o} clamping HOLD-BACK (${e[u]}) to targetDuration * 3 (${h})`}),e[u]=h),n&&!e.hasOwnProperty(c)&&(e[c]=n*3,this.trigger("info",{message:`${o} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[c]}).`})),n&&e[c]<m&&(this.trigger("warn",{message:`${o} clamping PART-HOLD-BACK (${e[c]}) to partTargetDuration * 2 (${m}).`}),e[c]=m)};class PB extends Cv{constructor(){super(),this.lineStream=new AB,this.parseStream=new OB,this.lineStream.pipe(this.parseStream);const e=this,i=[];let n={},o,u,c=!1;const h=function(){},m={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},v="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let T=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let O=0,R=0;this.on("end",()=>{n.uri||!n.parts&&!n.preloadHints||(!n.map&&o&&(n.map=o),!n.key&&u&&(n.key=u),!n.timeline&&typeof T=="number"&&(n.timeline=T),this.manifest.preloadSegment=n)}),this.parseStream.on("data",function(M){let z,j;({tag(){({version(){M.version&&(this.manifest.version=M.version)},"allow-cache"(){this.manifest.allowCache=M.allowed,"allowed"in M||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const q={};"length"in M&&(n.byterange=q,q.length=M.length,"offset"in M||(M.offset=O)),"offset"in M&&(n.byterange=q,q.offset=M.offset),O=q.offset+q.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),M.duration>0&&(n.duration=M.duration),M.duration===0&&(n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!M.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(M.attributes.METHOD==="NONE"){u=null;return}if(!M.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(M.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:M.attributes};return}if(M.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:M.attributes.URI};return}if(M.attributes.KEYFORMAT===v){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(M.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(M.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),M.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(M.attributes.KEYID&&M.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:M.attributes.KEYFORMAT,keyId:M.attributes.KEYID.substring(2)},pssh:CB(M.attributes.URI.split(",")[1])};return}M.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),u={method:M.attributes.METHOD||"AES-128",uri:M.attributes.URI},typeof M.attributes.IV<"u"&&(u.iv=M.attributes.IV)},"media-sequence"(){if(!isFinite(M.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+M.number});return}this.manifest.mediaSequence=M.number},"discontinuity-sequence"(){if(!isFinite(M.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+M.number});return}this.manifest.discontinuitySequence=M.number,T=M.number},"playlist-type"(){if(!/VOD|EVENT/.test(M.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+M.playlist});return}this.manifest.playlistType=M.playlistType},map(){o={},M.uri&&(o.uri=M.uri),M.byterange&&(o.byterange=M.byterange),u&&(o.key=u)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||m,!M.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}n.attributes||(n.attributes={}),ya(n.attributes,M.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||m,!(M.attributes&&M.attributes.TYPE&&M.attributes["GROUP-ID"]&&M.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const q=this.manifest.mediaGroups[M.attributes.TYPE];q[M.attributes["GROUP-ID"]]=q[M.attributes["GROUP-ID"]]||{},z=q[M.attributes["GROUP-ID"]],j={default:/yes/i.test(M.attributes.DEFAULT)},j.default?j.autoselect=!0:j.autoselect=/yes/i.test(M.attributes.AUTOSELECT),M.attributes.LANGUAGE&&(j.language=M.attributes.LANGUAGE),M.attributes.URI&&(j.uri=M.attributes.URI),M.attributes["INSTREAM-ID"]&&(j.instreamId=M.attributes["INSTREAM-ID"]),M.attributes.CHARACTERISTICS&&(j.characteristics=M.attributes.CHARACTERISTICS),M.attributes.FORCED&&(j.forced=/yes/i.test(M.attributes.FORCED)),z[M.attributes.NAME]=j},discontinuity(){T+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=M.dateTimeString,this.manifest.dateTimeObject=M.dateTimeObject),n.dateTimeString=M.dateTimeString,n.dateTimeObject=M.dateTimeObject},targetduration(){if(!isFinite(M.duration)||M.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+M.duration});return}this.manifest.targetDuration=M.duration,Ly.call(this,this.manifest)},start(){if(!M.attributes||isNaN(M.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:M.attributes["TIME-OFFSET"],precise:M.attributes.PRECISE}},"cue-out"(){n.cueOut=M.data},"cue-out-cont"(){n.cueOutCont=M.data},"cue-in"(){n.cueIn=M.data},skip(){this.manifest.skip=cu(M.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",M.attributes,["SKIPPED-SEGMENTS"])},part(){c=!0;const q=this.manifest.segments.length,W=cu(M.attributes);n.parts=n.parts||[],n.parts.push(W),W.byterange&&(W.byterange.hasOwnProperty("offset")||(W.byterange.offset=R),R=W.byterange.offset+W.byterange.length);const ee=n.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${ee} for segment #${q}`,M.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((se,re)=>{se.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${re} lacks required attribute(s): LAST-PART`})})},"server-control"(){const q=this.manifest.serverControl=cu(M.attributes);q.hasOwnProperty("canBlockReload")||(q.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Ly.call(this,this.manifest),q.canSkipDateranges&&!q.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const q=this.manifest.segments.length,W=cu(M.attributes),ee=W.type&&W.type==="PART";n.preloadHints=n.preloadHints||[],n.preloadHints.push(W),W.byterange&&(W.byterange.hasOwnProperty("offset")||(W.byterange.offset=ee?R:0,ee&&(R=W.byterange.offset+W.byterange.length)));const se=n.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${se} for segment #${q}`,M.attributes,["TYPE","URI"]),!!W.type)for(let re=0;re<n.preloadHints.length-1;re++){const ie=n.preloadHints[re];ie.type&&ie.type===W.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${se} for segment #${q} has the same TYPE ${W.type} as preload hint #${re}`})}},"rendition-report"(){const q=cu(M.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(q);const W=this.manifest.renditionReports.length-1,ee=["LAST-MSN","URI"];c&&ee.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${W}`,M.attributes,ee)},"part-inf"(){this.manifest.partInf=cu(M.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",M.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Ly.call(this,this.manifest)}}[M.tagType]||h).call(e)},uri(){n.uri=M.uri,i.push(n),this.manifest.targetDuration&&!("duration"in n)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration),u&&(n.key=u),n.timeline=T,o&&(n.map=o),R=0,n={}},comment(){},custom(){M.segment?(n.custom=n.custom||{},n.custom[M.customType]=M.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[M.customType]=M.data)}})[M.type].call(e)})}warnOnMissingAttributes_(e,i,n){const o=[];n.forEach(function(u){i.hasOwnProperty(u)||o.push(u)}),o.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${o.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Jo={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},LB=["video","audio","text"],bx=["Video","Audio","Text"],$1=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(i,n,o){var u=("00"+Number(n).toString(16)).slice(-2),c=("00"+Number(o).toString(16)).slice(-2);return"avc1."+u+"00"+c})},Tr=function(e){e===void 0&&(e="");var i=e.split(","),n=[];return i.forEach(function(o){o=o.trim();var u;LB.forEach(function(c){var h=Jo[c].exec(o.toLowerCase());if(!(!h||h.length<=1)){u=c;var m=o.substring(0,h[1].length),v=o.replace(m,"");n.push({type:m,details:v,mediaType:c})}}),u||n.push({type:o,details:"",mediaType:"unknown"})}),n},NB=function(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var n=e.mediaGroups.AUDIO[i];if(!n)return null;for(var o in n){var u=n[o];if(u.default&&u.playlists)return Tr(u.playlists[0].attributes.CODECS)}return null},j1=function(e){return e===void 0&&(e=""),Jo.audio.test(e.trim().toLowerCase())},RB=function(e){return e===void 0&&(e=""),Jo.text.test(e.trim().toLowerCase())},dh=function(e){if(!(!e||typeof e!="string")){var i=e.toLowerCase().split(",").map(function(u){return $1(u.trim())}),n="video";i.length===1&&j1(i[0])?n="audio":i.length===1&&RB(i[0])&&(n="application");var o="mp4";return i.every(function(u){return Jo.mp4.test(u)})?o="mp4":i.every(function(u){return Jo.webm.test(u)})?o="webm":i.every(function(u){return Jo.ogg.test(u)})&&(o="ogg"),n+"/"+o+';codecs="'+e+'"'}},Yp=function(e){return e===void 0&&(e=""),Z.MediaSource&&Z.MediaSource.isTypeSupported&&Z.MediaSource.isTypeSupported(dh(e))||!1},Ny=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(i){i=i.trim();for(var n=0;n<bx.length;n++){var o=bx[n];if(Jo["muxer"+o].test(i))return!0}return!1})},Ex="mp4a.40.2",MB="avc1.4d400d",UB=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,BB=/^application\/dash\+xml/i,H1=function(e){return UB.test(e)?"hls":BB.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},FB=function(e){return e.toString(2).length},$B=function(e){return Math.ceil(FB(e)/8)},V1=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},jB=function(e){return V1(e)},ht=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!jB(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},ls=Z.BigInt||Number,g0=[ls("0x1"),ls("0x100"),ls("0x10000"),ls("0x1000000"),ls("0x100000000"),ls("0x10000000000"),ls("0x1000000000000"),ls("0x100000000000000"),ls("0x10000000000000000")];(function(){var t=new Uint16Array([65484]),e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var HB=function(e,i){var n=i===void 0?{}:i,o=n.signed,u=o===void 0?!1:o,c=n.le,h=c===void 0?!1:c;e=ht(e);var m=h?"reduce":"reduceRight",v=e[m]?e[m]:Array.prototype[m],T=v.call(e,function(R,M,z){var j=h?z:Math.abs(z+1-e.length);return R+ls(M)*g0[j]},ls(0));if(u){var O=g0[e.length]/ls(2)-ls(1);T=ls(T),T>O&&(T-=O,T-=O,T-=ls(2))}return Number(T)},VB=function(e,i){var n=i===void 0?{}:i,o=n.le,u=o===void 0?!1:o;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ls(e);for(var c=$B(e),h=new Uint8Array(new ArrayBuffer(c)),m=0;m<c;m++){var v=u?m:Math.abs(m+1-h.length);h[v]=Number(e/g0[m]&ls(255)),e<0&&(h[v]=Math.abs(~h[v]),h[v]-=m===0?1:2)}return h},q1=function(e,i){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;i||(e=unescape(encodeURIComponent(e)));for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);return n},qB=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];if(i=i.filter(function(h){return h&&(h.byteLength||h.length)&&typeof h!="string"}),i.length<=1)return ht(i[0]);var o=i.reduce(function(h,m,v){return h+(m.byteLength||m.length)},0),u=new Uint8Array(o),c=0;return i.forEach(function(h){h=ht(h),u.set(h,c),c+=h.byteLength}),u},wi=function(e,i,n){var o=n===void 0?{}:n,u=o.offset,c=u===void 0?0:u,h=o.mask,m=h===void 0?[]:h;e=ht(e),i=ht(i);var v=i.every?i.every:Array.prototype.every;return i.length&&e.length-c>=i.length&&v.call(i,function(T,O){var R=m[O]?m[O]&e[c+O]:e[c+O];return T===R})},Sx="http://example.com",Av=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=Z.location&&Z.location.href||"");var n=typeof Z.URL=="function",o=/^\/\//.test(e),u=!Z.location&&!/\/\//i.test(e);if(n?e=new Z.URL(e,Z.location||Sx):/\/\//i.test(e)||(e=hm.buildAbsoluteURL(Z.location&&Z.location.href||"",e)),n){var c=new URL(i,e);return u?c.href.slice(Sx.length):o?c.href.slice(c.protocol.length):c.href}return hm.buildAbsoluteURL(e,i)},WB=function(e,i,n){i.forEach(function(o){for(var u in e.mediaGroups[o])for(var c in e.mediaGroups[o][u]){var h=e.mediaGroups[o][u][c];n(h,o,u,c)}})},GB=function(e){return Z.atob?Z.atob(e):Buffer.from(e,"base64").toString("binary")};function zB(t){for(var e=GB(t),i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i}var lo={},wa={};function KB(t,e,i){if(i===void 0&&(i=Array.prototype),t&&typeof i.find=="function")return i.find.call(t,e);for(var n=0;n<t.length;n++)if(Object.prototype.hasOwnProperty.call(t,n)){var o=t[n];if(e.call(void 0,o,n,t))return o}}function kv(t,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(t):t}function XB(t,e){if(t===null||typeof t!="object")throw new TypeError("target is not an object");for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}var W1=kv({HTML:"text/html",isHTML:function(t){return t===W1.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),G1=kv({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===G1.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});wa.assign=XB;wa.find=KB;wa.freeze=kv;wa.MIME_TYPE=W1;wa.NAMESPACE=G1;var z1=wa,Or=z1.find,hh=z1.NAMESPACE;function YB(t){return t!==""}function QB(t){return t?t.split(/[\t\n\f\r ]+/).filter(YB):[]}function JB(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function xx(t){if(!t)return[];var e=QB(t);return Object.keys(e.reduce(JB,{}))}function ZB(t){return function(e){return t&&t.indexOf(e)!==-1}}function Ph(t,e){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}function Js(t,e){var i=t.prototype;if(!(i instanceof e)){let o=function(){};var n=o;o.prototype=e.prototype,o=new o,Ph(i,o),t.prototype=i=o}i.constructor!=t&&(typeof t!="function"&&console.error("unknown Class:"+t),i.constructor=t)}var Zs={},er=Zs.ELEMENT_NODE=1,Gu=Zs.ATTRIBUTE_NODE=2,fm=Zs.TEXT_NODE=3,K1=Zs.CDATA_SECTION_NODE=4,X1=Zs.ENTITY_REFERENCE_NODE=5,eF=Zs.ENTITY_NODE=6,Y1=Zs.PROCESSING_INSTRUCTION_NODE=7,Q1=Zs.COMMENT_NODE=8,J1=Zs.DOCUMENT_NODE=9,Z1=Zs.DOCUMENT_TYPE_NODE=10,Ta=Zs.DOCUMENT_FRAGMENT_NODE=11,tF=Zs.NOTATION_NODE=12,bs={},Zi={};bs.INDEX_SIZE_ERR=(Zi[1]="Index size error",1);bs.DOMSTRING_SIZE_ERR=(Zi[2]="DOMString size error",2);var Ks=bs.HIERARCHY_REQUEST_ERR=(Zi[3]="Hierarchy request error",3);bs.WRONG_DOCUMENT_ERR=(Zi[4]="Wrong document",4);bs.INVALID_CHARACTER_ERR=(Zi[5]="Invalid character",5);bs.NO_DATA_ALLOWED_ERR=(Zi[6]="No data allowed",6);bs.NO_MODIFICATION_ALLOWED_ERR=(Zi[7]="No modification allowed",7);var eA=bs.NOT_FOUND_ERR=(Zi[8]="Not found",8);bs.NOT_SUPPORTED_ERR=(Zi[9]="Not supported",9);var wx=bs.INUSE_ATTRIBUTE_ERR=(Zi[10]="Attribute in use",10);bs.INVALID_STATE_ERR=(Zi[11]="Invalid state",11);bs.SYNTAX_ERR=(Zi[12]="Syntax error",12);bs.INVALID_MODIFICATION_ERR=(Zi[13]="Invalid modification",13);bs.NAMESPACE_ERR=(Zi[14]="Invalid namespace",14);bs.INVALID_ACCESS_ERR=(Zi[15]="Invalid access",15);function Ni(t,e){if(e instanceof Error)var i=e;else i=this,Error.call(this,Zi[t]),this.message=Zi[t],Error.captureStackTrace&&Error.captureStackTrace(this,Ni);return i.code=t,e&&(this.message=this.message+": "+e),i}Ni.prototype=Error.prototype;Ph(bs,Ni);function fa(){}fa.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var i=[],n=0;n<this.length;n++)xu(this[n],i,t,e);return i.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}};function zu(t,e){this._node=t,this._refresh=e,Iv(this)}function Iv(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var i=t._refresh(t._node);hA(t,"length",i.length),Ph(i,t),t._inc=e}}zu.prototype.item=function(t){return Iv(this),this[t]};Js(zu,fa);function pm(){}function tA(t,e){for(var i=t.length;i--;)if(t[i]===e)return i}function Cx(t,e,i,n){if(n?e[tA(e,n)]=i:e[e.length++]=i,t){i.ownerElement=t;var o=t.ownerDocument;o&&(n&&nA(o,t,n),iF(o,t,i))}}function Ax(t,e,i){var n=tA(e,i);if(n>=0){for(var o=e.length-1;n<o;)e[n]=e[++n];if(e.length=o,t){var u=t.ownerDocument;u&&(nA(u,t,i),i.ownerElement=null)}}else throw new Ni(eA,new Error(t.tagName+"@"+i))}pm.prototype={length:0,item:fa.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var i=this[e];if(i.nodeName==t)return i}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new Ni(wx);var i=this.getNamedItem(t.nodeName);return Cx(this._ownerElement,this,t,i),i},setNamedItemNS:function(t){var e=t.ownerElement,i;if(e&&e!=this._ownerElement)throw new Ni(wx);return i=this.getNamedItemNS(t.namespaceURI,t.localName),Cx(this._ownerElement,this,t,i),i},removeNamedItem:function(t){var e=this.getNamedItem(t);return Ax(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var i=this.getNamedItemNS(t,e);return Ax(this._ownerElement,this,i),i},getNamedItemNS:function(t,e){for(var i=this.length;i--;){var n=this[i];if(n.localName==e&&n.namespaceURI==t)return n}return null}};function iA(){}iA.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,i){var n=new Lh;if(n.implementation=this,n.childNodes=new fa,n.doctype=i||null,i&&n.appendChild(i),e){var o=n.createElementNS(t,e);n.appendChild(o)}return n},createDocumentType:function(t,e,i){var n=new Jm;return n.name=t,n.nodeName=t,n.publicId=e||"",n.systemId=i||"",n}};function ri(){}ri.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return mm(this,t,e)},replaceChild:function(t,e){mm(this,t,e,aA),e&&this.removeChild(e)},removeChild:function(t){return rA(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(t){return _0(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==fm&&t.nodeType==fm?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var i=e._nsMap;if(i){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)&&i[n]===t)return n}e=e.nodeType==Gu?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var i=e._nsMap;if(i&&Object.prototype.hasOwnProperty.call(i,t))return i[t];e=e.nodeType==Gu?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return e==null}};function sA(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}Ph(Zs,ri);Ph(Zs,ri.prototype);function fh(t,e){if(e(t))return!0;if(t=t.firstChild)do if(fh(t,e))return!0;while(t=t.nextSibling)}function Lh(){this.ownerDocument=this}function iF(t,e,i){t&&t._inc++;var n=i.namespaceURI;n===hh.XMLNS&&(e._nsMap[i.prefix?i.localName:""]=i.value)}function nA(t,e,i,n){t&&t._inc++;var o=i.namespaceURI;o===hh.XMLNS&&delete e._nsMap[i.prefix?i.localName:""]}function Ov(t,e,i){if(t&&t._inc){t._inc++;var n=e.childNodes;if(i)n[n.length++]=i;else{for(var o=e.firstChild,u=0;o;)n[u++]=o,o=o.nextSibling;n.length=u,delete n[n.length]}}}function rA(t,e){var i=e.previousSibling,n=e.nextSibling;return i?i.nextSibling=n:t.firstChild=n,n?n.previousSibling=i:t.lastChild=i,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,Ov(t.ownerDocument,t),e}function sF(t){return t&&(t.nodeType===ri.DOCUMENT_NODE||t.nodeType===ri.DOCUMENT_FRAGMENT_NODE||t.nodeType===ri.ELEMENT_NODE)}function nF(t){return t&&(Dr(t)||Dv(t)||ba(t)||t.nodeType===ri.DOCUMENT_FRAGMENT_NODE||t.nodeType===ri.COMMENT_NODE||t.nodeType===ri.PROCESSING_INSTRUCTION_NODE)}function ba(t){return t&&t.nodeType===ri.DOCUMENT_TYPE_NODE}function Dr(t){return t&&t.nodeType===ri.ELEMENT_NODE}function Dv(t){return t&&t.nodeType===ri.TEXT_NODE}function kx(t,e){var i=t.childNodes||[];if(Or(i,Dr)||ba(e))return!1;var n=Or(i,ba);return!(e&&n&&i.indexOf(n)>i.indexOf(e))}function Ix(t,e){var i=t.childNodes||[];function n(u){return Dr(u)&&u!==e}if(Or(i,n))return!1;var o=Or(i,ba);return!(e&&o&&i.indexOf(o)>i.indexOf(e))}function rF(t,e,i){if(!sF(t))throw new Ni(Ks,"Unexpected parent node type "+t.nodeType);if(i&&i.parentNode!==t)throw new Ni(eA,"child not in parent");if(!nF(e)||ba(e)&&t.nodeType!==ri.DOCUMENT_NODE)throw new Ni(Ks,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function aF(t,e,i){var n=t.childNodes||[],o=e.childNodes||[];if(e.nodeType===ri.DOCUMENT_FRAGMENT_NODE){var u=o.filter(Dr);if(u.length>1||Or(o,Dv))throw new Ni(Ks,"More than one element or text in fragment");if(u.length===1&&!kx(t,i))throw new Ni(Ks,"Element in fragment can not be inserted before doctype")}if(Dr(e)&&!kx(t,i))throw new Ni(Ks,"Only one element can be added and only after doctype");if(ba(e)){if(Or(n,ba))throw new Ni(Ks,"Only one doctype is allowed");var c=Or(n,Dr);if(i&&n.indexOf(c)<n.indexOf(i))throw new Ni(Ks,"Doctype can only be inserted before an element");if(!i&&c)throw new Ni(Ks,"Doctype can not be appended since element is present")}}function aA(t,e,i){var n=t.childNodes||[],o=e.childNodes||[];if(e.nodeType===ri.DOCUMENT_FRAGMENT_NODE){var u=o.filter(Dr);if(u.length>1||Or(o,Dv))throw new Ni(Ks,"More than one element or text in fragment");if(u.length===1&&!Ix(t,i))throw new Ni(Ks,"Element in fragment can not be inserted before doctype")}if(Dr(e)&&!Ix(t,i))throw new Ni(Ks,"Only one element can be added and only after doctype");if(ba(e)){let m=function(v){return ba(v)&&v!==i};var h=m;if(Or(n,m))throw new Ni(Ks,"Only one doctype is allowed");var c=Or(n,Dr);if(i&&n.indexOf(c)<n.indexOf(i))throw new Ni(Ks,"Doctype can only be inserted before an element")}}function mm(t,e,i,n){rF(t,e,i),t.nodeType===ri.DOCUMENT_NODE&&(n||aF)(t,e,i);var o=e.parentNode;if(o&&o.removeChild(e),e.nodeType===Ta){var u=e.firstChild;if(u==null)return e;var c=e.lastChild}else u=c=e;var h=i?i.previousSibling:t.lastChild;u.previousSibling=h,c.nextSibling=i,h?h.nextSibling=u:t.firstChild=u,i==null?t.lastChild=c:i.previousSibling=c;do u.parentNode=t;while(u!==c&&(u=u.nextSibling));return Ov(t.ownerDocument||t,t),e.nodeType==Ta&&(e.firstChild=e.lastChild=null),e}function oF(t,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,Ov(t.ownerDocument,t,e),e}Lh.prototype={nodeName:"#document",nodeType:J1,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==Ta){for(var i=t.firstChild;i;){var n=i.nextSibling;this.insertBefore(i,e),i=n}return t}return mm(this,t,e),t.ownerDocument=this,this.documentElement===null&&t.nodeType===er&&(this.documentElement=t),t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),rA(this,t)},replaceChild:function(t,e){mm(this,t,e,aA),t.ownerDocument=this,e&&this.removeChild(e),Dr(t)&&(this.documentElement=t)},importNode:function(t,e){return dA(this,t,e)},getElementById:function(t){var e=null;return fh(this.documentElement,function(i){if(i.nodeType==er&&i.getAttribute("id")==t)return e=i,!0}),e},getElementsByClassName:function(t){var e=xx(t);return new zu(this,function(i){var n=[];return e.length>0&&fh(i.documentElement,function(o){if(o!==i&&o.nodeType===er){var u=o.getAttribute("class");if(u){var c=t===u;if(!c){var h=xx(u);c=e.every(ZB(h))}c&&n.push(o)}}}),n})},createElement:function(t){var e=new ol;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new fa;var i=e.attributes=new pm;return i._ownerElement=e,e},createDocumentFragment:function(){var t=new Zm;return t.ownerDocument=this,t.childNodes=new fa,t},createTextNode:function(t){var e=new Pv;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new Lv;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new Nv;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var i=new Mv;return i.ownerDocument=this,i.tagName=i.target=t,i.nodeValue=i.data=e,i},createAttribute:function(t){var e=new gm;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new Rv;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var i=new ol,n=e.split(":"),o=i.attributes=new pm;return i.childNodes=new fa,i.ownerDocument=this,i.nodeName=e,i.tagName=e,i.namespaceURI=t,n.length==2?(i.prefix=n[0],i.localName=n[1]):i.localName=e,o._ownerElement=i,i},createAttributeNS:function(t,e){var i=new gm,n=e.split(":");return i.ownerDocument=this,i.nodeName=e,i.name=e,i.namespaceURI=t,i.specified=!0,n.length==2?(i.prefix=n[0],i.localName=n[1]):i.localName=e,i}};Js(Lh,ri);function ol(){this._nsMap={}}ol.prototype={nodeType:er,hasAttribute:function(t){return this.getAttributeNode(t)!=null},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var i=this.ownerDocument.createAttribute(t);i.value=i.nodeValue=""+e,this.setAttributeNode(i)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===Ta?this.insertBefore(t,null):oF(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var i=this.getAttributeNodeNS(t,e);i&&this.removeAttributeNode(i)},hasAttributeNS:function(t,e){return this.getAttributeNodeNS(t,e)!=null},getAttributeNS:function(t,e){var i=this.getAttributeNodeNS(t,e);return i&&i.value||""},setAttributeNS:function(t,e,i){var n=this.ownerDocument.createAttributeNS(t,e);n.value=n.nodeValue=""+i,this.setAttributeNode(n)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new zu(this,function(e){var i=[];return fh(e,function(n){n!==e&&n.nodeType==er&&(t==="*"||n.tagName==t)&&i.push(n)}),i})},getElementsByTagNameNS:function(t,e){return new zu(this,function(i){var n=[];return fh(i,function(o){o!==i&&o.nodeType===er&&(t==="*"||o.namespaceURI===t)&&(e==="*"||o.localName==e)&&n.push(o)}),n})}};Lh.prototype.getElementsByTagName=ol.prototype.getElementsByTagName;Lh.prototype.getElementsByTagNameNS=ol.prototype.getElementsByTagNameNS;Js(ol,ri);function gm(){}gm.prototype.nodeType=Gu;Js(gm,ri);function Nh(){}Nh.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(Zi[Ks])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,i){var n=this.data.substring(0,t),o=this.data.substring(t+e);i=n+i+o,this.nodeValue=this.data=i,this.length=i.length}};Js(Nh,ri);function Pv(){}Pv.prototype={nodeName:"#text",nodeType:fm,splitText:function(t){var e=this.data,i=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};Js(Pv,Nh);function Lv(){}Lv.prototype={nodeName:"#comment",nodeType:Q1};Js(Lv,Nh);function Nv(){}Nv.prototype={nodeName:"#cdata-section",nodeType:K1};Js(Nv,Nh);function Jm(){}Jm.prototype.nodeType=Z1;Js(Jm,ri);function oA(){}oA.prototype.nodeType=tF;Js(oA,ri);function lA(){}lA.prototype.nodeType=eF;Js(lA,ri);function Rv(){}Rv.prototype.nodeType=X1;Js(Rv,ri);function Zm(){}Zm.prototype.nodeName="#document-fragment";Zm.prototype.nodeType=Ta;Js(Zm,ri);function Mv(){}Mv.prototype.nodeType=Y1;Js(Mv,ri);function uA(){}uA.prototype.serializeToString=function(t,e,i){return cA.call(t,e,i)};ri.prototype.toString=cA;function cA(t,e){var i=[],n=this.nodeType==9&&this.documentElement||this,o=n.prefix,u=n.namespaceURI;if(u&&o==null){var o=n.lookupPrefix(u);if(o==null)var c=[{namespace:u,prefix:null}]}return xu(this,i,t,e,c),i.join("")}function Ox(t,e,i){var n=t.prefix||"",o=t.namespaceURI;if(!o||n==="xml"&&o===hh.XML||o===hh.XMLNS)return!1;for(var u=i.length;u--;){var c=i[u];if(c.prefix===n)return c.namespace!==o}return!0}function Ry(t,e,i){t.push(" ",e,'="',i.replace(/[<>&"\t\n\r]/g,sA),'"')}function xu(t,e,i,n,o){if(o||(o=[]),n)if(t=n(t),t){if(typeof t=="string"){e.push(t);return}}else return;switch(t.nodeType){case er:var u=t.attributes,c=u.length,W=t.firstChild,h=t.tagName;i=hh.isHTML(t.namespaceURI)||i;var m=h;if(!i&&!t.prefix&&t.namespaceURI){for(var v,T=0;T<u.length;T++)if(u.item(T).name==="xmlns"){v=u.item(T).value;break}if(!v)for(var O=o.length-1;O>=0;O--){var R=o[O];if(R.prefix===""&&R.namespace===t.namespaceURI){v=R.namespace;break}}if(v!==t.namespaceURI)for(var O=o.length-1;O>=0;O--){var R=o[O];if(R.namespace===t.namespaceURI){R.prefix&&(m=R.prefix+":"+h);break}}}e.push("<",m);for(var M=0;M<c;M++){var z=u.item(M);z.prefix=="xmlns"?o.push({prefix:z.localName,namespace:z.value}):z.nodeName=="xmlns"&&o.push({prefix:"",namespace:z.value})}for(var M=0;M<c;M++){var z=u.item(M);if(Ox(z,i,o)){var j=z.prefix||"",q=z.namespaceURI;Ry(e,j?"xmlns:"+j:"xmlns",q),o.push({prefix:j,namespace:q})}xu(z,e,i,n,o)}if(h===m&&Ox(t,i,o)){var j=t.prefix||"",q=t.namespaceURI;Ry(e,j?"xmlns:"+j:"xmlns",q),o.push({prefix:j,namespace:q})}if(W||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(h)){if(e.push(">"),i&&/^script$/i.test(h))for(;W;)W.data?e.push(W.data):xu(W,e,i,n,o.slice()),W=W.nextSibling;else for(;W;)xu(W,e,i,n,o.slice()),W=W.nextSibling;e.push("</",m,">")}else e.push("/>");return;case J1:case Ta:for(var W=t.firstChild;W;)xu(W,e,i,n,o.slice()),W=W.nextSibling;return;case Gu:return Ry(e,t.name,t.value);case fm:return e.push(t.data.replace(/[<&>]/g,sA));case K1:return e.push("<![CDATA[",t.data,"]]>");case Q1:return e.push("<!--",t.data,"-->");case Z1:var ee=t.publicId,se=t.systemId;if(e.push("<!DOCTYPE ",t.name),ee)e.push(" PUBLIC ",ee),se&&se!="."&&e.push(" ",se),e.push(">");else if(se&&se!=".")e.push(" SYSTEM ",se,">");else{var re=t.internalSubset;re&&e.push(" [",re,"]"),e.push(">")}return;case Y1:return e.push("<?",t.target," ",t.data,"?>");case X1:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function dA(t,e,i){var n;switch(e.nodeType){case er:n=e.cloneNode(!1),n.ownerDocument=t;case Ta:break;case Gu:i=!0;break}if(n||(n=e.cloneNode(!1)),n.ownerDocument=t,n.parentNode=null,i)for(var o=e.firstChild;o;)n.appendChild(dA(t,o,i)),o=o.nextSibling;return n}function _0(t,e,i){var n=new e.constructor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];typeof u!="object"&&u!=n[o]&&(n[o]=u)}switch(e.childNodes&&(n.childNodes=new fa),n.ownerDocument=t,n.nodeType){case er:var c=e.attributes,h=n.attributes=new pm,m=c.length;h._ownerElement=n;for(var v=0;v<m;v++)n.setAttributeNode(_0(t,c.item(v),!0));break;case Gu:i=!0}if(i)for(var T=e.firstChild;T;)n.appendChild(_0(t,T,i)),T=T.nextSibling;return n}function hA(t,e,i){t[e]=i}try{if(Object.defineProperty){let t=function(e){switch(e.nodeType){case er:case Ta:var i=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&i.push(t(e)),e=e.nextSibling;return i.join("");default:return e.nodeValue}};var getTextContent=t;Object.defineProperty(zu.prototype,"length",{get:function(){return Iv(this),this.$$length}}),Object.defineProperty(ri.prototype,"textContent",{get:function(){return t(this)},set:function(e){switch(this.nodeType){case er:case Ta:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),hA=function(e,i,n){e["$$"+i]=n}}}catch{}lo.DocumentType=Jm;lo.DOMException=Ni;lo.DOMImplementation=iA;lo.Element=ol;lo.Node=ri;lo.NodeList=fa;lo.XMLSerializer=uA;var eg={},fA={};(function(t){var e=wa.freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}),t.entityMap=t.HTML_ENTITIES})(fA);var Uv={},ph=wa.NAMESPACE,y0=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Dx=new RegExp("[\\-\\.0-9"+y0.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Px=new RegExp("^"+y0.source+Dx.source+"*(?::"+y0.source+Dx.source+"*)?$"),Ud=0,Ha=1,du=2,Bd=3,hu=4,fu=5,Fd=6,Lp=7;function Ku(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Ku)}Ku.prototype=new Error;Ku.prototype.name=Ku.name;function pA(){}pA.prototype={parse:function(t,e,i){var n=this.domBuilder;n.startDocument(),mA(e,e={}),lF(t,e,i,n,this.errorHandler),n.endDocument()}};function lF(t,e,i,n,o){function u(Qe){if(Qe>65535){Qe-=65536;var Ze=55296+(Qe>>10),_t=56320+(Qe&1023);return String.fromCharCode(Ze,_t)}else return String.fromCharCode(Qe)}function c(Qe){var Ze=Qe.slice(1,-1);return Object.hasOwnProperty.call(i,Ze)?i[Ze]:Ze.charAt(0)==="#"?u(parseInt(Ze.substr(1).replace("x","0x"))):(o.error("entity not found:"+Qe),Qe)}function h(Qe){if(Qe>j){var Ze=t.substring(j,Qe).replace(/&#?\w+;/g,c);R&&m(j),n.characters(Ze,0,Qe-j),j=Qe}}function m(Qe,Ze){for(;Qe>=T&&(Ze=O.exec(t));)v=Ze.index,T=v+Ze[0].length,R.lineNumber++;R.columnNumber=Qe-v+1}for(var v=0,T=0,O=/.*(?:\r\n?|\n)|.*$/g,R=n.locator,M=[{currentNSMap:e}],z={},j=0;;){try{var q=t.indexOf("<",j);if(q<0){if(!t.substr(j).match(/^\s*$/)){var W=n.doc,ee=W.createTextNode(t.substr(j));W.appendChild(ee),n.currentElement=ee}return}switch(q>j&&h(q),t.charAt(q+1)){case"/":var We=t.indexOf(">",q+3),se=t.substring(q+2,We).replace(/[ \t\n\r]+$/g,""),re=M.pop();We<0?(se=t.substring(q+2).replace(/[\s<].*/,""),o.error("end tag name: "+se+" is not complete:"+re.tagName),We=q+1+se.length):se.match(/\s</)&&(se=se.replace(/[\s<].*/,""),o.error("end tag name: "+se+" maybe not complete"),We=q+1+se.length);var ie=re.localNSMap,ye=re.tagName==se,Pe=ye||re.tagName&&re.tagName.toLowerCase()==se.toLowerCase();if(Pe){if(n.endElement(re.uri,re.localName,se),ie)for(var Ie in ie)Object.prototype.hasOwnProperty.call(ie,Ie)&&n.endPrefixMapping(Ie);ye||o.fatalError("end tag name: "+se+" is not match the current start tagName:"+re.tagName)}else M.push(re);We++;break;case"?":R&&m(q),We=fF(t,q,n);break;case"!":R&&m(q),We=hF(t,q,n,o);break;default:R&&m(q);var Be=new gA,Ve=M[M.length-1].currentNSMap,We=uF(t,q,Be,Ve,c,o),it=Be.length;if(!Be.closed&&dF(t,We,Be.tagName,z)&&(Be.closed=!0,i.nbsp||o.warning("unclosed xml attribute")),R&&it){for(var Le=Lx(R,{}),ct=0;ct<it;ct++){var Ht=Be[ct];m(Ht.offset),Ht.locator=Lx(R,{})}n.locator=Le,Nx(Be,n,Ve)&&M.push(Be),n.locator=R}else Nx(Be,n,Ve)&&M.push(Be);ph.isHTML(Be.uri)&&!Be.closed?We=cF(t,We,Be.tagName,c,n):We++}}catch(Qe){if(Qe instanceof Ku)throw Qe;o.error("element parse error: "+Qe),We=-1}We>j?j=We:h(Math.max(q,j)+1)}}function Lx(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function uF(t,e,i,n,o,u){function c(R,M,z){i.attributeNames.hasOwnProperty(R)&&u.fatalError("Attribute "+R+" redefined"),i.addValue(R,M.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,o),z)}for(var h,m,v=++e,T=Ud;;){var O=t.charAt(v);switch(O){case"=":if(T===Ha)h=t.slice(e,v),T=Bd;else if(T===du)T=Bd;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(T===Bd||T===Ha)if(T===Ha&&(u.warning('attribute value must after "="'),h=t.slice(e,v)),e=v+1,v=t.indexOf(O,e),v>0)m=t.slice(e,v),c(h,m,e-1),T=fu;else throw new Error("attribute value no end '"+O+"' match");else if(T==hu)m=t.slice(e,v),c(h,m,e),u.warning('attribute "'+h+'" missed start quot('+O+")!!"),e=v+1,T=fu;else throw new Error('attribute value must after "="');break;case"/":switch(T){case Ud:i.setTagName(t.slice(e,v));case fu:case Fd:case Lp:T=Lp,i.closed=!0;case hu:case Ha:case du:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return u.error("unexpected end of input"),T==Ud&&i.setTagName(t.slice(e,v)),v;case">":switch(T){case Ud:i.setTagName(t.slice(e,v));case fu:case Fd:case Lp:break;case hu:case Ha:m=t.slice(e,v),m.slice(-1)==="/"&&(i.closed=!0,m=m.slice(0,-1));case du:T===du&&(m=h),T==hu?(u.warning('attribute "'+m+'" missed quot(")!'),c(h,m,e)):((!ph.isHTML(n[""])||!m.match(/^(?:disabled|checked|selected)$/i))&&u.warning('attribute "'+m+'" missed value!! "'+m+'" instead!!'),c(m,m,e));break;case Bd:throw new Error("attribute value missed!!")}return v;case"":O=" ";default:if(O<=" ")switch(T){case Ud:i.setTagName(t.slice(e,v)),T=Fd;break;case Ha:h=t.slice(e,v),T=du;break;case hu:var m=t.slice(e,v);u.warning('attribute "'+m+'" missed quot(")!!'),c(h,m,e);case fu:T=Fd;break}else switch(T){case du:i.tagName,(!ph.isHTML(n[""])||!h.match(/^(?:disabled|checked|selected)$/i))&&u.warning('attribute "'+h+'" missed value!! "'+h+'" instead2!!'),c(h,h,e),e=v,T=Ha;break;case fu:u.warning('attribute space is required"'+h+'"!!');case Fd:T=Ha,e=v;break;case Bd:T=hu,e=v;break;case Lp:throw new Error("elements closed character '/' and '>' must be connected to")}}v++}}function Nx(t,e,i){for(var n=t.tagName,o=null,O=t.length;O--;){var u=t[O],c=u.qName,h=u.value,R=c.indexOf(":");if(R>0)var m=u.prefix=c.slice(0,R),v=c.slice(R+1),T=m==="xmlns"&&v;else v=c,m=null,T=c==="xmlns"&&"";u.localName=v,T!==!1&&(o==null&&(o={},mA(i,i={})),i[T]=o[T]=h,u.uri=ph.XMLNS,e.startPrefixMapping(T,h))}for(var O=t.length;O--;){u=t[O];var m=u.prefix;m&&(m==="xml"&&(u.uri=ph.XML),m!=="xmlns"&&(u.uri=i[m||""]))}var R=n.indexOf(":");R>0?(m=t.prefix=n.slice(0,R),v=t.localName=n.slice(R+1)):(m=null,v=t.localName=n);var M=t.uri=i[m||""];if(e.startElement(M,v,n,t),t.closed){if(e.endElement(M,v,n),o)for(m in o)Object.prototype.hasOwnProperty.call(o,m)&&e.endPrefixMapping(m)}else return t.currentNSMap=i,t.localNSMap=o,!0}function cF(t,e,i,n,o){if(/^(?:script|textarea)$/i.test(i)){var u=t.indexOf("</"+i+">",e),c=t.substring(e+1,u);if(/[&<]/.test(c))return/^script$/i.test(i)?(o.characters(c,0,c.length),u):(c=c.replace(/&#?\w+;/g,n),o.characters(c,0,c.length),u)}return e+1}function dF(t,e,i,n){var o=n[i];return o==null&&(o=t.lastIndexOf("</"+i+">"),o<e&&(o=t.lastIndexOf("</"+i)),n[i]=o),o<e}function mA(t,e){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}function hF(t,e,i,n){var o=t.charAt(e+2);switch(o){case"-":if(t.charAt(e+3)==="-"){var u=t.indexOf("-->",e+4);return u>e?(i.comment(t,e+4,u-e-4),u+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(t.substr(e+3,6)=="CDATA["){var u=t.indexOf("]]>",e+9);return i.startCDATA(),i.characters(t,e+9,u-e-9),i.endCDATA(),u+3}var c=pF(t,e),h=c.length;if(h>1&&/!doctype/i.test(c[0][0])){var m=c[1][0],v=!1,T=!1;h>3&&(/^public$/i.test(c[2][0])?(v=c[3][0],T=h>4&&c[4][0]):/^system$/i.test(c[2][0])&&(T=c[3][0]));var O=c[h-1];return i.startDTD(m,v,T),i.endDTD(),O.index+O[0].length}}return-1}function fF(t,e,i){var n=t.indexOf("?>",e);if(n){var o=t.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,i.processingInstruction(o[1],o[2]),n+2):-1}return-1}function gA(){this.attributeNames={}}gA.prototype={setTagName:function(t){if(!Px.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,i){if(!Px.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:i}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}};function pF(t,e){var i,n=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=e,o.exec(t);i=o.exec(t);)if(n.push(i),i[1])return n}Uv.XMLReader=pA;Uv.ParseError=Ku;var mF=wa,gF=lo,Rx=fA,_A=Uv,_F=gF.DOMImplementation,Mx=mF.NAMESPACE,yF=_A.ParseError,vF=_A.XMLReader;function yA(t){return t.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function vA(t){this.options=t||{locator:{}}}vA.prototype.parseFromString=function(t,e){var i=this.options,n=new vF,o=i.domBuilder||new Rh,u=i.errorHandler,c=i.locator,h=i.xmlns||{},m=/\/x?html?$/.test(e),v=m?Rx.HTML_ENTITIES:Rx.XML_ENTITIES;c&&o.setDocumentLocator(c),n.errorHandler=TF(u,o,c),n.domBuilder=i.domBuilder||o,m&&(h[""]=Mx.HTML),h.xml=h.xml||Mx.XML;var T=i.normalizeLineEndings||yA;return t&&typeof t=="string"?n.parse(T(t),h,v):n.errorHandler.error("invalid doc source"),o.doc};function TF(t,e,i){if(!t){if(e instanceof Rh)return e;t=e}var n={},o=t instanceof Function;i=i||{};function u(c){var h=t[c];!h&&o&&(h=t.length==2?function(m){t(c,m)}:t),n[c]=h&&function(m){h("[xmldom "+c+"]	"+m+v0(i))}||function(){}}return u("warning"),u("error"),u("fatalError"),n}function Rh(){this.cdata=!1}function pu(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}Rh.prototype={startDocument:function(){this.doc=new _F().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,i,n){var o=this.doc,u=o.createElementNS(t,i||e),c=n.length;Np(this,u),this.currentElement=u,this.locator&&pu(this.locator,u);for(var h=0;h<c;h++){var t=n.getURI(h),m=n.getValue(h),i=n.getQName(h),v=o.createAttributeNS(t,i);this.locator&&pu(n.getLocator(h),v),v.value=v.nodeValue=m,u.setAttributeNode(v)}},endElement:function(t,e,i){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var i=this.doc.createProcessingInstruction(t,e);this.locator&&pu(this.locator,i),Np(this,i)},ignorableWhitespace:function(t,e,i){},characters:function(t,e,i){if(t=Ux.apply(this,arguments),t){if(this.cdata)var n=this.doc.createCDATASection(t);else var n=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(t)&&this.doc.appendChild(n),this.locator&&pu(this.locator,n)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,i){t=Ux.apply(this,arguments);var n=this.doc.createComment(t);this.locator&&pu(this.locator,n),Np(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,i){var n=this.doc.implementation;if(n&&n.createDocumentType){var o=n.createDocumentType(t,e,i);this.locator&&pu(this.locator,o),Np(this,o),this.doc.doctype=o}},warning:function(t){console.warn("[xmldom warning]	"+t,v0(this.locator))},error:function(t){console.error("[xmldom error]	"+t,v0(this.locator))},fatalError:function(t){throw new yF(t,this.locator)}};function v0(t){if(t)return`
@`+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function Ux(t,e,i){return typeof t=="string"?t.substr(e,i):t.length>=e+i||e?new java.lang.String(t,e,i)+"":t}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){Rh.prototype[t]=function(){return null}});function Np(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}eg.__DOMHandler=Rh;eg.normalizeLineEndings=yA;eg.DOMParser=vA;var bF=eg.DOMParser;/*! @name mpd-parser @version 1.0.1 @license Apache-2.0 */const Bx=t=>!!t&&typeof t=="object",ms=(...t)=>t.reduce((e,i)=>(typeof i!="object"||Object.keys(i).forEach(n=>{Array.isArray(e[n])&&Array.isArray(i[n])?e[n]=e[n].concat(i[n]):Bx(e[n])&&Bx(i[n])?e[n]=ms(e[n],i[n]):e[n]=i[n]}),e),{}),TA=t=>Object.keys(t).map(e=>t[e]),EF=(t,e)=>{const i=[];for(let n=t;n<e;n++)i.push(n);return i},tg=t=>t.reduce((e,i)=>e.concat(i),[]),bA=t=>{if(!t.length)return[];const e=[];for(let i=0;i<t.length;i++)e.push(t[i]);return e},SF=(t,e)=>t.reduce((i,n,o)=>(n[e]&&i.push(o),i),[]),xF=(t,e)=>TA(t.reduce((i,n)=>(n.forEach(o=>{i[e(o)]=o}),i),{}));var Xu={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const mh=({baseUrl:t="",source:e="",range:i="",indexRange:n=""})=>{const o={uri:e,resolvedUri:Av(t||"",e)};if(i||n){const c=(i||n).split("-");let h=Z.BigInt?Z.BigInt(c[0]):parseInt(c[0],10),m=Z.BigInt?Z.BigInt(c[1]):parseInt(c[1],10);h<Number.MAX_SAFE_INTEGER&&typeof h=="bigint"&&(h=Number(h)),m<Number.MAX_SAFE_INTEGER&&typeof m=="bigint"&&(m=Number(m));let v;typeof m=="bigint"||typeof h=="bigint"?v=Z.BigInt(m)-Z.BigInt(h)+Z.BigInt(1):v=m-h+1,typeof v=="bigint"&&v<Number.MAX_SAFE_INTEGER&&(v=Number(v)),o.byterange={length:v,offset:h}}return o},wF=t=>{let e;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=Z.BigInt(t.offset)+Z.BigInt(t.length)-Z.BigInt(1):e=t.offset+t.length-1,`${t.offset}-${e}`},Fx=t=>(t&&typeof t!="number"&&(t=parseInt(t,10)),isNaN(t)?null:t),CF={static(t){const{duration:e,timescale:i=1,sourceDuration:n,periodDuration:o}=t,u=Fx(t.endNumber),c=e/i;return typeof u=="number"?{start:0,end:u}:typeof o=="number"?{start:0,end:o/c}:{start:0,end:n/c}},dynamic(t){const{NOW:e,clientOffset:i,availabilityStartTime:n,timescale:o=1,duration:u,periodStart:c=0,minimumUpdatePeriod:h=0,timeShiftBufferDepth:m=1/0}=t,v=Fx(t.endNumber),T=(e+i)/1e3,O=n+c,M=T+h-O,z=Math.ceil(M*o/u),j=Math.floor((T-O-m)*o/u),q=Math.floor((T-O)*o/u);return{start:Math.max(0,j),end:typeof v=="number"?v:Math.min(z,q)}}},AF=t=>e=>{const{duration:i,timescale:n=1,periodStart:o,startNumber:u=1}=t;return{number:u+e,duration:i/n,timeline:o,time:e*i}},Bv=t=>{const{type:e,duration:i,timescale:n=1,periodDuration:o,sourceDuration:u}=t,{start:c,end:h}=CF[e](t),m=EF(c,h).map(AF(t));if(e==="static"){const v=m.length-1,T=typeof o=="number"?o:u;m[v].duration=T-i/n*v}return m},EA=t=>{const{baseUrl:e,initialization:i={},sourceDuration:n,indexRange:o="",periodStart:u,presentationTime:c,number:h=0,duration:m}=t;if(!e)throw new Error(Xu.NO_BASE_URL);const v=mh({baseUrl:e,source:i.sourceURL,range:i.range}),T=mh({baseUrl:e,source:e,indexRange:o});if(T.map=v,m){const O=Bv(t);O.length&&(T.duration=O[0].duration,T.timeline=O[0].timeline)}else n&&(T.duration=n,T.timeline=u);return T.presentationTime=c||u,T.number=h,[T]},Fv=(t,e,i)=>{const n=t.sidx.map?t.sidx.map:null,o=t.sidx.duration,u=t.timeline||0,c=t.sidx.byterange,h=c.offset+c.length,m=e.timescale,v=e.references.filter(q=>q.referenceType!==1),T=[],O=t.endList?"static":"dynamic",R=t.sidx.timeline;let M=R,z=t.mediaSequence||0,j;typeof e.firstOffset=="bigint"?j=Z.BigInt(h)+e.firstOffset:j=h+e.firstOffset;for(let q=0;q<v.length;q++){const W=e.references[q],ee=W.referencedSize,se=W.subsegmentDuration;let re;typeof j=="bigint"?re=j+Z.BigInt(ee)-Z.BigInt(1):re=j+ee-1;const ie=`${j}-${re}`,Pe=EA({baseUrl:i,timescale:m,timeline:u,periodStart:R,presentationTime:M,number:z,duration:se,sourceDuration:o,indexRange:ie,type:O})[0];n&&(Pe.map=n),T.push(Pe),typeof j=="bigint"?j+=Z.BigInt(ee):j+=ee,M+=se/m,z++}return t.segments=T,t},kF=["AUDIO","SUBTITLES"],IF=1/60,SA=t=>xF(t,({timeline:e})=>e).sort((e,i)=>e.timeline>i.timeline?1:-1),OF=(t,e)=>{for(let i=0;i<t.length;i++)if(t[i].attributes.NAME===e)return t[i];return null},$x=t=>{let e=[];return WB(t,kF,(i,n,o,u)=>{e=e.concat(i.playlists||[])}),e},jx=({playlist:t,mediaSequence:e})=>{t.mediaSequence=e,t.segments.forEach((i,n)=>{i.number=t.mediaSequence+n})},DF=({oldPlaylists:t,newPlaylists:e,timelineStarts:i})=>{e.forEach(n=>{n.discontinuitySequence=i.findIndex(function({timeline:m}){return m===n.timeline});const o=OF(t,n.attributes.NAME);if(!o||n.sidx)return;const u=n.segments[0],c=o.segments.findIndex(function(m){return Math.abs(m.presentationTime-u.presentationTime)<IF});if(c===-1){jx({playlist:n,mediaSequence:o.mediaSequence+o.segments.length}),n.segments[0].discontinuity=!0,n.discontinuityStarts.unshift(0),(!o.segments.length&&n.timeline>o.timeline||o.segments.length&&n.timeline>o.segments[o.segments.length-1].timeline)&&n.discontinuitySequence--;return}o.segments[c].discontinuity&&!u.discontinuity&&(u.discontinuity=!0,n.discontinuityStarts.unshift(0),n.discontinuitySequence--),jx({playlist:n,mediaSequence:o.segments[c].number})})},PF=({oldManifest:t,newManifest:e})=>{const i=t.playlists.concat($x(t)),n=e.playlists.concat($x(e));return e.timelineStarts=SA([t.timelineStarts,e.timelineStarts]),DF({oldPlaylists:i,newPlaylists:n,timelineStarts:e.timelineStarts}),e},ig=t=>t&&t.uri+"-"+wF(t.byterange),My=t=>TA(t.reduce((i,n)=>{const o=n.attributes.id+(n.attributes.lang||"");return i[o]?(n.segments&&(n.segments[0]&&(n.segments[0].discontinuity=!0),i[o].segments.push(...n.segments)),n.attributes.contentProtection&&(i[o].attributes.contentProtection=n.attributes.contentProtection)):(i[o]=n,i[o].attributes.timelineStarts=[]),i[o].attributes.timelineStarts.push({start:n.attributes.periodStart,timeline:n.attributes.periodStart}),i},{})).map(i=>(i.discontinuityStarts=SF(i.segments||[],"discontinuity"),i)),$v=(t,e)=>{const i=ig(t.sidx),n=i&&e[i]&&e[i].sidx;return n&&Fv(t,n,t.sidx.resolvedUri),t},LF=(t,e={})=>{if(!Object.keys(e).length)return t;for(const i in t)t[i]=$v(t[i],e);return t},NF=({attributes:t,segments:e,sidx:i,mediaSequence:n,discontinuitySequence:o,discontinuityStarts:u},c)=>{const h={attributes:{NAME:t.id,BANDWIDTH:t.bandwidth,CODECS:t.codecs,["PROGRAM-ID"]:1},uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:"",targetDuration:t.duration,discontinuitySequence:o,discontinuityStarts:u,timelineStarts:t.timelineStarts,mediaSequence:n,segments:e};return t.contentProtection&&(h.contentProtection=t.contentProtection),i&&(h.sidx=i),c&&(h.attributes.AUDIO="audio",h.attributes.SUBTITLES="subs"),h},RF=({attributes:t,segments:e,mediaSequence:i,discontinuityStarts:n,discontinuitySequence:o})=>{typeof e>"u"&&(e=[{uri:t.baseUrl,timeline:t.periodStart,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration);const u={NAME:t.id,BANDWIDTH:t.bandwidth,["PROGRAM-ID"]:1};return t.codecs&&(u.CODECS=t.codecs),{attributes:u,uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,timelineStarts:t.timelineStarts,discontinuityStarts:n,discontinuitySequence:o,mediaSequence:i,segments:e}},MF=(t,e={},i=!1)=>{let n;const o=t.reduce((u,c)=>{const h=c.attributes.role&&c.attributes.role.value||"",m=c.attributes.lang||"";let v=c.attributes.label||"main";if(m&&!c.attributes.label){const O=h?` (${h})`:"";v=`${c.attributes.lang}${O}`}u[v]||(u[v]={language:m,autoselect:!0,default:h==="main",playlists:[],uri:""});const T=$v(NF(c,i),e);return u[v].playlists.push(T),typeof n>"u"&&h==="main"&&(n=c,n.default=!0),u},{});if(!n){const u=Object.keys(o)[0];o[u].default=!0}return o},UF=(t,e={})=>t.reduce((i,n)=>{const o=n.attributes.lang||"text";return i[o]||(i[o]={language:o,default:!1,autoselect:!1,playlists:[],uri:""}),i[o].playlists.push($v(RF(n),e)),i},{}),BF=t=>t.reduce((e,i)=>(i&&i.forEach(n=>{const{channel:o,language:u}=n;e[u]={autoselect:!1,default:!1,instreamId:o,language:u},n.hasOwnProperty("aspectRatio")&&(e[u].aspectRatio=n.aspectRatio),n.hasOwnProperty("easyReader")&&(e[u].easyReader=n.easyReader),n.hasOwnProperty("3D")&&(e[u]["3D"]=n["3D"])}),e),{}),FF=({attributes:t,segments:e,sidx:i,discontinuityStarts:n})=>{const o={attributes:{NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:t.type==="static",timeline:t.periodStart,resolvedUri:"",targetDuration:t.duration,discontinuityStarts:n,timelineStarts:t.timelineStarts,segments:e};return t.frameRate&&(o.attributes["FRAME-RATE"]=t.frameRate),t.contentProtection&&(o.contentProtection=t.contentProtection),i&&(o.sidx=i),o},$F=({attributes:t})=>t.mimeType==="video/mp4"||t.mimeType==="video/webm"||t.contentType==="video",jF=({attributes:t})=>t.mimeType==="audio/mp4"||t.mimeType==="audio/webm"||t.contentType==="audio",HF=({attributes:t})=>t.mimeType==="text/vtt"||t.contentType==="text",VF=(t,e)=>{t.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=e.findIndex(function({timeline:n}){return n===i.timeline}),i.segments&&i.segments.forEach((n,o)=>{n.number=o})})},Hx=t=>t?Object.keys(t).reduce((e,i)=>{const n=t[i];return e.concat(n.playlists)},[]):[],qF=({dashPlaylists:t,locations:e,sidxMapping:i={},previousManifest:n})=>{if(!t.length)return{};const{sourceDuration:o,type:u,suggestedPresentationDelay:c,minimumUpdatePeriod:h}=t[0].attributes,m=My(t.filter($F)).map(FF),v=My(t.filter(jF)),T=My(t.filter(HF)),O=t.map(ee=>ee.attributes.captionServices).filter(Boolean),R={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:o,playlists:LF(m,i)};h>=0&&(R.minimumUpdatePeriod=h*1e3),e&&(R.locations=e),u==="dynamic"&&(R.suggestedPresentationDelay=c);const M=R.playlists.length===0,z=v.length?MF(v,i,M):null,j=T.length?UF(T,i):null,q=m.concat(Hx(z),Hx(j)),W=q.map(({timelineStarts:ee})=>ee);return R.timelineStarts=SA(W),VF(q,R.timelineStarts),z&&(R.mediaGroups.AUDIO.audio=z),j&&(R.mediaGroups.SUBTITLES.subs=j),O.length&&(R.mediaGroups["CLOSED-CAPTIONS"].cc=BF(O)),n?PF({oldManifest:n,newManifest:R}):R},WF=(t,e,i)=>{const{NOW:n,clientOffset:o,availabilityStartTime:u,timescale:c=1,periodStart:h=0,minimumUpdatePeriod:m=0}=t,v=(n+o)/1e3,T=u+h,R=v+m-T;return Math.ceil((R*c-e)/i)},xA=(t,e)=>{const{type:i,minimumUpdatePeriod:n=0,media:o="",sourceDuration:u,timescale:c=1,startNumber:h=1,periodStart:m}=t,v=[];let T=-1;for(let O=0;O<e.length;O++){const R=e[O],M=R.d,z=R.r||0,j=R.t||0;T<0&&(T=j),j&&j>T&&(T=j);let q;if(z<0){const se=O+1;se===e.length?i==="dynamic"&&n>0&&o.indexOf("$Number$")>0?q=WF(t,T,M):q=(u*c-T)/M:q=(e[se].t-T)/M}else q=z+1;const W=h+v.length+q;let ee=h+v.length;for(;ee<W;)v.push({number:ee,duration:M/c,time:T,timeline:m}),T+=M,ee++}return v},GF=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,zF=t=>(e,i,n,o)=>{if(e==="$$")return"$";if(typeof t[i]>"u")return e;const u=""+t[i];return i==="RepresentationID"||(n?o=parseInt(o,10):o=1,u.length>=o)?u:`${new Array(o-u.length+1).join("0")}${u}`},Vx=(t,e)=>t.replace(GF,zF(e)),KF=(t,e)=>!t.duration&&!e?[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodStart}]:t.duration?Bv(t):xA(t,e),XF=(t,e)=>{const i={RepresentationID:t.id,Bandwidth:t.bandwidth||0},{initialization:n={sourceURL:"",range:""}}=t,o=mh({baseUrl:t.baseUrl,source:Vx(n.sourceURL,i),range:n.range});return KF(t,e).map(c=>{i.Number=c.number,i.Time=c.time;const h=Vx(t.media||"",i),m=t.timescale||1,v=t.presentationTimeOffset||0,T=t.periodStart+(c.time-v)/m;return{uri:h,timeline:c.timeline,duration:c.duration,resolvedUri:Av(t.baseUrl||"",h),map:o,number:c.number,presentationTime:T}})},YF=(t,e)=>{const{baseUrl:i,initialization:n={}}=t,o=mh({baseUrl:i,source:n.sourceURL,range:n.range}),u=mh({baseUrl:i,source:e.media,range:e.mediaRange});return u.map=o,u},QF=(t,e)=>{const{duration:i,segmentUrls:n=[],periodStart:o}=t;if(!i&&!e||i&&e)throw new Error(Xu.SEGMENT_TIME_UNSPECIFIED);const u=n.map(m=>YF(t,m));let c;return i&&(c=Bv(t)),e&&(c=xA(t,e)),c.map((m,v)=>{if(u[v]){const T=u[v],O=t.timescale||1,R=t.presentationTimeOffset||0;return T.timeline=m.timeline,T.duration=m.duration,T.number=m.number,T.presentationTime=o+(m.time-R)/O,T}}).filter(m=>m)},JF=({attributes:t,segmentInfo:e})=>{let i,n;e.template?(n=XF,i=ms(t,e.template)):e.base?(n=EA,i=ms(t,e.base)):e.list&&(n=QF,i=ms(t,e.list));const o={attributes:t};if(!n)return o;const u=n(i,e.segmentTimeline);if(i.duration){const{duration:c,timescale:h=1}=i;i.duration=c/h}else u.length?i.duration=u.reduce((c,h)=>Math.max(c,Math.ceil(h.duration)),0):i.duration=0;return o.attributes=i,o.segments=u,e.base&&i.indexRange&&(o.sidx=u[0],o.segments=[]),o},ZF=t=>t.map(JF),Li=(t,e)=>bA(t.childNodes).filter(({tagName:i})=>i===e),jv=t=>t.textContent.trim(),e$=t=>parseFloat(t.split("/").reduce((e,i)=>e/i)),mu=t=>{const h=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(t);if(!h)return 0;const[m,v,T,O,R,M]=h.slice(1);return parseFloat(m||0)*31536e3+parseFloat(v||0)*2592e3+parseFloat(T||0)*86400+parseFloat(O||0)*3600+parseFloat(R||0)*60+parseFloat(M||0)},t$=t=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t)&&(t+="Z"),Date.parse(t)),qx={mediaPresentationDuration(t){return mu(t)},availabilityStartTime(t){return t$(t)/1e3},minimumUpdatePeriod(t){return mu(t)},suggestedPresentationDelay(t){return mu(t)},type(t){return t},timeShiftBufferDepth(t){return mu(t)},start(t){return mu(t)},width(t){return parseInt(t,10)},height(t){return parseInt(t,10)},bandwidth(t){return parseInt(t,10)},frameRate(t){return e$(t)},startNumber(t){return parseInt(t,10)},timescale(t){return parseInt(t,10)},presentationTimeOffset(t){return parseInt(t,10)},duration(t){const e=parseInt(t,10);return isNaN(e)?mu(t):e},d(t){return parseInt(t,10)},t(t){return parseInt(t,10)},r(t){return parseInt(t,10)},DEFAULT(t){return t}},ps=t=>t&&t.attributes?bA(t.attributes).reduce((e,i)=>{const n=qx[i.name]||qx.DEFAULT;return e[i.name]=n(i.value),e},{}):{},i$={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},sg=(t,e)=>e.length?tg(t.map(function(i){return e.map(function(n){return Av(i,jv(n))})})):t,Hv=t=>{const e=Li(t,"SegmentTemplate")[0],i=Li(t,"SegmentList")[0],n=i&&Li(i,"SegmentURL").map(O=>ms({tag:"SegmentURL"},ps(O))),o=Li(t,"SegmentBase")[0],u=i||e,c=u&&Li(u,"SegmentTimeline")[0],h=i||o||e,m=h&&Li(h,"Initialization")[0],v=e&&ps(e);v&&m?v.initialization=m&&ps(m):v&&v.initialization&&(v.initialization={sourceURL:v.initialization});const T={template:v,segmentTimeline:c&&Li(c,"S").map(O=>ps(O)),list:i&&ms(ps(i),{segmentUrls:n,initialization:ps(m)}),base:o&&ms(ps(o),{initialization:ps(m)})};return Object.keys(T).forEach(O=>{T[O]||delete T[O]}),T},s$=(t,e,i)=>n=>{const o=Li(n,"BaseURL"),u=sg(e,o),c=ms(t,ps(n)),h=Hv(n);return u.map(m=>({segmentInfo:ms(i,h),attributes:ms(c,{baseUrl:m})}))},n$=t=>t.reduce((e,i)=>{const n=ps(i);n.schemeIdUri&&(n.schemeIdUri=n.schemeIdUri.toLowerCase());const o=i$[n.schemeIdUri];if(o){e[o]={attributes:n};const u=Li(i,"cenc:pssh")[0];if(u){const c=jv(u);e[o].pssh=c&&zB(c)}}return e},{}),r$=t=>{if(t.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof t.value!="string"?[]:t.value.split(";")).map(i=>{let n,o;return o=i,/^CC\d=/.test(i)?[n,o]=i.split("="):/^CC\d$/.test(i)&&(n=i),{channel:n,language:o}});if(t.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof t.value!="string"?[]:t.value.split(";")).map(i=>{const n={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[o,u=""]=i.split("=");n.channel=o,n.language=i,u.split(",").forEach(c=>{const[h,m]=c.split(":");h==="lang"?n.language=m:h==="er"?n.easyReader=Number(m):h==="war"?n.aspectRatio=Number(m):h==="3D"&&(n["3D"]=Number(m))})}else n.language=i;return n.channel&&(n.channel="SERVICE"+n.channel),n})},a$=(t,e,i)=>n=>{const o=ps(n),u=sg(e,Li(n,"BaseURL")),c=Li(n,"Role")[0],h={role:ps(c)};let m=ms(t,o,h);const v=Li(n,"Accessibility")[0],T=r$(ps(v));T&&(m=ms(m,{captionServices:T}));const O=Li(n,"Label")[0];if(O&&O.childNodes.length){const q=O.childNodes[0].nodeValue.trim();m=ms(m,{label:q})}const R=n$(Li(n,"ContentProtection"));Object.keys(R).length&&(m=ms(m,{contentProtection:R}));const M=Hv(n),z=Li(n,"Representation"),j=ms(i,M);return tg(z.map(s$(m,u,j)))},o$=(t,e)=>(i,n)=>{const o=sg(e,Li(i.node,"BaseURL")),u=ms(t,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(u.periodDuration=i.attributes.duration);const c=Li(i.node,"AdaptationSet"),h=Hv(i.node);return tg(c.map(a$(u,o,h)))},l$=({attributes:t,priorPeriodAttributes:e,mpdType:i})=>typeof t.start=="number"?t.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&i==="static"?0:null,u$=(t,e={})=>{const{manifestUri:i="",NOW:n=Date.now(),clientOffset:o=0}=e,u=Li(t,"Period");if(!u.length)throw new Error(Xu.INVALID_NUMBER_OF_PERIOD);const c=Li(t,"Location"),h=ps(t),m=sg([i],Li(t,"BaseURL"));h.type=h.type||"static",h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=n,h.clientOffset=o,c.length&&(h.locations=c.map(jv));const v=[];return u.forEach((T,O)=>{const R=ps(T),M=v[O-1];R.start=l$({attributes:R,priorPeriodAttributes:M?M.attributes:null,mpdType:h.type}),v.push({node:T,attributes:R})}),{locations:h.locations,representationInfo:tg(v.map(o$(h,m)))}},wA=t=>{if(t==="")throw new Error(Xu.DASH_EMPTY_MANIFEST);const e=new bF;let i,n;try{i=e.parseFromString(t,"application/xml"),n=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch{}if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(Xu.DASH_INVALID_XML);return n},c$=t=>{const e=Li(t,"UTCTiming")[0];if(!e)return null;const i=ps(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Xu.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},d$=(t,e={})=>{const i=u$(wA(t),e),n=ZF(i.representationInfo);return qF({dashPlaylists:n,locations:i.locations,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest})},h$=t=>c$(wA(t));var CA=Math.pow(2,32),f$=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i;return e.getBigUint64?(i=e.getBigUint64(0),i<Number.MAX_SAFE_INTEGER?Number(i):i):e.getUint32(0)*CA+e.getUint32(4)},p$={getUint64:f$,MAX_UINT32:CA},Wx=p$.getUint64,m$=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},n=12;i.version===0?(i.earliestPresentationTime=e.getUint32(n),i.firstOffset=e.getUint32(n+4),n+=8):(i.earliestPresentationTime=Wx(t.subarray(n)),i.firstOffset=Wx(t.subarray(n+8)),n+=16),n+=2;var o=e.getUint16(n);for(n+=2;o>0;n+=12,o--)i.references.push({referenceType:(t[n]&128)>>>7,referencedSize:e.getUint32(n)&2147483647,subsegmentDuration:e.getUint32(n+4),startsWithSap:!!(t[n+8]&128),sapType:(t[n+8]&112)>>>4,sapDeltaTime:e.getUint32(n+8)&268435455});return i},g$=m$,_$=ht([73,68,51]),y$=function(e,i){i===void 0&&(i=0),e=ht(e);var n=e[i+5],o=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9],u=(n&16)>>4;return u?o+20:o+10},zd=function t(e,i){return i===void 0&&(i=0),e=ht(e),e.length-i<10||!wi(e,_$,{offset:i})?i:(i+=y$(e,i),t(e,i))},Gx=function(e){return typeof e=="string"?q1(e):e},v$=function(e){return Array.isArray(e)?e.map(function(i){return Gx(i)}):[Gx(e)]},T$=function t(e,i,n){n===void 0&&(n=!1),i=v$(i),e=ht(e);var o=[];if(!i.length)return o;for(var u=0;u<e.length;){var c=(e[u]<<24|e[u+1]<<16|e[u+2]<<8|e[u+3])>>>0,h=e.subarray(u+4,u+8);if(c===0)break;var m=u+c;if(m>e.length){if(n)break;m=e.length}var v=e.subarray(u+8,m);wi(h,i[0])&&(i.length===1?o.push(v):o.push.apply(o,t(v,i.slice(1),n))),u=m}return o},Rp={EBML:ht([26,69,223,163]),DocType:ht([66,130]),Segment:ht([24,83,128,103]),SegmentInfo:ht([21,73,169,102]),Tracks:ht([22,84,174,107]),Track:ht([174]),TrackNumber:ht([215]),DefaultDuration:ht([35,227,131]),TrackEntry:ht([174]),TrackType:ht([131]),FlagDefault:ht([136]),CodecID:ht([134]),CodecPrivate:ht([99,162]),VideoTrack:ht([224]),AudioTrack:ht([225]),Cluster:ht([31,67,182,117]),Timestamp:ht([231]),TimestampScale:ht([42,215,177]),BlockGroup:ht([160]),BlockDuration:ht([155]),Block:ht([161]),SimpleBlock:ht([163])},T0=[128,64,32,16,8,4,2,1],b$=function(e){for(var i=1,n=0;n<T0.length&&!(e&T0[n]);n++)i++;return i},_m=function(e,i,n,o){n===void 0&&(n=!0),o===void 0&&(o=!1);var u=b$(e[i]),c=e.subarray(i,i+u);return n&&(c=Array.prototype.slice.call(e,i,i+u),c[0]^=T0[u-1]),{length:u,value:HB(c,{signed:o}),bytes:c}},zx=function t(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(i){return t(i)}):typeof e=="number"?VB(e):e},E$=function(e){return Array.isArray(e)?e.map(function(i){return zx(i)}):[zx(e)]},S$=function t(e,i,n){if(n>=i.length)return i.length;var o=_m(i,n,!1);if(wi(e.bytes,o.bytes))return n;var u=_m(i,n+o.length);return t(e,i,n+u.length+u.value+o.length)},Kx=function t(e,i){i=E$(i),e=ht(e);var n=[];if(!i.length)return n;for(var o=0;o<e.length;){var u=_m(e,o,!1),c=_m(e,o+u.length),h=o+u.length+c.length;c.value===127&&(c.value=S$(u,e,h),c.value!==e.length&&(c.value-=h));var m=h+c.value>e.length?e.length:h+c.value,v=e.subarray(h,m);wi(i[0],u.bytes)&&(i.length===1?n.push(v):n=n.concat(t(v,i.slice(1))));var T=u.length+c.length+v.length;o+=T}return n},x$=ht([0,0,0,1]),w$=ht([0,0,1]),C$=ht([0,0,3]),A$=function(e){for(var i=[],n=1;n<e.length-2;)wi(e.subarray(n,n+3),C$)&&(i.push(n+2),n++),n++;if(i.length===0)return e;var o=e.length-i.length,u=new Uint8Array(o),c=0;for(n=0;n<o;c++,n++)c===i[0]&&(c++,i.shift()),u[n]=e[c];return u},AA=function(e,i,n,o){o===void 0&&(o=1/0),e=ht(e),n=[].concat(n);for(var u=0,c,h=0;u<e.length&&(h<o||c);){var m=void 0;if(wi(e.subarray(u),x$)?m=4:wi(e.subarray(u),w$)&&(m=3),!m){u++;continue}if(h++,c)return A$(e.subarray(c,u));var v=void 0;i==="h264"?v=e[u+m]&31:i==="h265"&&(v=e[u+m]>>1&63),n.indexOf(v)!==-1&&(c=u+m),u+=m+(i==="h264"?1:2)}return e.subarray(0,0)},k$=function(e,i,n){return AA(e,"h264",i,n)},I$=function(e,i,n){return AA(e,"h265",i,n)},ks={webm:ht([119,101,98,109]),matroska:ht([109,97,116,114,111,115,107,97]),flac:ht([102,76,97,67]),ogg:ht([79,103,103,83]),ac3:ht([11,119]),riff:ht([82,73,70,70]),avi:ht([65,86,73]),wav:ht([87,65,86,69]),"3gp":ht([102,116,121,112,51,103]),mp4:ht([102,116,121,112]),fmp4:ht([115,116,121,112]),mov:ht([102,116,121,112,113,116]),moov:ht([109,111,111,118]),moof:ht([109,111,111,102])},Yu={aac:function(e){var i=zd(e);return wi(e,[255,16],{offset:i,mask:[255,22]})},mp3:function(e){var i=zd(e);return wi(e,[255,2],{offset:i,mask:[255,6]})},webm:function(e){var i=Kx(e,[Rp.EBML,Rp.DocType])[0];return wi(i,ks.webm)},mkv:function(e){var i=Kx(e,[Rp.EBML,Rp.DocType])[0];return wi(i,ks.matroska)},mp4:function(e){if(Yu["3gp"](e)||Yu.mov(e))return!1;if(wi(e,ks.mp4,{offset:4})||wi(e,ks.fmp4,{offset:4})||wi(e,ks.moof,{offset:4})||wi(e,ks.moov,{offset:4}))return!0},mov:function(e){return wi(e,ks.mov,{offset:4})},"3gp":function(e){return wi(e,ks["3gp"],{offset:4})},ac3:function(e){var i=zd(e);return wi(e,ks.ac3,{offset:i})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var i=0;i+188<e.length&&i<188;){if(e[i]===71&&e[i+188]===71)return!0;i+=1}return!1},flac:function(e){var i=zd(e);return wi(e,ks.flac,{offset:i})},ogg:function(e){return wi(e,ks.ogg)},avi:function(e){return wi(e,ks.riff)&&wi(e,ks.avi,{offset:8})},wav:function(e){return wi(e,ks.riff)&&wi(e,ks.wav,{offset:8})},h264:function(e){return k$(e,7,3).length},h265:function(e){return I$(e,[32,33],3).length}},b0=Object.keys(Yu).filter(function(t){return t!=="ts"&&t!=="h264"&&t!=="h265"}).concat(["ts","h264","h265"]);b0.forEach(function(t){var e=Yu[t];Yu[t]=function(i){return e(ht(i))}});var O$=Yu,Vv=function(e){e=ht(e);for(var i=0;i<b0.length;i++){var n=b0[i];if(O$[n](e))return n}return""},D$=function(e){return T$(e,["moof"]).length>0},qv=9e4,Wv,Gv,ng,zv,kA,IA,OA;Wv=function(t){return t*qv};Gv=function(t,e){return t*e};ng=function(t){return t/qv};zv=function(t,e){return t/e};kA=function(t,e){return Wv(zv(t,e))};IA=function(t,e){return Gv(ng(t),e)};OA=function(t,e,i){return ng(i?t:t-e)};var ym={ONE_SECOND_IN_TS:qv,secondsToVideoTs:Wv,secondsToAudioTs:Gv,videoTsToSeconds:ng,audioTsToSeconds:zv,audioTsToVideoTs:kA,videoTsToAudioTs:IA,metadataTsToSeconds:OA};/**
 * @license
 * Video.js 8.0.4 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var DA="8.0.4";const la={},eo=function(t,e){return la[t]=la[t]||[],e&&(la[t]=la[t].concat(e)),la[t]},P$=function(t,e){eo(t,e)},PA=function(t,e){const i=eo(t).indexOf(e);return i<=-1?!1:(la[t]=la[t].slice(),la[t].splice(i,1),!0)},L$=function(t,e){eo(t,[].concat(e).map(i=>{const n=(...o)=>(PA(t,n),i(...o));return n}))},vm={prefixed:!0},Qp=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Xx=Qp[0];let Kd;for(let t=0;t<Qp.length;t++)if(Qp[t][1]in $e){Kd=Qp[t];break}if(Kd){for(let t=0;t<Kd.length;t++)vm[Xx[t]]=Kd[t];vm.prefixed=Kd[0]!==Xx[0]}let zs=[];const N$=(t,e)=>(i,n,o)=>{const u=e.levels[n],c=new RegExp(`^(${u})$`);if(i!=="log"&&o.unshift(i.toUpperCase()+":"),o.unshift(t+":"),zs){zs.push([].concat(o));const m=zs.length-1e3;zs.splice(0,m>0?m:0)}if(!Z.console)return;let h=Z.console[i];!h&&i==="debug"&&(h=Z.console.info||Z.console.log),!(!h||!u||!c.test(i))&&h[Array.isArray(o)?"apply":"call"](Z.console,o)};function LA(t){let e="info",i;const n=function(...o){i("log",e,o)};return i=N$(t,n),n.createLogger=o=>LA(t+": "+o),n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},n.level=o=>{if(typeof o=="string"){if(!n.levels.hasOwnProperty(o))throw new Error(`"${o}" in not a valid log level`);e=o}return e},n.history=()=>zs?[].concat(zs):[],n.history.filter=o=>(zs||[]).filter(u=>new RegExp(`.*${o}.*`).test(u[0])),n.history.clear=()=>{zs&&(zs.length=0)},n.history.disable=()=>{zs!==null&&(zs.length=0,zs=null)},n.history.enable=()=>{zs===null&&(zs=[])},n.error=(...o)=>i("error",e,o),n.warn=(...o)=>i("warn",e,o),n.debug=(...o)=>i("debug",e,o),n}const Bt=LA("VIDEOJS"),NA=Bt.createLogger,R$=Object.prototype.toString,RA=function(t){return Nr(t)?Object.keys(t):[]};function Iu(t,e){RA(t).forEach(i=>e(t[i],i))}function MA(t,e,i=0){return RA(t).reduce((n,o)=>e(n,t[o],o),i)}function Nr(t){return!!t&&typeof t=="object"}function Qu(t){return Nr(t)&&R$.call(t)==="[object Object]"&&t.constructor===Object}function di(...t){const e={};return t.forEach(i=>{i&&Iu(i,(n,o)=>{if(!Qu(n)){e[o]=n;return}Qu(e[o])||(e[o]={}),e[o]=di(e[o],n)})}),e}function rg(t,e,i,n=!0){const o=c=>Object.defineProperty(t,e,{value:c,enumerable:!0,writable:!0}),u={configurable:!0,enumerable:!0,get(){const c=i();return o(c),c}};return n&&(u.set=o),Object.defineProperty(t,e,u)}var M$=Object.freeze({__proto__:null,each:Iu,reduce:MA,isObject:Nr,isPlain:Qu,merge:di,defineLazyProperty:rg});let Kv=!1,UA=null,Rr=!1,BA,FA=!1,Ou=!1,Du=!1,Mr=!1,Xv=null,ag=null,$A=null,Tm=!1,og=!1,bm=!1,lg=!1;const gh=Boolean(fc()&&("ontouchstart"in Z||Z.navigator.maxTouchPoints||Z.DocumentTouch&&Z.document instanceof Z.DocumentTouch)),gu=Z.navigator&&Z.navigator.userAgentData;gu&&(Rr=gu.platform==="Android",Ou=Boolean(gu.brands.find(t=>t.brand==="Microsoft Edge")),Du=Boolean(gu.brands.find(t=>t.brand==="Chromium")),Mr=!Ou&&Du,Xv=ag=(gu.brands.find(t=>t.brand==="Chromium")||{}).version||null,og=gu.platform==="Windows");if(!Du){const t=Z.navigator&&Z.navigator.userAgent||"";Kv=/iPod/i.test(t),UA=function(){const e=t.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Rr=/Android/i.test(t),BA=function(){const e=t.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const i=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return i&&n?parseFloat(e[1]+"."+e[2]):i||null}(),FA=/Firefox/i.test(t),Ou=/Edg/i.test(t),Du=/Chrome/i.test(t)||/CriOS/i.test(t),Mr=!Ou&&Du,Xv=ag=function(){const e=t.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),$A=function(){const e=/MSIE\s(\d+)\.\d/.exec(t);let i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(t)&&/rv:11.0/.test(t)&&(i=11),i}(),Tm=/Safari/i.test(t)&&!Mr&&!Rr&&!Ou,og=/Windows/i.test(t),bm=/iPad/i.test(t)||Tm&&gh&&!/iPhone/i.test(t),lg=/iPhone/i.test(t)&&!bm}const Us=lg||bm||Kv,ug=(Tm||Us)&&!Mr;var U$=Object.freeze({__proto__:null,get IS_IPOD(){return Kv},get IOS_VERSION(){return UA},get IS_ANDROID(){return Rr},get ANDROID_VERSION(){return BA},get IS_FIREFOX(){return FA},get IS_EDGE(){return Ou},get IS_CHROMIUM(){return Du},get IS_CHROME(){return Mr},get CHROMIUM_VERSION(){return Xv},get CHROME_VERSION(){return ag},get IE_VERSION(){return $A},get IS_SAFARI(){return Tm},get IS_WINDOWS(){return og},get IS_IPAD(){return bm},get IS_IPHONE(){return lg},TOUCH_ENABLED:gh,IS_IOS:Us,IS_ANY_SAFARI:ug});function Yx(t){return typeof t=="string"&&Boolean(t.trim())}function B$(t){if(t.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function fc(){return $e===Z.document}function pc(t){return Nr(t)&&t.nodeType===1}function jA(){try{return Z.parent!==Z.self}catch{return!0}}function HA(t){return function(e,i){if(!Yx(e))return $e[t](null);Yx(i)&&(i=$e.querySelector(i));const n=pc(i)?i:$e;return n[t]&&n[t](e)}}function Rt(t="div",e={},i={},n){const o=$e.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(u){const c=e[u];u==="textContent"?uo(o,c):(o[u]!==c||u==="tabIndex")&&(o[u]=c)}),Object.getOwnPropertyNames(i).forEach(function(u){o.setAttribute(u,i[u])}),n&&Yv(o,n),o}function uo(t,e){return typeof t.textContent>"u"?t.innerText=e:t.textContent=e,t}function E0(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function eh(t,e){return B$(e),t.classList.contains(e)}function Zo(t,...e){return t.classList.add(...e.reduce((i,n)=>i.concat(n.split(/\s+/)),[])),t}function cg(t,...e){return t?(t.classList.remove(...e.reduce((i,n)=>i.concat(n.split(/\s+/)),[])),t):(Bt.warn("removeClass was called with an element that doesn't exist"),null)}function VA(t,e,i){return typeof i=="function"&&(i=i(t,e)),typeof i!="boolean"&&(i=void 0),e.split(/\s+/).forEach(n=>t.classList.toggle(n,i)),t}function qA(t,e){Object.getOwnPropertyNames(e).forEach(function(i){const n=e[i];n===null||typeof n>"u"||n===!1?t.removeAttribute(i):t.setAttribute(i,n===!0?"":n)})}function Wa(t){const e={},i=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(t&&t.attributes&&t.attributes.length>0){const n=t.attributes;for(let o=n.length-1;o>=0;o--){const u=n[o].name;let c=n[o].value;(typeof t[u]=="boolean"||i.indexOf(","+u+",")!==-1)&&(c=c!==null),e[u]=c}}return e}function WA(t,e){return t.getAttribute(e)}function Ju(t,e,i){t.setAttribute(e,i)}function dg(t,e){t.removeAttribute(e)}function GA(){$e.body.focus(),$e.onselectstart=function(){return!1}}function zA(){$e.onselectstart=function(){return!0}}function Zu(t){if(t&&t.getBoundingClientRect&&t.parentNode){const e=t.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(n=>{e[n]!==void 0&&(i[n]=e[n])}),i.height||(i.height=parseFloat(ec(t,"height"))),i.width||(i.width=parseFloat(ec(t,"width"))),i}}function _h(t){if(!t||t&&!t.offsetParent)return{left:0,top:0,width:0,height:0};const e=t.offsetWidth,i=t.offsetHeight;let n=0,o=0;for(;t.offsetParent&&t!==$e[vm.fullscreenElement];)n+=t.offsetLeft,o+=t.offsetTop,t=t.offsetParent;return{left:n,top:o,width:e,height:i}}function hg(t,e){const i={x:0,y:0};if(Us){let T=t;for(;T&&T.nodeName.toLowerCase()!=="html";){const O=ec(T,"transform");if(/^matrix/.test(O)){const R=O.slice(7,-1).split(/,\s/).map(Number);i.x+=R[4],i.y+=R[5]}else if(/^matrix3d/.test(O)){const R=O.slice(9,-1).split(/,\s/).map(Number);i.x+=R[12],i.y+=R[13]}T=T.parentNode}}const n={},o=_h(e.target),u=_h(t),c=u.width,h=u.height;let m=e.offsetY-(u.top-o.top),v=e.offsetX-(u.left-o.left);return e.changedTouches&&(v=e.changedTouches[0].pageX-u.left,m=e.changedTouches[0].pageY+u.top,Us&&(v-=i.x,m-=i.y)),n.y=1-Math.max(0,Math.min(1,m/h)),n.x=Math.max(0,Math.min(1,v/c)),n}function KA(t){return Nr(t)&&t.nodeType===3}function fg(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function XA(t){return typeof t=="function"&&(t=t()),(Array.isArray(t)?t:[t]).map(e=>{if(typeof e=="function"&&(e=e()),pc(e)||KA(e))return e;if(typeof e=="string"&&/\S/.test(e))return $e.createTextNode(e)}).filter(e=>e)}function Yv(t,e){return XA(e).forEach(i=>t.appendChild(i)),t}function YA(t,e){return Yv(fg(t),e)}function yh(t){return t.button===void 0&&t.buttons===void 0||t.button===0&&t.buttons===void 0||t.type==="mouseup"&&t.button===0&&t.buttons===0?!0:!(t.button!==0||t.buttons!==1)}const to=HA("querySelector"),QA=HA("querySelectorAll");function ec(t,e){if(!t||!e)return"";if(typeof Z.getComputedStyle=="function"){let i;try{i=Z.getComputedStyle(t)}catch{return""}return i?i.getPropertyValue(e)||i[e]:""}return""}var JA=Object.freeze({__proto__:null,isReal:fc,isEl:pc,isInFrame:jA,createEl:Rt,textContent:uo,prependTo:E0,hasClass:eh,addClass:Zo,removeClass:cg,toggleClass:VA,setAttributes:qA,getAttributes:Wa,getAttribute:WA,setAttribute:Ju,removeAttribute:dg,blockTextSelection:GA,unblockTextSelection:zA,getBoundingClientRect:Zu,findPosition:_h,getPointerPosition:hg,isTextNode:KA,emptyEl:fg,normalizeContent:XA,appendContent:Yv,insertContent:YA,isSingleLeftClick:yh,$:to,$$:QA,computedStyle:ec});let ZA=!1,S0;const F$=function(){if(S0.options.autoSetup===!1)return;const t=Array.prototype.slice.call($e.getElementsByTagName("video")),e=Array.prototype.slice.call($e.getElementsByTagName("audio")),i=Array.prototype.slice.call($e.getElementsByTagName("video-js")),n=t.concat(e,i);if(n&&n.length>0)for(let o=0,u=n.length;o<u;o++){const c=n[o];if(c&&c.getAttribute)c.player===void 0&&c.getAttribute("data-setup")!==null&&S0(c);else{x0(1);break}}else ZA||x0(1)};function x0(t,e){fc()&&(e&&(S0=e),Z.setTimeout(F$,t))}function w0(){ZA=!0,Z.removeEventListener("load",w0)}fc()&&($e.readyState==="complete"?w0():Z.addEventListener("load",w0));const ek=function(t){const e=$e.createElement("style");return e.className=t,e},tk=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e};var Ps=new WeakMap;const $$=3;let j$=$$;function Ur(){return j$++}function Qx(t,e){if(!Ps.has(t))return;const i=Ps.get(t);i.handlers[e].length===0&&(delete i.handlers[e],t.removeEventListener?t.removeEventListener(e,i.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Ps.delete(t)}function Qv(t,e,i,n){i.forEach(function(o){t(e,o,n)})}function pg(t){if(t.fixed_)return t;function e(){return!0}function i(){return!1}if(!t||!t.isPropagationStopped||!t.isImmediatePropagationStopped){const n=t||Z.event;t={};for(const o in n)o!=="layerX"&&o!=="layerY"&&o!=="keyLocation"&&o!=="webkitMovementX"&&o!=="webkitMovementY"&&o!=="path"&&(o==="returnValue"&&n.preventDefault||(t[o]=n[o]));if(t.target||(t.target=t.srcElement||$e),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){n.preventDefault&&n.preventDefault(),t.returnValue=!1,n.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),t.cancelBubble=!0,n.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=i,t.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=i,t.clientX!==null&&t.clientX!==void 0){const o=$e.documentElement,u=$e.body;t.pageX=t.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0),t.pageY=t.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}t.which=t.charCode||t.keyCode,t.button!==null&&t.button!==void 0&&(t.button=t.button&1?0:t.button&4?1:t.button&2?2:0)}return t.fixed_=!0,t}let Mp;const H$=function(){if(typeof Mp!="boolean"){Mp=!1;try{const t=Object.defineProperty({},"passive",{get(){Mp=!0}});Z.addEventListener("test",null,t),Z.removeEventListener("test",null,t)}catch{}}return Mp},V$=["touchstart","touchmove"];function vn(t,e,i){if(Array.isArray(e))return Qv(vn,t,e,i);Ps.has(t)||Ps.set(t,{});const n=Ps.get(t);if(n.handlers||(n.handlers={}),n.handlers[e]||(n.handlers[e]=[]),i.guid||(i.guid=Ur()),n.handlers[e].push(i),n.dispatcher||(n.disabled=!1,n.dispatcher=function(o,u){if(n.disabled)return;o=pg(o);const c=n.handlers[o.type];if(c){const h=c.slice(0);for(let m=0,v=h.length;m<v&&!o.isImmediatePropagationStopped();m++)try{h[m].call(t,o,u)}catch(T){Bt.error(T)}}}),n.handlers[e].length===1)if(t.addEventListener){let o=!1;H$()&&V$.indexOf(e)>-1&&(o={passive:!0}),t.addEventListener(e,n.dispatcher,o)}else t.attachEvent&&t.attachEvent("on"+e,n.dispatcher)}function vs(t,e,i){if(!Ps.has(t))return;const n=Ps.get(t);if(!n.handlers)return;if(Array.isArray(e))return Qv(vs,t,e,i);const o=function(c,h){n.handlers[h]=[],Qx(c,h)};if(e===void 0){for(const c in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},c)&&o(t,c);return}const u=n.handlers[e];if(u){if(!i){o(t,e);return}if(i.guid)for(let c=0;c<u.length;c++)u[c].guid===i.guid&&u.splice(c--,1);Qx(t,e)}}function mc(t,e,i){const n=Ps.has(t)?Ps.get(t):{},o=t.parentNode||t.ownerDocument;if(typeof e=="string"?e={type:e,target:t}:e.target||(e.target=t),e=pg(e),n.dispatcher&&n.dispatcher.call(t,e,i),o&&!e.isPropagationStopped()&&e.bubbles===!0)mc.call(null,o,e,i);else if(!o&&!e.defaultPrevented&&e.target&&e.target[e.type]){Ps.has(e.target)||Ps.set(e.target,{});const u=Ps.get(e.target);e.target[e.type]&&(u.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),u.disabled=!1)}return!e.defaultPrevented}function mg(t,e,i){if(Array.isArray(e))return Qv(mg,t,e,i);const n=function(){vs(t,e,n),i.apply(this,arguments)};n.guid=i.guid=i.guid||Ur(),vn(t,e,n)}function Jv(t,e,i){const n=function(){vs(t,e,n),i.apply(this,arguments)};n.guid=i.guid=i.guid||Ur(),vn(t,e,n)}var q$=Object.freeze({__proto__:null,fixEvent:pg,on:vn,off:vs,trigger:mc,one:mg,any:Jv});const Dn=30,hi=function(t,e,i){e.guid||(e.guid=Ur());const n=e.bind(t);return n.guid=i?i+"_"+e.guid:e.guid,n},Br=function(t,e){let i=Z.performance.now();return function(...o){const u=Z.performance.now();u-i>=e&&(t(...o),i=u)}},ik=function(t,e,i,n=Z){let o;const u=()=>{n.clearTimeout(o),o=null},c=function(){const h=this,m=arguments;let v=function(){o=null,v=null,i||t.apply(h,m)};!o&&i&&t.apply(h,m),n.clearTimeout(o),o=n.setTimeout(v,e)};return c.cancel=u,c};var W$=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Dn,bind_:hi,throttle:Br,debounce:ik});let $d;class Pn{on(e,i){const n=this.addEventListener;this.addEventListener=()=>{},vn(this,e,i),this.addEventListener=n}off(e,i){vs(this,e,i)}one(e,i){const n=this.addEventListener;this.addEventListener=()=>{},mg(this,e,i),this.addEventListener=n}any(e,i){const n=this.addEventListener;this.addEventListener=()=>{},Jv(this,e,i),this.addEventListener=n}trigger(e){const i=e.type||e;typeof e=="string"&&(e={type:i}),e=pg(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),mc(this,e)}queueTrigger(e){$d||($d=new Map);const i=e.type||e;let n=$d.get(this);n||(n=new Map,$d.set(this,n));const o=n.get(i);n.delete(i),Z.clearTimeout(o);const u=Z.setTimeout(()=>{n.delete(i),n.size===0&&(n=null,$d.delete(this)),this.trigger(e)},0);n.set(i,u)}}Pn.prototype.allowedEvents_={};Pn.prototype.addEventListener=Pn.prototype.on;Pn.prototype.removeEventListener=Pn.prototype.off;Pn.prototype.dispatchEvent=Pn.prototype.trigger;const gg=t=>typeof t.name=="function"?t.name():typeof t.name=="string"?t.name:t.name_?t.name_:t.constructor&&t.constructor.name?t.constructor.name:typeof t,pa=t=>t instanceof Pn||!!t.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof t[e]=="function"),G$=(t,e)=>{pa(t)?e():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(e))},C0=t=>typeof t=="string"&&/\S/.test(t)||Array.isArray(t)&&!!t.length,Em=(t,e,i)=>{if(!t||!t.nodeName&&!pa(t))throw new Error(`Invalid target for ${gg(e)}#${i}; must be a DOM node or evented object.`)},sk=(t,e,i)=>{if(!C0(t))throw new Error(`Invalid event type for ${gg(e)}#${i}; must be a non-empty string or array.`)},nk=(t,e,i)=>{if(typeof t!="function")throw new Error(`Invalid listener for ${gg(e)}#${i}; must be a function.`)},Uy=(t,e,i)=>{const n=e.length<3||e[0]===t||e[0]===t.eventBusEl_;let o,u,c;return n?(o=t.eventBusEl_,e.length>=3&&e.shift(),[u,c]=e):[o,u,c]=e,Em(o,t,i),sk(u,t,i),nk(c,t,i),c=hi(t,c),{isTargetingSelf:n,target:o,type:u,listener:c}},Bo=(t,e,i,n)=>{Em(t,t,e),t.nodeName?q$[e](t,i,n):t[e](i,n)},z$={on(...t){const{isTargetingSelf:e,target:i,type:n,listener:o}=Uy(this,t,"on");if(Bo(i,"on",n,o),!e){const u=()=>this.off(i,n,o);u.guid=o.guid;const c=()=>this.off("dispose",u);c.guid=o.guid,Bo(this,"on","dispose",u),Bo(i,"on","dispose",c)}},one(...t){const{isTargetingSelf:e,target:i,type:n,listener:o}=Uy(this,t,"one");if(e)Bo(i,"one",n,o);else{const u=(...c)=>{this.off(i,n,u),o.apply(null,c)};u.guid=o.guid,Bo(i,"one",n,u)}},any(...t){const{isTargetingSelf:e,target:i,type:n,listener:o}=Uy(this,t,"any");if(e)Bo(i,"any",n,o);else{const u=(...c)=>{this.off(i,n,u),o.apply(null,c)};u.guid=o.guid,Bo(i,"any",n,u)}},off(t,e,i){if(!t||C0(t))vs(this.eventBusEl_,t,e);else{const n=t,o=e;Em(n,this,"off"),sk(o,this,"off"),nk(i,this,"off"),i=hi(this,i),this.off("dispose",i),n.nodeName?(vs(n,o,i),vs(n,"dispose",i)):pa(n)&&(n.off(o,i),n.off("dispose",i))}},trigger(t,e){Em(this.eventBusEl_,this,"trigger");const i=t&&typeof t!="string"?t.type:t;if(!C0(i))throw new Error(`Invalid event type for ${gg(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return mc(this.eventBusEl_,t,e)}};function Zv(t,e={}){const{eventBusKey:i}=e;if(i){if(!t[i].nodeName)throw new Error(`The eventBusKey "${i}" does not refer to an element.`);t.eventBusEl_=t[i]}else t.eventBusEl_=Rt("span",{className:"vjs-event-bus"});return Object.assign(t,z$),t.eventedCallbacks&&t.eventedCallbacks.forEach(n=>{n()}),t.on("dispose",()=>{t.off(),[t,t.el_,t.eventBusEl_].forEach(function(n){n&&Ps.has(n)&&Ps.delete(n)}),Z.setTimeout(()=>{t.eventBusEl_=null},0)}),t}const K$={state:{},setState(t){typeof t=="function"&&(t=t());let e;return Iu(t,(i,n)=>{this.state[n]!==i&&(e=e||{},e[n]={from:this.state[n],to:i}),this.state[n]=i}),e&&pa(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function rk(t,e){return Object.assign(t,K$),t.state=Object.assign({},t.state,e),typeof t.handleStateChanged=="function"&&pa(t)&&t.on("statechanged",t.handleStateChanged),t}const th=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toLowerCase())},Ai=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toUpperCase())},ak=function(t,e){return Ai(t)===Ai(e)};var X$=Object.freeze({__proto__:null,toLowerCase:th,toTitleCase:Ai,titleCaseEquals:ak});class Ee{constructor(e,i,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=di({},this.options_),i=this.options_=di(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){const o=e&&e.id&&e.id()||"no_player";this.id_=`${o}_component_${Ur()}`}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(o=>this.addClass(o)),i.evented!==!1&&(Zv(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),rk(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(n),i.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=di(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,i,n){return Rt(e,i,n)}localize(e,i,n=e){const o=this.player_.language&&this.player_.language(),u=this.player_.languages&&this.player_.languages(),c=u&&u[o],h=o&&o.split("-")[0],m=u&&u[h];let v=n;return c&&c[e]?v=c[e]:m&&m[e]&&(v=m[e]),i&&(v=v.replace(/\{(\d+)\}/g,function(T,O){const R=i[O-1];let M=R;return typeof R>"u"&&(M=T),M})),v}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((n,o)=>n.concat(o),[]);let i=this;for(let n=0;n<e.length;n++)if(i=i.getChild(e[n]),!i||!i.getChild)return;return i}addChild(e,i={},n=this.children_.length){let o,u;if(typeof e=="string"){u=Ai(e);const c=i.componentClass||u;i.name=u;const h=Ee.getComponent(c);if(!h)throw new Error(`Component ${c} does not exist`);if(typeof h!="function")return null;o=new h(this.player_||this,i)}else o=e;if(o.parentComponent_&&o.parentComponent_.removeChild(o),this.children_.splice(n,0,o),o.parentComponent_=this,typeof o.id=="function"&&(this.childIndex_[o.id()]=o),u=u||o.name&&Ai(o.name()),u&&(this.childNameIndex_[u]=o,this.childNameIndex_[th(u)]=o),typeof o.el=="function"&&o.el()){let c=null;this.children_[n+1]&&(this.children_[n+1].el_?c=this.children_[n+1].el_:pc(this.children_[n+1])&&(c=this.children_[n+1])),this.contentEl().insertBefore(o.el(),c)}return o}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let i=!1;for(let o=this.children_.length-1;o>=0;o--)if(this.children_[o]===e){i=!0,this.children_.splice(o,1);break}if(!i)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Ai(e.name())]=null,this.childNameIndex_[th(e.name())]=null;const n=e.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const i=this.options_,n=c=>{const h=c.name;let m=c.opts;if(i[h]!==void 0&&(m=i[h]),m===!1)return;m===!0&&(m={}),m.playerOptions=this.options_.playerOptions;const v=this.addChild(h,m);v&&(this[h]=v)};let o;const u=Ee.getComponent("Tech");Array.isArray(e)?o=e:o=Object.keys(e),o.concat(Object.keys(this.options_).filter(function(c){return!o.some(function(h){return typeof h=="string"?c===h:c===h.name})})).map(c=>{let h,m;return typeof c=="string"?(h=c,m=e[h]||this.options_[h]||{}):(h=c.name,m=c),{name:h,opts:m}}).filter(c=>{const h=Ee.getComponent(c.opts.componentClass||Ai(c.name));return h&&!u.isTech(h)}).forEach(n)}}buildCSSClass(){return""}ready(e,i=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}i?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(e,i){return to(e,i||this.contentEl())}$$(e,i){return QA(e,i||this.contentEl())}hasClass(e){return eh(this.el_,e)}addClass(...e){Zo(this.el_,...e)}removeClass(...e){cg(this.el_,...e)}toggleClass(e,i){VA(this.el_,e,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return WA(this.el_,e)}setAttribute(e,i){Ju(this.el_,e,i)}removeAttribute(e){dg(this.el_,e)}width(e,i){return this.dimension("width",e,i)}height(e,i){return this.dimension("height",e,i)}dimensions(e,i){this.width(e,!0),this.height(i)}dimension(e,i,n){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[e]=i:i==="auto"?this.el_.style[e]="":this.el_.style[e]=i+"px",n||this.trigger("componentresize");return}if(!this.el_)return 0;const o=this.el_.style[e],u=o.indexOf("px");return parseInt(u!==-1?o.slice(0,u):this.el_["offset"+Ai(e)],10)}currentDimension(e){let i=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(i=ec(this.el_,e),i=parseFloat(i),i===0||isNaN(i)){const n=`offset${Ai(e)}`;i=this.el_[n]}return i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(bt.isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,i=null;const n=10,o=200;let u;this.on("touchstart",function(h){h.touches.length===1&&(i={pageX:h.touches[0].pageX,pageY:h.touches[0].pageY},e=Z.performance.now(),u=!0)}),this.on("touchmove",function(h){if(h.touches.length>1)u=!1;else if(i){const m=h.touches[0].pageX-i.pageX,v=h.touches[0].pageY-i.pageY;Math.sqrt(m*m+v*v)>n&&(u=!1)}});const c=function(){u=!1};this.on("touchleave",c),this.on("touchcancel",c),this.on("touchend",function(h){i=null,u===!0&&Z.performance.now()-e<o&&(h.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=hi(this.player(),this.player().reportUserActivity);let i;this.on("touchstart",function(){e(),this.clearInterval(i),i=this.setInterval(e,250)});const n=function(o){e(),this.clearInterval(i)};this.on("touchmove",e),this.on("touchend",n),this.on("touchcancel",n)}setTimeout(e,i){var n;return e=hi(this,e),this.clearTimersOnDispose_(),n=Z.setTimeout(()=>{this.setTimeoutIds_.has(n)&&this.setTimeoutIds_.delete(n),e()},i),this.setTimeoutIds_.add(n),n}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),Z.clearTimeout(e)),e}setInterval(e,i){e=hi(this,e),this.clearTimersOnDispose_();const n=Z.setInterval(e,i);return this.setIntervalIds_.add(n),n}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),Z.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var i;return e=hi(this,e),i=Z.requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),e()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(e,i){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),i=hi(this,i);const n=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,n),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),Z.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((n,o)=>this[i](o))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,i){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const n=Ee.getComponent("Tech"),o=n&&n.isTech(i),u=Ee===i||Ee.prototype.isPrototypeOf(i.prototype);if(o||!u){let h;throw o?h="techs must be registered using Tech.registerTech()":h="must be a Component subclass",new Error(`Illegal component, "${e}"; ${h}.`)}e=Ai(e),Ee.components_||(Ee.components_={});const c=Ee.getComponent("Player");if(e==="Player"&&c&&c.players){const h=c.players,m=Object.keys(h);if(h&&m.length>0&&m.map(v=>h[v]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Ee.components_[e]=i,Ee.components_[th(e)]=i,i}static getComponent(e){if(!(!e||!Ee.components_))return Ee.components_[e]}}Ee.registerComponent("Component",Ee);function Y$(t,e,i){if(typeof e!="number"||e<0||e>i)throw new Error(`Failed to execute '${t}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${i}).`)}function Jx(t,e,i,n){return Y$(t,n,i.length-1),i[n][e]}function By(t){let e;return t===void 0||t.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:t.length,start:Jx.bind(null,"start",0,t),end:Jx.bind(null,"end",1,t)},Z.Symbol&&Z.Symbol.iterator&&(e[Z.Symbol.iterator]=()=>(t||[]).values()),e}function Pr(t,e){return Array.isArray(t)?By(t):t===void 0||e===void 0?By():By([[t,e]])}const ok=function(t,e){t=t<0?0:t;let i=Math.floor(t%60),n=Math.floor(t/60%60),o=Math.floor(t/3600);const u=Math.floor(e/60%60),c=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(o=n=i="-"),o=o>0||c>0?o+":":"",n=((o||u>=10)&&n<10?"0"+n:n)+":",i=i<10?"0"+i:i,o+n+i};let eT=ok;function lk(t){eT=t}function uk(){eT=ok}function ll(t,e=t){return eT(t,e)}var Q$=Object.freeze({__proto__:null,createTimeRanges:Pr,createTimeRange:Pr,setFormatTime:lk,resetFormatTime:uk,formatTime:ll});function ck(t,e){let i=0,n,o;if(!e)return 0;(!t||!t.length)&&(t=Pr(0,0));for(let u=0;u<t.length;u++)n=t.start(u),o=t.end(u),o>e&&(o=e),i+=o-n;return i/e}function Ls(t){if(t instanceof Ls)return t;typeof t=="number"?this.code=t:typeof t=="string"?this.message=t:Nr(t)&&(typeof t.code=="number"&&(this.code=t.code),Object.assign(this,t)),this.message||(this.message=Ls.defaultMessages[this.code]||"")}Ls.prototype.code=0;Ls.prototype.message="";Ls.prototype.status=null;Ls.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Ls.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let t=0;t<Ls.errorTypes.length;t++)Ls[Ls.errorTypes[t]]=t,Ls.prototype[Ls.errorTypes[t]]=t;function ih(t){return t!=null&&typeof t.then=="function"}function xr(t){ih(t)&&t.then(null,e=>{})}const A0=function(t){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((i,n,o)=>(t[n]&&(i[n]=t[n]),i),{cues:t.cues&&Array.prototype.map.call(t.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})},J$=function(t){const e=t.$$("track"),i=Array.prototype.map.call(e,o=>o.track);return Array.prototype.map.call(e,function(o){const u=A0(o.track);return o.src&&(u.src=o.src),u}).concat(Array.prototype.filter.call(t.textTracks(),function(o){return i.indexOf(o)===-1}).map(A0))},Z$=function(t,e){return t.forEach(function(i){const n=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(o=>n.addCue(o))}),e.textTracks()};var Zx={textTracksToJson:J$,jsonToTextTracks:Z$,trackToJson_:A0};const Fy="vjs-modal-dialog";class gc extends Ee{constructor(e,i){super(e,i),this.handleKeyDown_=n=>this.handleKeyDown(n),this.close_=n=>this.close(n),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Rt("div",{className:`${Fy}-content`},{role:"document"}),this.descEl_=Rt("p",{className:`${Fy}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),uo(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Fy} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(!this.opened_){const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const i=this.closeable_=!!e;let n=this.getChild("closeButton");if(i&&!n){const o=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(n,"close",this.close_)}!i&&n&&(this.off(n,"close",this.close_),this.removeChild(n),n.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const i=this.contentEl(),n=i.parentNode,o=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(i),this.empty(),YA(i,e),this.trigger("modalfill"),o?n.insertBefore(i,o):n.appendChild(i);const u=this.getChild("closeButton");u&&n.appendChild(u.el_)}empty(){this.trigger("beforemodalempty"),fg(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=$e.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),bt.isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!bt.isEventKey(e,"Tab"))return;const i=this.focusableEls_(),n=this.el_.querySelector(":focus");let o;for(let u=0;u<i.length;u++)if(n===i[u]){o=u;break}$e.activeElement===this.el_&&(o=0),e.shiftKey&&o===0?(i[i.length-1].focus(),e.preventDefault()):!e.shiftKey&&o===i.length-1&&(i[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,i=>(i instanceof Z.HTMLAnchorElement||i instanceof Z.HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof Z.HTMLInputElement||i instanceof Z.HTMLSelectElement||i instanceof Z.HTMLTextAreaElement||i instanceof Z.HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof Z.HTMLIFrameElement||i instanceof Z.HTMLObjectElement||i instanceof Z.HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}gc.prototype.options_={pauseOnOpen:!0,temporary:!0};Ee.registerComponent("ModalDialog",gc);class tc extends Pn{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<e.length;i++)this.addTrack(e[i])}addTrack(e){const i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},pa(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let i;for(let n=0,o=this.length;n<o;n++)if(this[n]===e){i=this[n],i.off&&i.off(),this.tracks_.splice(n,1);break}i&&this.trigger({track:i,type:"removetrack",target:this})}getTrackById(e){let i=null;for(let n=0,o=this.length;n<o;n++){const u=this[n];if(u.id===e){i=u;break}}return i}}tc.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const t in tc.prototype.allowedEvents_)tc.prototype["on"+t]=null;const $y=function(t,e){for(let i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].enabled=!1)};class ej extends tc{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].enabled){$y(e,e[i]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&$y(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,$y(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const jy=function(t,e){for(let i=0;i<t.length;i++)!Object.keys(t[i]).length||e.id===t[i].id||(t[i].selected=!1)};class tj extends tc{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].selected){jy(e,e[i]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(e){e.selected&&jy(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,jy(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class dk extends tc{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class ij{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let i=0,n=e.length;i<n;i++)this.addTrackElement_(e[i])}addTrackElement_(e){const i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.trackElements_[i]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let i;for(let n=0,o=this.trackElements_.length;n<o;n++)if(e===this.trackElements_[n].track){i=this.trackElements_[n];break}return i}removeTrackElement_(e){for(let i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}}}class Sm{constructor(e){Sm.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const i=this.length||0;let n=0;const o=e.length;this.cues_=e,this.length_=e.length;const u=function(c){""+c in this||Object.defineProperty(this,""+c,{get(){return this.cues_[c]}})};if(i<o)for(n=i;n<o;n++)u.call(this,n)}getCueById(e){let i=null;for(let n=0,o=this.length;n<o;n++){const u=this[n];if(u.id===e){i=u;break}}return i}}const sj={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},nj={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},rj={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},ew={disabled:"disabled",hidden:"hidden",showing:"showing"};class tT extends Pn{constructor(e={}){super();const i={id:e.id||"vjs_track_"+Ur(),kind:e.kind||"",language:e.language||""};let n=e.label||"";for(const o in i)Object.defineProperty(this,o,{get(){return i[o]},set(){}});Object.defineProperty(this,"label",{get(){return n},set(o){o!==n&&(n=o,this.trigger("labelchange"))}})}}const iT=function(t){const e=["protocol","hostname","port","pathname","search","hash","host"],i=$e.createElement("a");i.href=t;const n={};for(let o=0;o<e.length;o++)n[e[o]]=i[e[o]];return n.protocol==="http:"&&(n.host=n.host.replace(/:80$/,"")),n.protocol==="https:"&&(n.host=n.host.replace(/:443$/,"")),n.protocol||(n.protocol=Z.location.protocol),n.host||(n.host=Z.location.host),n},hk=function(t){if(!t.match(/^https?:\/\//)){const e=$e.createElement("a");e.href=t,t=e.href}return t},sT=function(t){if(typeof t=="string"){const i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(t);if(i)return i.pop().toLowerCase()}return""},_g=function(t,e=Z.location){const i=iT(t);return(i.protocol===":"?e.protocol:i.protocol)+i.host!==e.protocol+e.host};var aj=Object.freeze({__proto__:null,parseUrl:iT,getAbsoluteURL:hk,getFileExtension:sT,isCrossOrigin:_g});const tw=function(t,e){const i=new Z.WebVTT.Parser(Z,Z.vttjs,Z.WebVTT.StringDecoder()),n=[];i.oncue=function(o){e.addCue(o)},i.onparsingerror=function(o){n.push(o)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(t),n.length>0&&(Z.console&&Z.console.groupCollapsed&&Z.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),n.forEach(o=>Bt.error(o)),Z.console&&Z.console.groupEnd&&Z.console.groupEnd()),i.flush()},iw=function(t,e){const i={uri:t},n=_g(t);n&&(i.cors=n);const o=e.tech_.crossOrigin()==="use-credentials";o&&(i.withCredentials=o),ch(i,hi(this,function(u,c,h){if(u)return Bt.error(u,c);e.loaded_=!0,typeof Z.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],m=>{if(m.type==="vttjserror"){Bt.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return tw(h,e)}):tw(h,e)}))};class Mh extends tT{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const i=di(e,{kind:rj[e.kind]||"subtitles",language:e.language||e.srclang||""});let n=ew[i.mode]||"disabled";const o=i.default;(i.kind==="metadata"||i.kind==="chapters")&&(n="hidden"),super(i),this.tech_=i.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const u=new Sm(this.cues_),c=new Sm(this.activeCues_);let h=!1;this.timeupdateHandler=hi(this,function(v={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){v.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,h&&(this.trigger("cuechange"),h=!1),v.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const m=()=>{this.stopTracking()};this.tech_.one("dispose",m),n!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return o},set(){}},mode:{get(){return n},set(v){ew[v]&&n!==v&&(n=v,!this.preload_&&n!=="disabled"&&this.cues.length===0&&iw(this.src,this),this.stopTracking(),n!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?u:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return c;const v=this.tech_.currentTime(),T=[];for(let O=0,R=this.cues.length;O<R;O++){const M=this.cues[O];M.startTime<=v&&M.endTime>=v&&T.push(M)}if(h=!1,T.length!==this.activeCues_.length)h=!0;else for(let O=0;O<T.length;O++)this.activeCues_.indexOf(T[O])===-1&&(h=!0);return this.activeCues_=T,c.setCues_(this.activeCues_),c},set(){}}}),i.src?(this.src=i.src,this.preload_||(this.loaded_=!0),(this.preload_||i.kind!=="subtitles"&&i.kind!=="captions")&&iw(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let i=e;if(Z.vttjs&&!(e instanceof Z.vttjs.VTTCue)){i=new Z.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const o in e)o in i||(i[o]=e[o]);i.id=e.id,i.originalCue_=e}const n=this.tech_.textTracks();for(let o=0;o<n.length;o++)n[o]!==this&&n[o].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(e){let i=this.cues_.length;for(;i--;){const n=this.cues_[i];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}Mh.prototype.allowedEvents_={cuechange:"cuechange"};class fk extends tT{constructor(e={}){const i=di(e,{kind:nj[e.kind]||""});super(i);let n=!1;Object.defineProperty(this,"enabled",{get(){return n},set(o){typeof o!="boolean"||o===n||(n=o,this.trigger("enabledchange"))}}),i.enabled&&(this.enabled=i.enabled),this.loaded_=!0}}class pk extends tT{constructor(e={}){const i=di(e,{kind:sj[e.kind]||""});super(i);let n=!1;Object.defineProperty(this,"selected",{get(){return n},set(o){typeof o!="boolean"||o===n||(n=o,this.trigger("selectedchange"))}}),i.selected&&(this.selected=i.selected)}}class Ea extends Pn{constructor(e={}){super();let i;const n=new Mh(e);this.kind=n.kind,this.src=n.src,this.srclang=n.language,this.label=n.label,this.default=n.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return n}}}),i=Ea.NONE,n.addEventListener("loadeddata",()=>{i=Ea.LOADED,this.trigger({type:"load",target:this})})}}Ea.prototype.allowedEvents_={load:"load"};Ea.NONE=0;Ea.LOADING=1;Ea.LOADED=2;Ea.ERROR=3;const kn={audio:{ListClass:ej,TrackClass:fk,capitalName:"Audio"},video:{ListClass:tj,TrackClass:pk,capitalName:"Video"},text:{ListClass:dk,TrackClass:Mh,capitalName:"Text"}};Object.keys(kn).forEach(function(t){kn[t].getterName=`${t}Tracks`,kn[t].privateName=`${t}Tracks_`});const ic={remoteText:{ListClass:dk,TrackClass:Mh,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:ij,TrackClass:Ea,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Os=Object.assign({},kn,ic);ic.names=Object.keys(ic);kn.names=Object.keys(kn);Os.names=[].concat(ic.names).concat(kn.names);function oj(t,e,i,n,o={}){const u=t.textTracks();o.kind=e,i&&(o.label=i),n&&(o.language=n),o.tech=t;const c=new Os.text.TrackClass(o);return u.addTrack(c),c}class wt extends Ee{constructor(e={},i=function(){}){e.reportTouchActivity=!1,super(null,e,i),this.onDurationChange_=n=>this.onDurationChange(n),this.trackProgress_=n=>this.trackProgress(n),this.trackCurrentTime_=n=>this.trackCurrentTime(n),this.stopTrackingCurrentTime_=n=>this.stopTrackingCurrentTime(n),this.disposeSourceHandler_=n=>this.disposeSourceHandler(n),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Os.names.forEach(n=>{const o=Os[n];e&&e[o.getterName]&&(this[o.privateName]=e[o.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(n=>{e[`native${n}Tracks`]===!1&&(this[`featuresNative${n}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Os.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(hi(this,function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,i===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Pr(0,0)}bufferedPercent(){return ck(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(kn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(i=>{const n=this[`${i}Tracks`]()||[];let o=n.length;for(;o--;){const u=n[o];i==="text"&&this.removeRemoteTextTrack(u),n.removeTrack(u)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let i=e.length;for(;i--;){const n=e[i];this.removeRemoteTextTrack(n)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Ls(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Pr(0,0):Pr()}play(){}setScrubbing(){}scrubbing(){}setCurrentTime(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){kn.names.forEach(e=>{const i=kn[e],n=()=>{this.trigger(`${e}trackchange`)},o=this[i.getterName]();o.addEventListener("removetrack",n),o.addEventListener("addtrack",n),this.on("dispose",()=>{o.removeEventListener("removetrack",n),o.removeEventListener("addtrack",n)})})}addWebVttScript_(){if(!Z.WebVTT)if($e.body.contains(this.el())){if(!this.options_["vtt.js"]&&Qu(cm)&&Object.keys(cm).length>0){this.trigger("vttjsloaded");return}const e=$e.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),Z.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),i=this.remoteTextTracks(),n=h=>e.addTrack(h.track),o=h=>e.removeTrack(h.track);i.on("addtrack",n),i.on("removetrack",o),this.addWebVttScript_();const u=()=>this.trigger("texttrackchange"),c=()=>{u();for(let h=0;h<e.length;h++){const m=e[h];m.removeEventListener("cuechange",u),m.mode==="showing"&&m.addEventListener("cuechange",u)}};c(),e.addEventListener("change",c),e.addEventListener("addtrack",c),e.addEventListener("removetrack",c),this.on("dispose",function(){i.off("addtrack",n),i.off("removetrack",o),e.removeEventListener("change",c),e.removeEventListener("addtrack",c),e.removeEventListener("removetrack",c);for(let h=0;h<e.length;h++)e[h].removeEventListener("cuechange",u)})}addTextTrack(e,i,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return oj(this,e,i,n)}createRemoteTextTrack(e){const i=di(e,{tech:this});return new ic.remoteTextEl.TrackClass(i)}addRemoteTextTrack(e={},i){const n=this.createRemoteTextTrack(e);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(n.track)),n}removeRemoteTextTrack(e){const i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const i=Ur();return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),e())})):this.requestNamedAnimationFrame(i,e),i}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(){}overrideNativeVideoTracks(){}canPlayType(){return""}static canPlayType(){return""}static canPlaySource(e,i){return wt.canPlayType(e.type)}static isTech(e){return e.prototype instanceof wt||e instanceof wt||e===wt}static registerTech(e,i){if(wt.techs_||(wt.techs_={}),!wt.isTech(i))throw new Error(`Tech ${e} must be a Tech`);if(!wt.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!wt.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ai(e),wt.techs_[e]=i,wt.techs_[th(e)]=i,e!=="Tech"&&wt.defaultTechOrder_.push(e),i}static getTech(e){if(e){if(wt.techs_&&wt.techs_[e])return wt.techs_[e];if(e=Ai(e),Z&&Z.videojs&&Z.videojs[e])return Bt.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),Z.videojs[e]}}}Os.names.forEach(function(t){const e=Os[t];wt.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});wt.prototype.featuresVolumeControl=!0;wt.prototype.featuresMuteControl=!0;wt.prototype.featuresFullscreenResize=!1;wt.prototype.featuresPlaybackRate=!1;wt.prototype.featuresProgressEvents=!1;wt.prototype.featuresSourceset=!1;wt.prototype.featuresTimeupdateEvents=!1;wt.prototype.featuresNativeTextTracks=!1;wt.prototype.featuresVideoFrameCallback=!1;wt.withSourceHandlers=function(t){t.registerSourceHandler=function(i,n){let o=t.sourceHandlers;o||(o=t.sourceHandlers=[]),n===void 0&&(n=o.length),o.splice(n,0,i)},t.canPlayType=function(i){const n=t.sourceHandlers||[];let o;for(let u=0;u<n.length;u++)if(o=n[u].canPlayType(i),o)return o;return""},t.selectSourceHandler=function(i,n){const o=t.sourceHandlers||[];let u;for(let c=0;c<o.length;c++)if(u=o[c].canHandleSource(i,n),u)return o[c];return null},t.canPlaySource=function(i,n){const o=t.selectSourceHandler(i,n);return o?o.canHandleSource(i,n):""},["seekable","seeking","duration"].forEach(function(i){const n=this[i];typeof n=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):n.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(i){let n=t.selectSourceHandler(i,this.options_);n||(t.nativeSourceHandler?n=t.nativeSourceHandler:Bt.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),n!==t.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=n.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};Ee.registerComponent("Tech",wt);wt.registerTech("Tech",wt);wt.defaultTechOrder_=[];const el={},k0={},xm={};function lj(t,e){el[t]=el[t]||[],el[t].push(e)}function uj(t,e,i){t.setTimeout(()=>jo(e,el[e.type],i,t),1)}function cj(t,e){t.forEach(i=>i.setTech&&i.setTech(e))}function dj(t,e,i){return t.reduceRight(nT(i),e[i]())}function hj(t,e,i,n){return e[i](t.reduce(nT(i),n))}function sw(t,e,i,n=null){const o="call"+Ai(i),u=t.reduce(nT(o),n),c=u===xm,h=c?null:e[i](u);return mj(t,i,h,c),h}const fj={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},pj={setCurrentTime:1,setMuted:1,setVolume:1},nw={play:1,pause:1};function nT(t){return(e,i)=>e===xm?xm:i[t]?i[t](e):e}function mj(t,e,i,n){for(let o=t.length-1;o>=0;o--){const u=t[o];u[e]&&u[e](n,i)}}function gj(t){k0[t.id()]=null}function _j(t,e){const i=k0[t.id()];let n=null;if(i==null)return n=e(t),k0[t.id()]=[[e,n]],n;for(let o=0;o<i.length;o++){const[u,c]=i[o];u===e&&(n=c)}return n===null&&(n=e(t),i.push([e,n])),n}function jo(t={},e=[],i,n,o=[],u=!1){const[c,...h]=e;if(typeof c=="string")jo(t,el[c],i,n,o,u);else if(c){const m=_j(n,c);if(!m.setSource)return o.push(m),jo(t,h,i,n,o,u);m.setSource(Object.assign({},t),function(v,T){if(v)return jo(t,h,i,n,o,u);o.push(m),jo(T,t.type===T.type?h:el[T.type],i,n,o,u)})}else h.length?jo(t,h,i,n,o,u):u?i(t,o):jo(t,el["*"],i,n,o,!0)}const yj={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},wm=function(t=""){const e=sT(t);return yj[e.toLowerCase()]||""},vj=(t,e)=>{if(!e)return"";if(t.cache_.source.src===e&&t.cache_.source.type)return t.cache_.source.type;const i=t.cache_.sources.filter(o=>o.src===e);if(i.length)return i[0].type;const n=t.$$("source");for(let o=0;o<n.length;o++){const u=n[o];if(u.type&&u.src&&u.src===e)return u.type}return wm(e)},mk=function(t){if(Array.isArray(t)){let e=[];t.forEach(function(i){i=mk(i),Array.isArray(i)?e=e.concat(i):Nr(i)&&e.push(i)}),t=e}else typeof t=="string"&&t.trim()?t=[rw({src:t})]:Nr(t)&&typeof t.src=="string"&&t.src&&t.src.trim()?t=[rw(t)]:t=[];return t};function rw(t){if(!t.type){const e=wm(t.src);e&&(t.type=e)}return t}class Tj extends Ee{constructor(e,i,n){const o=di({createEl:!1},i);if(super(e,o,n),!i.playerOptions.sources||i.playerOptions.sources.length===0)for(let u=0,c=i.playerOptions.techOrder;u<c.length;u++){const h=Ai(c[u]);let m=wt.getTech(h);if(h||(m=Ee.getComponent(h)),m&&m.isSupported()){e.loadTech_(h);break}}else e.src(i.playerOptions.sources)}}Ee.registerComponent("MediaLoader",Tj);class yg extends Ee{constructor(e,i){super(e,i),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=n=>this.handleMouseOver(n),this.handleMouseOut_=n=>this.handleMouseOut(n),this.handleClick_=n=>this.handleClick(n),this.handleKeyDown_=n=>this.handleKeyDown(n),this.emitTapEvents(),this.enable()}createEl(e="div",i={},n={}){i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),e==="button"&&Bt.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),n=Object.assign({role:"button"},n),this.tabIndex_=i.tabIndex;const o=Rt(e,i,n);return o.appendChild(Rt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Rt("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,i=this.el()){if(e===void 0)return this.controlText_||"Need Text";const n=this.localize(e);this.controlText_=e,uo(this.controlTextEl_,n),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&i.setAttribute("title",n)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){bt.isEventKey(e,"Space")||bt.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}Ee.registerComponent("ClickableComponent",yg);class I0 extends yg{constructor(e,i){super(e,i),this.update(),this.update_=n=>this.update(n),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Rt("picture",{className:"vjs-poster",tabIndex:-1},{},Rt("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))}crossOrigin(e){if(typeof e>"u")return this.el_?this.el_.querySelector("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.el_.querySelector("img").crossOrigin=e}update(e){const i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(e){this.el_.querySelector("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?xr(this.player_.play()):this.player_.pause())}}I0.prototype.crossorigin=I0.prototype.crossOrigin;Ee.registerComponent("PosterImage",I0);const Sn="#222",aw="#ccc",bj={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Hy(t,e){let i;if(t.length===4)i=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else if(t.length===7)i=t.slice(1);else throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function Vy(t,e,i){try{t.style[e]=i}catch{return}}class Ej extends Ee{constructor(e,i,n){super(e,i,n);const o=u=>this.updateDisplay(u);e.on("loadstart",u=>this.toggleDisplay(u)),e.on("texttrackchange",o),e.on("loadedmetadata",u=>this.preselectTrack(u)),e.ready(hi(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",o),e.on("playerresize",o);const u=Z.screen.orientation||Z,c=Z.screen.orientation?"change":"orientationchange";u.addEventListener(c,o),e.on("dispose",()=>u.removeEventListener(c,o));const h=this.options_.playerOptions.tracks||[];for(let m=0;m<h.length;m++)this.player_.addRemoteTextTrack(h[m],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},i=this.player_.textTracks(),n=this.player_.cache_.selectedLanguage;let o,u,c;for(let h=0;h<i.length;h++){const m=i[h];n&&n.enabled&&n.language&&n.language===m.language&&m.kind in e?m.kind===n.kind?c=m:c||(c=m):n&&!n.enabled?(c=null,o=null,u=null):m.default&&(m.kind==="descriptions"&&!o?o=m:m.kind in e&&!u&&(u=m))}c?c.mode="showing":u?u.mode="showing":o&&(o.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof Z.WebVTT=="function"&&Z.WebVTT.processCues(Z,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){const c=[];for(let h=0;h<e.length;++h){const m=e[h];m.mode==="showing"&&c.push(m)}this.updateForTrack(c);return}let n=null,o=null,u=e.length;for(;u--;){const c=e[u];c.mode==="showing"&&(c.kind==="descriptions"?n=c:o=c)}o?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):n&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(n))}updateDisplayState(e){const i=this.player_.textTrackSettings.getValues(),n=e.activeCues;let o=n.length;for(;o--;){const u=n[o];if(!u)continue;const c=u.displayState;if(i.color&&(c.firstChild.style.color=i.color),i.textOpacity&&Vy(c.firstChild,"color",Hy(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(c.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&Vy(c.firstChild,"backgroundColor",Hy(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?Vy(c,"backgroundColor",Hy(i.windowColor,i.windowOpacity)):c.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?c.firstChild.style.textShadow=`2px 2px 3px ${Sn}, 2px 2px 4px ${Sn}, 2px 2px 5px ${Sn}`:i.edgeStyle==="raised"?c.firstChild.style.textShadow=`1px 1px ${Sn}, 2px 2px ${Sn}, 3px 3px ${Sn}`:i.edgeStyle==="depressed"?c.firstChild.style.textShadow=`1px 1px ${aw}, 0 1px ${aw}, -1px -1px ${Sn}, 0 -1px ${Sn}`:i.edgeStyle==="uniform"&&(c.firstChild.style.textShadow=`0 0 4px ${Sn}, 0 0 4px ${Sn}, 0 0 4px ${Sn}, 0 0 4px ${Sn}`)),i.fontPercent&&i.fontPercent!==1){const h=Z.parseFloat(c.style.fontSize);c.style.fontSize=h*i.fontPercent+"px",c.style.height="auto",c.style.top="auto"}i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?c.firstChild.style.fontVariant="small-caps":c.firstChild.style.fontFamily=bj[i.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof Z.WebVTT!="function"||e.every(n=>!n.activeCues))return;const i=[];for(let n=0;n<e.length;++n){const o=e[n];for(let u=0;u<o.activeCues.length;++u)i.push(o.activeCues[u])}Z.WebVTT.processCues(Z,i,this.el_);for(let n=0;n<e.length;++n){const o=e[n];for(let u=0;u<o.activeCues.length;++u){const c=o.activeCues[u].displayState;Zo(c,"vjs-text-track-cue","vjs-text-track-cue-"+(o.language?o.language:n)),o.language&&Ju(c,"lang",o.language)}this.player_.textTrackSettings&&this.updateDisplayState(o)}}}Ee.registerComponent("TextTrackDisplay",Ej);class Sj extends Ee{createEl(){const e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),n=Rt("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])}),o=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(n),o}}Ee.registerComponent("LoadingSpinner",Sj);class tr extends yg{createEl(e,i={},n={}){e="button",i=Object.assign({className:this.buildCSSClass()},i),n=Object.assign({type:"button"},n);const o=Rt(e,i,n);return o.appendChild(Rt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}addChild(e,i={}){const n=this.constructor.name;return Bt.warn(`Adding an actionable (user controllable) child to a Button (${n}) is not supported; use a ClickableComponent instead.`),Ee.prototype.addChild.call(this,e,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(bt.isEventKey(e,"Space")||bt.isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}}Ee.registerComponent("Button",tr);class gk extends tr{constructor(e,i){super(e,i),this.mouseused_=!1,this.on("mousedown",n=>this.handleMouseDown(n))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const i=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){xr(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const n=this.player_.getChild("controlBar"),o=n&&n.getChild("playToggle");if(!o){this.player_.tech(!0).focus();return}const u=()=>o.focus();ih(i)?i.then(u,()=>{}):this.setTimeout(u,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}gk.prototype.controlText_="Play Video";Ee.registerComponent("BigPlayButton",gk);class xj extends tr{constructor(e,i){super(e,i),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){bt.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}Ee.registerComponent("CloseButton",xj);class _k extends tr{constructor(e,i={}){super(e,i),i.replay=i.replay===void 0||i.replay,this.on(e,"play",n=>this.handlePlay(n)),this.on(e,"pause",n=>this.handlePause(n)),i.replay&&this.on(e,"ended",n=>this.handleEnded(n))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?xr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}_k.prototype.controlText_="Play";Ee.registerComponent("PlayToggle",_k);class _c extends Ee{constructor(e,i){super(e,i),this.on(e,["timeupdate","ended"],n=>this.updateContent(n)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),i=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),n=Rt("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}`},{role:"presentation"});return i.appendChild(n),this.contentEl_=Rt("span",{className:`${e}-display`},{"aria-live":"off",role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(e=0){e=ll(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,Bt.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=$e.createTextNode(this.formattedTime_),this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}_c.prototype.labelText_="Time";_c.prototype.controlText_="Time";Ee.registerComponent("TimeDisplay",_c);class rT extends _c{buildCSSClass(){return"vjs-current-time"}updateContent(e){let i;this.player_.ended()?i=this.player_.duration():i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}rT.prototype.labelText_="Current Time";rT.prototype.controlText_="Current Time";Ee.registerComponent("CurrentTimeDisplay",rT);class aT extends _c{constructor(e,i){super(e,i);const n=o=>this.updateContent(o);this.on(e,"durationchange",n),this.on(e,"loadstart",n),this.on(e,"loadedmetadata",n)}buildCSSClass(){return"vjs-duration"}updateContent(e){const i=this.player_.duration();this.updateTextNode_(i)}}aT.prototype.labelText_="Duration";aT.prototype.controlText_="Duration";Ee.registerComponent("DurationDisplay",aT);class wj extends Ee{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),n=super.createEl("span",{textContent:"/"});return i.appendChild(n),e.appendChild(i),e}}Ee.registerComponent("TimeDivider",wj);class oT extends _c{constructor(e,i){super(e,i),this.on(e,"durationchange",n=>this.updateContent(n))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Rt("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let i;this.player_.ended()?i=0:this.player_.remainingTimeDisplay?i=this.player_.remainingTimeDisplay():i=this.player_.remainingTime(),this.updateTextNode_(i)}}oT.prototype.labelText_="Remaining Time";oT.prototype.controlText_="Remaining Time";Ee.registerComponent("RemainingTimeDisplay",oT);class Cj extends Ee{constructor(e,i){super(e,i),this.updateShowing(),this.on(this.player(),"durationchange",n=>this.updateShowing(n))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Rt("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Rt("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}`})),this.contentEl_.appendChild($e.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}Ee.registerComponent("LiveDisplay",Cj);class yk extends tr{constructor(e,i){super(e,i),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=n=>this.updateLiveEdgeStatus(n),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=Rt("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}yk.prototype.controlText_="Seek to live, currently playing live";Ee.registerComponent("SeekToLive",yk);function Uh(t,e,i){return t=Number(t),Math.min(i,Math.max(e,isNaN(t)?e:t))}var Aj=Object.freeze({__proto__:null,clamp:Uh});class lT extends Ee{constructor(e,i){super(e,i),this.handleMouseDown_=n=>this.handleMouseDown(n),this.handleMouseUp_=n=>this.handleMouseUp(n),this.handleKeyDown_=n=>this.handleKeyDown(n),this.handleClick_=n=>this.handleClick(n),this.handleMouseMove_=n=>this.handleMouseMove(n),this.update_=n=>this.update(n),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,i={},n={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),n=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},n),super.createEl(e,i,n)}handleMouseDown(e){const i=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!Mr&&e.preventDefault(),GA(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(){const e=this.bar.el_.ownerDocument;zA(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const i=this.vertical()?"height":"width";this.bar.el().style[i]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(Uh(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const i=hg(this.el_,e);return this.vertical()?i.y:i.x}handleKeyDown(e){bt.isEventKey(e,"Left")||bt.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):bt.isEventKey(e,"Right")||bt.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}Ee.registerComponent("Slider",lT);const qy=(t,e)=>Uh(t/e*100,0,100).toFixed(2)+"%";class kj extends Ee{constructor(e,i){super(e,i),this.partEls_=[],this.on(e,"progress",n=>this.update(n))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),i=Rt("span",{className:"vjs-control-text"}),n=Rt("span",{textContent:this.localize("Loaded")}),o=$e.createTextNode(": ");return this.percentageEl_=Rt("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(i),i.appendChild(n),i.appendChild(o),i.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const i=this.player_.liveTracker,n=this.player_.buffered(),o=i&&i.isLive()?i.seekableEnd():this.player_.duration(),u=this.player_.bufferedEnd(),c=this.partEls_,h=qy(u,o);this.percent_!==h&&(this.el_.style.width=h,uo(this.percentageEl_,h),this.percent_=h);for(let m=0;m<n.length;m++){const v=n.start(m),T=n.end(m);let O=c[m];O||(O=this.el_.appendChild(Rt()),c[m]=O),!(O.dataset.start===v&&O.dataset.end===T)&&(O.dataset.start=v,O.dataset.end=T,O.style.left=qy(v,u),O.style.width=qy(T-v,u))}for(let m=c.length;m>n.length;m--)this.el_.removeChild(c[m-1]);c.length=n.length})}}Ee.registerComponent("LoadProgressBar",kj);class Ij extends Ee{constructor(e,i){super(e,i),this.update=Br(hi(this,this.update),Dn)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,i,n){const o=_h(this.el_),u=Zu(this.player_.el()),c=e.width*i;if(!u||!o)return;const h=e.left-u.left+c,m=e.width-c+(u.right-e.right);let v=o.width/2;h<v?v+=v-h:m<v&&(v=m),v<0?v=0:v>o.width&&(v=o.width),v=Math.round(v),this.el_.style.right=`-${v}px`,this.write(n)}write(e){uo(this.el_,e)}updateTime(e,i,n,o){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let u;const c=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const h=this.player_.liveTracker.liveWindow(),m=h-i*h;u=(m<1?"":"-")+ll(m,h)}else u=ll(n,c);this.update(e,i,u),o&&o()})}}Ee.registerComponent("TimeTooltip",Ij);class uT extends Ee{constructor(e,i){super(e,i),this.update=Br(hi(this,this.update),Dn)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,i){const n=this.getChild("timeTooltip");if(!n)return;const o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,i,o)}}uT.prototype.options_={children:[]};!Us&&!Rr&&uT.prototype.options_.children.push("timeTooltip");Ee.registerComponent("PlayProgressBar",uT);class vk extends Ee{constructor(e,i){super(e,i),this.update=Br(hi(this,this.update),Dn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i){const n=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,n,()=>{this.el_.style.left=`${e.width*i}px`})}}vk.prototype.options_={children:["timeTooltip"]};Ee.registerComponent("MouseTimeDisplay",vk);const Up=5,ow=12;class cT extends lT{constructor(e,i){super(e,i),this.setEventHandlers_()}setEventHandlers_(){this.update_=hi(this,this.update),this.update=Br(this.update_,Dn),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in $e&&"visibilityState"in $e&&this.on($e,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){$e.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Dn))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if($e.visibilityState==="hidden")return;const i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const n=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),o=this.player_.liveTracker;let u=this.player_.duration();o&&o.isLive()&&(u=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),this.percent_=i),(this.currentTime_!==n||this.duration_!==u)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ll(n,u),ll(u,u)],"{1} of {2}")),this.currentTime_=n,this.duration_=u),this.bar&&this.bar.update(Zu(this.el()),this.getProgress())}),i}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let i;const n=this.player_.liveTracker;return n&&n.isLive()?(i=(e-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(i=1)):i=e/this.player_.duration(),i}handleMouseDown(e){yh(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,i=!1){if(!yh(e))return;!i&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let n;const o=this.calculateDistance(e),u=this.player_.liveTracker;if(!u||!u.isLive())n=o*this.player_.duration(),n===this.player_.duration()&&(n=n-.1);else{if(o>=.99){u.seekToLiveEdge();return}const c=u.seekableStart(),h=u.liveCurrentTime();if(n=c+o*u.liveWindow(),n>=h&&(n=h),n<=c&&(n=c+.1),n===1/0)return}this.userSeek_(n)}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?xr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+Up)}stepBack(){this.userSeek_(this.player_.currentTime()-Up)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const i=this.player_.liveTracker;if(bt.isEventKey(e,"Space")||bt.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(bt.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(bt.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(bt(e))){e.preventDefault(),e.stopPropagation();const n=(bt.codes[bt(e)]-bt.codes[0])*10/100;i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*n):this.userSeek_(this.player_.duration()*n)}else bt.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-Up*ow)):bt.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+Up*ow)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in $e&&"visibilityState"in $e&&this.off($e,"visibilitychange",this.toggleVisibility_),super.dispose()}}cT.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!Us&&!Rr&&cT.prototype.options_.children.splice(1,0,"mouseTimeDisplay");Ee.registerComponent("SeekBar",cT);class Tk extends Ee{constructor(e,i){super(e,i),this.handleMouseMove=Br(hi(this,this.handleMouseMove),Dn),this.throttledHandleMouseSeek=Br(hi(this,this.handleMouseSeek),Dn),this.handleMouseUpHandler_=n=>this.handleMouseUp(n),this.handleMouseDownHandler_=n=>this.handleMouseDown(n),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const i=this.getChild("seekBar");if(!i)return;const n=i.getChild("playProgressBar"),o=i.getChild("mouseTimeDisplay");if(!n&&!o)return;const u=i.el(),c=_h(u);let h=hg(u,e).x;h=Uh(h,0,1),o&&o.update(c,h),n&&n.update(c,i.getProgress())}handleMouseSeek(e){const i=this.getChild("seekBar");i&&i.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&xr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const i=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}Tk.prototype.options_={children:["seekBar"]};Ee.registerComponent("ProgressControl",Tk);class bk extends tr{constructor(e,i){super(e,i),this.on(e,["enterpictureinpicture","leavepictureinpicture"],n=>this.handlePictureInPictureChange(n)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],n=>this.handlePictureInPictureEnabledChange(n)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{e.currentType().substring(0,5)==="audio"||e.audioPosterMode()||e.audioOnlyMode()?(e.isInPictureInPicture()&&e.exitPictureInPicture(),this.hide()):this.show()}),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control ${super.buildCSSClass()}`}handlePictureInPictureEnabledChange(){$e.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}bk.prototype.controlText_="Picture-in-Picture";Ee.registerComponent("PictureInPictureToggle",bk);class Ek extends tr{constructor(e,i){super(e,i),this.on(e,"fullscreenchange",n=>this.handleFullscreenChange(n)),$e[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}Ek.prototype.controlText_="Fullscreen";Ee.registerComponent("FullscreenToggle",Ek);const Oj=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})};class Dj extends Ee{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}Ee.registerComponent("VolumeLevel",Dj);class Pj extends Ee{constructor(e,i){super(e,i),this.update=Br(hi(this,this.update),Dn)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,i,n,o){if(!n){const u=Zu(this.el_),c=Zu(this.player_.el()),h=e.width*i;if(!c||!u)return;const m=e.left-c.left+h,v=e.width-h+(c.right-e.right);let T=u.width/2;m<T?T+=T-m:v<T&&(T=v),T<0?T=0:T>u.width&&(T=u.width),this.el_.style.right=`-${T}px`}this.write(`${o}%`)}write(e){uo(this.el_,e)}updateVolume(e,i,n,o,u){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,i,n,o.toFixed(0)),u&&u()})}}Ee.registerComponent("VolumeLevelTooltip",Pj);class Sk extends Ee{constructor(e,i){super(e,i),this.update=Br(hi(this,this.update),Dn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i,n){const o=100*i;this.getChild("volumeLevelTooltip").updateVolume(e,i,n,o,()=>{n?this.el_.style.bottom=`${e.height*i}px`:this.el_.style.left=`${e.width*i}px`})}}Sk.prototype.options_={children:["volumeLevelTooltip"]};Ee.registerComponent("MouseVolumeLevelDisplay",Sk);class vg extends lT{constructor(e,i){super(e,i),this.on("slideractive",n=>this.updateLastVolume_(n)),this.on(e,"volumechange",n=>this.updateARIAAttributes(n)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){yh(e)&&super.handleMouseDown(e)}handleMouseMove(e){const i=this.getChild("mouseVolumeLevelDisplay");if(i){const n=this.el(),o=Zu(n),u=this.vertical();let c=hg(n,e);c=u?c.y:c.x,c=Uh(c,0,1),i.update(o,c,u)}yh(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}vg.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!Us&&!Rr&&vg.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");vg.prototype.playerEvent="volumechange";Ee.registerComponent("VolumeBar",vg);class xk extends Ee{constructor(e,i={}){i.vertical=i.vertical||!1,(typeof i.volumeBar>"u"||Qu(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(e,i),Oj(this,e),this.throttledHandleMouseMove=Br(hi(this,this.handleMouseMove),Dn),this.handleMouseUpHandler_=n=>this.handleMouseUp(n),this.on("mousedown",n=>this.handleMouseDown(n)),this.on("touchstart",n=>this.handleMouseDown(n)),this.on("mousemove",n=>this.handleMouseMove(n)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}xk.prototype.options_={children:["volumeBar"]};Ee.registerComponent("VolumeControl",xk);const Lj=function(t,e){e.tech_&&!e.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})};class wk extends tr{constructor(e,i){super(e,i),Lj(this,e),this.on(e,["loadstart","volumechange"],n=>this.update(n))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.volume(),n=this.player_.lastVolume_();if(i===0){const o=n<.1?.1:n;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let i=3;Us&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?i=0:e<.33?i=1:e<.67&&(i=2),cg(this.el_,[0,1,2,3].reduce((n,o)=>n+`${o?" ":""}vjs-vol-${o}`,"")),Zo(this.el_,`vjs-vol-${i}`)}updateControlText_(){const i=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}wk.prototype.controlText_="Mute";Ee.registerComponent("MuteToggle",wk);class Ck extends Ee{constructor(e,i={}){typeof i.inline<"u"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl>"u"||Qu(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(e,i),this.handleKeyPressHandler_=n=>this.handleKeyPress(n),this.on(e,["loadstart"],n=>this.volumePanelState_(n)),this.on(this.muteToggle,"keyup",n=>this.handleKeyPress(n)),this.on(this.volumeControl,"keyup",n=>this.handleVolumeControlKeyUp(n)),this.on("keydown",n=>this.handleKeyPress(n)),this.on("mouseover",n=>this.handleMouseOver(n)),this.on("mouseout",n=>this.handleMouseOut(n)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){bt.isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),vn($e,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),vs($e,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){bt.isEventKey(e,"Esc")&&this.handleMouseOut()}}Ck.prototype.options_={children:["muteToggle","volumeControl"]};Ee.registerComponent("VolumePanel",Ck);class Ak extends Ee{constructor(e,i){super(e,i),i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",n=>this.handleKeyDown(n)),this.boundHandleBlur_=n=>this.handleBlur(n),this.boundHandleTapClick_=n=>this.handleTapClick(n)}addEventListenerForItem(e){e instanceof Ee&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof Ee&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const i=this.addChild(e);i&&this.addEventListenerForItem(i)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Rt(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),vn(i,"click",function(n){n.preventDefault(),n.stopImmediatePropagation()}),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const i=e.relatedTarget||$e.activeElement;if(!this.children().some(n=>n.el()===i)){const n=this.menuButton_;n&&n.buttonPressed_&&i!==n.el().firstChild&&n.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const i=this.children();if(!Array.isArray(i))return;const n=i.filter(o=>o.el()===e.target)[0];if(!n)return;n.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){bt.isEventKey(e,"Left")||bt.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(bt.isEventKey(e,"Right")||bt.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())}}Ee.registerComponent("Menu",Ak);class dT extends Ee{constructor(e,i={}){super(e,i),this.menuButton_=new tr(e,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const n=tr.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+n,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const o=u=>this.handleClick(u);this.handleMenuKeyUp_=u=>this.handleMenuKeyUp(u),this.on(this.menuButton_,"tap",o),this.on(this.menuButton_,"click",o),this.on(this.menuButton_,"keydown",u=>this.handleKeyDown(u)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),vn($e,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",u=>this.handleMouseLeave(u)),this.on("keydown",u=>this.handleSubmenuKeyDown(u))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Ak(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const i=Rt("li",{className:"vjs-menu-title",textContent:Ai(this.options_.title),tabIndex:-1}),n=new Ee(this.player_,{el:i});e.addItem(n)}if(this.items=this.createItems(),this.items)for(let i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const i=tr.prototype.buildCSSClass();return`vjs-menu-button ${e} ${i} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,i=this.menuButton_.el()){return this.menuButton_.controlText(e,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),vs($e,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){bt.isEventKey(e,"Esc")||bt.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),bt.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(bt.isEventKey(e,"Up")||bt.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(bt.isEventKey(e,"Esc")||bt.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(bt.isEventKey(e,"Esc")||bt.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),bt.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Us&&jA())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}Ee.registerComponent("MenuButton",dT);class hT extends dT{constructor(e,i){const n=i.tracks;if(super(e,i),this.items.length<=1&&this.hide(),!n)return;const o=hi(this,this.update);n.addEventListener("removetrack",o),n.addEventListener("addtrack",o),n.addEventListener("labelchange",o),this.player_.on("ready",o),this.player_.on("dispose",function(){n.removeEventListener("removetrack",o),n.removeEventListener("addtrack",o),n.removeEventListener("labelchange",o)})}}Ee.registerComponent("TrackButton",hT);const Nj=["Tab","Esc","Up","Down","Right","Left"];class Bh extends yg{constructor(e,i){super(e,i),this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,i,n){this.nonIconControl=!0;const o=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),n);return o.replaceChild(Rt("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),o.querySelector(".vjs-icon-placeholder")),o}handleKeyDown(e){Nj.some(i=>bt.isEventKey(e,i))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}Ee.registerComponent("MenuItem",Bh);class Fh extends Bh{constructor(e,i){const n=i.track,o=e.textTracks();i.label=n.label||n.language||"Unknown",i.selected=n.mode==="showing",super(e,i),this.track=n,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean);const u=(...h)=>{this.handleTracksChange.apply(this,h)},c=(...h)=>{this.handleSelectedLanguageChange.apply(this,h)};if(e.on(["loadstart","texttrackchange"],u),o.addEventListener("change",u),o.addEventListener("selectedlanguagechange",c),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],u),o.removeEventListener("change",u),o.removeEventListener("selectedlanguagechange",c)}),o.onchange===void 0){let h;this.on(["tap","click"],function(){if(typeof Z.Event!="object")try{h=new Z.Event("change")}catch{}h||(h=$e.createEvent("Event"),h.initEvent("change",!0,!0)),o.dispatchEvent(h)})}this.handleTracksChange()}handleClick(e){const i=this.track,n=this.player_.textTracks();if(super.handleClick(e),!!n)for(let o=0;o<n.length;o++){const u=n[o];this.kinds.indexOf(u.kind)!==-1&&(u===i?u.mode!=="showing"&&(u.mode="showing"):u.mode!=="disabled"&&(u.mode="disabled"))}}handleTracksChange(e){const i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}Ee.registerComponent("TextTrackMenuItem",Fh);class kk extends Fh{constructor(e,i){i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(e,i)}handleTracksChange(e){const i=this.player().textTracks();let n=!0;for(let o=0,u=i.length;o<u;o++){const c=i[o];if(this.options_.kinds.indexOf(c.kind)>-1&&c.mode==="showing"){n=!1;break}}n!==this.isSelected_&&this.selected(n)}handleSelectedLanguageChange(e){const i=this.player().textTracks();let n=!0;for(let o=0,u=i.length;o<u;o++){const c=i[o];if(["captions","descriptions","subtitles"].indexOf(c.kind)>-1&&c.mode==="showing"){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})}}Ee.registerComponent("OffTextTrackMenuItem",kk);class yc extends hT{constructor(e,i={}){i.tracks=e.textTracks(),super(e,i)}createItems(e=[],i=Fh){let n;this.label_&&(n=`${this.label_} off`),e.push(new kk(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;const o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let u=0;u<o.length;u++){const c=o[u];if(this.kinds_.indexOf(c.kind)>-1){const h=new i(this.player_,{track:c,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});h.addClass(`vjs-${c.kind}-menu-item`),e.push(h)}}return e}}Ee.registerComponent("TextTrackButton",yc);class Ik extends Bh{constructor(e,i){const n=i.track,o=i.cue,u=e.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=o.text,i.selected=o.startTime<=u&&u<o.endTime,super(e,i),this.track=n,this.cue=o}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}Ee.registerComponent("ChaptersTrackMenuItem",Ik);class fT extends yc{constructor(e,i,n){super(e,i,n),this.selectCurrentItem_=()=>{this.items.forEach(o=>{o.selected(this.track_.activeCues[0]===o.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const i=this.findChaptersTrack();i!==this.track_?(this.setTrack(i),super.update()):(!this.items||i&&i.cues&&i.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.kind===this.kind_)return n}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ai(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const i=this.track_.cues;if(!i)return e;for(let n=0,o=i.length;n<o;n++){const u=i[n],c=new Ik(this.player_,{track:this.track_,cue:u});e.push(c)}return e}}fT.prototype.kind_="chapters";fT.prototype.controlText_="Chapters";Ee.registerComponent("ChaptersButton",fT);class pT extends yc{constructor(e,i,n){super(e,i,n);const o=e.textTracks(),u=hi(this,this.handleTracksChange);o.addEventListener("change",u),this.on("dispose",function(){o.removeEventListener("change",u)})}handleTracksChange(e){const i=this.player().textTracks();let n=!1;for(let o=0,u=i.length;o<u;o++){const c=i[o];if(c.kind!==this.kind_&&c.mode==="showing"){n=!0;break}}n?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}pT.prototype.kind_="descriptions";pT.prototype.controlText_="Descriptions";Ee.registerComponent("DescriptionsButton",pT);class mT extends yc{constructor(e,i,n){super(e,i,n)}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}mT.prototype.kind_="subtitles";mT.prototype.controlText_="Subtitles";Ee.registerComponent("SubtitlesButton",mT);class gT extends Fh{constructor(e,i){i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(e,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}}Ee.registerComponent("CaptionSettingsMenuItem",gT);class _T extends yc{constructor(e,i,n){super(e,i,n)}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new gT(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}_T.prototype.kind_="captions";_T.prototype.controlText_="Captions";Ee.registerComponent("CaptionsButton",_T);class Ok extends Fh{createEl(e,i,n){const o=super.createEl(e,i,n),u=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(u.appendChild(Rt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),u.appendChild(Rt("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),o}}Ee.registerComponent("SubsCapsMenuItem",Ok);class yT extends yc{constructor(e,i={}){super(e,i),this.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions"),this.menuButton_.controlText(Ai(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new gT(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Ok),e}}yT.prototype.kinds_=["captions","subtitles"];yT.prototype.controlText_="Subtitles";Ee.registerComponent("SubsCapsButton",yT);class Dk extends Bh{constructor(e,i){const n=i.track,o=e.audioTracks();i.label=n.label||n.language||"Unknown",i.selected=n.enabled,super(e,i),this.track=n,this.addClass(`vjs-${n.kind}-menu-item`);const u=(...c)=>{this.handleTracksChange.apply(this,c)};o.addEventListener("change",u),this.on("dispose",()=>{o.removeEventListener("change",u)})}createEl(e,i,n){const o=super.createEl(e,i,n),u=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(u.appendChild(Rt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),u.appendChild(Rt("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),o}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let n=0;n<i.length;n++){const o=i[n];o!==this.track&&(o.enabled=o===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}Ee.registerComponent("AudioTrackMenuItem",Dk);class Pk extends hT{constructor(e,i={}){i.tracks=e.audioTracks(),super(e,i)}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const i=this.player_.audioTracks();for(let n=0;n<i.length;n++){const o=i[n];e.push(new Dk(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return e}}Pk.prototype.controlText_="Audio Track";Ee.registerComponent("AudioTrackButton",Pk);class vT extends Bh{constructor(e,i){const n=i.rate,o=parseFloat(n,10);i.label=n,i.selected=o===e.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(e,i),this.label=n,this.rate=o,this.on(e,"ratechange",u=>this.update(u))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}vT.prototype.contentElType="button";Ee.registerComponent("PlaybackRateMenuItem",vT);class Lk extends dT{constructor(e,i){super(e,i),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",n=>this.updateVisibility(n)),this.on(e,"ratechange",n=>this.updateLabel(n)),this.on(e,"playbackrateschange",n=>this.handlePlaybackRateschange(n))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Rt("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),i=[];for(let n=e.length-1;n>=0;n--)i.push(new vT(this.player(),{rate:e[n]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Lk.prototype.controlText_="Playback Rate";Ee.registerComponent("PlaybackRateMenuButton",Lk);class Nk extends Ee{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",i={},n={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(e,i,n)}}Ee.registerComponent("Spacer",Nk);class Rj extends Nk{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:""})}}Ee.registerComponent("CustomControlSpacer",Rj);class Cm extends Ee{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Cm.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in $e&&Cm.prototype.options_.children.splice(Cm.prototype.options_.children.length-1,0,"pictureInPictureToggle");Ee.registerComponent("ControlBar",Cm);class Rk extends gc{constructor(e,i){super(e,i),this.on(e,"error",n=>this.open(n))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}Rk.prototype.options_=Object.assign({},gc.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});Ee.registerComponent("ErrorDisplay",Rk);const Wy="vjs-text-track-settings",lw=["#000","Black"],uw=["#00F","Blue"],cw=["#0FF","Cyan"],dw=["#0F0","Green"],hw=["#F0F","Magenta"],fw=["#F00","Red"],pw=["#FFF","White"],mw=["#FF0","Yellow"],Gy=["1","Opaque"],zy=["0.5","Semi-Transparent"],gw=["0","Transparent"],Vo={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[lw,pw,fw,dw,uw,mw,hw,cw]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Gy,zy,gw]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[pw,lw,fw,dw,uw,mw,hw,cw]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:t=>t==="1.00"?null:Number(t)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Gy,zy]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[gw,zy,Gy]}};Vo.windowColor.options=Vo.backgroundColor.options;function Mk(t,e){if(e&&(t=e(t)),t&&t!=="none")return t}function Mj(t,e){const i=t.options[t.options.selectedIndex].value;return Mk(i,e)}function Uj(t,e,i){if(e){for(let n=0;n<t.options.length;n++)if(Mk(t.options[n].value,i)===e){t.selectedIndex=n;break}}}class Bj extends gc{constructor(e,i){i.temporary=!1,super(e,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=Rt("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),Iu(Vo,n=>{this.on(this.$(n.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,i="",n="label"){const o=Vo[e],u=o.id.replace("%s",this.id_),c=[i,u].join(" ").trim();return[`<${n} id="${u}" class="${n==="label"?"vjs-label":""}">`,this.localize(o.label),`</${n}>`,`<select aria-labelledby="${c}">`].concat(o.options.map(h=>{const m=u+"-"+h[1].replace(/\W+/g,"");return[`<option id="${m}" value="${h[0]}" `,`aria-labelledby="${c} ${m}">`,this.localize(h[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return Rt("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return Rt("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return Rt("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return MA(Vo,(e,i,n)=>{const o=Mj(this.$(i.selector),i.parser);return o!==void 0&&(e[n]=o),e},{})}setValues(e){Iu(Vo,(i,n)=>{Uj(this.$(i.selector),e[n],i.parser)})}setDefaults(){Iu(Vo,e=>{const i=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=i})}restoreSettings(){let e;try{e=JSON.parse(Z.localStorage.getItem(Wy))}catch(i){Bt.warn(i)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?Z.localStorage.setItem(Wy,JSON.stringify(e)):Z.localStorage.removeItem(Wy)}catch(i){Bt.warn(i)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,i=e&&e.subsCapsButton,n=e&&e.captionsButton;i?i.focus():n&&n.focus()}}Ee.registerComponent("TextTrackSettings",Bj);class Fj extends Ee{constructor(e,i){let n=i.ResizeObserver||Z.ResizeObserver;i.ResizeObserver===null&&(n=!1);const o=di({createEl:!n,reportTouchActivity:!1},i);super(e,o),this.ResizeObserver=i.ResizeObserver||Z.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=ik(()=>{this.resizeHandler()},100,!1,this),n?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const u=this.debouncedHandler_;let c=this.unloadListener_=function(){vs(this,"resize",u),vs(this,"unload",c),c=null};vn(this.el_.contentWindow,"unload",c),vn(this.el_.contentWindow,"resize",u)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}Ee.registerComponent("ResizeManager",Fj);const $j={trackingThreshold:20,liveTolerance:15};class jj extends Ee{constructor(e,i){const n=di($j,i,{createEl:!1});super(e,n),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=o=>this.handlePlay(o),this.handleFirstTimeupdate_=o=>this.handleFirstTimeupdate(o),this.handleSeeked_=o=>this.handleSeeked(o),this.seekToLiveEdge_=o=>this.seekToLiveEdge(o),this.reset_(),this.on(this.player_,"durationchange",o=>this.handleDurationchange(o)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const i=Number(Z.performance.now().toFixed(4)),n=this.lastTime_===-1?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+n;const o=this.liveCurrentTime(),u=this.player_.currentTime();let c=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-u)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===1/0)&&(c=!1),c!==this.behindLiveEdge_&&(this.behindLiveEdge_=c,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Dn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),i=[];let n=e?e.length:0;for(;n--;)i.push(e.end(n));return i.length?i.sort()[i.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),i=[];let n=e?e.length:0;for(;n--;)i.push(e.start(n));return i.length?i.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}Ee.registerComponent("LiveTracker",jj);class Hj extends Ee{constructor(e,i){super(e,i),this.on("statechanged",n=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Rt("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${Ur()}`}),description:Rt("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${Ur()}`})},Rt("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){const e=this.player_.tech_,i=e&&e.el_,n={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(o=>{const u=this.state[o],c=this.els[o],h=n[o];fg(c),u&&uo(c,u),i&&(i.removeAttribute(h),u&&i.setAttribute(h,c.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,i=e&&e.el_;i&&(i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}Ee.registerComponent("TitleBar",Hj);const O0=t=>{const e=t.el();if(e.hasAttribute("src"))return t.triggerSourceset(e.src),!0;const i=t.$$("source"),n=[];let o="";if(!i.length)return!1;for(let u=0;u<i.length;u++){const c=i[u].src;c&&n.indexOf(c)===-1&&n.push(c)}return n.length?(n.length===1&&(o=n[0]),t.triggerSourceset(o),!0):!1},Vj=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(t){const e=$e.createElement(this.nodeName.toLowerCase());e.innerHTML=t;const i=$e.createDocumentFragment();for(;e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",Z.Element.prototype.appendChild.call(this,i),this.innerHTML}}),Uk=(t,e)=>{let i={};for(let n=0;n<t.length&&(i=Object.getOwnPropertyDescriptor(t[n],e),!(i&&i.set&&i.get));n++);return i.enumerable=!0,i.configurable=!0,i},qj=t=>Uk([t.el(),Z.HTMLMediaElement.prototype,Z.Element.prototype,Vj],"innerHTML"),_w=function(t){const e=t.el();if(e.resetSourceWatch_)return;const i={},n=qj(t),o=u=>(...c)=>{const h=u.apply(e,c);return O0(t),h};["append","appendChild","insertAdjacentHTML"].forEach(u=>{e[u]&&(i[u]=e[u],e[u]=o(i[u]))}),Object.defineProperty(e,"innerHTML",di(n,{set:o(n.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(i).forEach(u=>{e[u]=i[u]}),Object.defineProperty(e,"innerHTML",n)},t.one("sourceset",e.resetSourceWatch_)},Wj=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?hk(Z.Element.prototype.getAttribute.call(this,"src")):""},set(t){return Z.Element.prototype.setAttribute.call(this,"src",t),t}}),Gj=t=>Uk([t.el(),Z.HTMLMediaElement.prototype,Wj],"src"),zj=function(t){if(!t.featuresSourceset)return;const e=t.el();if(e.resetSourceset_)return;const i=Gj(t),n=e.setAttribute,o=e.load;Object.defineProperty(e,"src",di(i,{set:u=>{const c=i.set.call(e,u);return t.triggerSourceset(e.src),c}})),e.setAttribute=(u,c)=>{const h=n.call(e,u,c);return/src/i.test(u)&&t.triggerSourceset(e.src),h},e.load=()=>{const u=o.call(e);return O0(t)||(t.triggerSourceset(""),_w(t)),u},e.currentSrc?t.triggerSourceset(e.currentSrc):O0(t)||_w(t),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=o,e.setAttribute=n,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}};class Ye extends wt{constructor(e,i){super(e,i);const n=e.source;let o=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",n&&(this.el_.currentSrc!==n.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(n):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const u=this.el_.childNodes;let c=u.length;const h=[];for(;c--;){const m=u[c];m.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(m),this.remoteTextTracks().addTrack(m.track),this.textTracks().addTrack(m.track),!o&&!this.el_.hasAttribute("crossorigin")&&_g(m.src)&&(o=!0)):h.push(m))}for(let m=0;m<h.length;m++)this.el_.removeChild(h[m])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&o&&Bt.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(gh||lg)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Ye.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){zj(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let i;const n=()=>{i=[];for(let u=0;u<e.length;u++){const c=e[u];c.kind==="metadata"&&i.push({track:c,storedMode:c.mode})}};n(),e.addEventListener("change",n),this.on("dispose",()=>e.removeEventListener("change",n));const o=()=>{for(let u=0;u<i.length;u++){const c=i[u];c.track.mode==="disabled"&&c.track.mode!==c.storedMode&&(c.track.mode=c.storedMode)}e.removeEventListener("change",o)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",n),e.removeEventListener("change",o),e.addEventListener("change",o)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",n),e.addEventListener("change",n),e.removeEventListener("change",o)})}overrideNative_(e,i){if(i!==this[`featuresNative${e}Tracks`])return;const n=e.toLowerCase();this[`${n}TracksListeners_`]&&Object.keys(this[`${n}TracksListeners_`]).forEach(o=>{this.el()[`${n}Tracks`].removeEventListener(o,this[`${n}TracksListeners_`][o])}),this[`featuresNative${e}Tracks`]=!i,this[`${n}TracksListeners_`]=null,this.proxyNativeTracksForType_(n)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const i=kn[e],n=this.el()[i.getterName],o=this[i.getterName]();if(!this[`featuresNative${i.capitalName}Tracks`]||!n||!n.addEventListener)return;const u={change:h=>{const m={type:"change",target:o,currentTarget:o,srcElement:o};o.trigger(m),e==="text"&&this[ic.remoteText.getterName]().trigger(m)},addtrack(h){o.addTrack(h.track)},removetrack(h){o.removeTrack(h.track)}},c=function(){const h=[];for(let m=0;m<o.length;m++){let v=!1;for(let T=0;T<n.length;T++)if(n[T]===o[m]){v=!0;break}v||h.push(o[m])}for(;h.length;)o.removeTrack(h.shift())};this[i.getterName+"Listeners_"]=u,Object.keys(u).forEach(h=>{const m=u[h];n.addEventListener(h,m),this.on("dispose",v=>n.removeEventListener(h,m))}),this.on("loadstart",c),this.on("dispose",h=>this.off("loadstart",c))}proxyNativeTracks_(){kn.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),Ye.disposeMediaElement(e),e=n}else{e=$e.createElement("video");const n=this.options_.tag&&Wa(this.options_.tag),o=di({},n);(!gh||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,qA(e,Object.assign(o,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Ju(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let n=0;n<i.length;n++){const o=i[n],u=this.options_[o];typeof u<"u"&&(u?Ju(e,o,o):dg(e,o),e[o]=u)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let n=!1;const o=function(){n=!0};this.on("loadstart",o);const u=function(){n||this.trigger("loadstart")};this.on("loadedmetadata",u),this.ready(function(){this.off("loadstart",o),this.off("loadedmetadata",u),n||this.trigger("loadstart")});return}const i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(n){this.trigger(n)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&ug?this.el_.fastSeek(e):this.el_.currentTime=e}catch(i){Bt(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Rr&&Mr&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)xr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){Ye.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,i,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,n):super.addTextTrack(e,i,n)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const i=$e.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i}addRemoteTextTrack(e,i){const n=super.addRemoteTextTrack(e,i);return this.featuresNativeTextTracks&&this.el().appendChild(n),n}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const i=this.$$("track");let n=i.length;for(;n--;)(e===i[n]||e===i[n].track)&&this.el().removeChild(i[n])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),Z.performance&&(e.creationTime=Z.performance.now()),e}}rg(Ye,"TEST_VID",function(){if(!fc())return;const t=$e.createElement("video"),e=$e.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",t.appendChild(e),t});Ye.isSupported=function(){try{Ye.TEST_VID.volume=.5}catch{return!1}return!!(Ye.TEST_VID&&Ye.TEST_VID.canPlayType)};Ye.canPlayType=function(t){return Ye.TEST_VID.canPlayType(t)};Ye.canPlaySource=function(t,e){return Ye.canPlayType(t.type)};Ye.canControlVolume=function(){try{const t=Ye.TEST_VID.volume;Ye.TEST_VID.volume=t/2+.1;const e=t!==Ye.TEST_VID.volume;return e&&Us?(Z.setTimeout(()=>{Ye&&Ye.prototype&&(Ye.prototype.featuresVolumeControl=t!==Ye.TEST_VID.volume)}),!1):e}catch{return!1}};Ye.canMuteVolume=function(){try{const t=Ye.TEST_VID.muted;return Ye.TEST_VID.muted=!t,Ye.TEST_VID.muted?Ju(Ye.TEST_VID,"muted","muted"):dg(Ye.TEST_VID,"muted","muted"),t!==Ye.TEST_VID.muted}catch{return!1}};Ye.canControlPlaybackRate=function(){if(Rr&&Mr&&ag<58)return!1;try{const t=Ye.TEST_VID.playbackRate;return Ye.TEST_VID.playbackRate=t/2+.1,t!==Ye.TEST_VID.playbackRate}catch{return!1}};Ye.canOverrideAttributes=function(){try{const t=()=>{};Object.defineProperty($e.createElement("video"),"src",{get:t,set:t}),Object.defineProperty($e.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty($e.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty($e.createElement("audio"),"innerHTML",{get:t,set:t})}catch{return!1}return!0};Ye.supportsNativeTextTracks=function(){return ug||Us&&Mr};Ye.supportsNativeVideoTracks=function(){return!!(Ye.TEST_VID&&Ye.TEST_VID.videoTracks)};Ye.supportsNativeAudioTracks=function(){return!!(Ye.TEST_VID&&Ye.TEST_VID.audioTracks)};Ye.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([t,e]){rg(Ye.prototype,t,()=>Ye[e](),!0)});Ye.prototype.featuresVolumeControl=Ye.canControlVolume();Ye.prototype.movingMediaElementInDOM=!Us;Ye.prototype.featuresFullscreenResize=!0;Ye.prototype.featuresProgressEvents=!0;Ye.prototype.featuresTimeupdateEvents=!0;Ye.prototype.featuresVideoFrameCallback=!!(Ye.TEST_VID&&Ye.TEST_VID.requestVideoFrameCallback);Ye.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}};Ye.resetMediaElement=function(t){if(!t)return;const e=t.querySelectorAll("source");let i=e.length;for(;i--;)t.removeChild(e[i]);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){Ye.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Ye.prototype["set"+Ai(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(t){Ye.prototype[t]=function(){return this.el_[t]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(t){Ye.prototype["set"+Ai(t)]=function(e){this.el_[t]=e}});["pause","load","play"].forEach(function(t){Ye.prototype[t]=function(){return this.el_[t]()}});wt.withSourceHandlers(Ye);Ye.nativeSourceHandler={};Ye.nativeSourceHandler.canPlayType=function(t){try{return Ye.TEST_VID.canPlayType(t)}catch{return""}};Ye.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return Ye.nativeSourceHandler.canPlayType(t.type);if(t.src){const i=sT(t.src);return Ye.nativeSourceHandler.canPlayType(`video/${i}`)}return""};Ye.nativeSourceHandler.handleSource=function(t,e,i){e.setSrc(t.src)};Ye.nativeSourceHandler.dispose=function(){};Ye.registerSourceHandler(Ye.nativeSourceHandler);wt.registerTech("Html5",Ye);const Bk=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ky={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},D0=["tiny","xsmall","small","medium","large","xlarge","huge"],Jp={};D0.forEach(t=>{const e=t.charAt(0)==="x"?`x-${t.substring(1)}`:t;Jp[t]=`vjs-layout-${e}`});const Kj={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class fi extends Ee{constructor(e,i,n){if(e.id=e.id||i.id||`vjs_video_${Ur()}`,i=Object.assign(fi.getTagSettings(e),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const c=e.closest("[lang]");c&&(i.language=c.getAttribute("lang"))}if(super(null,i,n),this.boundDocumentFullscreenChange_=c=>this.documentFullscreenChange_(c),this.boundFullWindowOnEscKey_=c=>this.fullWindowOnEscKey(c),this.boundUpdateStyleEl_=c=>this.updateStyleEl_(c),this.boundApplyInitTime_=c=>this.applyInitTime_(c),this.boundUpdateCurrentBreakpoint_=c=>this.updateCurrentBreakpoint_(c),this.boundHandleTechClick_=c=>this.handleTechClick_(c),this.boundHandleTechDoubleClick_=c=>this.handleTechDoubleClick_(c),this.boundHandleTechTouchStart_=c=>this.handleTechTouchStart_(c),this.boundHandleTechTouchMove_=c=>this.handleTechTouchMove_(c),this.boundHandleTechTouchEnd_=c=>this.handleTechTouchEnd_(c),this.boundHandleTechTap_=c=>this.handleTechTap_(c),this.isFullscreen_=!1,this.log=NA(this.id_),this.fsApi_=vm,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Wa(e),this.language(this.options_.language),i.languages){const c={};Object.getOwnPropertyNames(i.languages).forEach(function(h){c[h.toLowerCase()]=i.languages[h]}),this.languages_=c}else this.languages_=fi.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(c=>{if(typeof this[c]!="function")throw new Error(`plugin "${c}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Zv(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(vn($e,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const o=di(this.options_);i.plugins&&Object.keys(i.plugins).forEach(c=>{this[c](i.plugins[c])}),i.debug&&this.debug(!0),this.options_.playerOptions=o,this.middleware_=[],this.playbackRates(i.playbackRates),this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),gh&&this.addClass("vjs-touch-enabled"),Us||this.addClass("vjs-workinghover"),fi.players[this.id_]=this;const u=DA.split(".")[0];this.addClass(`vjs-v${u}`),this.userActive(!0),this.reportUserActivity(),this.one("play",c=>this.listenForUserActivity_(c)),this.on("keydown",c=>this.handleKeyDown(c)),this.on("languagechange",c=>this.handleLanguagechange(c)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),vs($e,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),vs($e,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),fi.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),gj(this),Os.names.forEach(e=>{const i=Os[e],n=this[i.getterName]();n&&n.off&&n.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,i,n=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const o=this.tag.tagName.toLowerCase()==="video-js";n?i=this.el_=e.parentNode:o||(i=this.el_=super.createEl("div"));const u=Wa(e);if(o){for(i=this.el_=e,e=this.tag=$e.createElement("video");i.children.length;)e.appendChild(i.firstChild);eh(i,"video-js")||Zo(i,"video-js"),i.appendChild(e),n=this.playerElIngest_=i,Object.keys(i).forEach(h=>{try{e[h]=i[h]}catch{}})}if(e.setAttribute("tabindex","-1"),u.tabindex="-1",Mr&&og&&(e.setAttribute("role","application"),u.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in u&&delete u.width,"height"in u&&delete u.height,Object.getOwnPropertyNames(u).forEach(function(h){o&&h==="class"||i.setAttribute(h,u[h]),o&&e.setAttribute(h,u[h])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused"),Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=ek("vjs-styles-dimensions");const h=to(".vjs-styles-defaults"),m=to("head");m.insertBefore(this.styleEl_,h?h.nextSibling:m.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const c=e.getElementsByTagName("a");for(let h=0;h<c.length;h++){const m=c.item(h);Zo(m,"vjs-hidden"),m.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!n&&e.parentNode.insertBefore(i,e),E0(e,i),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){Bt.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,i){const n=e+"_";if(i===void 0)return this[n]||0;if(i===""||i==="auto"){this[n]=void 0,this.updateStyleEl_();return}const o=parseFloat(i);if(isNaN(o)){Bt.error(`Improper value "${i}" supplied for for ${e}`);return}this[n]=o,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,pa(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),G$(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(Z.VIDEOJS_NO_DYNAMIC_STYLE===!0){const h=typeof this.width_=="number"?this.width_:this.options_.width,m=typeof this.height_=="number"?this.height_:this.options_.height,v=this.tech_&&this.tech_.el();v&&(h>=0&&(v.width=h),m>=0&&(v.height=m));return}let e,i,n,o;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?n=this.aspectRatio_:this.videoWidth()>0?n=this.videoWidth()+":"+this.videoHeight():n="16:9";const u=n.split(":"),c=u[1]/u[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/c:e=this.videoWidth()||300,this.height_!==void 0?i=this.height_:i=e*c,/^[^a-zA-Z]/.test(this.id())?o="dimensions-"+this.id():o=this.id()+"-dimensions",this.addClass(o),tk(this.styleEl_,`
      .${o} {
        width: ${e}px;
        height: ${i}px;
      }

      .${o}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${c*100}%;
      }
    `)}loadTech_(e,i){this.tech_&&this.unloadTech_();const n=Ai(e),o=e.charAt(0).toLowerCase()+e.slice(1);n!=="Html5"&&this.tag&&(wt.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;let u=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(u=!1);const c={source:i,autoplay:u,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${o}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Os.names.forEach(m=>{const v=Os[m];c[v.getterName]=this[v.privateName]}),Object.assign(c,this.options_[n]),Object.assign(c,this.options_[o]),Object.assign(c,this.options_[e.toLowerCase()]),this.tag&&(c.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(c.startTime=this.cache_.currentTime);const h=wt.getTech(e);if(!h)throw new Error(`No Tech named '${n}' exists! '${n}' should be registered using videojs.registerTech()'`);this.tech_=new h(c),this.tech_.ready(hi(this,this.handleTechReady_),!0),Zx.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Bk.forEach(m=>{this.on(this.tech_,m,v=>this[`handleTech${Ai(m)}_`](v))}),Object.keys(Ky).forEach(m=>{this.on(this.tech_,m,v=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${Ky[m]}_`].bind(this),event:v});return}this[`handleTech${Ky[m]}_`](v)})}),this.on(this.tech_,"loadstart",m=>this.handleTechLoadStart_(m)),this.on(this.tech_,"sourceset",m=>this.handleTechSourceset_(m)),this.on(this.tech_,"waiting",m=>this.handleTechWaiting_(m)),this.on(this.tech_,"ended",m=>this.handleTechEnded_(m)),this.on(this.tech_,"seeking",m=>this.handleTechSeeking_(m)),this.on(this.tech_,"play",m=>this.handleTechPlay_(m)),this.on(this.tech_,"pause",m=>this.handleTechPause_(m)),this.on(this.tech_,"durationchange",m=>this.handleTechDurationChange_(m)),this.on(this.tech_,"fullscreenchange",(m,v)=>this.handleTechFullscreenChange_(m,v)),this.on(this.tech_,"fullscreenerror",(m,v)=>this.handleTechFullscreenError_(m,v)),this.on(this.tech_,"enterpictureinpicture",m=>this.handleTechEnterPictureInPicture_(m)),this.on(this.tech_,"leavepictureinpicture",m=>this.handleTechLeavePictureInPicture_(m)),this.on(this.tech_,"error",m=>this.handleTechError_(m)),this.on(this.tech_,"posterchange",m=>this.handleTechPosterChange_(m)),this.on(this.tech_,"textdata",m=>this.handleTechTextData_(m)),this.on(this.tech_,"ratechange",m=>this.handleTechRateChange_(m)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(n!=="Html5"||!this.tag)&&E0(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Os.names.forEach(e=>{const i=Os[e];this[i.privateName]=this[i.getterName]()}),this.textTracksJson_=Zx.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&Bt.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const i=()=>{const o=this.muted();this.muted(!0);const u=()=>{this.muted(o)};this.playTerminatedQueue_.push(u);const c=this.play();if(ih(c))return c.catch(h=>{throw u(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${h||""}`)})};let n;if(e==="any"&&!this.muted()?(n=this.play(),ih(n)&&(n=n.catch(i))):e==="muted"&&!this.muted()?n=i():n=this.play(),!!ih(n))return n.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let i=e,n="";typeof i!="string"&&(i=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!n&&(n=vj(this,i)),this.cache_.source=di({},e,{src:i,type:n});const o=this.cache_.sources.filter(m=>m.src&&m.src===i),u=[],c=this.$$("source"),h=[];for(let m=0;m<c.length;m++){const v=Wa(c[m]);u.push(v),v.src&&v.src===i&&h.push(v.src)}h.length&&!o.length?this.cache_.sources=u:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(e){if(!this.changingSrc_){let i=u=>this.updateSourceCaches_(u);const n=this.currentSource().src,o=e.src;n&&!/^blob:/.test(n)&&/^blob:/.test(o)&&(!this.lastSource_||this.lastSource_.tech!==o&&this.lastSource_.player!==n)&&(i=()=>{}),i(o),e.src||this.tech_.any(["sourceset","loadstart"],u=>{if(u.type==="sourceset")return;const c=this.techGet("currentSrc");this.lastSource_.tech=c,this.updateSourceCaches_(c)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),i=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?xr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),n=>n.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const i=e.target.player;if(i&&i!==this)return;const n=this.el();let o=$e[this.fsApi_.fullscreenElement]===n;!o&&n.matches?o=n.matches(":"+this.fsApi_.fullscreen):!o&&n.msMatchesSelector&&(o=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,i){this.ready(function(){if(e in pj)return hj(this.middleware_,this.tech_,e,i);if(e in nw)return sw(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(n){throw Bt(n),n}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in fj)return dj(this.middleware_,this.tech_,e);if(e in nw)return sw(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){throw this.tech_[e]===void 0?(Bt(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,i),i):i.name==="TypeError"?(Bt(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,i),this.tech_.isReady_=!1,i):(Bt(i),i)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=xr){this.playCallbacks_.push(e);const i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i){this.waitToPlay_=o=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!i&&(ug||Us)&&this.load();return}const n=this.techGet_("play");n===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(n)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(i){i()})}runPlayCallbacks_(e){const i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(n){n(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Pr(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(typeof e<"u"){if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Pr(0,0)),e}bufferedPercent(){return ck(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),i=this.duration();let n=e.end(e.length-1);return n>i&&(n=i),n}volume(e){let i;if(e!==void 0){i=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=i,this.techCall_("setVolume",i),i>0&&this.lastVolume_(i);return}return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const i=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const i=this;return new Promise((n,o)=>{function u(){i.off("fullscreenerror",h),i.off("fullscreenchange",c)}function c(){u(),n()}function h(v,T){u(),o(T)}i.one("fullscreenchange",c),i.one("fullscreenerror",h);const m=i.requestFullscreenHelper_(e);m&&(m.then(u,u),m.then(n,o))})}requestFullscreenHelper_(e){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(i=e)),this.fsApi_.requestFullscreen){const n=this.el_[this.fsApi_.requestFullscreen](i);return n&&n.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),n}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((i,n)=>{function o(){e.off("fullscreenerror",c),e.off("fullscreenchange",u)}function u(){o(),i()}function c(m,v){o(),n(v)}e.one("fullscreenchange",u),e.one("fullscreenerror",c);const h=e.exitFullscreenHelper_();h&&(h.then(o,o),h.then(i,n))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=$e[this.fsApi_.exitFullscreen]();return e&&xr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=$e.documentElement.style.overflow,vn($e,"keydown",this.boundFullWindowOnEscKey_),$e.documentElement.style.overflow="hidden",Zo($e.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){bt.isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,vs($e,"keydown",this.boundFullWindowOnEscKey_),$e.documentElement.style.overflow=this.docOrigOverflow,cg($e.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if("pictureInPictureEnabled"in $e&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")}exitPictureInPicture(){if("pictureInPictureEnabled"in $e)return $e.exitPictureInPicture()}handleKeyDown(e){const{userActions:i}=this.options_;!i||!i.hotkeys||(o=>{const u=o.tagName.toLowerCase();if(o.isContentEditable)return!0;const c=["button","checkbox","hidden","radio","reset","submit"];return u==="input"?c.indexOf(o.type)===-1:["textarea"].indexOf(u)!==-1})(this.el_.ownerDocument.activeElement)||(typeof i.hotkeys=="function"?i.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const i=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:n=c=>bt.isEventKey(c,"f"),muteKey:o=c=>bt.isEventKey(c,"m"),playPauseKey:u=c=>bt.isEventKey(c,"k")||bt.isEventKey(c,"Space")}=i;if(n.call(this,e)){e.preventDefault(),e.stopPropagation();const c=Ee.getComponent("FullscreenToggle");$e[this.fsApi_.fullscreenEnabled]!==!1&&c.prototype.handleClick.call(this,e)}else o.call(this,e)?(e.preventDefault(),e.stopPropagation(),Ee.getComponent("MuteToggle").prototype.handleClick.call(this,e)):u.call(this,e)&&(e.preventDefault(),e.stopPropagation(),Ee.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let i;for(let n=0,o=this.options_.techOrder;n<o.length;n++){const u=o[n];let c=wt.getTech(u);if(c||(c=Ee.getComponent(u)),!c){Bt.error(`The "${u}" tech is undefined. Skipped browser support check for that tech.`);continue}if(c.isSupported()&&(i=c.canPlayType(e),i))return i}return""}selectSource(e){const i=this.options_.techOrder.map(h=>[h,wt.getTech(h)]).filter(([h,m])=>m?m.isSupported():(Bt.error(`The "${h}" tech is undefined. Skipped browser support check for that tech.`),!1)),n=function(h,m,v){let T;return h.some(O=>m.some(R=>{if(T=v(O,R),T)return!0})),T};let o;const u=h=>(m,v)=>h(v,m),c=([h,m],v)=>{if(m.canPlaySource(v,this.options_[h.toLowerCase()]))return{source:v,tech:h}};return this.options_.sourceOrder?o=n(e,i,u(c)):o=n(i,e,c),o||!1}handleSrc_(e,i){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const n=mk(e);if(!n.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,i||(this.cache_.sources=n),this.updateSourceCaches_(n[0]),uj(this,n[0],(o,u)=>{if(this.middleware_=u,i||(this.cache_.sources=n),this.updateSourceCaches_(o),this.src_(o)){if(n.length>1)return this.handleSrc_(n.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}cj(u,this.tech_)}),n.length>1){const o=()=>{this.error(null),this.handleSrc_(n.slice(1),!0)},u=()=>{this.off("error",o)};this.one("error",o),this.one("playing",u),this.resetRetryOnError_=()=>{this.off("error",o),this.off("playing",u)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const i=this.selectSource([e]);return i?ak(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();xr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),pa(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{durationDisplay:e,remainingTimeDisplay:i}=this.controlBar||{};e&&e.updateContent(),i&&i.updateContent()}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),i=[];return Object.keys(e).length!==0&&i.push(e),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let i;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),i=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,i=typeof i>"u"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(e){return e!==void 0?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(eo("beforeerror").forEach(i=>{const n=i(this,e);if(!(Nr(n)&&!Array.isArray(n)||typeof n=="string"||typeof n=="number"||n===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=n}),this.options_.suppressNotSupportedError&&e&&e.code===4){const i=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)});return}if(e===null){this.error_=e,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Ls(e),this.addClass("vjs-error"),Bt.error(`(CODE:${this.error_.code} ${Ls.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),eo("error").forEach(i=>i(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,i,n;const o=hi(this,this.reportUserActivity),u=function(T){(T.screenX!==i||T.screenY!==n)&&(i=T.screenX,n=T.screenY,o())},c=function(){o(),this.clearInterval(e),e=this.setInterval(o,250)},h=function(T){o(),this.clearInterval(e)};this.on("mousedown",c),this.on("mousemove",u),this.on("mouseup",h),this.on("mouseleave",h);const m=this.getChild("controlBar");m&&!Us&&!Rr&&(m.on("mouseenter",function(T){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),m.on("mouseleave",function(T){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);let v;this.setInterval(function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(v);const T=this.options_.inactivityTimeout;T<=0||(v=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},T))},250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),i=this.getChild("ControlBar"),n=i&&i.currentHeight();e.forEach(o=>{o!==i&&o.el_&&!o.hasClass("vjs-hidden")&&(o.hide(),this.audioOnlyCache_.hiddenChildren.push(o))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(n),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,i,n){if(this.tech_)return this.tech_.addTextTrack(e,i,n)}addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)}removeRemoteTextTrack(e={}){let{track:i}=e;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),pa(this)&&this.trigger("languagechange"))}languages(){return di(fi.prototype.options_.languages,this.languages_)}toJSON(){const e=di(this.options_),i=e.tracks;e.tracks=[];for(let n=0;n<i.length;n++){let o=i[n];o=di(o),o.player=void 0,e.tracks[n]=o}return e}createModal(e,i){i=i||{},i.content=e||"";const n=new gc(this,i);return this.addChild(n),n.on("dispose",()=>{this.removeChild(n)}),n.open(),n}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),i=this.currentWidth();for(let n=0;n<D0.length;n++){const o=D0[n],u=this.breakpoints_[o];if(i<=u){if(e===o)return;e&&this.removeClass(Jp[e]),this.addClass(Jp[o]),this.breakpoint_=o;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},Kj,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const i=this.responsive_;if(e!==i)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Jp[this.breakpoint_]||""}loadMedia(e,i){if(!e||typeof e!="object")return;this.reset(),this.cache_.media=di(e);const{artist:n,artwork:o,description:u,poster:c,src:h,textTracks:m,title:v}=this.cache_.media;!o&&c&&(this.cache_.media.artwork=[{src:c,type:wm(c)}]),h&&this.src(h),c&&this.poster(c),Array.isArray(m)&&m.forEach(T=>this.addRemoteTextTrack(T,!1)),this.titleBar&&this.titleBar.update({title:v,description:u||n||""}),this.ready(i)}getMedia(){if(!this.cache_.media){const e=this.poster(),i=this.currentSources(),n=Array.prototype.map.call(this.remoteTextTracks(),u=>({kind:u.kind,label:u.label,language:u.language,src:u.src})),o={src:i,textTracks:n};return e&&(o.poster=e,o.artwork=[{src:o.poster,type:wm(o.poster)}]),o}return di(this.cache_.media)}static getTagSettings(e){const i={sources:[],tracks:[]},n=Wa(e),o=n["data-setup"];if(eh(e,"vjs-fill")&&(n.fill=!0),eh(e,"vjs-fluid")&&(n.fluid=!0),o!==null){const[u,c]=LU(o||"{}");u&&Bt.error(u),Object.assign(n,c)}if(Object.assign(i,n),e.hasChildNodes()){const u=e.childNodes;for(let c=0,h=u.length;c<h;c++){const m=u[c],v=m.nodeName.toLowerCase();v==="source"?i.sources.push(Wa(m)):v==="track"&&i.tracks.push(Wa(m))}}return i}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(i=>typeof i=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Os.names.forEach(function(t){const e=Os[t];fi.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});fi.prototype.crossorigin=fi.prototype.crossOrigin;fi.players={};const jd=Z.navigator;fi.prototype.options_={techOrder:wt.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:jd&&(jd.languages&&jd.languages[0]||jd.userLanguage||jd.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(t){fi.prototype[t]=function(){return this.techGet_(t)}});Bk.forEach(function(t){fi.prototype[`handleTech${Ai(t)}_`]=function(){return this.trigger(t)}});Ee.registerComponent("Player",fi);const Am="plugin",Pu="activePlugins_",wu={},km=t=>wu.hasOwnProperty(t),Zp=t=>km(t)?wu[t]:void 0,Fk=(t,e)=>{t[Pu]=t[Pu]||{},t[Pu][e]=!0},Im=(t,e,i)=>{const n=(i?"before":"")+"pluginsetup";t.trigger(n,e),t.trigger(n+":"+e.name,e)},Xj=function(t,e){const i=function(){Im(this,{name:t,plugin:e,instance:null},!0);const n=e.apply(this,arguments);return Fk(this,t),Im(this,{name:t,plugin:e,instance:n}),n};return Object.keys(e).forEach(function(n){i[n]=e[n]}),i},yw=(t,e)=>(e.prototype.name=t,function(...i){Im(this,{name:t,plugin:e,instance:null},!0);const n=new e(this,...i);return this[t]=()=>n,Im(this,n.getEventHash()),n});class Ys{constructor(e){if(this.constructor===Ys)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Zv(this),delete this.trigger,rk(this,this.constructor.defaultState),Fk(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,i={}){return mc(this.eventBusEl_,e,this.getEventHash(i))}handleStateChanged(e){}dispose(){const{name:e,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[Pu][e]=!1,this.player=this.state=null,i[e]=yw(e,wu[e])}static isBasic(e){const i=typeof e=="string"?Zp(e):e;return typeof i=="function"&&!Ys.prototype.isPrototypeOf(i.prototype)}static registerPlugin(e,i){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(km(e))Bt.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(fi.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof i}.`);return wu[e]=i,e!==Am&&(Ys.isBasic(i)?fi.prototype[e]=Xj(e,i):fi.prototype[e]=yw(e,i)),i}static deregisterPlugin(e){if(e===Am)throw new Error("Cannot de-register base plugin.");km(e)&&(delete wu[e],delete fi.prototype[e])}static getPlugins(e=Object.keys(wu)){let i;return e.forEach(n=>{const o=Zp(n);o&&(i=i||{},i[n]=o)}),i}static getPluginVersion(e){const i=Zp(e);return i&&i.VERSION||""}}Ys.getPlugin=Zp;Ys.BASE_PLUGIN_NAME=Am;Ys.registerPlugin(Am,Ys);fi.prototype.usingPlugin=function(t){return!!this[Pu]&&this[Pu][t]===!0};fi.prototype.hasPlugin=function(t){return!!km(t)};function Yj(t,e){let i=!1;return function(...n){return i||Bt.warn(t),i=!0,e.apply(this,n)}}function ar(t,e,i,n){return Yj(`${e} is deprecated and will be removed in ${t}.0; please use ${i} instead.`,n)}const $k=t=>t.indexOf("#")===0?t.slice(1):t;function he(t,e,i){let n=he.getPlayer(t);if(n)return e&&Bt.warn(`Player "${t}" is already initialised. Options will not be applied.`),i&&n.ready(i),n;const o=typeof t=="string"?to("#"+$k(t)):t;if(!pc(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!o.ownerDocument.defaultView||!o.ownerDocument.body.contains(o))&&Bt.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(o.parentNode&&o.parentNode.hasAttribute("data-vjs-player")?o.parentNode:o).cloneNode(!0)),eo("beforesetup").forEach(c=>{const h=c(o,di(e));if(!Nr(h)||Array.isArray(h)){Bt.error("please return an object in beforesetup hooks");return}e=di(e,h)});const u=Ee.getComponent("Player");return n=new u(o,e,i),eo("setup").forEach(c=>c(n)),n}he.hooks_=la;he.hooks=eo;he.hook=P$;he.hookOnce=L$;he.removeHook=PA;if(Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&fc()){let t=to(".vjs-styles-defaults");if(!t){t=ek("vjs-styles-defaults");const e=to("head");e&&e.insertBefore(t,e.firstChild),tk(t,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}x0(1,he);he.VERSION=DA;he.options=fi.prototype.options_;he.getPlayers=()=>fi.players;he.getPlayer=t=>{const e=fi.players;let i;if(typeof t=="string"){const n=$k(t),o=e[n];if(o)return o;i=to("#"+n)}else i=t;if(pc(i)){const{player:n,playerId:o}=i;if(n||e[o])return n||e[o]}};he.getAllPlayers=()=>Object.keys(fi.players).map(t=>fi.players[t]).filter(Boolean);he.players=fi.players;he.getComponent=Ee.getComponent;he.registerComponent=(t,e)=>{wt.isTech(e)&&Bt.warn(`The ${t} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Ee.registerComponent.call(Ee,t,e)};he.getTech=wt.getTech;he.registerTech=wt.registerTech;he.use=lj;Object.defineProperty(he,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(he.middleware,"TERMINATOR",{value:xm,writeable:!1,enumerable:!0});he.browser=U$;he.obj=M$;he.mergeOptions=ar(9,"videojs.mergeOptions","videojs.obj.merge",di);he.defineLazyProperty=ar(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",rg);he.bind=ar(9,"videojs.bind","native Function.prototype.bind",hi);he.registerPlugin=Ys.registerPlugin;he.deregisterPlugin=Ys.deregisterPlugin;he.plugin=(t,e)=>(Bt.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Ys.registerPlugin(t,e));he.getPlugins=Ys.getPlugins;he.getPlugin=Ys.getPlugin;he.getPluginVersion=Ys.getPluginVersion;he.addLanguage=function(t,e){return t=(""+t).toLowerCase(),he.options.languages=di(he.options.languages,{[t]:e}),he.options.languages[t]};he.log=Bt;he.createLogger=NA;he.time=Q$;he.createTimeRange=ar(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Pr);he.createTimeRanges=ar(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Pr);he.formatTime=ar(9,"videojs.formatTime","videojs.time.formatTime",ll);he.setFormatTime=ar(9,"videojs.setFormatTime","videojs.time.setFormatTime",lk);he.resetFormatTime=ar(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",uk);he.parseUrl=ar(9,"videojs.parseUrl","videojs.url.parseUrl",iT);he.isCrossOrigin=ar(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",_g);he.EventTarget=Pn;he.any=Jv;he.on=vn;he.one=mg;he.off=vs;he.trigger=mc;he.xhr=ch;he.TextTrack=Mh;he.AudioTrack=fk;he.VideoTrack=pk;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(t=>{he[t]=function(){return Bt.warn(`videojs.${t}() is deprecated; use videojs.dom.${t}() instead`),JA[t].apply(null,arguments)}});he.computedStyle=ar(9,"videojs.computedStyle","videojs.dom.computedStyle",ec);he.dom=JA;he.fn=W$;he.num=Aj;he.str=X$;he.url=aj;/*! @name videojs-contrib-quality-levels @version 3.0.0 @license Apache-2.0 */class Qj{constructor(e){let i=this;return i.id=e.id,i.label=i.id,i.width=e.width,i.height=e.height,i.bitrate=e.bandwidth,i.frameRate=e.frameRate,i.enabled_=e.enabled,Object.defineProperty(i,"enabled",{get(){return i.enabled_()},set(n){i.enabled_(n)}}),i}}class Om extends he.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e}addQualityLevel(e){let i=this.getQualityLevelById(e.id);if(i)return i;const n=this.levels_.length;return i=new Qj(e),""+n in this||Object.defineProperty(this,n,{get(){return this.levels_[n]}}),this.levels_.push(i),this.trigger({qualityLevel:i,type:"addqualitylevel"}),i}removeQualityLevel(e){let i=null;for(let n=0,o=this.length;n<o;n++)if(this[n]===e){i=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),i}getQualityLevelById(e){for(let i=0,n=this.length;i<n;i++){const o=this[i];if(o.id===e)return o}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Om.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const t in Om.prototype.allowedEvents_)Om.prototype["on"+t]=null;var jk="3.0.0";const Jj=he.registerPlugin||he.plugin,Zj=function(t,e){const i=t.qualityLevels,n=new Om,o=function(){n.dispose(),t.qualityLevels=i,t.off("dispose",o)};return t.on("dispose",o),t.qualityLevels=()=>n,t.qualityLevels.VERSION=jk,n},Hk=function(t){return Zj(this,he.mergeOptions({},t))};Jj("qualityLevels",Hk);Hk.VERSION=jk;/*! @name @videojs/http-streaming @version 3.0.0 @license Apache-2.0 */const Qn=xB,Dm=(t,e)=>e&&e.responseURL&&t!==e.responseURL?e.responseURL:t,or=t=>he.log.debug?he.log.debug.bind(he,"VHS:",`${t} >`):function(){};function ui(...t){const e=he.obj||he;return(e.merge||e.mergeOptions).apply(e,t)}function _s(...t){const e=he.time||he;return(e.createTimeRanges||e.createTimeRanges).apply(e,t)}const io=1/30,wr=io*3,Vk=function(t,e){const i=[];let n;if(t&&t.length)for(n=0;n<t.length;n++)e(t.start(n),t.end(n))&&i.push([t.start(n),t.end(n)]);return _s(i)},Cu=function(t,e){return Vk(t,function(i,n){return i-wr<=e&&n+wr>=e})},Bp=function(t,e){return Vk(t,function(i){return i-io>=e})},e4=function(t){if(t.length<2)return _s();const e=[];for(let i=1;i<t.length;i++){const n=t.end(i-1),o=t.start(i);e.push([n,o])}return _s(e)},t4=function(t,e){let i=null,n=null,o=0;const u=[],c=[];if(!t||!t.length||!e||!e.length)return _s();let h=t.length;for(;h--;)u.push({time:t.start(h),type:"start"}),u.push({time:t.end(h),type:"end"});for(h=e.length;h--;)u.push({time:e.start(h),type:"start"}),u.push({time:e.end(h),type:"end"});for(u.sort(function(m,v){return m.time-v.time}),h=0;h<u.length;h++)u[h].type==="start"?(o++,o===2&&(i=u[h].time)):u[h].type==="end"&&(o--,o===1&&(n=u[h].time)),i!==null&&n!==null&&(c.push([i,n]),i=null,n=null);return _s(c)},qk=t=>{const e=[];if(!t||!t.length)return"";for(let i=0;i<t.length;i++)e.push(t.start(i)+" => "+t.end(i));return e.join(", ")},i4=function(t,e,i=1){return((t.length?t.end(t.length-1):0)-e)/i},Xo=t=>{const e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e},s4=function(t,e){if(t===e)return!1;if(!t&&e||!e&&t||t.length!==e.length)return!0;for(let i=0;i<t.length;i++)if(t.start(i)!==e.start(i)||t.end(i)!==e.end(i))return!0;return!1},vw=function(t){if(!(!t||!t.length||!t.end))return t.end(t.length-1)},TT=function(t,e){let i=0;if(!t||!t.length)return i;for(let n=0;n<t.length;n++){const o=t.start(n),u=t.end(n);if(!(e>u)){if(e>o&&e<=u){i+=u-e;continue}i+=u-o}}return i},bT=(t,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(n){i+=n.duration}),(e.preloadHints||[]).forEach(function(n){n.type==="PART"&&(i+=t.partTargetDuration)}),i},P0=t=>(t.segments||[]).reduce((e,i,n)=>(i.parts?i.parts.forEach(function(o,u){e.push({duration:o.duration,segmentIndex:n,partIndex:u,part:o,segment:i})}):e.push({duration:i.duration,segmentIndex:n,partIndex:null,segment:i,part:null}),e),[]),Wk=t=>{const e=t.segments&&t.segments.length&&t.segments[t.segments.length-1];return e&&e.parts||[]},Gk=({preloadSegment:t})=>{if(!t)return;const{parts:e,preloadHints:i}=t;let n=(i||[]).reduce((o,u)=>o+(u.type==="PART"?1:0),0);return n+=e&&e.length?e.length:0,n},zk=(t,e)=>{if(e.endList)return 0;if(t&&t.suggestedPresentationDelay)return t.suggestedPresentationDelay;const i=Wk(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},n4=function(t,e){let i=0,n=e-t.mediaSequence,o=t.segments[n];if(o){if(typeof o.start<"u")return{result:o.start,precise:!0};if(typeof o.end<"u")return{result:o.end-o.duration,precise:!0}}for(;n--;){if(o=t.segments[n],typeof o.end<"u")return{result:i+o.end,precise:!0};if(i+=bT(t,o),typeof o.start<"u")return{result:i+o.start,precise:!0}}return{result:i,precise:!1}},r4=function(t,e){let i=0,n,o=e-t.mediaSequence;for(;o<t.segments.length;o++){if(n=t.segments[o],typeof n.start<"u")return{result:n.start-i,precise:!0};if(i+=bT(t,n),typeof n.end<"u")return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}},Kk=function(t,e,i){if(typeof e>"u"&&(e=t.mediaSequence+t.segments.length),e<t.mediaSequence)return 0;const n=n4(t,e);if(n.precise)return n.result;const o=r4(t,e);return o.precise?o.result:n.result+i},Xk=function(t,e,i){if(!t)return 0;if(typeof i!="number"&&(i=0),typeof e>"u"){if(t.totalDuration)return t.totalDuration;if(!t.endList)return Z.Infinity}return Kk(t,e,i)},sh=function({defaultDuration:t,durationList:e,startIndex:i,endIndex:n}){let o=0;if(i>n&&([i,n]=[n,i]),i<0){for(let u=i;u<Math.min(0,n);u++)o+=t;i=0}for(let u=i;u<n;u++)o+=e[u].duration;return o},Yk=function(t,e,i,n){if(!t||!t.segments)return null;if(t.endList)return Xk(t);if(e===null)return null;e=e||0;let o=Kk(t,t.mediaSequence+t.segments.length,e);return i&&(n=typeof n=="number"?n:zk(null,t),o-=n),Math.max(0,o)},a4=function(t,e,i){const o=e||0,u=Yk(t,e,!0,i);return u===null?_s():_s(o,u)},o4=function({playlist:t,currentTime:e,startingSegmentIndex:i,startingPartIndex:n,startTime:o,exactManifestTimings:u}){let c=e-o;const h=P0(t);let m=0;for(let v=0;v<h.length;v++){const T=h[v];if(i===T.segmentIndex&&!(typeof n=="number"&&typeof T.partIndex=="number"&&n!==T.partIndex)){m=v;break}}if(c<0){if(m>0)for(let v=m-1;v>=0;v--){const T=h[v];if(c+=T.duration,u){if(c<0)continue}else if(c+io<=0)continue;return{partIndex:T.partIndex,segmentIndex:T.segmentIndex,startTime:o-sh({defaultDuration:t.targetDuration,durationList:h,startIndex:m,endIndex:v})}}return{partIndex:h[0]&&h[0].partIndex||null,segmentIndex:h[0]&&h[0].segmentIndex||0,startTime:e}}if(m<0){for(let v=m;v<0;v++)if(c-=t.targetDuration,c<0)return{partIndex:h[0]&&h[0].partIndex||null,segmentIndex:h[0]&&h[0].segmentIndex||0,startTime:e};m=0}for(let v=m;v<h.length;v++){const T=h[v];if(c-=T.duration,u){if(c>0)continue}else if(c-io>=0)continue;return{partIndex:T.partIndex,segmentIndex:T.segmentIndex,startTime:o+sh({defaultDuration:t.targetDuration,durationList:h,startIndex:m,endIndex:v})}}return{segmentIndex:h[h.length-1].segmentIndex,partIndex:h[h.length-1].partIndex,startTime:e}},Qk=function(t){return t.excludeUntil&&t.excludeUntil>Date.now()},ET=function(t){return t.excludeUntil&&t.excludeUntil===1/0},Tg=function(t){const e=Qk(t);return!t.disabled&&!e},l4=function(t){return t.disabled},u4=function(t){for(let e=0;e<t.segments.length;e++)if(t.segments[e].key)return!0;return!1},Jk=function(t,e){return e.attributes&&e.attributes[t]},c4=function(t,e,i,n=0){return Jk("BANDWIDTH",i)?(t*i.attributes.BANDWIDTH-n*8)/e:NaN},L0=(t,e)=>{if(t.playlists.length===1)return!0;const i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return t.playlists.filter(n=>Tg(n)?(n.attributes.BANDWIDTH||0)<i:!1).length===0},ST=(t,e)=>!t&&!e||!t&&e||t&&!e?!1:!!(t===e||t.id&&e.id&&t.id===e.id||t.resolvedUri&&e.resolvedUri&&t.resolvedUri===e.resolvedUri||t.uri&&e.uri&&t.uri===e.uri),Tw=function(t,e){const i=t&&t.mediaGroups&&t.mediaGroups.AUDIO||{};let n=!1;for(const o in i){for(const u in i[o])if(n=e(i[o][u]),n)break;if(n)break}return!!n},$h=t=>{if(!t||!t.playlists||!t.playlists.length)return Tw(t,i=>i.playlists&&i.playlists.length||i.uri);for(let e=0;e<t.playlists.length;e++){const i=t.playlists[e],n=i.attributes&&i.attributes.CODECS;if(!(n&&n.split(",").every(u=>j1(u))||Tw(t,u=>ST(i,u))))return!1}return!0};var Xs={liveEdgeDelay:zk,duration:Xk,seekable:a4,getMediaInfoForTime:o4,isEnabled:Tg,isDisabled:l4,isExcluded:Qk,isIncompatible:ET,playlistEnd:Yk,isAes:u4,hasAttribute:Jk,estimateSegmentRequestTime:c4,isLowestEnabledRendition:L0,isAudioOnly:$h,playlistMatch:ST,segmentDurationWithParts:bT};const{log:Zk}=he,xT=(t,e)=>`${t}-${e}`,d4=({onwarn:t,oninfo:e,manifestString:i,customTagParsers:n=[],customTagMappers:o=[],llhls:u})=>{const c=new PB;t&&c.on("warn",t),e&&c.on("info",e),n.forEach(v=>c.addParser(v)),o.forEach(v=>c.addTagMapper(v)),c.push(i),c.end();const h=c.manifest;if(u||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(v){h.hasOwnProperty(v)&&delete h[v]}),h.segments&&h.segments.forEach(function(v){["parts","preloadHints"].forEach(function(T){v.hasOwnProperty(T)&&delete v[T]})})),!h.targetDuration){let v=10;h.segments&&h.segments.length&&(v=h.segments.reduce((T,O)=>Math.max(T,O.duration),0)),t&&t(`manifest has no targetDuration defaulting to ${v}`),h.targetDuration=v}const m=Wk(h);if(m.length&&!h.partTargetDuration){const v=m.reduce((T,O)=>Math.max(T,O.duration),0);t&&(t(`manifest has no partTargetDuration defaulting to ${v}`),Zk.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),h.partTargetDuration=v}return h},jh=(t,e)=>{t.mediaGroups&&["AUDIO","SUBTITLES"].forEach(i=>{if(t.mediaGroups[i])for(const n in t.mediaGroups[i])for(const o in t.mediaGroups[i][n]){const u=t.mediaGroups[i][n][o];e(u,i,n,o)}})},eI=({playlist:t,uri:e,id:i})=>{t.id=i,t.playlistErrors_=0,e&&(t.uri=e),t.attributes=t.attributes||{}},h4=t=>{let e=t.playlists.length;for(;e--;){const i=t.playlists[e];eI({playlist:i,id:xT(e,i.uri)}),i.resolvedUri=Qn(t.uri,i.uri),t.playlists[i.id]=i,t.playlists[i.uri]=i,i.attributes.BANDWIDTH||Zk.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},f4=t=>{jh(t,e=>{e.uri&&(e.resolvedUri=Qn(t.uri,e.uri))})},p4=(t,e)=>{const i=xT(0,e),n={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:Z.location.href,resolvedUri:Z.location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return n.playlists[i]=n.playlists[0],n.playlists[e]=n.playlists[0],n},tI=(t,e)=>{t.uri=e;for(let n=0;n<t.playlists.length;n++)if(!t.playlists[n].uri){const o=`placeholder-uri-${n}`;t.playlists[n].uri=o}const i=$h(t);jh(t,(n,o,u,c)=>{const h=`placeholder-uri-${o}-${u}-${c}`;if(!n.playlists||!n.playlists.length){if(i&&o==="AUDIO"&&!n.uri)for(let m=0;m<t.playlists.length;m++){const v=t.playlists[m];if(v.attributes&&v.attributes.AUDIO&&v.attributes.AUDIO===u)return}n.playlists=[ya({},n)]}n.playlists.forEach(function(m,v){const T=xT(v,h);m.uri?m.resolvedUri=m.resolvedUri||Qn(t.uri,m.uri):(m.uri=v===0?h:T,m.resolvedUri=m.uri),m.id=m.id||T,m.attributes=m.attributes||{},t.playlists[m.id]=m,t.playlists[m.uri]=m})}),h4(t),f4(t)},{EventTarget:m4}=he,g4=(t,e)=>{if(e.endList||!e.serverControl)return t;const i={};if(e.serverControl.canBlockReload){const{preloadSegment:n}=e;let o=e.mediaSequence+e.segments.length;if(n){const u=n.parts||[],c=Gk(e)-1;c>-1&&c!==u.length-1&&(i._HLS_part=c),(c>-1||u.length)&&o--}i._HLS_msn=o}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){const n=new Z.URL(t);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(o){i.hasOwnProperty(o)&&n.searchParams.set(o,i[o])}),t=n.toString()}return t},_4=(t,e)=>{if(!t)return e;const i=ui(t,e);if(t.preloadHints&&!e.preloadHints&&delete i.preloadHints,t.parts&&!e.parts)delete i.parts;else if(t.parts&&e.parts)for(let n=0;n<e.parts.length;n++)t.parts&&t.parts[n]&&(i.parts[n]=ui(t.parts[n],e.parts[n]));return!t.skipped&&e.skipped&&(i.skipped=!1),t.preload&&!e.preload&&(i.preload=!1),i},y4=(t,e,i)=>{const n=t.slice(),o=e.slice();i=i||0;const u=[];let c;for(let h=0;h<o.length;h++){const m=n[h+i],v=o[h];m?(c=m.map||c,u.push(_4(m,v))):(c&&!v.map&&(v.map=c),u.push(v))}return u},iI=(t,e)=>{!t.resolvedUri&&t.uri&&(t.resolvedUri=Qn(e,t.uri)),t.key&&!t.key.resolvedUri&&(t.key.resolvedUri=Qn(e,t.key.uri)),t.map&&!t.map.resolvedUri&&(t.map.resolvedUri=Qn(e,t.map.uri)),t.map&&t.map.key&&!t.map.key.resolvedUri&&(t.map.key.resolvedUri=Qn(e,t.map.key.uri)),t.parts&&t.parts.length&&t.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=Qn(e,i.uri))}),t.preloadHints&&t.preloadHints.length&&t.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=Qn(e,i.uri))})},sI=function(t){const e=t.segments||[],i=t.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let n=0;n<i.preloadHints.length;n++)if(i.preloadHints[n].type==="MAP")return e}i.duration=t.targetDuration,i.preload=!0,e.push(i)}return e},nI=(t,e)=>t===e||t.segments&&e.segments&&t.segments.length===e.segments.length&&t.endList===e.endList&&t.mediaSequence===e.mediaSequence&&t.preloadSegment===e.preloadSegment,N0=(t,e,i=nI)=>{const n=ui(t,{}),o=n.playlists[e.id];if(!o||i(o,e))return null;e.segments=sI(e);const u=ui(o,e);if(u.preloadSegment&&!e.preloadSegment&&delete u.preloadSegment,o.segments){if(e.skip){e.segments=e.segments||[];for(let c=0;c<e.skip.skippedSegments;c++)e.segments.unshift({skipped:!0})}u.segments=y4(o.segments,e.segments,e.mediaSequence-o.mediaSequence)}u.segments.forEach(c=>{iI(c,u.resolvedUri)});for(let c=0;c<n.playlists.length;c++)n.playlists[c].id===e.id&&(n.playlists[c]=u);return n.playlists[e.id]=u,n.playlists[e.uri]=u,jh(t,(c,h,m,v)=>{if(c.playlists)for(let T=0;T<c.playlists.length;T++)e.id===c.playlists[T].id&&(c.playlists[T]=u)}),n},R0=(t,e)=>{const i=t.segments||[],n=i[i.length-1],o=n&&n.parts&&n.parts[n.parts.length-1],u=o&&o.duration||n&&n.duration;return e&&u?u*1e3:(t.partTargetDuration||t.targetDuration||10)*500};class Au extends m4{constructor(e,i,n={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=or("PlaylistLoader");const{withCredentials:o=!1}=n;this.src=e,this.vhs_=i,this.withCredentials=o;const u=i.options_;this.customTagParsers=u&&u.customTagParsers||[],this.customTagMappers=u&&u.customTagMappers||[],this.llhls=u&&u.llhls,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let i=Qn(this.main.uri,e.uri);this.llhls&&(i=g4(i,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials},(n,o)=>{if(this.request){if(n)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,i,n){const{uri:o,id:u}=i;this.request=null,n&&(this.state=n),this.error={playlist:this.main.playlists[u],status:e.status,message:`HLS playlist request error at URL: ${o}.`,responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}parseManifest_({url:e,manifestString:i}){return d4({onwarn:({message:n})=>this.logger_(`m3u8-parser warn for ${e}: ${n}`),oninfo:({message:n})=>this.logger_(`m3u8-parser info for ${e}: ${n}`),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:i,url:n,id:o}){this.request=null,this.state="HAVE_METADATA";const u=i||this.parseManifest_({url:n,manifestString:e});u.lastRequest=Date.now(),eI({playlist:u,uri:n,id:o});const c=N0(this.main,u);this.targetDuration=u.partTargetDuration||u.targetDuration,this.pendingMedia_=null,c?(this.main=c,this.media_=this.main.playlists[o]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(R0(this.media(),!!c)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),Z.clearTimeout(this.finalRenditionTimeout),this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,i){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(Z.clearTimeout(this.finalRenditionTimeout),i){const c=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=Z.setTimeout(this.media.bind(this,e,!1),c);return}const n=this.state,o=!this.media_||e.id!==this.media_.id,u=this.main.playlists[e.id];if(u&&u.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,o&&(this.trigger("mediachanging"),n==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(R0(e,!0)),!!o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(c,h)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Dm(e.resolvedUri,h),c)return this.playlistRequestError(this.request,e,n);this.haveMetadata({playlistString:h.responseText,url:e.uri,id:e.id}),n==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const i=this.media();if(e){const n=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},n);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=Z.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=Z.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,i)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=Dm(this.src,i);const n=this.parseManifest_({manifestString:i.responseText,url:this.src});this.setupInitialPlaylist(n)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,tI(this.main,this.srcUri()),e.playlists.forEach(n=>{n.segments=sI(n),n.segments.forEach(o=>{iI(o,n.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const i=this.srcUri()||Z.location.href;this.main=p4(e,i),this.haveMetadata({playlistObject:e,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}}const{xhr:v4}=he,M0=function(t,e,i,n){const o=t.responseType==="arraybuffer"?t.response:t.responseText;!e&&o&&(t.responseTime=Date.now(),t.roundTripTime=t.responseTime-t.requestTime,t.bytesReceived=o.byteLength||o.length,t.bandwidth||(t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3))),i.headers&&(t.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(t.timedout=!0),!e&&!t.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(t&&(o||t.responseText)))),n(e,t)},rI=function(){const t=function e(i,n){i=ui({timeout:45e3},i);const o=e.beforeRequest||he.Vhs.xhr.beforeRequest;if(o&&typeof o=="function"){const m=o(i);m&&(i=m)}const c=(he.Vhs.xhr.original===!0?v4:he.Vhs.xhr)(i,function(m,v){return M0(c,m,v,n)}),h=c.abort;return c.abort=function(){return c.aborted=!0,h.apply(c,arguments)},c.uri=i.uri,c.requestTime=Date.now(),c};return t.original=!0,t},T4=function(t){let e;const i=t.offset;return typeof t.offset=="bigint"||typeof t.length=="bigint"?e=Z.BigInt(t.offset)+Z.BigInt(t.length)-Z.BigInt(1):e=t.offset+t.length-1,"bytes="+i+"-"+e},U0=function(t){const e={};return t.byterange&&(e.Range=T4(t.byterange)),e},b4=function(t,e){return t.start(e)+"-"+t.end(e)},E4=function(t,e){const i=t.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},S4=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},aI=function(t){const e={};return Object.keys(t).forEach(i=>{const n=t[i];V1(n)?e[i]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:e[i]=n}),e},Pm=function(t){const e=t.byterange||{length:1/0,offset:0};return[e.length,e.offset,t.resolvedUri].join(",")},oI=function(t){return t.resolvedUri},lI=t=>{const e=Array.prototype.slice.call(t),i=16;let n="",o,u;for(let c=0;c<e.length/i;c++)o=e.slice(c*i,c*i+i).map(E4).join(""),u=e.slice(c*i,c*i+i).map(S4).join(""),n+=o+" "+u+`
`;return n},x4=({bytes:t})=>lI(t),w4=t=>{let e="",i;for(i=0;i<t.length;i++)e+=b4(t,i)+" ";return e};var C4=Object.freeze({__proto__:null,createTransferableMessage:aI,initSegmentId:Pm,segmentKeyId:oI,hexDump:lI,tagDump:x4,textRanges:w4});const uI=.25,A4=(t,e)=>{if(!e.dateTimeObject)return null;const i=e.videoTimingInfo.transmuxerPrependedSeconds,o=e.videoTimingInfo.transmuxedPresentationStart+i,u=t-o;return new Date(e.dateTimeObject.getTime()+u*1e3)},k4=t=>t.transmuxedPresentationEnd-t.transmuxedPresentationStart-t.transmuxerPrependedSeconds,I4=(t,e)=>{let i;try{i=new Date(t)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let n=e.segments[0];if(i<n.dateTimeObject)return null;for(let m=0;m<e.segments.length-1;m++){n=e.segments[m];const v=e.segments[m+1].dateTimeObject;if(i<v)break}const o=e.segments[e.segments.length-1],u=o.dateTimeObject,c=o.videoTimingInfo?k4(o.videoTimingInfo):o.duration+o.duration*uI,h=new Date(u.getTime()+c*1e3);return i>h?null:(i>u&&(n=o),{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:Xs.duration(e,e.mediaSequence+e.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"})},O4=(t,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let i=0,n;for(let u=0;u<e.segments.length&&(n=e.segments[u],i=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration,!(t<=i));u++);const o=e.segments[e.segments.length-1];if(o.videoTimingInfo&&o.videoTimingInfo.transmuxedPresentationEnd<t)return null;if(t>i){if(t>i+o.duration*uI)return null;n=o}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}},D4=(t,e)=>{let i,n;try{i=new Date(t),n=new Date(e)}catch{}const o=i.getTime();return(n.getTime()-o)/1e3},P4=t=>{if(!t.segments||t.segments.length===0)return!1;for(let e=0;e<t.segments.length;e++)if(!t.segments[e].dateTimeObject)return!1;return!0},L4=({playlist:t,time:e=void 0,callback:i})=>{if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||e===void 0)return i({message:"getProgramTime: playlist and time must be provided"});const n=O4(e,t);if(!n)return i({message:"valid programTime was not found"});if(n.type==="estimate")return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:n.estimatedStart});const o={mediaSeconds:e},u=A4(e,n.segment);return u&&(o.programDateTime=u.toISOString()),i(null,o)},cI=({programTime:t,playlist:e,retryCount:i=2,seekTo:n,pauseAfterSeek:o=!0,tech:u,callback:c})=>{if(!c)throw new Error("seekToProgramTime: callback must be provided");if(typeof t>"u"||!e||!n)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!u.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!P4(e))return c({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const h=I4(t,e);if(!h)return c({message:`${t} was not found in the stream`});const m=h.segment,v=D4(m.dateTimeObject,t);if(h.type==="estimate"){if(i===0)return c({message:`${t} is not buffered yet. Try again`});n(h.estimatedStart+v),u.one("seeked",()=>{cI({programTime:t,playlist:e,retryCount:i-1,seekTo:n,pauseAfterSeek:o,tech:u,callback:c})});return}const T=m.start+v,O=()=>c(null,u.currentTime());u.one("seeked",O),o&&u.pause(),n(T)},Xy=(t,e)=>{if(t.readyState===4)return e()},N4=(t,e,i)=>{let n=[],o,u=!1;const c=function(T,O,R,M){return O.abort(),u=!0,i(T,O,R,M)},h=function(T,O){if(u)return;if(T)return c(T,O,"",n);const R=O.responseText.substring(n&&n.byteLength||0,O.responseText.length);if(n=qB(n,q1(R,!0)),o=o||zd(n),n.length<10||o&&n.length<o+2)return Xy(O,()=>c(T,O,"",n));const M=Vv(n);return M==="ts"&&n.length<188?Xy(O,()=>c(T,O,"",n)):!M&&n.length<376?Xy(O,()=>c(T,O,"",n)):c(null,O,M,n)},v=e({uri:t,beforeSend(T){T.overrideMimeType("text/plain; charset=x-user-defined"),T.addEventListener("progress",function({total:O,loaded:R}){return M0(T,null,{statusCode:T.status},h)})}},function(T,O){return M0(v,T,O,h)});return v},{EventTarget:R4}=he,bw=function(t,e){if(!nI(t,e)||t.sidx&&e.sidx&&(t.sidx.offset!==e.sidx.offset||t.sidx.length!==e.sidx.length))return!1;if(!t.sidx&&e.sidx||t.sidx&&!e.sidx||t.segments&&!e.segments||!t.segments&&e.segments)return!1;if(!t.segments&&!e.segments)return!0;for(let i=0;i<t.segments.length;i++){const n=t.segments[i],o=e.segments[i];if(n.uri!==o.uri)return!1;if(!n.byterange&&!o.byterange)continue;const u=n.byterange,c=o.byterange;if(u&&!c||!u&&c||u.offset!==c.offset||u.length!==c.length)return!1}return!0},M4=({mainXml:t,srcUrl:e,clientOffset:i,sidxMapping:n,previousManifest:o})=>{const u=d$(t,{manifestUri:e,clientOffset:i,sidxMapping:n,previousManifest:o});return tI(u,e),u},U4=(t,e,i)=>{let n=!0,o=ui(t,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let u=0;u<e.playlists.length;u++){const c=e.playlists[u];if(c.sidx){const m=ig(c.sidx);i&&i[m]&&i[m].sidx&&Fv(c,i[m].sidx,c.sidx.resolvedUri)}const h=N0(o,c,bw);h&&(o=h,n=!1)}return jh(e,(u,c,h,m)=>{if(u.playlists&&u.playlists.length){const v=u.playlists[0].id,T=N0(o,u.playlists[0],bw);T&&(o=T,o.mediaGroups[c][h][m].playlists[0]=o.playlists[v],n=!1)}}),e.minimumUpdatePeriod!==t.minimumUpdatePeriod&&(n=!1),n?null:o},B4=(t,e)=>(Boolean(!t.map&&!e.map)||Boolean(t.map&&e.map&&t.map.byterange.offset===e.map.byterange.offset&&t.map.byterange.length===e.map.byterange.length))&&t.uri===e.uri&&t.byterange.offset===e.byterange.offset&&t.byterange.length===e.byterange.length,Ew=(t,e)=>{const i={};for(const n in t){const u=t[n].sidx;if(u){const c=ig(u);if(!e[c])break;const h=e[c].sidxInfo;B4(h,u)&&(i[c]=e[c])}}return i},F4=(t,e)=>{let n=Ew(t.playlists,e);return jh(t,(o,u,c,h)=>{if(o.playlists&&o.playlists.length){const m=o.playlists;n=ui(n,Ew(m,e))}}),n};class B0 extends R4{constructor(e,i,n={},o){super(),this.mainPlaylistLoader_=o||this,o||(this.isMain_=!0);const{withCredentials:u=!1}=n;if(this.vhs_=i,this.withCredentials=u,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=or("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,i,n){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2},n&&(this.state=n),this.trigger("error"),!0}addSidxSegments_(e,i,n){const o=e.sidx&&ig(e.sidx);if(!e.sidx||!o||this.mainPlaylistLoader_.sidxMapping_[o]){this.mediaRequest_=Z.setTimeout(()=>n(!1),0);return}const u=Dm(e.sidx.resolvedUri),c=(h,m)=>{if(this.requestErrored_(h,m,i))return;const v=this.mainPlaylistLoader_.sidxMapping_;let T;try{T=g$(ht(m.response).subarray(8))}catch(O){this.requestErrored_(O,m,i);return}return v[o]={sidxInfo:e.sidx,sidx:T},Fv(e,T,e.sidx.resolvedUri),n(!0)};this.request=N4(u,this.vhs_.xhr,(h,m,v,T)=>{if(h)return c(h,m);if(!v||v!=="mp4")return c({status:m.status,message:`Unsupported ${v||"unknown"} container type for sidx segment at URL: ${u}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},m);const{offset:O,length:R}=e.sidx.byterange;if(T.length>=R+O)return c(h,{response:T.subarray(O,O+R),status:m.status,uri:m.uri});this.request=this.vhs_.xhr({uri:u,responseType:"arraybuffer",headers:U0({byterange:e.sidx.byterange})},c)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},Z.clearTimeout(this.minimumUpdatePeriodTimeout_),Z.clearTimeout(this.mediaRequest_),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const n=!this.media_||e.id!==this.media_.id;if(n&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,n&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}n&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,i,o=>{this.haveMetadata({startingState:i,playlist:e})}))}haveMetadata({startingState:e,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(Z.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const i=this.media();if(e){const n=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(()=>this.load(),n);return}if(!this.started){this.start();return}i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=Z.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,i)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(i,n)=>{if(this.requestErrored_(i,n)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const o=n.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?this.mainLoaded_=Date.parse(n.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Dm(this.mainPlaylistLoader_.srcUrl,n),o){this.handleMain_(),this.syncClientServerClock_(()=>e(n,o));return}return e(n,o)})}syncClientServerClock_(e){const i=h$(this.mainPlaylistLoader_.mainXml_);if(i===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(i.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),e();this.request=this.vhs_.xhr({uri:Qn(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(n,o)=>{if(!this.request)return;if(n)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let u;i.method==="HEAD"?!o.responseHeaders||!o.responseHeaders.date?u=this.mainLoaded_:u=Date.parse(o.responseHeaders.date):u=Date.parse(o.responseText),this.mainPlaylistLoader_.clientOffset_=u-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let i=M4({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(i=U4(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const n=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return n&&n!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=n),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(i)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(Z.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let i=e.main&&e.main.minimumUpdatePeriod;if(i===0&&(e.media()?i=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof i!="number"||i<=0){i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`);return}this.createMUPTimeout_(i)}createMUPTimeout_(e){const i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=Z.setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,i)=>{i&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=F4(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,n=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const i=this.mainPlaylistLoader_.main.playlists,n=!this.media_||this.media_!==i[e];if(n?this.media_=i[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const o=()=>{this.media().endList||(this.mediaUpdateTimeout=Z.setTimeout(()=>{this.trigger("mediaupdatetimeout"),o()},R0(this.media(),Boolean(n))))};o()}this.trigger("loadedplaylist")}}var Ji={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const $4=t=>{const e=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e.buffer},dI=function(t){return t.on=t.addEventListener,t.off=t.removeEventListener,t},j4=function(t){try{return URL.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch{const i=new BlobBuilder;return i.append(t),URL.createObjectURL(i.getBlob())}},hI=function(t){return function(){const e=j4(t),i=dI(new Worker(e));i.objURL=e;const n=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),n.call(this)},i}},fI=function(t){return`var browserWorkerPolyFill = ${dI.toString()};
browserWorkerPolyFill(self);
`+t},pI=function(t){return t.toString().replace(/^function.+?{/,"").slice(0,-1)},H4=fI(pI(function(){var t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var g={};this.on=function(b,w){g[b]||(g[b]=[]),g[b]=g[b].concat(w)},this.off=function(b,w){var x;return g[b]?(x=g[b].indexOf(w),g[b]=g[b].slice(),g[b].splice(x,1),x>-1):!1},this.trigger=function(b){var w,x,I,N;if(w=g[b],!!w)if(arguments.length===2)for(I=w.length,x=0;x<I;++x)w[x].call(this,arguments[1]);else{for(N=[],x=arguments.length,x=1;x<arguments.length;++x)N.push(arguments[x]);for(I=w.length,x=0;x<I;++x)w[x].apply(this,N)}},this.dispose=function(){g={}}}};e.prototype.pipe=function(g){return this.on("data",function(b){g.push(b)}),this.on("done",function(b){g.flush(b)}),this.on("partialdone",function(b){g.partialFlush(b)}),this.on("endedtimeline",function(b){g.endTimeline(b)}),this.on("reset",function(b){g.reset(b)}),g},e.prototype.push=function(g){this.trigger("data",g)},e.prototype.flush=function(g){this.trigger("done",g)},e.prototype.partialFlush=function(g){this.trigger("partialdone",g)},e.prototype.endTimeline=function(g){this.trigger("endedtimeline",g)},e.prototype.reset=function(g){this.trigger("reset",g)};var i=e,n=Math.pow(2,32),o=function(g){var b=new DataView(g.buffer,g.byteOffset,g.byteLength),w;return b.getBigUint64?(w=b.getBigUint64(0),w<Number.MAX_SAFE_INTEGER?Number(w):w):b.getUint32(0)*n+b.getUint32(4)},u={getUint64:o,MAX_UINT32:n},c=u.MAX_UINT32,h,m,v,T,O,R,M,z,j,q,W,ee,se,re,ie,ye,Pe,Ie,Be,Ve,We,it,Le,ct,Ht,Qe,Ze,_t,Vt,mi,ei,Ft,Mt,Qt,be,He;(function(){var g;if(Le={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(g in Le)Le.hasOwnProperty(g)&&(Le[g]=[g.charCodeAt(0),g.charCodeAt(1),g.charCodeAt(2),g.charCodeAt(3)]);ct=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Qe=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Ht=new Uint8Array([0,0,0,1]),Ze=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),_t=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Vt={video:Ze,audio:_t},Ft=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ei=new Uint8Array([0,0,0,0,0,0,0,0]),Mt=new Uint8Array([0,0,0,0,0,0,0,0]),Qt=Mt,be=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),He=Mt,mi=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),h=function(g){var b=[],w=0,x,I,N;for(x=1;x<arguments.length;x++)b.push(arguments[x]);for(x=b.length;x--;)w+=b[x].byteLength;for(I=new Uint8Array(w+8),N=new DataView(I.buffer,I.byteOffset,I.byteLength),N.setUint32(0,I.byteLength),I.set(g,4),x=0,w=8;x<b.length;x++)I.set(b[x],w),w+=b[x].byteLength;return I},m=function(){return h(Le.dinf,h(Le.dref,Ft))},v=function(g){return h(Le.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,g.audioobjecttype<<3|g.samplingfrequencyindex>>>1,g.samplingfrequencyindex<<7|g.channelcount<<3,6,1,2]))},T=function(){return h(Le.ftyp,ct,Ht,ct,Qe)},ye=function(g){return h(Le.hdlr,Vt[g])},O=function(g){return h(Le.mdat,g)},ie=function(g){var b=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,g.duration>>>24&255,g.duration>>>16&255,g.duration>>>8&255,g.duration&255,85,196,0,0]);return g.samplerate&&(b[12]=g.samplerate>>>24&255,b[13]=g.samplerate>>>16&255,b[14]=g.samplerate>>>8&255,b[15]=g.samplerate&255),h(Le.mdhd,b)},re=function(g){return h(Le.mdia,ie(g),ye(g.type),M(g))},R=function(g){return h(Le.mfhd,new Uint8Array([0,0,0,0,(g&4278190080)>>24,(g&16711680)>>16,(g&65280)>>8,g&255]))},M=function(g){return h(Le.minf,g.type==="video"?h(Le.vmhd,mi):h(Le.smhd,ei),m(),Ie(g))},z=function(g,b){for(var w=[],x=b.length;x--;)w[x]=Ve(b[x]);return h.apply(null,[Le.moof,R(g)].concat(w))},j=function(g){for(var b=g.length,w=[];b--;)w[b]=ee(g[b]);return h.apply(null,[Le.moov,W(4294967295)].concat(w).concat(q(g)))},q=function(g){for(var b=g.length,w=[];b--;)w[b]=We(g[b]);return h.apply(null,[Le.mvex].concat(w))},W=function(g){var b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(g&4278190080)>>24,(g&16711680)>>16,(g&65280)>>8,g&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h(Le.mvhd,b)},Pe=function(g){var b=g.samples||[],w=new Uint8Array(4+b.length),x,I;for(I=0;I<b.length;I++)x=b[I].flags,w[I+4]=x.dependsOn<<4|x.isDependedOn<<2|x.hasRedundancy;return h(Le.sdtp,w)},Ie=function(g){return h(Le.stbl,Be(g),h(Le.stts,He),h(Le.stsc,Qt),h(Le.stsz,be),h(Le.stco,Mt))},function(){var g,b;Be=function(w){return h(Le.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),w.type==="video"?g(w):b(w))},g=function(w){var x=w.sps||[],I=w.pps||[],N=[],$=[],V,Y;for(V=0;V<x.length;V++)N.push((x[V].byteLength&65280)>>>8),N.push(x[V].byteLength&255),N=N.concat(Array.prototype.slice.call(x[V]));for(V=0;V<I.length;V++)$.push((I[V].byteLength&65280)>>>8),$.push(I[V].byteLength&255),$=$.concat(Array.prototype.slice.call(I[V]));if(Y=[Le.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(w.width&65280)>>8,w.width&255,(w.height&65280)>>8,w.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h(Le.avcC,new Uint8Array([1,w.profileIdc,w.profileCompatibility,w.levelIdc,255].concat([x.length],N,[I.length],$))),h(Le.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],w.sarRatio){var J=w.sarRatio[0],le=w.sarRatio[1];Y.push(h(Le.pasp,new Uint8Array([(J&4278190080)>>24,(J&16711680)>>16,(J&65280)>>8,J&255,(le&4278190080)>>24,(le&16711680)>>16,(le&65280)>>8,le&255])))}return h.apply(null,Y)},b=function(w){return h(Le.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(w.channelcount&65280)>>8,w.channelcount&255,(w.samplesize&65280)>>8,w.samplesize&255,0,0,0,0,(w.samplerate&65280)>>8,w.samplerate&255,0,0]),v(w))}}(),se=function(g){var b=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,0,(g.duration&4278190080)>>24,(g.duration&16711680)>>16,(g.duration&65280)>>8,g.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(g.width&65280)>>8,g.width&255,0,0,(g.height&65280)>>8,g.height&255,0,0]);return h(Le.tkhd,b)},Ve=function(g){var b,w,x,I,N,$,V;return b=h(Le.tfhd,new Uint8Array([0,0,0,58,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),$=Math.floor(g.baseMediaDecodeTime/c),V=Math.floor(g.baseMediaDecodeTime%c),w=h(Le.tfdt,new Uint8Array([1,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255,V>>>24&255,V>>>16&255,V>>>8&255,V&255])),N=32+20+8+16+8+8,g.type==="audio"?(x=it(g,N),h(Le.traf,b,w,x)):(I=Pe(g),x=it(g,I.length+N),h(Le.traf,b,w,x,I))},ee=function(g){return g.duration=g.duration||4294967295,h(Le.trak,se(g),re(g))},We=function(g){var b=new Uint8Array([0,0,0,0,(g.id&4278190080)>>24,(g.id&16711680)>>16,(g.id&65280)>>8,g.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return g.type!=="video"&&(b[b.length-1]=0),h(Le.trex,b)},function(){var g,b,w;w=function(x,I){var N=0,$=0,V=0,Y=0;return x.length&&(x[0].duration!==void 0&&(N=1),x[0].size!==void 0&&($=2),x[0].flags!==void 0&&(V=4),x[0].compositionTimeOffset!==void 0&&(Y=8)),[0,0,N|$|V|Y,1,(x.length&4278190080)>>>24,(x.length&16711680)>>>16,(x.length&65280)>>>8,x.length&255,(I&4278190080)>>>24,(I&16711680)>>>16,(I&65280)>>>8,I&255]},b=function(x,I){var N,$,V,Y,J,le;for(Y=x.samples||[],I+=8+12+16*Y.length,V=w(Y,I),$=new Uint8Array(V.length+Y.length*16),$.set(V),N=V.length,le=0;le<Y.length;le++)J=Y[le],$[N++]=(J.duration&4278190080)>>>24,$[N++]=(J.duration&16711680)>>>16,$[N++]=(J.duration&65280)>>>8,$[N++]=J.duration&255,$[N++]=(J.size&4278190080)>>>24,$[N++]=(J.size&16711680)>>>16,$[N++]=(J.size&65280)>>>8,$[N++]=J.size&255,$[N++]=J.flags.isLeading<<2|J.flags.dependsOn,$[N++]=J.flags.isDependedOn<<6|J.flags.hasRedundancy<<4|J.flags.paddingValue<<1|J.flags.isNonSyncSample,$[N++]=J.flags.degradationPriority&240<<8,$[N++]=J.flags.degradationPriority&15,$[N++]=(J.compositionTimeOffset&4278190080)>>>24,$[N++]=(J.compositionTimeOffset&16711680)>>>16,$[N++]=(J.compositionTimeOffset&65280)>>>8,$[N++]=J.compositionTimeOffset&255;return h(Le.trun,$)},g=function(x,I){var N,$,V,Y,J,le;for(Y=x.samples||[],I+=8+12+8*Y.length,V=w(Y,I),N=new Uint8Array(V.length+Y.length*8),N.set(V),$=V.length,le=0;le<Y.length;le++)J=Y[le],N[$++]=(J.duration&4278190080)>>>24,N[$++]=(J.duration&16711680)>>>16,N[$++]=(J.duration&65280)>>>8,N[$++]=J.duration&255,N[$++]=(J.size&4278190080)>>>24,N[$++]=(J.size&16711680)>>>16,N[$++]=(J.size&65280)>>>8,N[$++]=J.size&255;return h(Le.trun,N)},it=function(x,I){return x.type==="audio"?g(x,I):b(x,I)}}();var Ue={ftyp:T,mdat:O,moof:z,moov:j,initSegment:function(g){var b=T(),w=j(g),x;return x=new Uint8Array(b.byteLength+w.byteLength),x.set(b),x.set(w,b.byteLength),x}},Xe=function(g){var b,w,x=[],I=[];for(I.byteLength=0,I.nalCount=0,I.duration=0,x.byteLength=0,b=0;b<g.length;b++)w=g[b],w.nalUnitType==="access_unit_delimiter_rbsp"?(x.length&&(x.duration=w.dts-x.dts,I.byteLength+=x.byteLength,I.nalCount+=x.length,I.duration+=x.duration,I.push(x)),x=[w],x.byteLength=w.data.byteLength,x.pts=w.pts,x.dts=w.dts):(w.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(x.keyFrame=!0),x.duration=w.dts-x.dts,x.byteLength+=w.data.byteLength,x.push(w));return I.length&&(!x.duration||x.duration<=0)&&(x.duration=I[I.length-1].duration),I.byteLength+=x.byteLength,I.nalCount+=x.length,I.duration+=x.duration,I.push(x),I},Ct=function(g){var b,w,x=[],I=[];for(x.byteLength=0,x.nalCount=0,x.duration=0,x.pts=g[0].pts,x.dts=g[0].dts,I.byteLength=0,I.nalCount=0,I.duration=0,I.pts=g[0].pts,I.dts=g[0].dts,b=0;b<g.length;b++)w=g[b],w.keyFrame?(x.length&&(I.push(x),I.byteLength+=x.byteLength,I.nalCount+=x.nalCount,I.duration+=x.duration),x=[w],x.nalCount=w.length,x.byteLength=w.byteLength,x.pts=w.pts,x.dts=w.dts,x.duration=w.duration):(x.duration+=w.duration,x.nalCount+=w.length,x.byteLength+=w.byteLength,x.push(w));return I.length&&x.duration<=0&&(x.duration=I[I.length-1].duration),I.byteLength+=x.byteLength,I.nalCount+=x.nalCount,I.duration+=x.duration,I.push(x),I},Jt=function(g){var b;return!g[0][0].keyFrame&&g.length>1&&(b=g.shift(),g.byteLength-=b.byteLength,g.nalCount-=b.nalCount,g[0][0].dts=b.dts,g[0][0].pts=b.pts,g[0][0].duration+=b.duration),g},je=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},X=function(g,b){var w=je();return w.dataOffset=b,w.compositionTimeOffset=g.pts-g.dts,w.duration=g.duration,w.size=4*g.length,w.size+=g.byteLength,g.keyFrame&&(w.flags.dependsOn=2,w.flags.isNonSyncSample=0),w},ne=function(g,b){var w,x,I,N,$,V=b||0,Y=[];for(w=0;w<g.length;w++)for(N=g[w],x=0;x<N.length;x++)$=N[x],I=X($,V),V+=I.size,Y.push(I);return Y},pe=function(g){var b,w,x,I,N,$,V=0,Y=g.byteLength,J=g.nalCount,le=Y+4*J,me=new Uint8Array(le),Ke=new DataView(me.buffer);for(b=0;b<g.length;b++)for(I=g[b],w=0;w<I.length;w++)for(N=I[w],x=0;x<N.length;x++)$=N[x],Ke.setUint32(V,$.data.byteLength),V+=4,me.set($.data,V),V+=$.data.byteLength;return me},_e=function(g,b){var w,x=b||0,I=[];return w=X(g,x),I.push(w),I},Ce=function(g){var b,w,x=0,I=g.byteLength,N=g.length,$=I+4*N,V=new Uint8Array($),Y=new DataView(V.buffer);for(b=0;b<g.length;b++)w=g[b],Y.setUint32(x,w.data.byteLength),x+=4,V.set(w.data,x),x+=w.data.byteLength;return V},Re={groupNalsIntoFrames:Xe,groupFramesIntoGops:Ct,extendFirstKeyFrame:Jt,generateSampleTable:ne,concatenateNalData:pe,generateSampleTableForFrame:_e,concatenateNalDataForFrame:Ce},Fe=[33,16,5,32,164,27],Oe=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Se=function(g){for(var b=[];g--;)b.push(0);return b},ke=function(g){return Object.keys(g).reduce(function(b,w){return b[w]=new Uint8Array(g[w].reduce(function(x,I){return x.concat(I)},[])),b},{})},et,Je=function(){if(!et){var g={96e3:[Fe,[227,64],Se(154),[56]],88200:[Fe,[231],Se(170),[56]],64e3:[Fe,[248,192],Se(240),[56]],48e3:[Fe,[255,192],Se(268),[55,148,128],Se(54),[112]],44100:[Fe,[255,192],Se(268),[55,163,128],Se(84),[112]],32e3:[Fe,[255,192],Se(268),[55,234],Se(226),[112]],24e3:[Fe,[255,192],Se(268),[55,255,128],Se(268),[111,112],Se(126),[224]],16e3:[Fe,[255,192],Se(268),[55,255,128],Se(268),[111,255],Se(269),[223,108],Se(195),[1,192]],12e3:[Oe,Se(268),[3,127,248],Se(268),[6,255,240],Se(268),[13,255,224],Se(268),[27,253,128],Se(259),[56]],11025:[Oe,Se(268),[3,127,248],Se(268),[6,255,240],Se(268),[13,255,224],Se(268),[27,255,192],Se(268),[55,175,128],Se(108),[112]],8e3:[Oe,Se(268),[3,121,16],Se(47),[7]]};et=ke(g)}return et},tt=9e4,rt,mt,Dt,Pt,ai,es,en;rt=function(g){return g*tt},mt=function(g,b){return g*b},Dt=function(g){return g/tt},Pt=function(g,b){return g/b},ai=function(g,b){return rt(Pt(g,b))},es=function(g,b){return mt(Dt(g),b)},en=function(g,b,w){return Dt(w?g:g-b)};var Xt={ONE_SECOND_IN_TS:tt,secondsToVideoTs:rt,secondsToAudioTs:mt,videoTsToSeconds:Dt,audioTsToSeconds:Pt,audioTsToVideoTs:ai,videoTsToAudioTs:es,metadataTsToSeconds:en},tn=Je,us=Xt,Gi=function(g){var b,w,x=0;for(b=0;b<g.length;b++)w=g[b],x+=w.data.byteLength;return x},Fi=function(g,b,w,x){var I,N=0,$=0,V=0,Y=0,J,le,me;if(b.length&&(I=us.audioTsToVideoTs(g.baseMediaDecodeTime,g.samplerate),N=Math.ceil(us.ONE_SECOND_IN_TS/(g.samplerate/1024)),w&&x&&($=I-Math.max(w,x),V=Math.floor($/N),Y=V*N),!(V<1||Y>us.ONE_SECOND_IN_TS/2))){for(J=tn()[g.samplerate],J||(J=b[0].data),le=0;le<V;le++)me=b[0],b.splice(0,0,{data:J,dts:me.dts-N,pts:me.pts-N});return g.baseMediaDecodeTime-=Math.floor(us.videoTsToAudioTs(Y,g.samplerate)),Y}},co=function(g,b,w){return b.minSegmentDts>=w?g:(b.minSegmentDts=1/0,g.filter(function(x){return x.dts>=w?(b.minSegmentDts=Math.min(b.minSegmentDts,x.dts),b.minSegmentPts=b.minSegmentDts,!0):!1}))},qh=function(g){var b,w,x=[];for(b=0;b<g.length;b++)w=g[b],x.push({size:w.data.byteLength,duration:1024});return x},Ec=function(g){var b,w,x=0,I=new Uint8Array(Gi(g));for(b=0;b<g.length;b++)w=g[b],I.set(w.data,x),x+=w.data.byteLength;return I},Ng={prefixWithSilence:Fi,trimAdtsFramesByEarliestDts:co,generateSampleTable:qh,concatenateFrameData:Ec},Sc=Xt.ONE_SECOND_IN_TS,xc=function(g,b){typeof b.pts=="number"&&(g.timelineStartInfo.pts===void 0&&(g.timelineStartInfo.pts=b.pts),g.minSegmentPts===void 0?g.minSegmentPts=b.pts:g.minSegmentPts=Math.min(g.minSegmentPts,b.pts),g.maxSegmentPts===void 0?g.maxSegmentPts=b.pts:g.maxSegmentPts=Math.max(g.maxSegmentPts,b.pts)),typeof b.dts=="number"&&(g.timelineStartInfo.dts===void 0&&(g.timelineStartInfo.dts=b.dts),g.minSegmentDts===void 0?g.minSegmentDts=b.dts:g.minSegmentDts=Math.min(g.minSegmentDts,b.dts),g.maxSegmentDts===void 0?g.maxSegmentDts=b.dts:g.maxSegmentDts=Math.max(g.maxSegmentDts,b.dts))},Wh=function(g){delete g.minSegmentDts,delete g.maxSegmentDts,delete g.minSegmentPts,delete g.maxSegmentPts},Gh=function(g,b){var w,x,I=g.minSegmentDts;return b||(I-=g.timelineStartInfo.dts),w=g.timelineStartInfo.baseMediaDecodeTime,w+=I,w=Math.max(0,w),g.type==="audio"&&(x=g.samplerate/Sc,w*=x,w=Math.floor(w)),w},ts={clearDtsInfo:Wh,calculateTrackBaseMediaDecodeTime:Gh,collectDtsInfo:xc},sn=4,zh=128,wc=function(g){for(var b=0,w={payloadType:-1,payloadSize:0},x=0,I=0;b<g.byteLength&&g[b]!==zh;){for(;g[b]===255;)x+=255,b++;for(x+=g[b++];g[b]===255;)I+=255,b++;if(I+=g[b++],!w.payload&&x===sn){var N=String.fromCharCode(g[b+3],g[b+4],g[b+5],g[b+6]);if(N==="GA94"){w.payloadType=x,w.payloadSize=I,w.payload=g.subarray(b,b+I);break}else w.payload=void 0}b+=I,x=0,I=0}return w},hl=function(g){return g.payload[0]!==181||(g.payload[1]<<8|g.payload[2])!==49||String.fromCharCode(g.payload[3],g.payload[4],g.payload[5],g.payload[6])!=="GA94"||g.payload[7]!==3?null:g.payload.subarray(8,g.payload.length-1)},fl=function(g,b){var w=[],x,I,N,$;if(!(b[0]&64))return w;for(I=b[0]&31,x=0;x<I;x++)N=x*3,$={type:b[N+2]&3,pts:g},b[N+2]&4&&($.ccData=b[N+3]<<8|b[N+4],w.push($));return w},Rg=function(g){for(var b=g.byteLength,w=[],x=1,I,N;x<b-2;)g[x]===0&&g[x+1]===0&&g[x+2]===3?(w.push(x+2),x+=2):x++;if(w.length===0)return g;I=b-w.length,N=new Uint8Array(I);var $=0;for(x=0;x<I;$++,x++)$===w[0]&&($++,w.shift()),N[x]=g[$];return N},cs={parseSei:wc,parseUserData:hl,parseCaptionPackets:fl,discardEmulationPreventionBytes:Rg,USER_DATA_REGISTERED_ITU_T_T35:sn},Ri=i,Rn=cs,$i=function(g){g=g||{},$i.prototype.init.call(this),this.parse708captions_=typeof g.parse708captions=="boolean"?g.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new ti(0,0),new ti(0,1),new ti(1,0),new ti(1,1)],this.parse708captions_&&(this.cc708Stream_=new qt({captionServices:g.captionServices})),this.reset(),this.ccStreams_.forEach(function(b){b.on("data",this.trigger.bind(this,"data")),b.on("partialdone",this.trigger.bind(this,"partialdone")),b.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};$i.prototype=new Ri,$i.prototype.push=function(g){var b,w,x;if(g.nalUnitType==="sei_rbsp"&&(b=Rn.parseSei(g.escapedRBSP),!!b.payload&&b.payloadType===Rn.USER_DATA_REGISTERED_ITU_T_T35&&(w=Rn.parseUserData(b),!!w))){if(g.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(g.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}x=Rn.parseCaptionPackets(g.pts,w),this.captionPackets_=this.captionPackets_.concat(x),this.latestDts_!==g.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=g.dts}},$i.prototype.flushCCStreams=function(g){this.ccStreams_.forEach(function(b){return g==="flush"?b.flush():b.partialFlush()},this)},$i.prototype.flushStream=function(g){if(!this.captionPackets_.length){this.flushCCStreams(g);return}this.captionPackets_.forEach(function(b,w){b.presortIndex=w}),this.captionPackets_.sort(function(b,w){return b.pts===w.pts?b.presortIndex-w.presortIndex:b.pts-w.pts}),this.captionPackets_.forEach(function(b){b.type<2?this.dispatchCea608Packet(b):this.dispatchCea708Packet(b)},this),this.captionPackets_.length=0,this.flushCCStreams(g)},$i.prototype.flush=function(){return this.flushStream("flush")},$i.prototype.partialFlush=function(){return this.flushStream("partialFlush")},$i.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(g){g.reset()})},$i.prototype.dispatchCea608Packet=function(g){this.setsTextOrXDSActive(g)?this.activeCea608Channel_[g.type]=null:this.setsChannel1Active(g)?this.activeCea608Channel_[g.type]=0:this.setsChannel2Active(g)&&(this.activeCea608Channel_[g.type]=1),this.activeCea608Channel_[g.type]!==null&&this.ccStreams_[(g.type<<1)+this.activeCea608Channel_[g.type]].push(g)},$i.prototype.setsChannel1Active=function(g){return(g.ccData&30720)===4096},$i.prototype.setsChannel2Active=function(g){return(g.ccData&30720)===6144},$i.prototype.setsTextOrXDSActive=function(g){return(g.ccData&28928)===256||(g.ccData&30974)===4138||(g.ccData&30974)===6186},$i.prototype.dispatchCea708Packet=function(g){this.parse708captions_&&this.cc708Stream_.push(g)};var Cc={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Mg=function(g){var b=Cc[g]||g;return g&4096&&g===b?"":String.fromCharCode(b)},Yt=function(g){return 32<=g&&g<=127||160<=g&&g<=255},Mi=function(g){this.windowNum=g,this.reset()};Mi.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Mi.prototype.getText=function(){return this.rows.join(`
`)},Mi.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Mi.prototype.newLine=function(g){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(g),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Mi.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Mi.prototype.addText=function(g){this.rows[this.rowIdx]+=g},Mi.prototype.backspace=function(){if(!this.isEmpty()){var g=this.rows[this.rowIdx];this.rows[this.rowIdx]=g.substr(0,g.length-1)}};var ho=function(g,b,w){this.serviceNum=g,this.text="",this.currentWindow=new Mi(-1),this.windows=[],this.stream=w,typeof b=="string"&&this.createTextDecoder(b)};ho.prototype.init=function(g,b){this.startPts=g;for(var w=0;w<8;w++)this.windows[w]=new Mi(w),typeof b=="function"&&(this.windows[w].beforeRowOverflow=b)},ho.prototype.setCurrentWindow=function(g){this.currentWindow=this.windows[g]},ho.prototype.createTextDecoder=function(g){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(g)}catch(b){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+g+" encoding. "+b})}};var qt=function(g){g=g||{},qt.prototype.init.call(this);var b=this,w=g.captionServices||{},x={},I;Object.keys(w).forEach(N=>{I=w[N],/^SERVICE/.test(N)&&(x[N]=I.encoding)}),this.serviceEncodings=x,this.current708Packet=null,this.services={},this.push=function(N){N.type===3?(b.new708Packet(),b.add708Bytes(N)):(b.current708Packet===null&&b.new708Packet(),b.add708Bytes(N))}};qt.prototype=new Ri,qt.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},qt.prototype.add708Bytes=function(g){var b=g.ccData,w=b>>>8,x=b&255;this.current708Packet.ptsVals.push(g.pts),this.current708Packet.data.push(w),this.current708Packet.data.push(x)},qt.prototype.push708Packet=function(){var g=this.current708Packet,b=g.data,w=null,x=null,I=0,N=b[I++];for(g.seq=N>>6,g.sizeCode=N&63;I<b.length;I++)N=b[I++],w=N>>5,x=N&31,w===7&&x>0&&(N=b[I++],w=N),this.pushServiceBlock(w,I,x),x>0&&(I+=x-1)},qt.prototype.pushServiceBlock=function(g,b,w){var x,I=b,N=this.current708Packet.data,$=this.services[g];for($||($=this.initService(g,I));I<b+w&&I<N.length;I++)x=N[I],Yt(x)?I=this.handleText(I,$):x===24?I=this.multiByteCharacter(I,$):x===16?I=this.extendedCommands(I,$):128<=x&&x<=135?I=this.setCurrentWindow(I,$):152<=x&&x<=159?I=this.defineWindow(I,$):x===136?I=this.clearWindows(I,$):x===140?I=this.deleteWindows(I,$):x===137?I=this.displayWindows(I,$):x===138?I=this.hideWindows(I,$):x===139?I=this.toggleWindows(I,$):x===151?I=this.setWindowAttributes(I,$):x===144?I=this.setPenAttributes(I,$):x===145?I=this.setPenColor(I,$):x===146?I=this.setPenLocation(I,$):x===143?$=this.reset(I,$):x===8?$.currentWindow.backspace():x===12?$.currentWindow.clearText():x===13?$.currentWindow.pendingNewLine=!0:x===14?$.currentWindow.clearText():x===141&&I++},qt.prototype.extendedCommands=function(g,b){var w=this.current708Packet.data,x=w[++g];return Yt(x)&&(g=this.handleText(g,b,{isExtended:!0})),g},qt.prototype.getPts=function(g){return this.current708Packet.ptsVals[Math.floor(g/2)]},qt.prototype.initService=function(g,b){var x="SERVICE"+g,w=this,x,I;return x in this.serviceEncodings&&(I=this.serviceEncodings[x]),this.services[g]=new ho(g,I,w),this.services[g].init(this.getPts(b),function(N){w.flushDisplayed(N,w.services[g])}),this.services[g]},qt.prototype.handleText=function(g,b,w){var x=w&&w.isExtended,I=w&&w.isMultiByte,N=this.current708Packet.data,$=x?4096:0,V=N[g],Y=N[g+1],J=b.currentWindow,le,me;return b.textDecoder_&&!x?(I?(me=[V,Y],g++):me=[V],le=b.textDecoder_.decode(new Uint8Array(me))):le=Mg($|V),J.pendingNewLine&&!J.isEmpty()&&J.newLine(this.getPts(g)),J.pendingNewLine=!1,J.addText(le),g},qt.prototype.multiByteCharacter=function(g,b){var w=this.current708Packet.data,x=w[g+1],I=w[g+2];return Yt(x)&&Yt(I)&&(g=this.handleText(++g,b,{isMultiByte:!0})),g},qt.prototype.setCurrentWindow=function(g,b){var w=this.current708Packet.data,x=w[g],I=x&7;return b.setCurrentWindow(I),g},qt.prototype.defineWindow=function(g,b){var w=this.current708Packet.data,x=w[g],I=x&7;b.setCurrentWindow(I);var N=b.currentWindow;return x=w[++g],N.visible=(x&32)>>5,N.rowLock=(x&16)>>4,N.columnLock=(x&8)>>3,N.priority=x&7,x=w[++g],N.relativePositioning=(x&128)>>7,N.anchorVertical=x&127,x=w[++g],N.anchorHorizontal=x,x=w[++g],N.anchorPoint=(x&240)>>4,N.rowCount=x&15,x=w[++g],N.columnCount=x&63,x=w[++g],N.windowStyle=(x&56)>>3,N.penStyle=x&7,N.virtualRowCount=N.rowCount+1,g},qt.prototype.setWindowAttributes=function(g,b){var w=this.current708Packet.data,x=w[g],I=b.currentWindow.winAttr;return x=w[++g],I.fillOpacity=(x&192)>>6,I.fillRed=(x&48)>>4,I.fillGreen=(x&12)>>2,I.fillBlue=x&3,x=w[++g],I.borderType=(x&192)>>6,I.borderRed=(x&48)>>4,I.borderGreen=(x&12)>>2,I.borderBlue=x&3,x=w[++g],I.borderType+=(x&128)>>5,I.wordWrap=(x&64)>>6,I.printDirection=(x&48)>>4,I.scrollDirection=(x&12)>>2,I.justify=x&3,x=w[++g],I.effectSpeed=(x&240)>>4,I.effectDirection=(x&12)>>2,I.displayEffect=x&3,g},qt.prototype.flushDisplayed=function(g,b){for(var w=[],x=0;x<8;x++)b.windows[x].visible&&!b.windows[x].isEmpty()&&w.push(b.windows[x].getText());b.endPts=g,b.text=w.join(`

`),this.pushCaption(b),b.startPts=g},qt.prototype.pushCaption=function(g){g.text!==""&&(this.trigger("data",{startPts:g.startPts,endPts:g.endPts,text:g.text,stream:"cc708_"+g.serviceNum}),g.text="",g.startPts=g.endPts)},qt.prototype.displayWindows=function(g,b){var w=this.current708Packet.data,x=w[++g],I=this.getPts(g);this.flushDisplayed(I,b);for(var N=0;N<8;N++)x&1<<N&&(b.windows[N].visible=1);return g},qt.prototype.hideWindows=function(g,b){var w=this.current708Packet.data,x=w[++g],I=this.getPts(g);this.flushDisplayed(I,b);for(var N=0;N<8;N++)x&1<<N&&(b.windows[N].visible=0);return g},qt.prototype.toggleWindows=function(g,b){var w=this.current708Packet.data,x=w[++g],I=this.getPts(g);this.flushDisplayed(I,b);for(var N=0;N<8;N++)x&1<<N&&(b.windows[N].visible^=1);return g},qt.prototype.clearWindows=function(g,b){var w=this.current708Packet.data,x=w[++g],I=this.getPts(g);this.flushDisplayed(I,b);for(var N=0;N<8;N++)x&1<<N&&b.windows[N].clearText();return g},qt.prototype.deleteWindows=function(g,b){var w=this.current708Packet.data,x=w[++g],I=this.getPts(g);this.flushDisplayed(I,b);for(var N=0;N<8;N++)x&1<<N&&b.windows[N].reset();return g},qt.prototype.setPenAttributes=function(g,b){var w=this.current708Packet.data,x=w[g],I=b.currentWindow.penAttr;return x=w[++g],I.textTag=(x&240)>>4,I.offset=(x&12)>>2,I.penSize=x&3,x=w[++g],I.italics=(x&128)>>7,I.underline=(x&64)>>6,I.edgeType=(x&56)>>3,I.fontStyle=x&7,g},qt.prototype.setPenColor=function(g,b){var w=this.current708Packet.data,x=w[g],I=b.currentWindow.penColor;return x=w[++g],I.fgOpacity=(x&192)>>6,I.fgRed=(x&48)>>4,I.fgGreen=(x&12)>>2,I.fgBlue=x&3,x=w[++g],I.bgOpacity=(x&192)>>6,I.bgRed=(x&48)>>4,I.bgGreen=(x&12)>>2,I.bgBlue=x&3,x=w[++g],I.edgeRed=(x&48)>>4,I.edgeGreen=(x&12)>>2,I.edgeBlue=x&3,g},qt.prototype.setPenLocation=function(g,b){var w=this.current708Packet.data,x=w[g],I=b.currentWindow.penLoc;return b.currentWindow.pendingNewLine=!0,x=w[++g],I.row=x&15,x=w[++g],I.column=x&63,g},qt.prototype.reset=function(g,b){var w=this.getPts(g);return this.flushDisplayed(w,b),this.initService(b.serviceNum,g)};var fo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},is=function(g){return g===null?"":(g=fo[g]||g,String.fromCharCode(g))},Fr=14,Mn=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Un=function(){for(var g=[],b=Fr+1;b--;)g.push("");return g},ti=function(g,b){ti.prototype.init.call(this),this.field_=g||0,this.dataChannel_=b||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(w){var x,I,N,$,V;if(x=w.ccData&32639,x===this.lastControlCode_){this.lastControlCode_=null;return}if((x&61440)===4096?this.lastControlCode_=x:x!==this.PADDING_&&(this.lastControlCode_=null),N=x>>>8,$=x&255,x!==this.PADDING_)if(x===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(x===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(w.pts),this.flushDisplayed(w.pts),I=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=I,this.startPts_=w.pts;else if(x===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(w.pts);else if(x===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(w.pts);else if(x===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(w.pts);else if(x===this.CARRIAGE_RETURN_)this.clearFormatting(w.pts),this.flushDisplayed(w.pts),this.shiftRowsUp_(),this.startPts_=w.pts;else if(x===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(x===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(w.pts),this.displayed_=Un();else if(x===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Un();else if(x===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(w.pts),this.displayed_=Un()),this.mode_="paintOn",this.startPts_=w.pts;else if(this.isSpecialCharacter(N,$))N=(N&3)<<8,V=is(N|$),this[this.mode_](w.pts,V),this.column_++;else if(this.isExtCharacter(N,$))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),N=(N&3)<<8,V=is(N|$),this[this.mode_](w.pts,V),this.column_++;else if(this.isMidRowCode(N,$))this.clearFormatting(w.pts),this[this.mode_](w.pts," "),this.column_++,($&14)===14&&this.addFormatting(w.pts,["i"]),($&1)===1&&this.addFormatting(w.pts,["u"]);else if(this.isOffsetControlCode(N,$))this.column_+=$&3;else if(this.isPAC(N,$)){var Y=Mn.indexOf(x&7968);this.mode_==="rollUp"&&(Y-this.rollUpRows_+1<0&&(Y=this.rollUpRows_-1),this.setRollUp(w.pts,Y)),Y!==this.row_&&(this.clearFormatting(w.pts),this.row_=Y),$&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(w.pts,["u"]),(x&16)===16&&(this.column_=((x&14)>>1)*4),this.isColorPAC($)&&($&14)===14&&this.addFormatting(w.pts,["i"])}else this.isNormalChar(N)&&($===0&&($=null),V=is(N),V+=is($),this[this.mode_](w.pts,V),this.column_+=V.length)}};ti.prototype=new Ri,ti.prototype.flushDisplayed=function(g){var b=this.displayed_.map(function(w,x){try{return w.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+x+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");b.length&&this.trigger("data",{startPts:this.startPts_,endPts:g,text:b,stream:this.name_})},ti.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Un(),this.nonDisplayed_=Un(),this.lastControlCode_=null,this.column_=0,this.row_=Fr,this.rollUpRows_=2,this.formatting_=[]},ti.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},ti.prototype.isSpecialCharacter=function(g,b){return g===this.EXT_&&b>=48&&b<=63},ti.prototype.isExtCharacter=function(g,b){return(g===this.EXT_+1||g===this.EXT_+2)&&b>=32&&b<=63},ti.prototype.isMidRowCode=function(g,b){return g===this.EXT_&&b>=32&&b<=47},ti.prototype.isOffsetControlCode=function(g,b){return g===this.OFFSET_&&b>=33&&b<=35},ti.prototype.isPAC=function(g,b){return g>=this.BASE_&&g<this.BASE_+8&&b>=64&&b<=127},ti.prototype.isColorPAC=function(g){return g>=64&&g<=79||g>=96&&g<=127},ti.prototype.isNormalChar=function(g){return g>=32&&g<=127},ti.prototype.setRollUp=function(g,b){if(this.mode_!=="rollUp"&&(this.row_=Fr,this.mode_="rollUp",this.flushDisplayed(g),this.nonDisplayed_=Un(),this.displayed_=Un()),b!==void 0&&b!==this.row_)for(var w=0;w<this.rollUpRows_;w++)this.displayed_[b-w]=this.displayed_[this.row_-w],this.displayed_[this.row_-w]="";b===void 0&&(b=this.row_),this.topRow_=b-this.rollUpRows_+1},ti.prototype.addFormatting=function(g,b){this.formatting_=this.formatting_.concat(b);var w=b.reduce(function(x,I){return x+"<"+I+">"},"");this[this.mode_](g,w)},ti.prototype.clearFormatting=function(g){if(this.formatting_.length){var b=this.formatting_.reverse().reduce(function(w,x){return w+"</"+x+">"},"");this.formatting_=[],this[this.mode_](g,b)}},ti.prototype.popOn=function(g,b){var w=this.nonDisplayed_[this.row_];w+=b,this.nonDisplayed_[this.row_]=w},ti.prototype.rollUp=function(g,b){var w=this.displayed_[this.row_];w+=b,this.displayed_[this.row_]=w},ti.prototype.shiftRowsUp_=function(){var g;for(g=0;g<this.topRow_;g++)this.displayed_[g]="";for(g=this.row_+1;g<Fr+1;g++)this.displayed_[g]="";for(g=this.topRow_;g<this.row_;g++)this.displayed_[g]=this.displayed_[g+1];this.displayed_[this.row_]=""},ti.prototype.paintOn=function(g,b){var w=this.displayed_[this.row_];w+=b,this.displayed_[this.row_]=w};var Ac={CaptionStream:$i,Cea608Stream:ti,Cea708Stream:qt},po={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},kc=i,$r=8589934592,Ug=4294967296,pl="shared",Ic=function(g,b){var w=1;for(g>b&&(w=-1);Math.abs(b-g)>Ug;)g+=w*$r;return g},ml=function(g){var b,w;ml.prototype.init.call(this),this.type_=g||pl,this.push=function(x){this.type_!==pl&&x.type!==this.type_||(w===void 0&&(w=x.dts),x.dts=Ic(x.dts,w),x.pts=Ic(x.pts,w),b=x.dts,this.trigger("data",x))},this.flush=function(){w=b,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){w=void 0,b=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};ml.prototype=new kc;var Aa={TimestampRolloverStream:ml,handleRollover:Ic},vi=(g,b,w)=>{if(!g)return-1;for(var x=w;x<g.length;x++)if(g[x]===b)return x;return-1},Kh={typedArrayIndexOf:vi},Bg=i,ka=po,ut=Kh.typedArrayIndexOf,ve={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Oc=function(g,b,w){var x,I="";for(x=b;x<w;x++)I+="%"+("00"+g[x].toString(16)).slice(-2);return I},jr=function(g,b,w){return decodeURIComponent(Oc(g,b,w))},ds=function(g,b,w){return unescape(Oc(g,b,w))},mo=function(g){return g[0]<<21|g[1]<<14|g[2]<<7|g[3]},Ia={APIC:function(g){var b=1,w,x,I="-->";g.data[0]===ve.Utf8&&(w=ut(g.data,0,b),!(w<0)&&(g.mimeType=ds(g.data,b,w),b=w+1,g.pictureType=g.data[b],b++,x=ut(g.data,0,b),!(x<0)&&(g.description=jr(g.data,b,x),b=x+1,g.mimeType===I?g.url=ds(g.data,b,g.data.length):g.pictureData=g.data.subarray(b,g.data.length))))},"T*":function(g){g.data[0]===ve.Utf8&&(g.value=jr(g.data,1,g.data.length).replace(/\0*$/,""),g.values=g.value.split("\0"))},TXXX:function(g){var b;g.data[0]===ve.Utf8&&(b=ut(g.data,0,1),b!==-1&&(g.description=jr(g.data,1,b),g.value=jr(g.data,b+1,g.data.length).replace(/\0*$/,""),g.data=g.value))},"W*":function(g){g.url=ds(g.data,0,g.data.length).replace(/\0.*$/,"")},WXXX:function(g){var b;g.data[0]===ve.Utf8&&(b=ut(g.data,0,1),b!==-1&&(g.description=jr(g.data,1,b),g.url=ds(g.data,b+1,g.data.length).replace(/\0.*$/,"")))},PRIV:function(g){var b;for(b=0;b<g.data.length;b++)if(g.data[b]===0){g.owner=ds(g.data,0,b);break}g.privateData=g.data.subarray(b+1),g.data=g.privateData}},go;go=function(g){var b={descriptor:g&&g.descriptor},w=0,x=[],I=0,N;if(go.prototype.init.call(this),this.dispatchType=ka.METADATA_STREAM_TYPE.toString(16),b.descriptor)for(N=0;N<b.descriptor.length;N++)this.dispatchType+=("00"+b.descriptor[N].toString(16)).slice(-2);this.push=function($){var V,Y,J,le,me,Ke;if($.type==="timed-metadata"){if($.dataAlignmentIndicator&&(I=0,x.length=0),x.length===0&&($.data.length<10||$.data[0]!=="I".charCodeAt(0)||$.data[1]!=="D".charCodeAt(0)||$.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(x.push($),I+=$.data.byteLength,x.length===1&&(w=mo($.data.subarray(6,10)),w+=10),!(I<w)){for(V={data:new Uint8Array(w),frames:[],pts:x[0].pts,dts:x[0].dts},me=0;me<w;)V.data.set(x[0].data.subarray(0,w-me),me),me+=x[0].data.byteLength,I-=x[0].data.byteLength,x.shift();Y=10,V.data[5]&64&&(Y+=4,Y+=mo(V.data.subarray(10,14)),w-=mo(V.data.subarray(16,20)));do{if(J=mo(V.data.subarray(Y+4,Y+8)),J<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(Ke=String.fromCharCode(V.data[Y],V.data[Y+1],V.data[Y+2],V.data[Y+3]),le={id:Ke,data:V.data.subarray(Y+10,Y+J+10)},le.key=le.id,Ia[le.id]?Ia[le.id](le):le.id[0]==="T"?Ia["T*"](le):le.id[0]==="W"&&Ia["W*"](le),le.owner==="com.apple.streaming.transportStreamTimestamp"){var Ae=le.data,ft=(Ae[3]&1)<<30|Ae[4]<<22|Ae[5]<<14|Ae[6]<<6|Ae[7]>>>2;ft*=4,ft+=Ae[7]&3,le.timeStamp=ft,V.pts===void 0&&V.dts===void 0&&(V.pts=le.timeStamp,V.dts=le.timeStamp),this.trigger("timestamp",le)}V.frames.push(le),Y+=10,Y+=J}while(Y<w);this.trigger("data",V)}}}},go.prototype=new Bg;var Xh=go,Bn=i,Dc=Ac,Bs=po,ss=Aa.TimestampRolloverStream,gl,Fn,Es,Hr=188,Pc=71;gl=function(){var g=new Uint8Array(Hr),b=0;gl.prototype.init.call(this),this.push=function(w){var x=0,I=Hr,N;for(b?(N=new Uint8Array(w.byteLength+b),N.set(g.subarray(0,b)),N.set(w,b),b=0):N=w;I<N.byteLength;){if(N[x]===Pc&&N[I]===Pc){this.trigger("data",N.subarray(x,I)),x+=Hr,I+=Hr;continue}x++,I++}x<N.byteLength&&(g.set(N.subarray(x),0),b=N.byteLength-x)},this.flush=function(){b===Hr&&g[0]===Pc&&(this.trigger("data",g),b=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){b=0,this.trigger("reset")}},gl.prototype=new Bn,Fn=function(){var g,b,w,x;Fn.prototype.init.call(this),x=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,g=function(I,N){var $=0;N.payloadUnitStartIndicator&&($+=I[$]+1),N.type==="pat"?b(I.subarray($),N):w(I.subarray($),N)},b=function(I,N){N.section_number=I[7],N.last_section_number=I[8],x.pmtPid=(I[10]&31)<<8|I[11],N.pmtPid=x.pmtPid},w=function(I,N){var $,V,Y,J;if(I[5]&1){for(x.programMapTable={video:null,audio:null,"timed-metadata":{}},$=(I[1]&15)<<8|I[2],V=3+$-4,Y=(I[10]&15)<<8|I[11],J=12+Y;J<V;){var le=I[J],me=(I[J+1]&31)<<8|I[J+2];le===Bs.H264_STREAM_TYPE&&x.programMapTable.video===null?x.programMapTable.video=me:le===Bs.ADTS_STREAM_TYPE&&x.programMapTable.audio===null?x.programMapTable.audio=me:le===Bs.METADATA_STREAM_TYPE&&(x.programMapTable["timed-metadata"][me]=le),J+=((I[J+3]&15)<<8|I[J+4])+5}N.programMapTable=x.programMapTable}},this.push=function(I){var N={},$=4;if(N.payloadUnitStartIndicator=!!(I[1]&64),N.pid=I[1]&31,N.pid<<=8,N.pid|=I[2],(I[3]&48)>>>4>1&&($+=I[$]+1),N.pid===0)N.type="pat",g(I.subarray($),N),this.trigger("data",N);else if(N.pid===this.pmtPid)for(N.type="pmt",g(I.subarray($),N),this.trigger("data",N);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([I,$,N]):this.processPes_(I,$,N)},this.processPes_=function(I,N,$){$.pid===this.programMapTable.video?$.streamType=Bs.H264_STREAM_TYPE:$.pid===this.programMapTable.audio?$.streamType=Bs.ADTS_STREAM_TYPE:$.streamType=this.programMapTable["timed-metadata"][$.pid],$.type="pes",$.data=I.subarray(N),this.trigger("data",$)}},Fn.prototype=new Bn,Fn.STREAM_TYPES={h264:27,adts:15},Es=function(){var g=this,b=!1,w={data:[],size:0},x={data:[],size:0},I={data:[],size:0},N,$=function(Y,J){var le;const me=Y[0]<<16|Y[1]<<8|Y[2];J.data=new Uint8Array,me===1&&(J.packetLength=6+(Y[4]<<8|Y[5]),J.dataAlignmentIndicator=(Y[6]&4)!==0,le=Y[7],le&192&&(J.pts=(Y[9]&14)<<27|(Y[10]&255)<<20|(Y[11]&254)<<12|(Y[12]&255)<<5|(Y[13]&254)>>>3,J.pts*=4,J.pts+=(Y[13]&6)>>>1,J.dts=J.pts,le&64&&(J.dts=(Y[14]&14)<<27|(Y[15]&255)<<20|(Y[16]&254)<<12|(Y[17]&255)<<5|(Y[18]&254)>>>3,J.dts*=4,J.dts+=(Y[18]&6)>>>1)),J.data=Y.subarray(9+Y[8]))},V=function(Y,J,le){var me=new Uint8Array(Y.size),Ke={type:J},Ae=0,ft=0,yt=!1,ki;if(!(!Y.data.length||Y.size<9)){for(Ke.trackId=Y.data[0].pid,Ae=0;Ae<Y.data.length;Ae++)ki=Y.data[Ae],me.set(ki.data,ft),ft+=ki.data.byteLength;$(me,Ke),yt=J==="video"||Ke.packetLength<=Y.size,(le||yt)&&(Y.size=0,Y.data.length=0),yt&&g.trigger("data",Ke)}};Es.prototype.init.call(this),this.push=function(Y){({pat:function(){},pes:function(){var J,le;switch(Y.streamType){case Bs.H264_STREAM_TYPE:J=w,le="video";break;case Bs.ADTS_STREAM_TYPE:J=x,le="audio";break;case Bs.METADATA_STREAM_TYPE:J=I,le="timed-metadata";break;default:return}Y.payloadUnitStartIndicator&&V(J,le,!0),J.data.push(Y),J.size+=Y.data.byteLength},pmt:function(){var J={type:"metadata",tracks:[]};N=Y.programMapTable,N.video!==null&&J.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&J.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),b=!0,g.trigger("data",J)}})[Y.type]()},this.reset=function(){w.size=0,w.data.length=0,x.size=0,x.data.length=0,this.trigger("reset")},this.flushStreams_=function(){V(w,"video"),V(x,"audio"),V(I,"timed-metadata")},this.flush=function(){if(!b&&N){var Y={type:"metadata",tracks:[]};N.video!==null&&Y.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&Y.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),g.trigger("data",Y)}b=!1,this.flushStreams_(),this.trigger("done")}},Es.prototype=new Bn;var Yh={PAT_PID:0,MP2T_PACKET_LENGTH:Hr,TransportPacketStream:gl,TransportParseStream:Fn,ElementaryStream:Es,TimestampRolloverStream:ss,CaptionStream:Dc.CaptionStream,Cea608Stream:Dc.Cea608Stream,Cea708Stream:Dc.Cea708Stream,MetadataStream:Xh};for(var _o in Bs)Bs.hasOwnProperty(_o)&&(Yh[_o]=Bs[_o]);var Oa=Yh,yo=i,Lc=Xt.ONE_SECOND_IN_TS,Da,Nc=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Da=function(g){var b,w=0;Da.prototype.init.call(this),this.skipWarn_=function(x,I){this.trigger("log",{level:"warn",message:`adts skiping bytes ${x} to ${I} in frame ${w} outside syncword`})},this.push=function(x){var I=0,N,$,V,Y,J;if(g||(w=0),x.type==="audio"){b&&b.length?(V=b,b=new Uint8Array(V.byteLength+x.data.byteLength),b.set(V),b.set(x.data,V.byteLength)):b=x.data;for(var le;I+7<b.length;){if(b[I]!==255||(b[I+1]&246)!==240){typeof le!="number"&&(le=I),I++;continue}if(typeof le=="number"&&(this.skipWarn_(le,I),le=null),$=(~b[I+1]&1)*2,N=(b[I+3]&3)<<11|b[I+4]<<3|(b[I+5]&224)>>5,Y=((b[I+6]&3)+1)*1024,J=Y*Lc/Nc[(b[I+2]&60)>>>2],b.byteLength-I<N)break;this.trigger("data",{pts:x.pts+w*J,dts:x.dts+w*J,sampleCount:Y,audioobjecttype:(b[I+2]>>>6&3)+1,channelcount:(b[I+2]&1)<<2|(b[I+3]&192)>>>6,samplerate:Nc[(b[I+2]&60)>>>2],samplingfrequencyindex:(b[I+2]&60)>>>2,samplesize:16,data:b.subarray(I+7+$,I+N)}),w++,I+=N}typeof le=="number"&&(this.skipWarn_(le,I),le=null),b=b.subarray(I)}},this.flush=function(){w=0,this.trigger("done")},this.reset=function(){b=void 0,this.trigger("reset")},this.endTimeline=function(){b=void 0,this.trigger("endedtimeline")}},Da.prototype=new yo;var _l=Da,Qh;Qh=function(g){var b=g.byteLength,w=0,x=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+x},this.loadWord=function(){var I=g.byteLength-b,N=new Uint8Array(4),$=Math.min(4,b);if($===0)throw new Error("no bytes available");N.set(g.subarray(I,I+$)),w=new DataView(N.buffer).getUint32(0),x=$*8,b-=$},this.skipBits=function(I){var N;x>I?(w<<=I,x-=I):(I-=x,N=Math.floor(I/8),I-=N*8,b-=N,this.loadWord(),w<<=I,x-=I)},this.readBits=function(I){var N=Math.min(x,I),$=w>>>32-N;return x-=N,x>0?w<<=N:b>0&&this.loadWord(),N=I-N,N>0?$<<N|this.readBits(N):$},this.skipLeadingZeros=function(){var I;for(I=0;I<x;++I)if(w&2147483648>>>I)return w<<=I,x-=I,I;return this.loadWord(),I+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var I=this.skipLeadingZeros();return this.readBits(I+1)-1},this.readExpGolomb=function(){var I=this.readUnsignedExpGolomb();return 1&I?1+I>>>1:-1*(I>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Fg=Qh,Jh=i,Zh=Fg,Pa,Vr,Rc;Vr=function(){var g=0,b,w;Vr.prototype.init.call(this),this.push=function(x){var I;w?(I=new Uint8Array(w.byteLength+x.data.byteLength),I.set(w),I.set(x.data,w.byteLength),w=I):w=x.data;for(var N=w.byteLength;g<N-3;g++)if(w[g+2]===1){b=g+5;break}for(;b<N;)switch(w[b]){case 0:if(w[b-1]!==0){b+=2;break}else if(w[b-2]!==0){b++;break}g+3!==b-2&&this.trigger("data",w.subarray(g+3,b-2));do b++;while(w[b]!==1&&b<N);g=b-2,b+=3;break;case 1:if(w[b-1]!==0||w[b-2]!==0){b+=3;break}this.trigger("data",w.subarray(g+3,b-2)),g=b-2,b+=3;break;default:b+=3;break}w=w.subarray(g),b-=g,g=0},this.reset=function(){w=null,g=0,this.trigger("reset")},this.flush=function(){w&&w.byteLength>3&&this.trigger("data",w.subarray(g+3)),w=null,g=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Vr.prototype=new Jh,Rc={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Pa=function(){var g=new Vr,b,w,x,I,N,$,V;Pa.prototype.init.call(this),b=this,this.push=function(Y){Y.type==="video"&&(w=Y.trackId,x=Y.pts,I=Y.dts,g.push(Y))},g.on("data",function(Y){var J={trackId:w,pts:x,dts:I,data:Y,nalUnitTypeCode:Y[0]&31};switch(J.nalUnitTypeCode){case 5:J.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:J.nalUnitType="sei_rbsp",J.escapedRBSP=N(Y.subarray(1));break;case 7:J.nalUnitType="seq_parameter_set_rbsp",J.escapedRBSP=N(Y.subarray(1)),J.config=$(J.escapedRBSP);break;case 8:J.nalUnitType="pic_parameter_set_rbsp";break;case 9:J.nalUnitType="access_unit_delimiter_rbsp";break}b.trigger("data",J)}),g.on("done",function(){b.trigger("done")}),g.on("partialdone",function(){b.trigger("partialdone")}),g.on("reset",function(){b.trigger("reset")}),g.on("endedtimeline",function(){b.trigger("endedtimeline")}),this.flush=function(){g.flush()},this.partialFlush=function(){g.partialFlush()},this.reset=function(){g.reset()},this.endTimeline=function(){g.endTimeline()},V=function(Y,J){var le=8,me=8,Ke,Ae;for(Ke=0;Ke<Y;Ke++)me!==0&&(Ae=J.readExpGolomb(),me=(le+Ae+256)%256),le=me===0?le:me},N=function(Y){for(var J=Y.byteLength,le=[],me=1,Ke,Ae;me<J-2;)Y[me]===0&&Y[me+1]===0&&Y[me+2]===3?(le.push(me+2),me+=2):me++;if(le.length===0)return Y;Ke=J-le.length,Ae=new Uint8Array(Ke);var ft=0;for(me=0;me<Ke;ft++,me++)ft===le[0]&&(ft++,le.shift()),Ae[me]=Y[ft];return Ae},$=function(Y){var J=0,le=0,me=0,Ke=0,Ae,ft,yt,ki,xs,zr,Ml,kf,ed,td,If,Ne=[1,1],id,$n;if(Ae=new Zh(Y),ft=Ae.readUnsignedByte(),ki=Ae.readUnsignedByte(),yt=Ae.readUnsignedByte(),Ae.skipUnsignedExpGolomb(),Rc[ft]&&(xs=Ae.readUnsignedExpGolomb(),xs===3&&Ae.skipBits(1),Ae.skipUnsignedExpGolomb(),Ae.skipUnsignedExpGolomb(),Ae.skipBits(1),Ae.readBoolean()))for(If=xs!==3?8:12,$n=0;$n<If;$n++)Ae.readBoolean()&&($n<6?V(16,Ae):V(64,Ae));if(Ae.skipUnsignedExpGolomb(),zr=Ae.readUnsignedExpGolomb(),zr===0)Ae.readUnsignedExpGolomb();else if(zr===1)for(Ae.skipBits(1),Ae.skipExpGolomb(),Ae.skipExpGolomb(),Ml=Ae.readUnsignedExpGolomb(),$n=0;$n<Ml;$n++)Ae.skipExpGolomb();if(Ae.skipUnsignedExpGolomb(),Ae.skipBits(1),kf=Ae.readUnsignedExpGolomb(),ed=Ae.readUnsignedExpGolomb(),td=Ae.readBits(1),td===0&&Ae.skipBits(1),Ae.skipBits(1),Ae.readBoolean()&&(J=Ae.readUnsignedExpGolomb(),le=Ae.readUnsignedExpGolomb(),me=Ae.readUnsignedExpGolomb(),Ke=Ae.readUnsignedExpGolomb()),Ae.readBoolean()&&Ae.readBoolean()){switch(id=Ae.readUnsignedByte(),id){case 1:Ne=[1,1];break;case 2:Ne=[12,11];break;case 3:Ne=[10,11];break;case 4:Ne=[16,11];break;case 5:Ne=[40,33];break;case 6:Ne=[24,11];break;case 7:Ne=[20,11];break;case 8:Ne=[32,11];break;case 9:Ne=[80,33];break;case 10:Ne=[18,11];break;case 11:Ne=[15,11];break;case 12:Ne=[64,33];break;case 13:Ne=[160,99];break;case 14:Ne=[4,3];break;case 15:Ne=[3,2];break;case 16:Ne=[2,1];break;case 255:{Ne=[Ae.readUnsignedByte()<<8|Ae.readUnsignedByte(),Ae.readUnsignedByte()<<8|Ae.readUnsignedByte()];break}}Ne&&Ne[0]/Ne[1]}return{profileIdc:ft,levelIdc:yt,profileCompatibility:ki,width:(kf+1)*16-J*2-le*2,height:(2-td)*(ed+1)*16-me*2-Ke*2,sarRatio:Ne}}},Pa.prototype=new Jh;var yl={H264Stream:Pa,NalByteStream:Vr},Mc=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ef=function(g,b){var w=g[b+6]<<21|g[b+7]<<14|g[b+8]<<7|g[b+9],x=g[b+5],I=(x&16)>>4;return w=w>=0?w:0,I?w+20:w+10},Ss=function(g,b){return g.length-b<10||g[b]!=="I".charCodeAt(0)||g[b+1]!=="D".charCodeAt(0)||g[b+2]!=="3".charCodeAt(0)?b:(b+=ef(g,b),Ss(g,b))},tf=function(g){var b=Ss(g,0);return g.length>=b+2&&(g[b]&255)===255&&(g[b+1]&240)===240&&(g[b+1]&22)===16},qr=function(g){return g[0]<<21|g[1]<<14|g[2]<<7|g[3]},$g=function(g,b,w){var x,I="";for(x=b;x<w;x++)I+="%"+("00"+g[x].toString(16)).slice(-2);return I},jg=function(g,b,w){return unescape($g(g,b,w))},Hg=function(g,b){var w=(g[b+5]&224)>>5,x=g[b+4]<<3,I=g[b+3]&3<<11;return I|x|w},Uc=function(g,b){return g[b]==="I".charCodeAt(0)&&g[b+1]==="D".charCodeAt(0)&&g[b+2]==="3".charCodeAt(0)?"timed-metadata":g[b]&!0&&(g[b+1]&240)===240?"audio":null},sf=function(g){for(var b=0;b+5<g.length;){if(g[b]!==255||(g[b+1]&246)!==240){b++;continue}return Mc[(g[b+2]&60)>>>2]}return null},Vg=function(g){var b,w,x,I;b=10,g[5]&64&&(b+=4,b+=qr(g.subarray(10,14)));do{if(w=qr(g.subarray(b+4,b+8)),w<1)return null;if(I=String.fromCharCode(g[b],g[b+1],g[b+2],g[b+3]),I==="PRIV"){x=g.subarray(b+10,b+w+10);for(var N=0;N<x.byteLength;N++)if(x[N]===0){var $=jg(x,0,N);if($==="com.apple.streaming.transportStreamTimestamp"){var V=x.subarray(N+1),Y=(V[3]&1)<<30|V[4]<<22|V[5]<<14|V[6]<<6|V[7]>>>2;return Y*=4,Y+=V[7]&3,Y}break}}b+=10,b+=w}while(b<g.byteLength);return null},vo={isLikelyAacData:tf,parseId3TagSize:ef,parseAdtsSize:Hg,parseType:Uc,parseSampleRate:sf,parseAacTimestamp:Vg},nf=i,nn=vo,To;To=function(){var g=new Uint8Array,b=0;To.prototype.init.call(this),this.setTimestamp=function(w){b=w},this.push=function(w){var x=0,I=0,N,$,V,Y;for(g.length?(Y=g.length,g=new Uint8Array(w.byteLength+Y),g.set(g.subarray(0,Y)),g.set(w,Y)):g=w;g.length-I>=3;){if(g[I]==="I".charCodeAt(0)&&g[I+1]==="D".charCodeAt(0)&&g[I+2]==="3".charCodeAt(0)){if(g.length-I<10||(x=nn.parseId3TagSize(g,I),I+x>g.length))break;$={type:"timed-metadata",data:g.subarray(I,I+x)},this.trigger("data",$),I+=x;continue}else if((g[I]&255)===255&&(g[I+1]&240)===240){if(g.length-I<7||(x=nn.parseAdtsSize(g,I),I+x>g.length))break;V={type:"audio",data:g.subarray(I,I+x),pts:b,dts:b},this.trigger("data",V),I+=x;continue}I++}N=g.length-I,N>0?g=g.subarray(I):g=new Uint8Array},this.reset=function(){g=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){g=new Uint8Array,this.trigger("endedtimeline")}},To.prototype=new nf;var rf=To,af=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],bo=af,of=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],lf=of,Fs=i,zi=Ue,Tn=Re,Ui=Ng,gi=ts,rn=Oa,Eo=Xt,$s=_l,Bc=yl.H264Stream,So=rf,xo=vo.isLikelyAacData,Fc=Xt.ONE_SECOND_IN_TS,$c=bo,vl=lf,wo,Wr,Co,lr,qg=function(g,b){b.stream=g,this.trigger("log",b)},Ao=function(g,b){for(var w=Object.keys(b),x=0;x<w.length;x++){var I=w[x];I==="headOfPipeline"||!b[I].on||b[I].on("log",qg.bind(g,I))}},Tl=function(g,b){var w;if(g.length!==b.length)return!1;for(w=0;w<g.length;w++)if(g[w]!==b[w])return!1;return!0},ji=function(g,b,w,x,I,N){var $=w-b,V=x-b,Y=I-w;return{start:{dts:g,pts:g+$},end:{dts:g+V,pts:g+Y},prependedContentDuration:N,baseMediaDecodeTime:g}};Wr=function(g,b){var w=[],x,I=0,N=0,$=1/0;b=b||{},x=b.firstSequenceNumber||0,Wr.prototype.init.call(this),this.push=function(V){gi.collectDtsInfo(g,V),g&&$c.forEach(function(Y){g[Y]=V[Y]}),w.push(V)},this.setEarliestDts=function(V){I=V},this.setVideoBaseMediaDecodeTime=function(V){$=V},this.setAudioAppendStart=function(V){N=V},this.flush=function(){var V,Y,J,le,me,Ke,Ae;if(w.length===0){this.trigger("done","AudioSegmentStream");return}V=Ui.trimAdtsFramesByEarliestDts(w,g,I),g.baseMediaDecodeTime=gi.calculateTrackBaseMediaDecodeTime(g,b.keepOriginalTimestamps),Ae=Ui.prefixWithSilence(g,V,N,$),g.samples=Ui.generateSampleTable(V),J=zi.mdat(Ui.concatenateFrameData(V)),w=[],Y=zi.moof(x,[g]),le=new Uint8Array(Y.byteLength+J.byteLength),x++,le.set(Y),le.set(J,Y.byteLength),gi.clearDtsInfo(g),me=Math.ceil(Fc*1024/g.samplerate),V.length&&(Ke=V.length*me,this.trigger("segmentTimingInfo",ji(Eo.audioTsToVideoTs(g.baseMediaDecodeTime,g.samplerate),V[0].dts,V[0].pts,V[0].dts+Ke,V[0].pts+Ke,Ae||0)),this.trigger("timingInfo",{start:V[0].pts,end:V[0].pts+Ke})),this.trigger("data",{track:g,boxes:le}),this.trigger("done","AudioSegmentStream")},this.reset=function(){gi.clearDtsInfo(g),w=[],this.trigger("reset")}},Wr.prototype=new Fs,wo=function(g,b){var w,x=[],I=[],N,$;b=b||{},w=b.firstSequenceNumber||0,wo.prototype.init.call(this),delete g.minPTS,this.gopCache_=[],this.push=function(V){gi.collectDtsInfo(g,V),V.nalUnitType==="seq_parameter_set_rbsp"&&!N&&(N=V.config,g.sps=[V.data],vl.forEach(function(Y){g[Y]=N[Y]},this)),V.nalUnitType==="pic_parameter_set_rbsp"&&!$&&($=V.data,g.pps=[V.data]),x.push(V)},this.flush=function(){for(var V,Y,J,le,me,Ke,Ae=0,ft,yt;x.length&&x[0].nalUnitType!=="access_unit_delimiter_rbsp";)x.shift();if(x.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(V=Tn.groupNalsIntoFrames(x),J=Tn.groupFramesIntoGops(V),J[0][0].keyFrame||(Y=this.getGopForFusion_(x[0],g),Y?(Ae=Y.duration,J.unshift(Y),J.byteLength+=Y.byteLength,J.nalCount+=Y.nalCount,J.pts=Y.pts,J.dts=Y.dts,J.duration+=Y.duration):J=Tn.extendFirstKeyFrame(J)),I.length){var ki;if(b.alignGopsAtEnd?ki=this.alignGopsAtEnd_(J):ki=this.alignGopsAtStart_(J),!ki){this.gopCache_.unshift({gop:J.pop(),pps:g.pps,sps:g.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),x=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}gi.clearDtsInfo(g),J=ki}gi.collectDtsInfo(g,J),g.samples=Tn.generateSampleTable(J),me=zi.mdat(Tn.concatenateNalData(J)),g.baseMediaDecodeTime=gi.calculateTrackBaseMediaDecodeTime(g,b.keepOriginalTimestamps),this.trigger("processedGopsInfo",J.map(function(xs){return{pts:xs.pts,dts:xs.dts,byteLength:xs.byteLength}})),ft=J[0],yt=J[J.length-1],this.trigger("segmentTimingInfo",ji(g.baseMediaDecodeTime,ft.dts,ft.pts,yt.dts+yt.duration,yt.pts+yt.duration,Ae)),this.trigger("timingInfo",{start:J[0].pts,end:J[J.length-1].pts+J[J.length-1].duration}),this.gopCache_.unshift({gop:J.pop(),pps:g.pps,sps:g.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),x=[],this.trigger("baseMediaDecodeTime",g.baseMediaDecodeTime),this.trigger("timelineStartInfo",g.timelineStartInfo),le=zi.moof(w,[g]),Ke=new Uint8Array(le.byteLength+me.byteLength),w++,Ke.set(le),Ke.set(me,le.byteLength),this.trigger("data",{track:g,boxes:Ke}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),x=[],this.gopCache_.length=0,I.length=0,this.trigger("reset")},this.resetStream_=function(){gi.clearDtsInfo(g),N=void 0,$=void 0},this.getGopForFusion_=function(V){var Y=45e3,J=1e4,le=1/0,me,Ke,Ae,ft,yt;for(yt=0;yt<this.gopCache_.length;yt++)ft=this.gopCache_[yt],Ae=ft.gop,!(!(g.pps&&Tl(g.pps[0],ft.pps[0]))||!(g.sps&&Tl(g.sps[0],ft.sps[0])))&&(Ae.dts<g.timelineStartInfo.dts||(me=V.dts-Ae.dts-Ae.duration,me>=-J&&me<=Y&&(!Ke||le>me)&&(Ke=ft,le=me)));return Ke?Ke.gop:null},this.alignGopsAtStart_=function(V){var Y,J,le,me,Ke,Ae,ft,yt;for(Ke=V.byteLength,Ae=V.nalCount,ft=V.duration,Y=J=0;Y<I.length&&J<V.length&&(le=I[Y],me=V[J],le.pts!==me.pts);){if(me.pts>le.pts){Y++;continue}J++,Ke-=me.byteLength,Ae-=me.nalCount,ft-=me.duration}return J===0?V:J===V.length?null:(yt=V.slice(J),yt.byteLength=Ke,yt.duration=ft,yt.nalCount=Ae,yt.pts=yt[0].pts,yt.dts=yt[0].dts,yt)},this.alignGopsAtEnd_=function(V){var Y,J,le,me,Ke,Ae;for(Y=I.length-1,J=V.length-1,Ke=null,Ae=!1;Y>=0&&J>=0;){if(le=I[Y],me=V[J],le.pts===me.pts){Ae=!0;break}if(le.pts>me.pts){Y--;continue}Y===I.length-1&&(Ke=J),J--}if(!Ae&&Ke===null)return null;var ft;if(Ae?ft=J:ft=Ke,ft===0)return V;var yt=V.slice(ft),ki=yt.reduce(function(xs,zr){return xs.byteLength+=zr.byteLength,xs.duration+=zr.duration,xs.nalCount+=zr.nalCount,xs},{byteLength:0,duration:0,nalCount:0});return yt.byteLength=ki.byteLength,yt.duration=ki.duration,yt.nalCount=ki.nalCount,yt.pts=yt[0].pts,yt.dts=yt[0].dts,yt},this.alignGopsWith=function(V){I=V}},wo.prototype=new Fs,lr=function(g,b){this.numberOfTracks=0,this.metadataStream=b,g=g||{},typeof g.remux<"u"?this.remuxTracks=!!g.remux:this.remuxTracks=!0,typeof g.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=g.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,lr.prototype.init.call(this),this.push=function(w){if(w.text)return this.pendingCaptions.push(w);if(w.frames)return this.pendingMetadata.push(w);this.pendingTracks.push(w.track),this.pendingBytes+=w.boxes.byteLength,w.track.type==="video"&&(this.videoTrack=w.track,this.pendingBoxes.push(w.boxes)),w.track.type==="audio"&&(this.audioTrack=w.track,this.pendingBoxes.unshift(w.boxes))}},lr.prototype=new Fs,lr.prototype.flush=function(g){var b=0,w={captions:[],captionStreams:{},metadata:[],info:{}},x,I,N,$=0,V;if(this.pendingTracks.length<this.numberOfTracks){if(g!=="VideoSegmentStream"&&g!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?($=this.videoTrack.timelineStartInfo.pts,vl.forEach(function(Y){w.info[Y]=this.videoTrack[Y]},this)):this.audioTrack&&($=this.audioTrack.timelineStartInfo.pts,$c.forEach(function(Y){w.info[Y]=this.audioTrack[Y]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?w.type=this.pendingTracks[0].type:w.type="combined",this.emittedTracks+=this.pendingTracks.length,N=zi.initSegment(this.pendingTracks),w.initSegment=new Uint8Array(N.byteLength),w.initSegment.set(N),w.data=new Uint8Array(this.pendingBytes),V=0;V<this.pendingBoxes.length;V++)w.data.set(this.pendingBoxes[V],b),b+=this.pendingBoxes[V].byteLength;for(V=0;V<this.pendingCaptions.length;V++)x=this.pendingCaptions[V],x.startTime=Eo.metadataTsToSeconds(x.startPts,$,this.keepOriginalTimestamps),x.endTime=Eo.metadataTsToSeconds(x.endPts,$,this.keepOriginalTimestamps),w.captionStreams[x.stream]=!0,w.captions.push(x);for(V=0;V<this.pendingMetadata.length;V++)I=this.pendingMetadata[V],I.cueTime=Eo.metadataTsToSeconds(I.pts,$,this.keepOriginalTimestamps),w.metadata.push(I);for(w.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",w),V=0;V<w.captions.length;V++)x=w.captions[V],this.trigger("caption",x);for(V=0;V<w.metadata.length;V++)I=w.metadata[V],this.trigger("id3Frame",I)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},lr.prototype.setRemux=function(g){this.remuxTracks=g},Co=function(g){var b=this,w=!0,x,I;Co.prototype.init.call(this),g=g||{},this.baseMediaDecodeTime=g.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="aac",N.metadataStream=new rn.MetadataStream,N.aacStream=new So,N.audioTimestampRolloverStream=new rn.TimestampRolloverStream("audio"),N.timedMetadataTimestampRolloverStream=new rn.TimestampRolloverStream("timed-metadata"),N.adtsStream=new $s,N.coalesceStream=new lr(g,N.metadataStream),N.headOfPipeline=N.aacStream,N.aacStream.pipe(N.audioTimestampRolloverStream).pipe(N.adtsStream),N.aacStream.pipe(N.timedMetadataTimestampRolloverStream).pipe(N.metadataStream).pipe(N.coalesceStream),N.metadataStream.on("timestamp",function($){N.aacStream.setTimestamp($.timeStamp)}),N.aacStream.on("data",function($){$.type!=="timed-metadata"&&$.type!=="audio"||N.audioSegmentStream||(I=I||{timelineStartInfo:{baseMediaDecodeTime:b.baseMediaDecodeTime},codec:"adts",type:"audio"},N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Wr(I,g),N.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream),b.trigger("trackinfo",{hasAudio:!!I,hasVideo:!!x}))}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Ao(this,N)},this.setupTsPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="ts",N.metadataStream=new rn.MetadataStream,N.packetStream=new rn.TransportPacketStream,N.parseStream=new rn.TransportParseStream,N.elementaryStream=new rn.ElementaryStream,N.timestampRolloverStream=new rn.TimestampRolloverStream,N.adtsStream=new $s,N.h264Stream=new Bc,N.captionStream=new rn.CaptionStream(g),N.coalesceStream=new lr(g,N.metadataStream),N.headOfPipeline=N.packetStream,N.packetStream.pipe(N.parseStream).pipe(N.elementaryStream).pipe(N.timestampRolloverStream),N.timestampRolloverStream.pipe(N.h264Stream),N.timestampRolloverStream.pipe(N.adtsStream),N.timestampRolloverStream.pipe(N.metadataStream).pipe(N.coalesceStream),N.h264Stream.pipe(N.captionStream).pipe(N.coalesceStream),N.elementaryStream.on("data",function($){var V;if($.type==="metadata"){for(V=$.tracks.length;V--;)!x&&$.tracks[V].type==="video"?(x=$.tracks[V],x.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime):!I&&$.tracks[V].type==="audio"&&(I=$.tracks[V],I.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime);x&&!N.videoSegmentStream&&(N.coalesceStream.numberOfTracks++,N.videoSegmentStream=new wo(x,g),N.videoSegmentStream.on("log",b.getLogTrigger_("videoSegmentStream")),N.videoSegmentStream.on("timelineStartInfo",function(Y){I&&!g.keepOriginalTimestamps&&(I.timelineStartInfo=Y,N.audioSegmentStream.setEarliestDts(Y.dts-b.baseMediaDecodeTime))}),N.videoSegmentStream.on("processedGopsInfo",b.trigger.bind(b,"gopInfo")),N.videoSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"videoSegmentTimingInfo")),N.videoSegmentStream.on("baseMediaDecodeTime",function(Y){I&&N.audioSegmentStream.setVideoBaseMediaDecodeTime(Y)}),N.videoSegmentStream.on("timingInfo",b.trigger.bind(b,"videoTimingInfo")),N.h264Stream.pipe(N.videoSegmentStream).pipe(N.coalesceStream)),I&&!N.audioSegmentStream&&(N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Wr(I,g),N.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),N.audioSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"audioSegmentTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream)),b.trigger("trackinfo",{hasAudio:!!I,hasVideo:!!x})}}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("id3Frame",function($){$.dispatchType=N.metadataStream.dispatchType,b.trigger("id3Frame",$)}),N.coalesceStream.on("caption",this.trigger.bind(this,"caption")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Ao(this,N)},this.setBaseMediaDecodeTime=function(N){var $=this.transmuxPipeline_;g.keepOriginalTimestamps||(this.baseMediaDecodeTime=N),I&&(I.timelineStartInfo.dts=void 0,I.timelineStartInfo.pts=void 0,gi.clearDtsInfo(I),$.audioTimestampRolloverStream&&$.audioTimestampRolloverStream.discontinuity()),x&&($.videoSegmentStream&&($.videoSegmentStream.gopCache_=[]),x.timelineStartInfo.dts=void 0,x.timelineStartInfo.pts=void 0,gi.clearDtsInfo(x),$.captionStream.reset()),$.timestampRolloverStream&&$.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(N){I&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(N)},this.setRemux=function(N){var $=this.transmuxPipeline_;g.remux=N,$&&$.coalesceStream&&$.coalesceStream.setRemux(N)},this.alignGopsWith=function(N){x&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(N)},this.getLogTrigger_=function(N){var $=this;return function(V){V.stream=N,$.trigger("log",V)}},this.push=function(N){if(w){var $=xo(N);$&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!$&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),w=!1}this.transmuxPipeline_.headOfPipeline.push(N)},this.flush=function(){w=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Co.prototype=new Fs;var Wg={Transmuxer:Co,VideoSegmentStream:wo,AudioSegmentStream:Wr,AUDIO_PROPERTIES:$c,VIDEO_PROPERTIES:vl,generateSegmentTimingInfo:ji},ko=function(g){return g>>>0},Gg=function(g){return("00"+g.toString(16)).slice(-2)},bl={toUnsigned:ko,toHexString:Gg},zg=function(g){var b="";return b+=String.fromCharCode(g[0]),b+=String.fromCharCode(g[1]),b+=String.fromCharCode(g[2]),b+=String.fromCharCode(g[3]),b},El=zg,uf=bl.toUnsigned,Kg=El,cf=function(g,b){var w=[],x,I,N,$,V;if(!b.length)return null;for(x=0;x<g.byteLength;)I=uf(g[x]<<24|g[x+1]<<16|g[x+2]<<8|g[x+3]),N=Kg(g.subarray(x+4,x+8)),$=I>1?x+I:g.byteLength,N===b[0]&&(b.length===1?w.push(g.subarray(x+8,$)):(V=cf(g.subarray(x+8,$),b.slice(1)),V.length&&(w=w.concat(V)))),x=$;return w},La=cf,Xg=bl.toUnsigned,Io=u.getUint64,Et=function(g){var b={version:g[0],flags:new Uint8Array(g.subarray(1,4))};return b.version===1?b.baseMediaDecodeTime=Io(g.subarray(4)):b.baseMediaDecodeTime=Xg(g[4]<<24|g[5]<<16|g[6]<<8|g[7]),b},ur=Et,jc=function(g){return{isLeading:(g[0]&12)>>>2,dependsOn:g[0]&3,isDependedOn:(g[1]&192)>>>6,hasRedundancy:(g[1]&48)>>>4,paddingValue:(g[1]&14)>>>1,isNonSyncSample:g[1]&1,degradationPriority:g[2]<<8|g[3]}},Sl=jc,df=Sl,hf=function(g){var b={version:g[0],flags:new Uint8Array(g.subarray(1,4)),samples:[]},w=new DataView(g.buffer,g.byteOffset,g.byteLength),x=b.flags[2]&1,I=b.flags[2]&4,N=b.flags[1]&1,$=b.flags[1]&2,V=b.flags[1]&4,Y=b.flags[1]&8,J=w.getUint32(4),le=8,me;for(x&&(b.dataOffset=w.getInt32(le),le+=4),I&&J&&(me={flags:df(g.subarray(le,le+4))},le+=4,N&&(me.duration=w.getUint32(le),le+=4),$&&(me.size=w.getUint32(le),le+=4),Y&&(b.version===1?me.compositionTimeOffset=w.getInt32(le):me.compositionTimeOffset=w.getUint32(le),le+=4),b.samples.push(me),J--);J--;)me={},N&&(me.duration=w.getUint32(le),le+=4),$&&(me.size=w.getUint32(le),le+=4),V&&(me.flags=df(g.subarray(le,le+4)),le+=4),Y&&(b.version===1?me.compositionTimeOffset=w.getInt32(le):me.compositionTimeOffset=w.getUint32(le),le+=4),b.samples.push(me);return b},ff=hf,Yg=function(g){var b=new DataView(g.buffer,g.byteOffset,g.byteLength),w={version:g[0],flags:new Uint8Array(g.subarray(1,4)),trackId:b.getUint32(4)},x=w.flags[2]&1,I=w.flags[2]&2,N=w.flags[2]&8,$=w.flags[2]&16,V=w.flags[2]&32,Y=w.flags[0]&65536,J=w.flags[0]&131072,le;return le=8,x&&(le+=4,w.baseDataOffset=b.getUint32(12),le+=4),I&&(w.sampleDescriptionIndex=b.getUint32(le),le+=4),N&&(w.defaultSampleDuration=b.getUint32(le),le+=4),$&&(w.defaultSampleSize=b.getUint32(le),le+=4),V&&(w.defaultSampleFlags=b.getUint32(le)),Y&&(w.durationIsEmpty=!0),!x&&J&&(w.baseDataOffsetIsMoof=!0),w},Hc=Yg,Gr;typeof window<"u"?Gr=window:typeof t<"u"?Gr=t:typeof self<"u"?Gr=self:Gr={};var pf=Gr,mf=cs.discardEmulationPreventionBytes,Qg=Ac.CaptionStream,cr=La,gf=ur,Jg=ff,xl=Hc,wl=pf,Zg=function(g,b){for(var w=g,x=0;x<b.length;x++){var I=b[x];if(w<I.size)return I;w-=I.size}return null},Vc=function(g,b,w){var x=new DataView(g.buffer,g.byteOffset,g.byteLength),I={logs:[],seiNals:[]},N,$,V,Y;for($=0;$+4<g.length;$+=V)if(V=x.getUint32($),$+=4,!(V<=0))switch(g[$]&31){case 6:var J=g.subarray($+1,$+1+V),le=Zg($,b);if(N={nalUnitType:"sei_rbsp",size:V,data:J,escapedRBSP:mf(J),trackId:w},le)N.pts=le.pts,N.dts=le.dts,Y=le;else if(Y)N.pts=Y.pts,N.dts=Y.dts;else{I.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+$+" for trackId "+w+". See mux.js#223."});break}I.seiNals.push(N);break}return I},qc=function(g,b,w){var x=b,I=w.defaultSampleDuration||0,N=w.defaultSampleSize||0,$=w.trackId,V=[];return g.forEach(function(Y){var J=Jg(Y),le=J.samples;le.forEach(function(me){me.duration===void 0&&(me.duration=I),me.size===void 0&&(me.size=N),me.trackId=$,me.dts=x,me.compositionTimeOffset===void 0&&(me.compositionTimeOffset=0),typeof x=="bigint"?(me.pts=x+wl.BigInt(me.compositionTimeOffset),x+=wl.BigInt(me.duration)):(me.pts=x+me.compositionTimeOffset,x+=me.duration)}),V=V.concat(le)}),V},e_=function(g,b){var w=cr(g,["moof","traf"]),x=cr(g,["mdat"]),I={},N=[];return x.forEach(function($,V){var Y=w[V];N.push({mdat:$,traf:Y})}),N.forEach(function($){var V=$.mdat,Y=$.traf,J=cr(Y,["tfhd"]),le=xl(J[0]),me=le.trackId,Ke=cr(Y,["tfdt"]),Ae=Ke.length>0?gf(Ke[0]).baseMediaDecodeTime:0,ft=cr(Y,["trun"]),yt,ki;b===me&&ft.length>0&&(yt=qc(ft,Ae,le),ki=Vc(V,yt,me),I[me]||(I[me]={seiNals:[],logs:[]}),I[me].seiNals=I[me].seiNals.concat(ki.seiNals),I[me].logs=I[me].logs.concat(ki.logs))}),I},t_=function(g,b,w){var x;if(b===null)return null;x=e_(g,b);var I=x[b]||{};return{seiNals:I.seiNals,logs:I.logs,timescale:w}},an=function(){var g=!1,b,w,x,I,N,$;this.isInitialized=function(){return g},this.init=function(V){b=new Qg,g=!0,$=V?V.isPartial:!1,b.on("data",function(Y){Y.startTime=Y.startPts/I,Y.endTime=Y.endPts/I,N.captions.push(Y),N.captionStreams[Y.stream]=!0}),b.on("log",function(Y){N.logs.push(Y)})},this.isNewInit=function(V,Y){return V&&V.length===0||Y&&typeof Y=="object"&&Object.keys(Y).length===0?!1:x!==V[0]||I!==Y[x]},this.parse=function(V,Y,J){var le;if(this.isInitialized()){if(!Y||!J)return null;if(this.isNewInit(Y,J))x=Y[0],I=J[x];else if(x===null||!I)return w.push(V),null}else return null;for(;w.length>0;){var me=w.shift();this.parse(me,Y,J)}return le=t_(V,x,I),le&&le.logs&&(N.logs=N.logs.concat(le.logs)),le===null||!le.seiNals?N.logs.length?{logs:N.logs,captions:[],captionStreams:[]}:null:(this.pushNals(le.seiNals),this.flushStream(),N)},this.pushNals=function(V){if(!this.isInitialized()||!V||V.length===0)return null;V.forEach(function(Y){b.push(Y)})},this.flushStream=function(){if(!this.isInitialized())return null;$?b.partialFlush():b.flush()},this.clearParsedCaptions=function(){N.captions=[],N.captionStreams={},N.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;b.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){w=[],x=null,I=null,N?this.clearParsedCaptions():N={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},_f=an,Oo=bl.toUnsigned,bn=bl.toHexString,Ti=La,dr=El,i_=Hc,Wc=ff,s_=ur,yf=u.getUint64,Na,Cl,Al,vf,Tf,Do,kl=pf;Na=function(g){var b={},w=Ti(g,["moov","trak"]);return w.reduce(function(x,I){var N,$,V,Y,J;return N=Ti(I,["tkhd"])[0],!N||($=N[0],V=$===0?12:20,Y=Oo(N[V]<<24|N[V+1]<<16|N[V+2]<<8|N[V+3]),J=Ti(I,["mdia","mdhd"])[0],!J)?null:($=J[0],V=$===0?12:20,x[Y]=Oo(J[V]<<24|J[V+1]<<16|J[V+2]<<8|J[V+3]),x)},b)},Cl=function(g,b){var w;w=Ti(b,["moof","traf"]);var x=w.reduce(function(I,N){var $=Ti(N,["tfhd"])[0],V=Oo($[4]<<24|$[5]<<16|$[6]<<8|$[7]),Y=g[V]||9e4,J=Ti(N,["tfdt"])[0],le=new DataView(J.buffer,J.byteOffset,J.byteLength),me;J[0]===1?me=yf(J.subarray(4,12)):me=le.getUint32(4);let Ke;return typeof me=="bigint"?Ke=me/kl.BigInt(Y):typeof me=="number"&&!isNaN(me)&&(Ke=me/Y),Ke<Number.MAX_SAFE_INTEGER&&(Ke=Number(Ke)),Ke<I&&(I=Ke),I},1/0);return typeof x=="bigint"||isFinite(x)?x:0},Al=function(g,b){var w=Ti(b,["moof","traf"]),x=0,I=0,N;if(w&&w.length){var $=Ti(w[0],["tfhd"])[0],V=Ti(w[0],["trun"])[0],Y=Ti(w[0],["tfdt"])[0];if($){var J=i_($);N=J.trackId}if(Y){var le=s_(Y);x=le.baseMediaDecodeTime}if(V){var me=Wc(V);me.samples&&me.samples.length&&(I=me.samples[0].compositionTimeOffset||0)}}var Ke=g[N]||9e4;typeof x=="bigint"&&(I=kl.BigInt(I),Ke=kl.BigInt(Ke));var Ae=(x+I)/Ke;return typeof Ae=="bigint"&&Ae<Number.MAX_SAFE_INTEGER&&(Ae=Number(Ae)),Ae},vf=function(g){var b=Ti(g,["moov","trak"]),w=[];return b.forEach(function(x){var I=Ti(x,["mdia","hdlr"]),N=Ti(x,["tkhd"]);I.forEach(function($,V){var Y=dr($.subarray(8,12)),J=N[V],le,me,Ke;Y==="vide"&&(le=new DataView(J.buffer,J.byteOffset,J.byteLength),me=le.getUint8(0),Ke=me===0?le.getUint32(12):le.getUint32(20),w.push(Ke))})}),w},Do=function(g){var b=g[0],w=b===0?12:20;return Oo(g[w]<<24|g[w+1]<<16|g[w+2]<<8|g[w+3])},Tf=function(g){var b=Ti(g,["moov","trak"]),w=[];return b.forEach(function(x){var I={},N=Ti(x,["tkhd"])[0],$,V;N&&($=new DataView(N.buffer,N.byteOffset,N.byteLength),V=$.getUint8(0),I.id=V===0?$.getUint32(12):$.getUint32(20));var Y=Ti(x,["mdia","hdlr"])[0];if(Y){var J=dr(Y.subarray(8,12));J==="vide"?I.type="video":J==="soun"?I.type="audio":I.type=J}var le=Ti(x,["mdia","minf","stbl","stsd"])[0];if(le){var me=le.subarray(8);I.codec=dr(me.subarray(4,8));var Ke=Ti(me,[I.codec])[0],Ae,ft;Ke&&(/^[asm]vc[1-9]$/i.test(I.codec)?(Ae=Ke.subarray(78),ft=dr(Ae.subarray(4,8)),ft==="avcC"&&Ae.length>11?(I.codec+=".",I.codec+=bn(Ae[9]),I.codec+=bn(Ae[10]),I.codec+=bn(Ae[11])):I.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(I.codec)?(Ae=Ke.subarray(28),ft=dr(Ae.subarray(4,8)),ft==="esds"&&Ae.length>20&&Ae[19]!==0?(I.codec+="."+bn(Ae[19]),I.codec+="."+bn(Ae[20]>>>2&63).replace(/^0/,"")):I.codec="mp4a.40.2"):I.codec=I.codec.toLowerCase())}var yt=Ti(x,["mdia","mdhd"])[0];yt&&(I.timescale=Do(yt)),w.push(I)}),w};var Il={findBox:Ti,parseType:dr,timescale:Na,startTime:Cl,compositionStartTime:Al,videoTrackIds:vf,tracks:Tf,getTimescaleFromMediaHeader:Do},Ol=po,Gc=function(g){var b=g[1]&31;return b<<=8,b|=g[2],b},Po=function(g){return!!(g[1]&64)},Dl=function(g){var b=0;return(g[3]&48)>>>4>1&&(b+=g[4]+1),b},n_=function(g,b){var w=Gc(g);return w===0?"pat":w===b?"pmt":b?"pes":null},bf=function(g){var b=Po(g),w=4+Dl(g);return b&&(w+=g[w]+1),(g[w+10]&31)<<8|g[w+11]},Pl=function(g){var b={},w=Po(g),x=4+Dl(g);if(w&&(x+=g[x]+1),!!(g[x+5]&1)){var I,N,$;I=(g[x+1]&15)<<8|g[x+2],N=3+I-4,$=(g[x+10]&15)<<8|g[x+11];for(var V=12+$;V<N;){var Y=x+V;b[(g[Y+1]&31)<<8|g[Y+2]]=g[Y],V+=((g[Y+3]&15)<<8|g[Y+4])+5}return b}},Ef=function(g,b){var w=Gc(g),x=b[w];switch(x){case Ol.H264_STREAM_TYPE:return"video";case Ol.ADTS_STREAM_TYPE:return"audio";case Ol.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},Sf=function(g){var b=Po(g);if(!b)return null;var w=4+Dl(g);if(w>=g.byteLength)return null;var x=null,I;return I=g[w+7],I&192&&(x={},x.pts=(g[w+9]&14)<<27|(g[w+10]&255)<<20|(g[w+11]&254)<<12|(g[w+12]&255)<<5|(g[w+13]&254)>>>3,x.pts*=4,x.pts+=(g[w+13]&6)>>>1,x.dts=x.pts,I&64&&(x.dts=(g[w+14]&14)<<27|(g[w+15]&255)<<20|(g[w+16]&254)<<12|(g[w+17]&255)<<5|(g[w+18]&254)>>>3,x.dts*=4,x.dts+=(g[w+18]&6)>>>1)),x},Ll=function(g){switch(g){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},xf=function(g){for(var b=4+Dl(g),w=g.subarray(b),x=0,I=0,N=!1,$;I<w.byteLength-3;I++)if(w[I+2]===1){x=I+5;break}for(;x<w.byteLength;)switch(w[x]){case 0:if(w[x-1]!==0){x+=2;break}else if(w[x-2]!==0){x++;break}I+3!==x-2&&($=Ll(w[I+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0));do x++;while(w[x]!==1&&x<w.length);I=x-2,x+=3;break;case 1:if(w[x-1]!==0||w[x-2]!==0){x+=3;break}$=Ll(w[I+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0),I=x-2,x+=3;break;default:x+=3;break}return w=w.subarray(I),x-=I,I=0,w&&w.byteLength>3&&($=Ll(w[I+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0)),N},zc={parseType:n_,parsePat:bf,parsePmt:Pl,parsePayloadUnitStartIndicator:Po,parsePesType:Ef,parsePesTime:Sf,videoPacketContainsKeyFrame:xf},Nl=po,Ra=Aa.handleRollover,Ut={};Ut.ts=zc,Ut.aac=vo;var on=Xt.ONE_SECOND_IN_TS,Ki=188,ns=71,wf=function(g,b){for(var w=0,x=Ki,I,N;x<g.byteLength;){if(g[w]===ns&&g[x]===ns){switch(I=g.subarray(w,x),N=Ut.ts.parseType(I,b.pid),N){case"pat":b.pid=Ut.ts.parsePat(I);break;case"pmt":var $=Ut.ts.parsePmt(I);b.table=b.table||{},Object.keys($).forEach(function(V){b.table[V]=$[V]});break}w+=Ki,x+=Ki;continue}w++,x++}},Rl=function(g,b,w){for(var x=0,I=Ki,N,$,V,Y,J,le=!1;I<=g.byteLength;){if(g[x]===ns&&(g[I]===ns||I===g.byteLength)){switch(N=g.subarray(x,I),$=Ut.ts.parseType(N,b.pid),$){case"pes":V=Ut.ts.parsePesType(N,b.table),Y=Ut.ts.parsePayloadUnitStartIndicator(N),V==="audio"&&Y&&(J=Ut.ts.parsePesTime(N),J&&(J.type="audio",w.audio.push(J),le=!0));break}if(le)break;x+=Ki,I+=Ki;continue}x++,I++}for(I=g.byteLength,x=I-Ki,le=!1;x>=0;){if(g[x]===ns&&(g[I]===ns||I===g.byteLength)){switch(N=g.subarray(x,I),$=Ut.ts.parseType(N,b.pid),$){case"pes":V=Ut.ts.parsePesType(N,b.table),Y=Ut.ts.parsePayloadUnitStartIndicator(N),V==="audio"&&Y&&(J=Ut.ts.parsePesTime(N),J&&(J.type="audio",w.audio.push(J),le=!0));break}if(le)break;x-=Ki,I-=Ki;continue}x--,I--}},Kc=function(g,b,w){for(var x=0,I=Ki,N,$,V,Y,J,le,me,Ke,Ae=!1,ft={data:[],size:0};I<g.byteLength;){if(g[x]===ns&&g[I]===ns){switch(N=g.subarray(x,I),$=Ut.ts.parseType(N,b.pid),$){case"pes":if(V=Ut.ts.parsePesType(N,b.table),Y=Ut.ts.parsePayloadUnitStartIndicator(N),V==="video"&&(Y&&!Ae&&(J=Ut.ts.parsePesTime(N),J&&(J.type="video",w.video.push(J),Ae=!0)),!w.firstKeyFrame)){if(Y&&ft.size!==0){for(le=new Uint8Array(ft.size),me=0;ft.data.length;)Ke=ft.data.shift(),le.set(Ke,me),me+=Ke.byteLength;if(Ut.ts.videoPacketContainsKeyFrame(le)){var yt=Ut.ts.parsePesTime(le);yt?(w.firstKeyFrame=yt,w.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}ft.size=0}ft.data.push(N),ft.size+=N.byteLength}break}if(Ae&&w.firstKeyFrame)break;x+=Ki,I+=Ki;continue}x++,I++}for(I=g.byteLength,x=I-Ki,Ae=!1;x>=0;){if(g[x]===ns&&g[I]===ns){switch(N=g.subarray(x,I),$=Ut.ts.parseType(N,b.pid),$){case"pes":V=Ut.ts.parsePesType(N,b.table),Y=Ut.ts.parsePayloadUnitStartIndicator(N),V==="video"&&Y&&(J=Ut.ts.parsePesTime(N),J&&(J.type="video",w.video.push(J),Ae=!0));break}if(Ae)break;x-=Ki,I-=Ki;continue}x--,I--}},Xc=function(g,b){if(g.audio&&g.audio.length){var w=b;(typeof w>"u"||isNaN(w))&&(w=g.audio[0].dts),g.audio.forEach(function(N){N.dts=Ra(N.dts,w),N.pts=Ra(N.pts,w),N.dtsTime=N.dts/on,N.ptsTime=N.pts/on})}if(g.video&&g.video.length){var x=b;if((typeof x>"u"||isNaN(x))&&(x=g.video[0].dts),g.video.forEach(function(N){N.dts=Ra(N.dts,x),N.pts=Ra(N.pts,x),N.dtsTime=N.dts/on,N.ptsTime=N.pts/on}),g.firstKeyFrame){var I=g.firstKeyFrame;I.dts=Ra(I.dts,x),I.pts=Ra(I.pts,x),I.dtsTime=I.dts/on,I.ptsTime=I.pts/on}}},Yc=function(g){for(var b=!1,w=0,x=null,I=null,N=0,$=0,V;g.length-$>=3;){var Y=Ut.aac.parseType(g,$);switch(Y){case"timed-metadata":if(g.length-$<10){b=!0;break}if(N=Ut.aac.parseId3TagSize(g,$),N>g.length){b=!0;break}I===null&&(V=g.subarray($,$+N),I=Ut.aac.parseAacTimestamp(V)),$+=N;break;case"audio":if(g.length-$<7){b=!0;break}if(N=Ut.aac.parseAdtsSize(g,$),N>g.length){b=!0;break}x===null&&(V=g.subarray($,$+N),x=Ut.aac.parseSampleRate(V)),w++,$+=N;break;default:$++;break}if(b)return null}if(x===null||I===null)return null;var J=on/x,le={audio:[{type:"audio",dts:I,pts:I},{type:"audio",dts:I+w*1024*J,pts:I+w*1024*J}]};return le},Qc=function(g){var b={pid:null,table:null},w={};wf(g,b);for(var x in b.table)if(b.table.hasOwnProperty(x)){var I=b.table[x];switch(I){case Nl.H264_STREAM_TYPE:w.video=[],Kc(g,b,w),w.video.length===0&&delete w.video;break;case Nl.ADTS_STREAM_TYPE:w.audio=[],Rl(g,b,w),w.audio.length===0&&delete w.audio;break}}return w},Cf=function(g,b){var w=Ut.aac.isLikelyAacData(g),x;return w?x=Yc(g):x=Qc(g),!x||!x.audio&&!x.video?null:(Xc(x,b),x)},Jc={inspect:Cf,parseAudioPes_:Rl};const Af=function(g,b){b.on("data",function(w){const x=w.initSegment;w.initSegment={data:x.buffer,byteOffset:x.byteOffset,byteLength:x.byteLength};const I=w.data;w.data=I.buffer,g.postMessage({action:"data",segment:w,byteOffset:I.byteOffset,byteLength:I.byteLength},[w.data])}),b.on("done",function(w){g.postMessage({action:"done"})}),b.on("gopInfo",function(w){g.postMessage({action:"gopInfo",gopInfo:w})}),b.on("videoSegmentTimingInfo",function(w){const x={start:{decode:Xt.videoTsToSeconds(w.start.dts),presentation:Xt.videoTsToSeconds(w.start.pts)},end:{decode:Xt.videoTsToSeconds(w.end.dts),presentation:Xt.videoTsToSeconds(w.end.pts)},baseMediaDecodeTime:Xt.videoTsToSeconds(w.baseMediaDecodeTime)};w.prependedContentDuration&&(x.prependedContentDuration=Xt.videoTsToSeconds(w.prependedContentDuration)),g.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:x})}),b.on("audioSegmentTimingInfo",function(w){const x={start:{decode:Xt.videoTsToSeconds(w.start.dts),presentation:Xt.videoTsToSeconds(w.start.pts)},end:{decode:Xt.videoTsToSeconds(w.end.dts),presentation:Xt.videoTsToSeconds(w.end.pts)},baseMediaDecodeTime:Xt.videoTsToSeconds(w.baseMediaDecodeTime)};w.prependedContentDuration&&(x.prependedContentDuration=Xt.videoTsToSeconds(w.prependedContentDuration)),g.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:x})}),b.on("id3Frame",function(w){g.postMessage({action:"id3Frame",id3Frame:w})}),b.on("caption",function(w){g.postMessage({action:"caption",caption:w})}),b.on("trackinfo",function(w){g.postMessage({action:"trackinfo",trackInfo:w})}),b.on("audioTimingInfo",function(w){g.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Xt.videoTsToSeconds(w.start),end:Xt.videoTsToSeconds(w.end)}})}),b.on("videoTimingInfo",function(w){g.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Xt.videoTsToSeconds(w.start),end:Xt.videoTsToSeconds(w.end)}})}),b.on("log",function(w){g.postMessage({action:"log",log:w})})};class Zc{constructor(b,w){this.options=w||{},this.self=b,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Wg.Transmuxer(this.options),Af(this.self,this.transmuxer)}pushMp4Captions(b){this.captionParser||(this.captionParser=new _f,this.captionParser.init());const w=new Uint8Array(b.data,b.byteOffset,b.byteLength),x=this.captionParser.parse(w,b.trackIds,b.timescales);this.self.postMessage({action:"mp4Captions",captions:x&&x.captions||[],logs:x&&x.logs||[],data:w.buffer},[w.buffer])}probeMp4StartTime({timescales:b,data:w}){const x=Il.startTime(b,w);this.self.postMessage({action:"probeMp4StartTime",startTime:x,data:w},[w.buffer])}probeMp4Tracks({data:b}){const w=Il.tracks(b);this.self.postMessage({action:"probeMp4Tracks",tracks:w,data:b},[b.buffer])}probeTs({data:b,baseStartTime:w}){const x=typeof w=="number"&&!isNaN(w)?w*Xt.ONE_SECOND_IN_TS:void 0,I=Jc.inspect(b,x);let N=null;I&&(N={hasVideo:I.video&&I.video.length===2||!1,hasAudio:I.audio&&I.audio.length===2||!1},N.hasVideo&&(N.videoStart=I.video[0].ptsTime),N.hasAudio&&(N.audioStart=I.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:N,data:b},[b.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(b){const w=new Uint8Array(b.data,b.byteOffset,b.byteLength);this.transmuxer.push(w)}reset(){this.transmuxer.reset()}setTimestampOffset(b){const w=b.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Xt.secondsToVideoTs(w)))}setAudioAppendStart(b){this.transmuxer.setAudioAppendStart(Math.ceil(Xt.secondsToVideoTs(b.appendStart)))}setRemux(b){this.transmuxer.setRemux(b.remux)}flush(b){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(b){this.transmuxer.alignGopsWith(b.gopsToAlignWith.slice())}}self.onmessage=function(g){if(g.data.action==="init"&&g.data.options){this.messageHandlers=new Zc(self,g.data.options);return}this.messageHandlers||(this.messageHandlers=new Zc(self)),g.data&&g.data.action&&g.data.action!=="init"&&this.messageHandlers[g.data.action]&&this.messageHandlers[g.data.action](g.data)}}));var V4=hI(H4);const q4=(t,e,i)=>{const{type:n,initSegment:o,captions:u,captionStreams:c,metadata:h,videoFrameDtsTime:m,videoFramePtsTime:v}=t.data.segment;e.buffer.push({captions:u,captionStreams:c,metadata:h});const T=t.data.segment.boxes||{data:t.data.segment.data},O={type:n,data:new Uint8Array(T.data,T.data.byteOffset,T.data.byteLength),initSegment:new Uint8Array(o.data,o.byteOffset,o.byteLength)};typeof m<"u"&&(O.videoFrameDtsTime=m),typeof v<"u"&&(O.videoFramePtsTime=v),i(O)},W4=({transmuxedData:t,callback:e})=>{t.buffer=[],e(t)},G4=(t,e)=>{e.gopInfo=t.data.gopInfo},mI=t=>{const{transmuxer:e,bytes:i,audioAppendStart:n,gopsToAlignWith:o,remux:u,onData:c,onTrackInfo:h,onAudioTimingInfo:m,onVideoTimingInfo:v,onVideoSegmentTimingInfo:T,onAudioSegmentTimingInfo:O,onId3:R,onCaptions:M,onDone:z,onEndedTimeline:j,onTransmuxerLog:q,isEndOfTimeline:W}=t,ee={buffer:[]};let se=W;const re=ie=>{e.currentTransmux===t&&(ie.data.action==="data"&&q4(ie,ee,c),ie.data.action==="trackinfo"&&h(ie.data.trackInfo),ie.data.action==="gopInfo"&&G4(ie,ee),ie.data.action==="audioTimingInfo"&&m(ie.data.audioTimingInfo),ie.data.action==="videoTimingInfo"&&v(ie.data.videoTimingInfo),ie.data.action==="videoSegmentTimingInfo"&&T(ie.data.videoSegmentTimingInfo),ie.data.action==="audioSegmentTimingInfo"&&O(ie.data.audioSegmentTimingInfo),ie.data.action==="id3Frame"&&R([ie.data.id3Frame],ie.data.id3Frame.dispatchType),ie.data.action==="caption"&&M(ie.data.caption),ie.data.action==="endedtimeline"&&(se=!1,j()),ie.data.action==="log"&&q(ie.data.log),ie.data.type==="transmuxed"&&(se||(e.onmessage=null,W4({transmuxedData:ee,callback:z}),gI(e))))};if(e.onmessage=re,n&&e.postMessage({action:"setAudioAppendStart",appendStart:n}),Array.isArray(o)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof u<"u"&&e.postMessage({action:"setRemux",remux:u}),i.byteLength){const ie=i instanceof ArrayBuffer?i:i.buffer,ye=i instanceof ArrayBuffer?0:i.byteOffset;e.postMessage({action:"push",data:ie,byteOffset:ye,byteLength:i.byteLength},[ie])}W&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},gI=t=>{t.currentTransmux=null,t.transmuxQueue.length&&(t.currentTransmux=t.transmuxQueue.shift(),typeof t.currentTransmux=="function"?t.currentTransmux():mI(t.currentTransmux))},Sw=(t,e)=>{t.postMessage({action:e}),gI(t)},_I=(t,e)=>{if(!e.currentTransmux){e.currentTransmux=t,Sw(e,t);return}e.transmuxQueue.push(Sw.bind(null,e,t))},z4=t=>{_I("reset",t)},K4=t=>{_I("endTimeline",t)},yI=t=>{if(!t.transmuxer.currentTransmux){t.transmuxer.currentTransmux=t,mI(t);return}t.transmuxer.transmuxQueue.push(t)},X4=t=>{const e=new V4;e.currentTransmux=null,e.transmuxQueue=[];const i=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)),e.postMessage({action:"init",options:t}),e};var Yy={reset:z4,endTimeline:K4,transmux:yI,createTransmuxer:X4};const Lm=function(t){const e=t.transmuxer,i=t.endAction||t.action,n=t.callback,o=ya({},t,{endAction:null,transmuxer:null,callback:null}),u=c=>{c.data.action===i&&(e.removeEventListener("message",u),c.data.data&&(c.data.data=new Uint8Array(c.data.data,t.byteOffset||0,t.byteLength||c.data.data.byteLength),t.data&&(t.data=c.data.data)),n(c.data))};if(e.addEventListener("message",u),t.data){const c=t.data instanceof ArrayBuffer;o.byteOffset=c?0:t.data.byteOffset,o.byteLength=t.data.byteLength;const h=[c?t.data:t.data.buffer];e.postMessage(o,h)}else e.postMessage(o)},Cr={FAILURE:2,TIMEOUT:-101,ABORTED:-102},F0=t=>{t.forEach(e=>{e.abort()})},Y4=t=>({bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}),Q4=t=>{const e=t.target,n={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return n.bytesReceived=t.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n},wT=(t,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Cr.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Cr.ABORTED,xhr:e}:t?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Cr.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Cr.FAILURE,xhr:e}:null,xw=(t,e,i)=>(n,o)=>{const u=o.response,c=wT(n,o);if(c)return i(c,t);if(u.byteLength!==16)return i({status:o.status,message:"Invalid HLS key at URL: "+o.uri,code:Cr.FAILURE,xhr:o},t);const h=new DataView(u),m=new Uint32Array([h.getUint32(0),h.getUint32(4),h.getUint32(8),h.getUint32(12)]);for(let v=0;v<e.length;v++)e[v].bytes=m;return i(null,t)},vI=(t,e)=>{const i=Vv(t.map.bytes);if(i!=="mp4"){const n=t.map.resolvedUri||t.map.uri;return e({internal:!0,message:`Found unsupported ${i||"unknown"} container for initialization segment at URL: ${n}`,code:Cr.FAILURE})}Lm({action:"probeMp4Tracks",data:t.map.bytes,transmuxer:t.transmuxer,callback:({tracks:n,data:o})=>(t.map.bytes=o,n.forEach(function(u){t.map.tracks=t.map.tracks||{},!t.map.tracks[u.type]&&(t.map.tracks[u.type]=u,typeof u.id=="number"&&u.timescale&&(t.map.timescales=t.map.timescales||{},t.map.timescales[u.id]=u.timescale))}),e(null))})},J4=({segment:t,finishProcessingFn:e})=>(i,n)=>{const o=wT(i,n);if(o)return e(o,t);const u=new Uint8Array(n.response);if(t.map.key)return t.map.encryptedBytes=u,e(null,t);t.map.bytes=u,vI(t,function(c){if(c)return c.xhr=n,c.status=n.status,e(c,t);e(null,t)})},Z4=({segment:t,finishProcessingFn:e,responseType:i})=>(n,o)=>{const u=wT(n,o);if(u)return e(u,t);const c=i==="arraybuffer"||!o.responseText?o.response:$4(o.responseText.substring(t.lastReachedChar||0));return t.stats=Y4(o),t.key?t.encryptedBytes=new Uint8Array(c):t.bytes=new Uint8Array(c),e(null,t)},e8=({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})=>{const M=t.map&&t.map.tracks||{},z=Boolean(M.audio&&M.video);let j=n.bind(null,t,"audio","start");const q=n.bind(null,t,"audio","end");let W=n.bind(null,t,"video","start");const ee=n.bind(null,t,"video","end"),se=()=>yI({bytes:e,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:z,onData:re=>{re.type=re.type==="combined"?"video":re.type,T(t,re)},onTrackInfo:re=>{i&&(z&&(re.isMuxed=!0),i(t,re))},onAudioTimingInfo:re=>{j&&typeof re.start<"u"&&(j(re.start),j=null),q&&typeof re.end<"u"&&q(re.end)},onVideoTimingInfo:re=>{W&&typeof re.start<"u"&&(W(re.start),W=null),ee&&typeof re.end<"u"&&ee(re.end)},onVideoSegmentTimingInfo:re=>{o(re)},onAudioSegmentTimingInfo:re=>{u(re)},onId3:(re,ie)=>{c(t,re,ie)},onCaptions:re=>{h(t,[re])},isEndOfTimeline:m,onEndedTimeline:()=>{v()},onTransmuxerLog:R,onDone:re=>{O&&(re.type=re.type==="combined"?"video":re.type,O(null,t,re))}});Lm({action:"probeTs",transmuxer:t.transmuxer,data:e,baseStartTime:t.baseStartTime,callback:re=>{t.bytes=e=re.data;const ie=re.result;ie&&(i(t,{hasAudio:ie.hasAudio,hasVideo:ie.hasVideo,isMuxed:z}),i=null,ie.hasAudio&&!z&&j(ie.audioStart),ie.hasVideo&&W(ie.videoStart),j=null,W=null),se()}})},TI=({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})=>{let M=new Uint8Array(e);if(D$(M)){t.isFmp4=!0;const{tracks:z}=t.map,j={isFmp4:!0,hasVideo:!!z.video,hasAudio:!!z.audio};z.audio&&z.audio.codec&&z.audio.codec!=="enca"&&(j.audioCodec=z.audio.codec),z.video&&z.video.codec&&z.video.codec!=="encv"&&(j.videoCodec=z.video.codec),z.video&&z.audio&&(j.isMuxed=!0),i(t,j);const q=W=>{T(t,{data:M,type:j.hasAudio&&!j.isMuxed?"audio":"video"}),W&&W.length&&h(t,W),O(null,t,{})};Lm({action:"probeMp4StartTime",timescales:t.map.timescales,data:M,transmuxer:t.transmuxer,callback:({data:W,startTime:ee})=>{if(e=W.buffer,t.bytes=M=W,j.hasAudio&&!j.isMuxed&&n(t,"audio","start",ee),j.hasVideo&&n(t,"video","start",ee),!z.video||!W.byteLength||!t.transmuxer){q();return}Lm({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:M,timescales:t.map.timescales,trackIds:[z.video.id],callback:se=>{e=se.data.buffer,t.bytes=M=se.data,se.logs.forEach(function(re){R(ui(re,{stream:"mp4CaptionParser"}))}),q(se.captions)}})}});return}if(!t.transmuxer){O(null,t,{});return}if(typeof t.container>"u"&&(t.container=Vv(M)),t.container!=="ts"&&t.container!=="aac"){i(t,{hasAudio:!1,hasVideo:!1}),O(null,t,{});return}e8({segment:t,bytes:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})},bI=function({id:t,key:e,encryptedBytes:i,decryptionWorker:n},o){const u=h=>{if(h.data.source===t){n.removeEventListener("message",u);const m=h.data.decrypted;o(new Uint8Array(m.bytes,m.byteOffset,m.byteLength))}};n.addEventListener("message",u);let c;e.bytes.slice?c=e.bytes.slice():c=new Uint32Array(Array.prototype.slice.call(e.bytes)),n.postMessage(aI({source:t,encrypted:i,key:c,iv:e.iv}),[i.buffer,c.buffer])},t8=({decryptionWorker:t,segment:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})=>{bI({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:t},M=>{e.bytes=M,TI({segment:e,bytes:e.bytes,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})})},i8=({activeXhrs:t,decryptionWorker:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})=>{let M=0,z=!1;return(j,q)=>{if(!z){if(j)return z=!0,F0(t),O(j,q);if(M+=1,M===t.length){const W=function(){if(q.encryptedBytes)return t8({decryptionWorker:e,segment:q,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R});TI({segment:q,bytes:q.bytes,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T,doneFn:O,onTransmuxerLog:R})};if(q.endOfAllRequests=Date.now(),q.map&&q.map.encryptedBytes&&!q.map.bytes)return bI({decryptionWorker:e,id:q.requestId+"-init",encryptedBytes:q.map.encryptedBytes,key:q.map.key},ee=>{q.map.bytes=ee,vI(q,se=>{if(se)return F0(t),O(se,q);W()})});W()}}}},s8=({loadendState:t,abortFn:e})=>i=>{i.target.aborted&&e&&!t.calledAbortFn&&(e(),t.calledAbortFn=!0)},n8=({segment:t,progressFn:e,trackInfoFn:i,timingInfoFn:n,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:m,endedTimelineFn:v,dataFn:T})=>O=>{if(!O.target.aborted)return t.stats=ui(t.stats,Q4(O)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),e(O,t)},r8=({xhr:t,xhrOptions:e,decryptionWorker:i,segment:n,abortFn:o,progressFn:u,trackInfoFn:c,timingInfoFn:h,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:v,id3Fn:T,captionsFn:O,isEndOfTimeline:R,endedTimelineFn:M,dataFn:z,doneFn:j,onTransmuxerLog:q})=>{const W=[],ee=i8({activeXhrs:W,decryptionWorker:i,trackInfoFn:c,timingInfoFn:h,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:v,id3Fn:T,captionsFn:O,isEndOfTimeline:R,endedTimelineFn:M,dataFn:z,doneFn:j,onTransmuxerLog:q});if(n.key&&!n.key.bytes){const Pe=[n.key];n.map&&!n.map.bytes&&n.map.key&&n.map.key.resolvedUri===n.key.resolvedUri&&Pe.push(n.map.key);const Ie=ui(e,{uri:n.key.resolvedUri,responseType:"arraybuffer"}),Be=xw(n,Pe,ee),Ve=t(Ie,Be);W.push(Ve)}if(n.map&&!n.map.bytes){if(n.map.key&&(!n.key||n.key.resolvedUri!==n.map.key.resolvedUri)){const We=ui(e,{uri:n.map.key.resolvedUri,responseType:"arraybuffer"}),it=xw(n,[n.map.key],ee),Le=t(We,it);W.push(Le)}const Ie=ui(e,{uri:n.map.resolvedUri,responseType:"arraybuffer",headers:U0(n.map)}),Be=J4({segment:n,finishProcessingFn:ee}),Ve=t(Ie,Be);W.push(Ve)}const se=ui(e,{uri:n.part&&n.part.resolvedUri||n.resolvedUri,responseType:"arraybuffer",headers:U0(n)}),re=Z4({segment:n,finishProcessingFn:ee,responseType:se.responseType}),ie=t(se,re);ie.addEventListener("progress",n8({segment:n,progressFn:u,trackInfoFn:c,timingInfoFn:h,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:v,id3Fn:T,captionsFn:O,isEndOfTimeline:R,endedTimelineFn:M,dataFn:z})),W.push(ie);const ye={};return W.forEach(Pe=>{Pe.addEventListener("loadend",s8({loadendState:ye,abortFn:o}))}),()=>F0(W)},a8=or("CodecUtils"),o8=function(t){const e=t.attributes||{};if(e.CODECS)return Tr(e.CODECS)},EI=(t,e)=>{const i=e.attributes||{};return t&&t.mediaGroups&&t.mediaGroups.AUDIO&&i.AUDIO&&t.mediaGroups.AUDIO[i.AUDIO]},l8=(t,e)=>{if(!EI(t,e))return!0;const i=e.attributes||{},n=t.mediaGroups.AUDIO[i.AUDIO];for(const o in n)if(!n[o].uri&&!n[o].playlists)return!0;return!1},Nm=function(t){const e={};return t.forEach(({mediaType:i,type:n,details:o})=>{e[i]=e[i]||[],e[i].push($1(`${n}${o}`))}),Object.keys(e).forEach(function(i){if(e[i].length>1){a8(`multiple ${i} codecs found as attributes: ${e[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[i]=null;return}e[i]=e[i][0]}),e},ww=function(t){let e=0;return t.audio&&e++,t.video&&e++,e},nh=function(t,e){const i=e.attributes||{},n=Nm(o8(e)||[]);if(EI(t,e)&&!n.audio&&!l8(t,e)){const o=Nm(NB(t,i.AUDIO)||[]);o.audio&&(n.audio=o.audio)}return n},Fp=or("PlaylistSelector"),Cw=function(t){if(!t||!t.playlist)return;const e=t.playlist;return JSON.stringify({id:e.id,bandwidth:t.bandwidth,width:t.width,height:t.height,codecs:e.attributes&&e.attributes.CODECS||""})},Rm=function(t,e){if(!t)return"";const i=Z.getComputedStyle(t);return i?i[e]:""},Lu=function(t,e){const i=t.slice();t.sort(function(n,o){const u=e(n,o);return u===0?i.indexOf(n)-i.indexOf(o):u})},CT=function(t,e){let i,n;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||Z.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||Z.Number.MAX_VALUE,i-n},u8=function(t,e){let i,n;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||Z.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||Z.Number.MAX_VALUE,i===n&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?t.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-n};let SI=function(t,e,i,n,o,u){if(!t)return;const c={bandwidth:e,width:i,height:n,limitRenditionByPlayerDimensions:o};let h=t.playlists;Xs.isAudioOnly(t)&&(h=u.getAudioTrackPlaylists_(),c.audioOnly=!0);let m=h.map(ie=>{let ye;const Pe=ie.attributes&&ie.attributes.RESOLUTION&&ie.attributes.RESOLUTION.width,Ie=ie.attributes&&ie.attributes.RESOLUTION&&ie.attributes.RESOLUTION.height;return ye=ie.attributes&&ie.attributes.BANDWIDTH,ye=ye||Z.Number.MAX_VALUE,{bandwidth:ye,width:Pe,height:Ie,playlist:ie}});Lu(m,(ie,ye)=>ie.bandwidth-ye.bandwidth),m=m.filter(ie=>!Xs.isIncompatible(ie.playlist));let v=m.filter(ie=>Xs.isEnabled(ie.playlist));v.length||(v=m.filter(ie=>!Xs.isDisabled(ie.playlist)));const T=v.filter(ie=>ie.bandwidth*Ji.BANDWIDTH_VARIANCE<e);let O=T[T.length-1];const R=T.filter(ie=>ie.bandwidth===O.bandwidth)[0];if(o===!1){const ie=R||v[0]||m[0];if(ie&&ie.playlist){let ye="sortedPlaylistReps";return R&&(ye="bandwidthBestRep"),v[0]&&(ye="enabledPlaylistReps"),Fp(`choosing ${Cw(ie)} using ${ye} with options`,c),ie.playlist}return Fp("could not choose a playlist with options",c),null}const M=T.filter(ie=>ie.width&&ie.height);Lu(M,(ie,ye)=>ie.width-ye.width);const z=M.filter(ie=>ie.width===i&&ie.height===n);O=z[z.length-1];const j=z.filter(ie=>ie.bandwidth===O.bandwidth)[0];let q,W,ee;j||(q=M.filter(ie=>ie.width>i||ie.height>n),W=q.filter(ie=>ie.width===q[0].width&&ie.height===q[0].height),O=W[W.length-1],ee=W.filter(ie=>ie.bandwidth===O.bandwidth)[0]);let se;if(u.leastPixelDiffSelector){const ie=M.map(ye=>(ye.pixelDiff=Math.abs(ye.width-i)+Math.abs(ye.height-n),ye));Lu(ie,(ye,Pe)=>ye.pixelDiff===Pe.pixelDiff?Pe.bandwidth-ye.bandwidth:ye.pixelDiff-Pe.pixelDiff),se=ie[0]}const re=se||ee||j||R||v[0]||m[0];if(re&&re.playlist){let ie="sortedPlaylistReps";return se?ie="leastPixelDiffRep":ee?ie="resolutionPlusOneRep":j?ie="resolutionBestRep":R?ie="bandwidthBestRep":v[0]&&(ie="enabledPlaylistReps"),Fp(`choosing ${Cw(re)} using ${ie} with options`,c),re.playlist}return Fp("could not choose a playlist with options",c),null};const Aw=function(){const t=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return SI(this.playlists.main,this.systemBandwidth,parseInt(Rm(this.tech_.el(),"width"),10)*t,parseInt(Rm(this.tech_.el(),"height"),10)*t,this.limitRenditionByPlayerDimensions,this.playlistController_)},c8=function(t){let e=-1,i=-1;if(t<0||t>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const n=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=t*this.systemBandwidth+(1-t)*e,i=this.systemBandwidth),SI(this.playlists.main,e,parseInt(Rm(this.tech_.el(),"width"),10)*n,parseInt(Rm(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions,this.playlistController_)}},d8=function(t){const{main:e,currentTime:i,bandwidth:n,duration:o,segmentDuration:u,timeUntilRebuffer:c,currentTimeline:h,syncController:m}=t,v=e.playlists.filter(z=>!Xs.isIncompatible(z));let T=v.filter(Xs.isEnabled);T.length||(T=v.filter(z=>!Xs.isDisabled(z)));const R=T.filter(Xs.hasAttribute.bind(null,"BANDWIDTH")).map(z=>{const q=m.getSyncPoint(z,o,h,i)?1:2,ee=Xs.estimateSegmentRequestTime(u,n,z)*q-c;return{playlist:z,rebufferingImpact:ee}}),M=R.filter(z=>z.rebufferingImpact<=0);return Lu(M,(z,j)=>CT(j.playlist,z.playlist)),M.length?M[0]:(Lu(R,(z,j)=>z.rebufferingImpact-j.rebufferingImpact),R[0]||null)},h8=function(){const t=this.playlists.main.playlists.filter(Xs.isEnabled);return Lu(t,(i,n)=>CT(i,n)),t.filter(i=>!!nh(this.playlists.main,i).video)[0]||null},f8=t=>{let e=0,i;return t.bytes&&(i=new Uint8Array(t.bytes),t.segments.forEach(n=>{i.set(n,e),e+=n.byteLength})),i},p8=function(t,e,i){if(!t[i]){e.trigger({type:"usage",name:"vhs-608"});let n=i;/^cc708_/.test(i)&&(n="SERVICE"+i.split("_")[1]);const o=e.textTracks().getTrackById(n);if(o)t[i]=o;else{const u=e.options_.vhs&&e.options_.vhs.captionServices||{};let c=i,h=i,m=!1;const v=u[n];v&&(c=v.label,h=v.language,m=v.default),t[i]=e.addRemoteTextTrack({kind:"captions",id:n,default:m,label:c,language:h},!1).track}}},m8=function({inbandTextTracks:t,captionArray:e,timestampOffset:i}){if(!e)return;const n=Z.WebKitDataCue||Z.VTTCue;e.forEach(o=>{const u=o.stream;t[u].addCue(new n(o.startTime+i,o.endTime+i,o.text))})},g8=function(t){Object.defineProperties(t.frame,{id:{get(){return he.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get(){return he.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get(){return he.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},_8=({inbandTextTracks:t,metadataArray:e,timestampOffset:i,videoDuration:n})=>{if(!e)return;const o=Z.WebKitDataCue||Z.VTTCue,u=t.metadataTrack_;if(!u||(e.forEach(T=>{const O=T.cueTime+i;typeof O!="number"||Z.isNaN(O)||O<0||!(O<1/0)||T.frames.forEach(R=>{const M=new o(O,O,R.value||R.url||R.data||"");M.frame=R,M.value=R,g8(M),u.addCue(M)})}),!u.cues||!u.cues.length))return;const c=u.cues,h=[];for(let T=0;T<c.length;T++)c[T]&&h.push(c[T]);const m=h.reduce((T,O)=>{const R=T[O.startTime]||[];return R.push(O),T[O.startTime]=R,T},{}),v=Object.keys(m).sort((T,O)=>Number(T)-Number(O));v.forEach((T,O)=>{const R=m[T],M=Number(v[O+1])||n;R.forEach(z=>{z.endTime=M})})},y8=(t,e,i)=>{t.metadataTrack_||(t.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,t.metadataTrack_.inBandMetadataTrackDispatchType=e)},Xd=function(t,e,i){let n,o;if(i&&i.cues)for(n=i.cues.length;n--;)o=i.cues[n],o.startTime>=t&&o.endTime<=e&&i.removeCue(o)},v8=function(t){const e=t.cues;if(e)for(let i=0;i<e.length;i++){const n=[];let o=0;for(let u=0;u<e.length;u++)e[i].startTime===e[u].startTime&&e[i].endTime===e[u].endTime&&e[i].text===e[u].text&&(o++,o>1&&n.push(e[u]));n.length&&n.forEach(u=>t.removeCue(u))}},T8=(t,e,i)=>{if(typeof e>"u"||e===null||!t.length)return[];const n=Math.ceil((e-i+3)*ym.ONE_SECOND_IN_TS);let o;for(o=0;o<t.length&&!(t[o].pts>n);o++);return t.slice(o)},b8=(t,e,i)=>{if(!e.length)return t;if(i)return e.slice();const n=e[0].pts;let o=0;for(o;o<t.length&&!(t[o].pts>=n);o++);return t.slice(0,o).concat(e)},E8=(t,e,i,n)=>{const o=Math.ceil((e-n)*ym.ONE_SECOND_IN_TS),u=Math.ceil((i-n)*ym.ONE_SECOND_IN_TS),c=t.slice();let h=t.length;for(;h--&&!(t[h].pts<=u););if(h===-1)return c;let m=h+1;for(;m--&&!(t[m].pts<=o););return m=Math.max(m,0),c.splice(m,h-m+1),c},S8=function(t,e){if(!t&&!e||!t&&e||t&&!e)return!1;if(t===e)return!0;const i=Object.keys(t).sort(),n=Object.keys(e).sort();if(i.length!==n.length)return!1;for(let o=0;o<i.length;o++){const u=i[o];if(u!==n[o]||t[u]!==e[u])return!1}return!0},xI=22,x8=function(t,e,i){e=e||[];const n=[];let o=0;for(let u=0;u<e.length;u++){const c=e[u];if(t===c.timeline&&(n.push(u),o+=c.duration,o>i))return u}return n.length===0?0:n[n.length-1]},Hd=1,w8=500,kw=t=>typeof t=="number"&&isFinite(t),$p=1/60,C8=(t,e,i)=>t!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,A8=(t,e,i)=>{let n=e-Ji.BACK_BUFFER_LENGTH;t.length&&(n=Math.max(n,t.start(0)));const o=e-i;return Math.min(o,n)},_u=t=>{const{startOfSegment:e,duration:i,segment:n,part:o,playlist:{mediaSequence:u,id:c,segments:h=[]},mediaIndex:m,partIndex:v,timeline:T}=t,O=h.length-1;let R="mediaIndex/partIndex increment";t.getMediaInfoForTime?R=`getMediaInfoForTime (${t.getMediaInfoForTime})`:t.isSyncRequest&&(R="getSyncSegmentCandidate (isSyncRequest)"),t.independent&&(R+=` with independent ${t.independent}`);const M=typeof v=="number",z=t.segment.uri?"segment":"pre-segment",j=M?Gk({preloadSegment:n})-1:0;return`${z} [${u+m}/${u+O}]`+(M?` part [${v}/${j}]`:"")+` segment start/end [${n.start} => ${n.end}]`+(M?` part start/end [${o.start} => ${o.end}]`:"")+` startOfSegment [${e}] duration [${i}] timeline [${T}] selected by [${R}] playlist [${c}]`},Iw=t=>`${t}TimingInfo`,k8=({segmentTimeline:t,currentTimeline:e,startOfSegment:i,buffered:n,overrideCheck:o})=>!o&&t===e?null:t<e?i:n.length?n.end(n.length-1):i,Ow=({timelineChangeController:t,currentTimeline:e,segmentTimeline:i,loaderType:n,audioDisabled:o})=>{if(e===i)return!1;if(n==="audio"){const u=t.lastTimelineChange({type:"main"});return!u||u.to!==i}if(n==="main"&&o){const u=t.pendingTimelineChange({type:"audio"});return!(u&&u.to===i)}return!1},I8=t=>{let e=0;return["video","audio"].forEach(function(i){const n=t[`${i}TimingInfo`];if(!n)return;const{start:o,end:u}=n;let c;typeof o=="bigint"||typeof u=="bigint"?c=Z.BigInt(u)-Z.BigInt(o):typeof o=="number"&&typeof u=="number"&&(c=u-o),typeof c<"u"&&c>e&&(e=c)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},Dw=({segmentDuration:t,maxDuration:e})=>t?Math.round(t)>e+io:!1,O8=(t,e)=>{if(e!=="hls")return null;const i=I8({audioTimingInfo:t.audioTimingInfo,videoTimingInfo:t.videoTimingInfo});if(!i)return null;const n=t.playlist.targetDuration,o=Dw({segmentDuration:i,maxDuration:n*2}),u=Dw({segmentDuration:i,maxDuration:n}),c=`Segment with index ${t.mediaIndex} from playlist ${t.playlist.id} has a duration of ${i} when the reported duration is ${t.duration} and the target duration is ${n}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return o||u?{severity:o?"warn":"info",message:c}:null};class $0 extends he.EventTarget{constructor(e,i={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=he.browser.IE_VERSION>=11,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=or(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(n){n!==this.state_&&(this.logger_(`${this.state_} -> ${n}`),this.state_=n,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return Yy.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,Z.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&Yy.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return _s();if(this.loaderType_==="main"){const{hasAudio:i,hasVideo:n,isMuxed:o}=e;if(n&&i&&!this.audioDisabled_&&!o)return this.sourceUpdater_.buffered();if(n)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,i=!1){if(!e)return null;const n=Pm(e);let o=this.initSegments_[n];return i&&!o&&e.bytes&&(this.initSegments_[n]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),o||e}segmentKey(e,i=!1){if(!e)return null;const n=oI(e);let o=this.keyCache_[n];this.cacheEncryptionKeys_&&i&&!o&&e.bytes&&(this.keyCache_[n]=o={resolvedUri:e.resolvedUri,bytes:e.bytes});const u={resolvedUri:(o||e).resolvedUri};return o&&(u.bytes=o.bytes),u}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,i={}){if(!e)return;const n=this.playlist_,o=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let u=null;if(n&&(n.id?u=n.id:n.uri&&(u=n.uri)),this.logger_(`playlist update [${u} => ${e.id||e.uri}]`),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!n||n.uri!==e.uri){this.mediaIndex!==null&&(e.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const c=e.mediaSequence-n.mediaSequence;if(this.logger_(`live window shift [${c}]`),this.mediaIndex!==null)if(this.mediaIndex-=c,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const h=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!h.parts||!h.parts.length||!h.parts[this.partIndex])){const m=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=m}}o&&(o.mediaIndex-=c,o.mediaIndex<0?(o.mediaIndex=null,o.partIndex=null):(o.mediaIndex>=0&&(o.segment=e.segments[o.mediaIndex]),o.partIndex>=0&&o.segment.parts&&(o.part=o.segment.parts[o.partIndex]))),this.syncController_.saveExpiredSegmentInfo(n,e)}pause(){this.checkBufferTimeout_&&(Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&Yy.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,i,n=()=>{},o=!1){if(i===1/0&&(i=this.duration_()),i<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let u=1;const c=()=>{u--,u===0&&n()};(o||!this.audioDisabled_)&&(u++,this.sourceUpdater_.removeAudio(e,i,c)),(o||this.loaderType_==="main")&&(this.gopBuffer_=E8(this.gopBuffer_,e,i,this.timeMapping_),u++,this.sourceUpdater_.removeVideo(e,i,c));for(const h in this.inbandTextTracks_)Xd(e,i,this.inbandTextTracks_[h]);Xd(e,i,this.segmentMetadataTrack_),c()}monitorBuffer_(){this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),w8)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();e&&(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,i=this.playlist_,n=this.partIndex){if(!i||!this.mediaSource_)return!1;const o=typeof e=="number"&&i.segments[e],u=e+1===i.segments.length,c=!o||!o.parts||n+1===o.parts.length;return i.endList&&this.mediaSource_.readyState==="open"&&u&&c}chooseNextRequest_(){const e=this.buffered_(),i=vw(e)||0,n=TT(e,this.currentTime_()),o=!this.hasPlayed_()&&n>=1,u=n>=this.goalBufferLength_(),c=this.playlist_.segments;if(!c.length||o||u)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());const h={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(h.isSyncRequest)h.mediaIndex=x8(this.currentTimeline_,c,i);else if(this.mediaIndex!==null){const O=c[this.mediaIndex],R=typeof this.partIndex=="number"?this.partIndex:-1;h.startOfSegment=O.end?O.end:i,O.parts&&O.parts[R+1]?(h.mediaIndex=this.mediaIndex,h.partIndex=R+1):h.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:O,startTime:R,partIndex:M}=Xs.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?i:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});h.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${i}`:`currentTime ${this.currentTime_()}`,h.mediaIndex=O,h.startOfSegment=R,h.partIndex=M}const m=c[h.mediaIndex];let v=m&&typeof h.partIndex=="number"&&m.parts&&m.parts[h.partIndex];if(!m||typeof h.partIndex=="number"&&!v)return null;if(typeof h.partIndex!="number"&&m.parts&&(h.partIndex=0,v=m.parts[0]),!n&&v&&!v.independent)if(h.partIndex===0){const O=c[h.mediaIndex-1],R=O.parts&&O.parts.length&&O.parts[O.parts.length-1];R&&R.independent&&(h.mediaIndex-=1,h.partIndex=O.parts.length-1,h.independent="previous segment")}else m.parts[h.partIndex-1].independent&&(h.partIndex-=1,h.independent="previous part");const T=this.mediaSource_&&this.mediaSource_.readyState==="ended";return h.mediaIndex>=c.length-1&&T&&!this.seeking_()?null:this.generateSegmentInfo_(h)}generateSegmentInfo_(e){const{independent:i,playlist:n,mediaIndex:o,startOfSegment:u,isSyncRequest:c,partIndex:h,forceTimestampOffset:m,getMediaInfoForTime:v}=e,T=n.segments[o],O=typeof h=="number"&&T.parts[h],R={requestId:"segment-loader-"+Math.random(),uri:O&&O.resolvedUri||T.resolvedUri,mediaIndex:o,partIndex:O?h:null,isSyncRequest:c,startOfSegment:u,playlist:n,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:T.timeline,duration:O&&O.duration||T.duration,segment:T,part:O,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:v,independent:i},M=typeof m<"u"?m:this.isPendingTimestampOffset_;R.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:T.timeline,currentTimeline:this.currentTimeline_,startOfSegment:u,buffered:this.buffered_(),overrideCheck:M});const z=vw(this.sourceUpdater_.audioBuffered());return typeof z=="number"&&(R.audioAppendStart=z-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(R.gopsToAlignWith=T8(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),R}timestampOffsetForSegment_(e){return k8(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const i=this.currentTime_(),n=e.bandwidth,o=this.pendingSegment_.duration,u=Xs.estimateSegmentRequestTime(o,n,this.playlist_,e.bytesReceived),c=i4(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(u<=c)return;const h=d8({main:this.vhs_.playlists.main,currentTime:i,bandwidth:n,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:c,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!h)return;const v=u-c-h.rebufferingImpact;let T=.5;c<=io&&(T=1),!(!h.playlist||h.playlist.uri===this.playlist_.uri||v<T)&&(this.bandwidth=h.playlist.attributes.BANDWIDTH*Ji.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${_u(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&this.trigger("progress")}handleTrackInfo_(e,i){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(i)||(i=i||{},S8(this.currentMediaInfo_,i)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,i,n,o){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const u=this.pendingSegment_,c=Iw(i);u[c]=u[c]||{},u[c][n]=o,this.logger_(`timinginfo: ${i} - ${n} - ${o}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(i.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));return}const o=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),u={};i.forEach(c=>{u[c.stream]=u[c.stream]||{startTime:1/0,captions:[],endTime:0};const h=u[c.stream];h.startTime=Math.min(h.startTime,c.startTime+o),h.endTime=Math.max(h.endTime,c.endTime+o),h.captions.push(c)}),Object.keys(u).forEach(c=>{const{startTime:h,endTime:m,captions:v}=u[c],T=this.inbandTextTracks_;this.logger_(`adding cues from ${h} -> ${m} for ${c}`),p8(T,this.vhs_.tech_,c),Xd(h,m,T[c]),m8({captionArray:v,inbandTextTracks:T,timestampOffset:o})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,i,n){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,n));return}const u=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();y8(this.inbandTextTracks_,n,this.vhs_.tech_),_8({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:u,videoDuration:this.duration_()})}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(i=>i())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(i=>i())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!Ow({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,i=this.getCurrentMediaInfo_();if(!e||!i)return!1;const{hasAudio:n,hasVideo:o,isMuxed:u}=i;return!(o&&!e.videoTimingInfo||n&&!this.audioDisabled_&&!u&&!e.audioTimingInfo||Ow({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,i));return}const n=this.pendingSegment_;if(this.setTimeMapping_(n.timeline),this.updateMediaSecondsLoaded_(n.part||n.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),n.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),n.isFmp4=e.isFmp4,n.timingInfo=n.timingInfo||{},n.isFmp4)this.trigger("fmp4"),n.timingInfo.start=n[Iw(i.type)].start;else{const o=this.getCurrentMediaInfo_(),u=this.loaderType_==="main"&&o&&o.hasVideo;let c;u&&(c=n.videoTimingInfo.start),n.timingInfo.start=this.trueSegmentStart_({currentStart:n.timingInfo.start,playlist:n.playlist,mediaIndex:n.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:u,firstVideoFrameTimeForData:c,videoTimingInfo:n.videoTimingInfo,audioTimingInfo:n.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(n,i.type),this.updateSourceBufferTimestampOffset_(n),n.isSyncRequest){this.updateTimingInfoEnd_(n),this.syncController_.saveSegmentTimingInfo({segmentInfo:n,shouldSaveTimelineMapping:this.loaderType_==="main"});const o=this.chooseNextRequest_();if(o.mediaIndex!==n.mediaIndex||o.partIndex!==n.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}n.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(n,i)}}updateAppendInitSegmentStatus(e,i){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:i,map:n,playlist:o}){if(n){const u=Pm(n);if(this.activeInitSegmentId_===u)return null;i=this.initSegmentForMap(n,!0).bytes,this.activeInitSegmentId_=u}return i&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=o,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:e,type:i,bytes:n},o){const u=this.sourceUpdater_.audioBuffered(),c=this.sourceUpdater_.videoBuffered();u.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Xo(u).join(", ")),c.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Xo(c).join(", "));const h=u.length?u.start(0):0,m=u.length?u.end(u.length-1):0,v=c.length?c.start(0):0,T=c.length?c.end(c.length-1):0;if(m-h<=Hd&&T-v<=Hd){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${n.byteLength}, audio buffer: ${Xo(u).join(", ")}, video buffer: ${Xo(c).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:i,bytes:n}));const R=this.currentTime_()-Hd;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${R}`),this.remove(0,R,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Hd}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=Z.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Hd*1e3)},!0)}handleAppendError_({segmentInfo:e,type:i,bytes:n},o){if(o){if(o.code===xI){this.handleQuotaExceededError_({segmentInfo:e,type:i,bytes:n});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error(`${i} append of ${n.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:n,data:o,bytes:u}){if(!u){const c=[o];let h=o.byteLength;n&&(c.unshift(n),h+=n.byteLength),u=f8({bytes:h,segments:c})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:i,bytes:u},this.handleAppendError_.bind(this,{segmentInfo:e,type:i,bytes:u}))}handleSegmentTimingInfo_(e,i,n){if(!this.pendingSegment_||i!==this.pendingSegment_.requestId)return;const o=this.pendingSegment_.segment,u=`${e}TimingInfo`;o[u]||(o[u]={}),o[u].transmuxerPrependedSeconds=n.prependedContentDuration||0,o[u].transmuxedPresentationStart=n.start.presentation,o[u].transmuxedDecodeStart=n.start.decode,o[u].transmuxedPresentationEnd=n.end.presentation,o[u].transmuxedDecodeEnd=n.end.decode,o[u].baseMediaDecodeTime=n.baseMediaDecodeTime}appendData_(e,i){const{type:n,data:o}=i;if(!o||!o.byteLength||n==="audio"&&this.audioDisabled_)return;const u=this.getInitSegmentAndUpdateState_({type:n,initSegment:i.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:n,initSegment:u,data:o})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const i=ya({},e,{forceTimestampOffset:!0});ya(e,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const i=this.createSimplifiedSegmentObj_(e),n=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),o=this.mediaIndex!==null,u=e.timeline!==this.currentTimeline_&&e.timeline>0,c=n||o&&u;this.logger_(`Requesting ${_u(e)}`),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=r8({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:c,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:h,level:m,stream:v})=>{this.logger_(`${_u(e)} logged from transmuxer stream ${v} as a ${m}: ${h}`)}})}trimBackBuffer_(e){const i=A8(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)}createSimplifiedSegmentObj_(e){const i=e.segment,n=e.part,o={resolvedUri:n?n.resolvedUri:i.resolvedUri,byterange:n?n.byterange:i.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},u=e.playlist.segments[e.mediaIndex-1];if(u&&u.timeline===i.timeline&&(u.videoTimingInfo?o.baseStartTime=u.videoTimingInfo.transmuxedDecodeEnd:u.audioTimingInfo&&(o.baseStartTime=u.audioTimingInfo.transmuxedDecodeEnd)),i.key){const c=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);o.key=this.segmentKey(i.key),o.key.iv=c}return i.map&&(o.map=this.initSegmentForMap(i.map)),o}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,i){if(this.pendingSegment_.byteLength=i.bytesReceived,e<$p){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${$p}`);return}this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,i,n){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,n));return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Cr.ABORTED)return;if(this.pause(),e.code===Cr.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),o.endOfAllRequests=i.endOfAllRequests,n.gopInfo&&(this.gopBuffer_=b8(this.gopBuffer_,n.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(o)}setTimeMapping_(e){const i=this.syncController_.mappingForTimeline(e);i!==null&&(this.timeMapping_=i)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:i,mediaIndex:n,firstVideoFrameTimeForData:o,currentVideoTimestampOffset:u,useVideoTimingInfo:c,videoTimingInfo:h,audioTimingInfo:m}){if(typeof e<"u")return e;if(!c)return m.start;const v=i.segments[n-1];return n===0||!v||typeof v.start>"u"||v.end!==o+u?o:h.start}waitForAppendsToComplete_(e){const i=this.getCurrentMediaInfo_(e);if(!i){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:n,hasVideo:o,isMuxed:u}=i,c=this.loaderType_==="main"&&o,h=!this.audioDisabled_&&n&&!u;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}c&&e.waitingOnAppends++,h&&e.waitingOnAppends++,c&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),h&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const i=C8(this.loaderType_,this.getCurrentMediaInfo_(),e);return i?(this.error({message:i,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let i=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:i,timingInfo:n}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:n.start:n.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const i=this.getMediaInfo_(),o=this.loaderType_==="main"&&i&&i.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;o&&(e.timingInfo.end=typeof o.end=="number"?o.end:o.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const i=O8(e,this.sourceType_);if(i&&(i.severity==="warn"?he.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${_u(e)}`);return}this.logger_(`Appended ${_u(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const n=e.segment,o=e.part,u=n.end&&this.currentTime_()-n.end>e.playlist.targetDuration*3,c=o&&o.end&&this.currentTime_()-o.end>e.playlist.partTargetDuration*3;if(u||c){this.logger_(`bad ${u?"segment":"part"} ${_u(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<$p){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${$p}`);return}const i=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,o=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(o-i)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const i=e.segment,n=i.start,o=i.end;if(!kw(n)||!kw(o))return;Xd(n,o,this.segmentMetadataTrack_);const u=Z.WebKitDataCue||Z.VTTCue,c={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:o},h=JSON.stringify(c),m=new u(n,o,h);m.value=c,this.segmentMetadataTrack_.addCue(m)}}function ua(){}const wI=function(t){return typeof t!="string"?t:t.replace(/./,e=>e.toUpperCase())},D8=["video","audio"],j0=(t,e)=>{const i=e[`${t}Buffer`];return i&&i.updating||e.queuePending[t]},P8=(t,e)=>{for(let i=0;i<e.length;i++){const n=e[i];if(n.type==="mediaSource")return null;if(n.type===t)return i}return null},Nu=(t,e)=>{if(e.queue.length===0)return;let i=0,n=e.queue[i];if(n.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),n.action(e),n.doneFn&&n.doneFn(),Nu("audio",e),Nu("video",e));return}if(t!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||j0(t,e))){if(n.type!==t){if(i=P8(t,e.queue),i===null)return;n=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[t]=n,n.action(t,e),!n.doneFn){e.queuePending[t]=null,Nu(t,e);return}}},CI=(t,e)=>{const i=e[`${t}Buffer`],n=wI(t);i&&(i.removeEventListener("updateend",e[`on${n}UpdateEnd_`]),i.removeEventListener("error",e[`on${n}Error_`]),e.codecs[t]=null,e[`${t}Buffer`]=null)},br=(t,e)=>t&&e&&Array.prototype.indexOf.call(t.sourceBuffers,e)!==-1,hn={appendBuffer:(t,e,i)=>(n,o)=>{const u=o[`${n}Buffer`];if(br(o.mediaSource,u)){o.logger_(`Appending segment ${e.mediaIndex}'s ${t.length} bytes to ${n}Buffer`);try{u.appendBuffer(t)}catch(c){o.logger_(`Error with code ${c.code} `+(c.code===xI?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${n}Buffer`),o.queuePending[n]=null,i(c)}}},remove:(t,e)=>(i,n)=>{const o=n[`${i}Buffer`];if(br(n.mediaSource,o)){n.logger_(`Removing ${t} to ${e} from ${i}Buffer`);try{o.remove(t,e)}catch{n.logger_(`Remove ${t} to ${e} from ${i}Buffer failed`)}}},timestampOffset:t=>(e,i)=>{const n=i[`${e}Buffer`];br(i.mediaSource,n)&&(i.logger_(`Setting ${e}timestampOffset to ${t}`),n.timestampOffset=t)},callback:t=>(e,i)=>{t()},endOfStream:t=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${t||""})`);try{e.mediaSource.endOfStream(t)}catch(i){he.log.warn("Failed to call media source endOfStream",i)}}},duration:t=>e=>{e.logger_(`Setting mediaSource duration to ${t}`);try{e.mediaSource.duration=t}catch(i){he.log.warn("Failed to set media source duration",i)}},abort:()=>(t,e)=>{if(e.mediaSource.readyState!=="open")return;const i=e[`${t}Buffer`];if(br(e.mediaSource,i)){e.logger_(`calling abort on ${t}Buffer`);try{i.abort()}catch(n){he.log.warn(`Failed to abort on ${t}Buffer`,n)}}},addSourceBuffer:(t,e)=>i=>{const n=wI(t),o=dh(e);i.logger_(`Adding ${t}Buffer with codec ${e} to mediaSource`);const u=i.mediaSource.addSourceBuffer(o);u.addEventListener("updateend",i[`on${n}UpdateEnd_`]),u.addEventListener("error",i[`on${n}Error_`]),i.codecs[t]=e,i[`${t}Buffer`]=u},removeSourceBuffer:t=>e=>{const i=e[`${t}Buffer`];if(CI(t,e),!!br(e.mediaSource,i)){e.logger_(`Removing ${t}Buffer with codec ${e.codecs[t]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(i)}catch(n){he.log.warn(`Failed to removeSourceBuffer ${t}Buffer`,n)}}},changeType:t=>(e,i)=>{const n=i[`${e}Buffer`],o=dh(t);br(i.mediaSource,n)&&i.codecs[e]!==t&&(i.logger_(`changing ${e}Buffer codec from ${i.codecs[e]} to ${t}`),n.changeType(o),i.codecs[e]=t)}},fn=({type:t,sourceUpdater:e,action:i,doneFn:n,name:o})=>{e.queue.push({type:t,action:i,doneFn:n,name:o}),Nu(t,e)},Pw=(t,e)=>i=>{if(e.queuePending[t]){const n=e.queuePending[t].doneFn;e.queuePending[t]=null,n&&n(e[`${t}Error_`])}Nu(t,e)};class AI extends he.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>Nu("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=or("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=Pw("video",this),this.onAudioUpdateEnd_=Pw("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,i){fn({type:"mediaSource",sourceUpdater:this,action:hn.addSourceBuffer(e,i),name:"addSourceBuffer"})}abort(e){fn({type:e,sourceUpdater:this,action:hn.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){he.log.error("removeSourceBuffer is not supported!");return}fn({type:"mediaSource",sourceUpdater:this,action:hn.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!he.browser.IE_VERSION&&!he.browser.IS_FIREFOX&&Z.MediaSource&&Z.MediaSource.prototype&&typeof Z.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return Z.SourceBuffer&&Z.SourceBuffer.prototype&&typeof Z.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,i){if(!this.canChangeType()){he.log.error("changeType is not supported!");return}fn({type:e,sourceUpdater:this,action:hn.changeType(i),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(i=>{const n=e[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,n);this.canChangeType()&&this.changeType(i,n)})}appendBuffer(e,i){const{segmentInfo:n,type:o,bytes:u}=e;if(this.processedAppend_=!0,o==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,i]),this.logger_(`delayed audio append of ${u.length} until video append`);return}const c=i;if(fn({type:o,sourceUpdater:this,action:hn.appendBuffer(u,n||{mediaIndex:-1},c),doneFn:i,name:"appendBuffer"}),o==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const h=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${h.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,h.forEach(m=>{this.appendBuffer.apply(this,m)})}}audioBuffered(){return br(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:_s()}videoBuffered(){return br(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:_s()}buffered(){const e=br(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=br(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():t4(this.audioBuffered(),this.videoBuffered())}setDuration(e,i=ua){fn({type:"mediaSource",sourceUpdater:this,action:hn.duration(e),name:"duration",doneFn:i})}endOfStream(e=null,i=ua){typeof e!="string"&&(e=void 0),fn({type:"mediaSource",sourceUpdater:this,action:hn.endOfStream(e),name:"endOfStream",doneFn:i})}removeAudio(e,i,n=ua){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){n();return}fn({type:"audio",sourceUpdater:this,action:hn.remove(e,i),doneFn:n,name:"remove"})}removeVideo(e,i,n=ua){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){n();return}fn({type:"video",sourceUpdater:this,action:hn.remove(e,i),doneFn:n,name:"remove"})}updating(){return!!(j0("audio",this)||j0("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(fn({type:"audio",sourceUpdater:this,action:hn.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(fn({type:"video",sourceUpdater:this,action:hn.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&fn({type:"audio",sourceUpdater:this,action:hn.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&fn({type:"video",sourceUpdater:this,action:hn.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),D8.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>CI(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Lw=t=>decodeURIComponent(escape(String.fromCharCode.apply(null,t))),Nw=new Uint8Array(`

`.split("").map(t=>t.charCodeAt(0)));class L8 extends $0{constructor(e,i={}){super(e,i),this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return _s();const e=this.subtitlesTrack_.cues,i=e[0].startTime,n=e[e.length-1].startTime;return _s([[i,n]])}initSegmentForMap(e,i=!1){if(!e)return null;const n=Pm(e);let o=this.initSegments_[n];if(i&&!o&&e.bytes){const u=Nw.byteLength+e.bytes.byteLength,c=new Uint8Array(u);c.set(e.bytes),c.set(Nw,e.bytes.byteLength),this.initSegments_[n]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:c}}return o||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,i){Xd(e,i,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const i=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",i),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,i,n){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===Cr.TIMEOUT&&this.handleTimeout_(),e.code===Cr.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending");const u=o.segment;if(u.map&&(u.map.bytes=i.map.bytes),o.bytes=i.bytes,typeof Z.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){let c;const h=()=>{this.subtitlesTrack_.tech_.off("vttjsloaded",c),this.stopForError({message:"Error loading vtt.js"})};c=()=>{this.subtitlesTrack_.tech_.off("vttjserror",h),this.segmentRequestFinished_(e,i,n)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",c),this.subtitlesTrack_.tech_.one("vttjserror",h);return}u.requested=!0;try{this.parseVTTCues_(o)}catch(c){this.stopForError({message:c.message});return}if(this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={start:o.cues[0].startTime,end:o.cues[o.cues.length-1].endTime}:o.timingInfo={start:o.startOfSegment,end:o.startOfSegment+o.duration},o.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=u.duration,o.cues.forEach(c=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new Z.VTTCue(c.startTime,c.endTime,c.text):c)}),v8(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let i,n=!1;typeof Z.TextDecoder=="function"?i=new Z.TextDecoder("utf8"):(i=Z.WebVTT.StringDecoder(),n=!0);const o=new Z.WebVTT.Parser(Z,Z.vttjs,i);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},o.oncue=e.cues.push.bind(e.cues),o.ontimestampmap=c=>{e.timestampmap=c},o.onparsingerror=c=>{he.log.warn("Error encountered when parsing cues: "+c.message)},e.segment.map){let c=e.segment.map.bytes;n&&(c=Lw(c)),o.parse(c)}let u=e.bytes;n&&(u=Lw(u)),o.parse(u),o.flush()}updateTimeMapping_(e,i,n){const o=e.segment;if(!i)return;if(!e.cues.length){o.empty=!0;return}const u=e.timestampmap,c=u.MPEGTS/ym.ONE_SECOND_IN_TS-u.LOCAL+i.mapping;if(e.cues.forEach(h=>{h.startTime+=c,h.endTime+=c}),!n.syncInfo){const h=e.cues[0].startTime,m=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(h,m-o.duration)}}}}const N8=function(t,e){const i=t.cues;for(let n=0;n<i.length;n++){const o=i[n];if(e>=o.adStartTime&&e<=o.adEndTime)return o}return null},R8=function(t,e,i=0){if(!t.segments)return;let n=i,o;for(let u=0;u<t.segments.length;u++){const c=t.segments[u];if(o||(o=N8(e,n+c.duration/2)),o){if("cueIn"in c){o.endTime=n,o.adEndTime=n,n+=c.duration,o=null;continue}if(n<o.endTime){n+=c.duration;continue}o.endTime+=c.duration}else if("cueOut"in c&&(o=new Z.VTTCue(n,n+c.duration,c.cueOut),o.adStartTime=n,o.adEndTime=n+parseFloat(c.cueOut),e.addCue(o)),"cueOutCont"in c){const[h,m]=c.cueOutCont.split("/").map(parseFloat);o=new Z.VTTCue(n,n+c.duration,""),o.adStartTime=n-h,o.adEndTime=o.adStartTime+m,e.addCue(o)}n+=c.duration}},M8=86400,Rw=[{name:"VOD",run:(t,e,i,n,o)=>i!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(t,e,i,n,o)=>{if(!Object.keys(t.timelineToDatetimeMappings).length)return null;let u=null,c=null;const h=P0(e);o=o||0;for(let m=0;m<h.length;m++){const v=e.endList||o===0?m:h.length-(m+1),T=h[v],O=T.segment,R=t.timelineToDatetimeMappings[O.timeline];if(!R||!O.dateTimeObject)continue;let z=O.dateTimeObject.getTime()/1e3+R;if(O.parts&&typeof T.partIndex=="number")for(let q=0;q<T.partIndex;q++)z+=O.parts[q].duration;const j=Math.abs(o-z);if(c!==null&&(j===0||c<j))break;c=j,u={time:z,segmentIndex:T.segmentIndex,partIndex:T.partIndex}}return u}},{name:"Segment",run:(t,e,i,n,o)=>{let u=null,c=null;o=o||0;const h=P0(e);for(let m=0;m<h.length;m++){const v=e.endList||o===0?m:h.length-(m+1),T=h[v],O=T.segment,R=T.part&&T.part.start||O&&O.start;if(O.timeline===n&&typeof R<"u"){const M=Math.abs(o-R);if(c!==null&&c<M)break;(!u||c===null||c>=M)&&(c=M,u={time:R,segmentIndex:T.segmentIndex,partIndex:T.partIndex})}}return u}},{name:"Discontinuity",run:(t,e,i,n,o)=>{let u=null;if(o=o||0,e.discontinuityStarts&&e.discontinuityStarts.length){let c=null;for(let h=0;h<e.discontinuityStarts.length;h++){const m=e.discontinuityStarts[h],v=e.discontinuitySequence+h+1,T=t.discontinuities[v];if(T){const O=Math.abs(o-T.time);if(c!==null&&c<O)break;(!u||c===null||c>=O)&&(c=O,u={time:T.time,segmentIndex:m,partIndex:null})}}}return u}},{name:"Playlist",run:(t,e,i,n,o)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class U8 extends he.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=or("SyncController")}getSyncPoint(e,i,n,o){const u=this.runStrategies_(e,i,n,o);return u.length?this.selectSyncPoint_(u,{key:"time",value:o}):null}getExpiredTime(e,i){if(!e||!e.segments)return null;const n=this.runStrategies_(e,i,e.discontinuitySequence,0);if(!n.length)return null;const o=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return o.segmentIndex>0&&(o.time*=-1),Math.abs(o.time+sh({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:o.segmentIndex,endIndex:0}))}runStrategies_(e,i,n,o){const u=[];for(let c=0;c<Rw.length;c++){const h=Rw[c],m=h.run(this,e,i,n,o);m&&(m.strategy=h.name,u.push({strategy:h.name,syncPoint:m}))}return u}selectSyncPoint_(e,i){let n=e[0].syncPoint,o=Math.abs(e[0].syncPoint[i.key]-i.value),u=e[0].strategy;for(let c=1;c<e.length;c++){const h=Math.abs(e[c].syncPoint[i.key]-i.value);h<o&&(o=h,n=e[c].syncPoint,u=e[c].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${u}]: [time:${n.time}, segmentIndex:${n.segmentIndex}`+(typeof n.partIndex=="number"?`,partIndex:${n.partIndex}`:"")+"]"),n}saveExpiredSegmentInfo(e,i){const n=i.mediaSequence-e.mediaSequence;if(n>M8){he.log.warn(`Not saving expired segment info. Media sequence gap ${n} is too large.`);return}for(let o=n-1;o>=0;o--){const u=e.segments[o];if(u&&typeof u.start<"u"){i.syncInfo={mediaSequence:e.mediaSequence+o,time:u.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const i=e.segments[0],n=i.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[i.timeline]=-n}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:i}){const n=this.calculateSegmentTimeMapping_(e,e.timingInfo,i),o=e.segment;n&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:o.start}));const u=o.dateTimeObject;o.discontinuity&&i&&u&&(this.timelineToDatetimeMappings[o.timeline]=-(u.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,i,n){const o=e.segment,u=e.part;let c=this.timelines[e.timeline],h,m;if(typeof e.timestampOffset=="number")c={time:e.startOfSegment,mapping:e.startOfSegment-i.start},n&&(this.timelines[e.timeline]=c,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${c.time}] [mapping: ${c.mapping}]`)),h=e.startOfSegment,m=i.end+c.mapping;else if(c)h=i.start+c.mapping,m=i.end+c.mapping;else return!1;return u&&(u.start=h,u.end=m),(!o.start||h<o.start)&&(o.start=h),o.end=m,!0}saveDiscontinuitySyncInfo_(e){const i=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let o=0;o<i.discontinuityStarts.length;o++){const u=i.discontinuityStarts[o],c=i.discontinuitySequence+o+1,h=u-e.mediaIndex,m=Math.abs(h);if(!this.discontinuities[c]||this.discontinuities[c].accuracy>m){let v;h<0?v=n.start-sh({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex,endIndex:u}):v=n.end+sh({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex+1,endIndex:u}),this.discontinuities[c]={time:v,accuracy:m}}}}dispose(){this.trigger("dispose"),this.off()}}class B8 extends he.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:i,to:n}){return typeof i=="number"&&typeof n=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:i,to:n},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:i,to:n}){return typeof i=="number"&&typeof n=="number"&&(this.lastTimelineChanges_[e]={type:e,from:i,to:n},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const F8=fI(pI(function(){var t=function(){function j(){this.listeners={}}var q=j.prototype;return q.on=function(ee,se){this.listeners[ee]||(this.listeners[ee]=[]),this.listeners[ee].push(se)},q.off=function(ee,se){if(!this.listeners[ee])return!1;var re=this.listeners[ee].indexOf(se);return this.listeners[ee]=this.listeners[ee].slice(0),this.listeners[ee].splice(re,1),re>-1},q.trigger=function(ee){var se=this.listeners[ee];if(se)if(arguments.length===2)for(var re=se.length,ie=0;ie<re;++ie)se[ie].call(this,arguments[1]);else for(var ye=Array.prototype.slice.call(arguments,1),Pe=se.length,Ie=0;Ie<Pe;++Ie)se[Ie].apply(this,ye)},q.dispose=function(){this.listeners={}},q.pipe=function(ee){this.on("data",function(se){ee.push(se)})},j}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(j){return j.subarray(0,j.byteLength-j[j.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const i=function(){const j=[[[],[],[],[],[]],[[],[],[],[],[]]],q=j[0],W=j[1],ee=q[4],se=W[4];let re,ie,ye;const Pe=[],Ie=[];let Be,Ve,We,it,Le,ct;for(re=0;re<256;re++)Ie[(Pe[re]=re<<1^(re>>7)*283)^re]=re;for(ie=ye=0;!ee[ie];ie^=Be||1,ye=Ie[ye]||1)for(it=ye^ye<<1^ye<<2^ye<<3^ye<<4,it=it>>8^it&255^99,ee[ie]=it,se[it]=ie,We=Pe[Ve=Pe[Be=Pe[ie]]],ct=We*16843009^Ve*65537^Be*257^ie*16843008,Le=Pe[it]*257^it*16843008,re=0;re<4;re++)q[re][ie]=Le=Le<<24^Le>>>8,W[re][it]=ct=ct<<24^ct>>>8;for(re=0;re<5;re++)q[re]=q[re].slice(0),W[re]=W[re].slice(0);return j};let n=null;class o{constructor(q){n||(n=i()),this._tables=[[n[0][0].slice(),n[0][1].slice(),n[0][2].slice(),n[0][3].slice(),n[0][4].slice()],[n[1][0].slice(),n[1][1].slice(),n[1][2].slice(),n[1][3].slice(),n[1][4].slice()]];let W,ee,se;const re=this._tables[0][4],ie=this._tables[1],ye=q.length;let Pe=1;if(ye!==4&&ye!==6&&ye!==8)throw new Error("Invalid aes key size");const Ie=q.slice(0),Be=[];for(this._key=[Ie,Be],W=ye;W<4*ye+28;W++)se=Ie[W-1],(W%ye===0||ye===8&&W%ye===4)&&(se=re[se>>>24]<<24^re[se>>16&255]<<16^re[se>>8&255]<<8^re[se&255],W%ye===0&&(se=se<<8^se>>>24^Pe<<24,Pe=Pe<<1^(Pe>>7)*283)),Ie[W]=Ie[W-ye]^se;for(ee=0;W;ee++,W--)se=Ie[ee&3?W:W-4],W<=4||ee<4?Be[ee]=se:Be[ee]=ie[0][re[se>>>24]]^ie[1][re[se>>16&255]]^ie[2][re[se>>8&255]]^ie[3][re[se&255]]}decrypt(q,W,ee,se,re,ie){const ye=this._key[1];let Pe=q^ye[0],Ie=se^ye[1],Be=ee^ye[2],Ve=W^ye[3],We,it,Le;const ct=ye.length/4-2;let Ht,Qe=4;const Ze=this._tables[1],_t=Ze[0],Vt=Ze[1],mi=Ze[2],ei=Ze[3],Ft=Ze[4];for(Ht=0;Ht<ct;Ht++)We=_t[Pe>>>24]^Vt[Ie>>16&255]^mi[Be>>8&255]^ei[Ve&255]^ye[Qe],it=_t[Ie>>>24]^Vt[Be>>16&255]^mi[Ve>>8&255]^ei[Pe&255]^ye[Qe+1],Le=_t[Be>>>24]^Vt[Ve>>16&255]^mi[Pe>>8&255]^ei[Ie&255]^ye[Qe+2],Ve=_t[Ve>>>24]^Vt[Pe>>16&255]^mi[Ie>>8&255]^ei[Be&255]^ye[Qe+3],Qe+=4,Pe=We,Ie=it,Be=Le;for(Ht=0;Ht<4;Ht++)re[(3&-Ht)+ie]=Ft[Pe>>>24]<<24^Ft[Ie>>16&255]<<16^Ft[Be>>8&255]<<8^Ft[Ve&255]^ye[Qe++],We=Pe,Pe=Ie,Ie=Be,Be=Ve,Ve=We}}class u extends t{constructor(){super(t),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(q){this.jobs.push(q),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const c=function(j){return j<<24|(j&65280)<<8|(j&16711680)>>8|j>>>24},h=function(j,q,W){const ee=new Int32Array(j.buffer,j.byteOffset,j.byteLength>>2),se=new o(Array.prototype.slice.call(q)),re=new Uint8Array(j.byteLength),ie=new Int32Array(re.buffer);let ye,Pe,Ie,Be,Ve,We,it,Le,ct;for(ye=W[0],Pe=W[1],Ie=W[2],Be=W[3],ct=0;ct<ee.length;ct+=4)Ve=c(ee[ct]),We=c(ee[ct+1]),it=c(ee[ct+2]),Le=c(ee[ct+3]),se.decrypt(Ve,We,it,Le,ie,ct),ie[ct]=c(ie[ct]^ye),ie[ct+1]=c(ie[ct+1]^Pe),ie[ct+2]=c(ie[ct+2]^Ie),ie[ct+3]=c(ie[ct+3]^Be),ye=Ve,Pe=We,Ie=it,Be=Le;return re};class m{constructor(q,W,ee,se){const re=m.STEP,ie=new Int32Array(q.buffer),ye=new Uint8Array(q.byteLength);let Pe=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(ie.subarray(Pe,Pe+re),W,ee,ye)),Pe=re;Pe<ie.length;Pe+=re)ee=new Uint32Array([c(ie[Pe-4]),c(ie[Pe-3]),c(ie[Pe-2]),c(ie[Pe-1])]),this.asyncStream_.push(this.decryptChunk_(ie.subarray(Pe,Pe+re),W,ee,ye));this.asyncStream_.push(function(){se(null,e(ye))})}static get STEP(){return 32e3}decryptChunk_(q,W,ee,se){return function(){const re=h(q,W,ee);se.set(re,q.byteOffset)}}}var v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},T;typeof window<"u"?T=window:typeof v<"u"?T=v:typeof self<"u"?T=self:T={};var O=T,R=function(q){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(q):q&&q.buffer instanceof ArrayBuffer},M=O.BigInt||Number;M("0x1"),M("0x100"),M("0x10000"),M("0x1000000"),M("0x100000000"),M("0x10000000000"),M("0x1000000000000"),M("0x100000000000000"),M("0x10000000000000000"),function(){var j=new Uint16Array([65484]),q=new Uint8Array(j.buffer,j.byteOffset,j.byteLength);return q[0]===255?"big":q[0]===204?"little":"unknown"}();const z=function(j){const q={};return Object.keys(j).forEach(W=>{const ee=j[W];R(ee)?q[W]={bytes:ee.buffer,byteOffset:ee.byteOffset,byteLength:ee.byteLength}:q[W]=ee}),q};self.onmessage=function(j){const q=j.data,W=new Uint8Array(q.encrypted.bytes,q.encrypted.byteOffset,q.encrypted.byteLength),ee=new Uint32Array(q.key.bytes,q.key.byteOffset,q.key.byteLength/4),se=new Uint32Array(q.iv.bytes,q.iv.byteOffset,q.iv.byteLength/4);new m(W,ee,se,function(re,ie){self.postMessage(z({source:q.source,decrypted:ie}),[ie.buffer])})}}));var $8=hI(F8);const j8=t=>{let e=t.default?"main":"alternative";return t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},Mm=(t,e)=>{t.abort(),t.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},H0=(t,e)=>{e.activePlaylistLoader=t,t.load()},H8=(t,e)=>()=>{const{segmentLoaders:{[t]:i,main:n},mediaTypes:{[t]:o}}=e,u=o.activeTrack(),c=o.getActiveGroup(),h=o.activePlaylistLoader,m=o.lastGroup_;if(!(c&&m&&c.id===m.id)&&(o.lastGroup_=c,o.lastTrack_=u,Mm(i,o),!(!c||c.isMainPlaylist))){if(!c.playlistLoader){h&&n.resetEverything();return}i.resyncLoader(),H0(c.playlistLoader,o)}},V8=(t,e)=>()=>{const{segmentLoaders:{[t]:i},mediaTypes:{[t]:n}}=e;n.lastGroup_=null,i.abort(),i.pause()},q8=(t,e)=>()=>{const{mainPlaylistLoader:i,segmentLoaders:{[t]:n,main:o},mediaTypes:{[t]:u}}=e,c=u.activeTrack(),h=u.getActiveGroup(),m=u.activePlaylistLoader,v=u.lastTrack_;if(!(v&&c&&v.id===c.id)&&(u.lastGroup_=h,u.lastTrack_=c,Mm(n,u),!!h)){if(h.isMainPlaylist){if(!c||!v||c.id===v.id)return;const T=e.vhs.playlistController_,O=T.selectPlaylist();if(T.media()===O)return;u.logger_(`track change. Switching main audio from ${v.id} to ${c.id}`),i.pause(),o.resetEverything(),T.fastQualityChange_(O);return}if(t==="AUDIO"){if(!h.playlistLoader){o.setAudio(!0),o.resetEverything();return}n.setAudio(!0),o.setAudio(!1)}if(m===h.playlistLoader){H0(h.playlistLoader,u);return}n.track&&n.track(c),n.resetEverything(),H0(h.playlistLoader,u)}},Um={AUDIO:(t,e)=>()=>{const{segmentLoaders:{[t]:i},mediaTypes:{[t]:n},excludePlaylist:o}=e;Mm(i,n);const u=n.activeTrack(),c=n.activeGroup(),h=(c.filter(v=>v.default)[0]||c[0]).id,m=n.tracks[h];if(u===m){o({error:{message:"Problem encountered loading the default audio track."}});return}he.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const v in n.tracks)n.tracks[v].enabled=n.tracks[v]===m;n.onTrackChanged()},SUBTITLES:(t,e)=>()=>{const{segmentLoaders:{[t]:i},mediaTypes:{[t]:n}}=e;he.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Mm(i,n);const o=n.activeTrack();o&&(o.mode="disabled"),n.onTrackChanged()}},Mw={AUDIO:(t,e,i)=>{if(!e)return;const{tech:n,requestOptions:o,segmentLoaders:{[t]:u}}=i;e.on("loadedmetadata",()=>{const c=e.media();u.playlist(c,o),(!n.paused()||c.endList&&n.preload()!=="none")&&u.load()}),e.on("loadedplaylist",()=>{u.playlist(e.media(),o),n.paused()||u.load()}),e.on("error",Um[t](t,i))},SUBTITLES:(t,e,i)=>{const{tech:n,requestOptions:o,segmentLoaders:{[t]:u},mediaTypes:{[t]:c}}=i;e.on("loadedmetadata",()=>{const h=e.media();u.playlist(h,o),u.track(c.activeTrack()),(!n.paused()||h.endList&&n.preload()!=="none")&&u.load()}),e.on("loadedplaylist",()=>{u.playlist(e.media(),o),n.paused()||u.load()}),e.on("error",Um[t](t,i))}},W8={AUDIO:(t,e)=>{const{vhs:i,sourceType:n,segmentLoaders:{[t]:o},requestOptions:u,main:{mediaGroups:c},mediaTypes:{[t]:{groups:h,tracks:m,logger_:v}},mainPlaylistLoader:T}=e,O=$h(T.main);(!c[t]||Object.keys(c[t]).length===0)&&(c[t]={main:{default:{default:!0}}},O&&(c[t].main.default.playlists=T.main.playlists));for(const R in c[t]){h[R]||(h[R]=[]);for(const M in c[t][R]){let z=c[t][R][M],j;if(O?(v(`AUDIO group '${R}' label '${M}' is a main playlist`),z.isMainPlaylist=!0,j=null):n==="vhs-json"&&z.playlists?j=new Au(z.playlists[0],i,u):z.resolvedUri?j=new Au(z.resolvedUri,i,u):z.playlists&&n==="dash"?j=new B0(z.playlists[0],i,u,T):j=null,z=ui({id:M,playlistLoader:j},z),Mw[t](t,z.playlistLoader,e),h[R].push(z),typeof m[M]>"u"){const q=new he.AudioTrack({id:M,kind:j8(z),enabled:!1,language:z.language,default:z.default,label:M});m[M]=q}}}o.on("error",Um[t](t,e))},SUBTITLES:(t,e)=>{const{tech:i,vhs:n,sourceType:o,segmentLoaders:{[t]:u},requestOptions:c,main:{mediaGroups:h},mediaTypes:{[t]:{groups:m,tracks:v}},mainPlaylistLoader:T}=e;for(const O in h[t]){m[O]||(m[O]=[]);for(const R in h[t][O]){if(h[t][O][R].forced)continue;let M=h[t][O][R],z;if(o==="hls")z=new Au(M.resolvedUri,n,c);else if(o==="dash"){if(!M.playlists.filter(q=>q.excludeUntil!==1/0).length)return;z=new B0(M.playlists[0],n,c,T)}else o==="vhs-json"&&(z=new Au(M.playlists?M.playlists[0]:M.resolvedUri,n,c));if(M=ui({id:R,playlistLoader:z},M),Mw[t](t,M.playlistLoader,e),m[O].push(M),typeof v[R]>"u"){const j=i.addRemoteTextTrack({id:R,kind:"subtitles",default:M.default&&M.autoselect,language:M.language,label:R},!1).track;v[R]=j}}}u.on("error",Um[t](t,e))},"CLOSED-CAPTIONS":(t,e)=>{const{tech:i,main:{mediaGroups:n},mediaTypes:{[t]:{groups:o,tracks:u}}}=e;for(const c in n[t]){o[c]||(o[c]=[]);for(const h in n[t][c]){const m=n[t][c][h];if(!/^(?:CC|SERVICE)/.test(m.instreamId))continue;const v=i.options_.vhs&&i.options_.vhs.captionServices||{};let T={label:h,language:m.language,instreamId:m.instreamId,default:m.default&&m.autoselect};if(v[T.instreamId]&&(T=ui(T,v[T.instreamId])),T.default===void 0&&delete T.default,o[c].push(ui({id:h},m)),typeof u[h]>"u"){const O=i.addRemoteTextTrack({id:T.instreamId,kind:"captions",default:T.default,language:T.language,label:T.label},!1).track;u[h]=O}}}}},kI=(t,e)=>{for(let i=0;i<t.length;i++)if(ST(e,t[i])||t[i].playlists&&kI(t[i].playlists,e))return!0;return!1},G8=(t,e)=>i=>{const{mainPlaylistLoader:n,mediaTypes:{[t]:{groups:o}}}=e,u=n.media();if(!u)return null;let c=null;u.attributes[t]&&(c=o[u.attributes[t]]);const h=Object.keys(o);if(!c)if(t==="AUDIO"&&h.length>1&&$h(e.main))for(let m=0;m<h.length;m++){const v=o[h[m]];if(kI(v,u)){c=v;break}}else o.main?c=o.main:h.length===1&&(c=o[h[0]]);return typeof i>"u"?c:i===null||!c?null:c.filter(m=>m.id===i.id)[0]||null},z8={AUDIO:(t,e)=>()=>{const{mediaTypes:{[t]:{tracks:i}}}=e;for(const n in i)if(i[n].enabled)return i[n];return null},SUBTITLES:(t,e)=>()=>{const{mediaTypes:{[t]:{tracks:i}}}=e;for(const n in i)if(i[n].mode==="showing"||i[n].mode==="hidden")return i[n];return null}},K8=(t,{mediaTypes:e})=>()=>{const i=e[t].activeTrack();return i?e[t].activeGroup(i):null},X8=t=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(v=>{W8[v](v,t)});const{mediaTypes:e,mainPlaylistLoader:i,tech:n,vhs:o,segmentLoaders:{["AUDIO"]:u,main:c}}=t;["AUDIO","SUBTITLES"].forEach(v=>{e[v].activeGroup=G8(v,t),e[v].activeTrack=z8[v](v,t),e[v].onGroupChanged=H8(v,t),e[v].onGroupChanging=V8(v,t),e[v].onTrackChanged=q8(v,t),e[v].getActiveGroup=K8(v,t)});const h=e.AUDIO.activeGroup();if(h){const v=(h.filter(O=>O.default)[0]||h[0]).id;e.AUDIO.tracks[v].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(c.setAudio(!1),u.setAudio(!0)):c.setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(v=>e[v].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(v=>e[v].onGroupChanging())});const m=()=>{e.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"vhs-audio-change"})};n.audioTracks().addEventListener("change",m),n.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),o.on("dispose",()=>{n.audioTracks().removeEventListener("change",m),n.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),n.clearTracks("audio");for(const v in e.AUDIO.tracks)n.audioTracks().addTrack(e.AUDIO.tracks[v])},Y8=()=>{const t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ua,activeTrack:ua,getActiveGroup:ua,onGroupChanged:ua,onTrackChanged:ua,lastTrack_:null,logger_:or(`MediaGroups[${e}]`)}}),t},Q8=60*2;let sa;const J8=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],Z8=function(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]},e3=function({currentPlaylist:t,buffered:e,currentTime:i,nextPlaylist:n,bufferLowWaterLine:o,bufferHighWaterLine:u,duration:c,bufferBasedABR:h,log:m}){if(!n)return he.log.warn("We received no playlist to switch to. Please check your stream."),!1;const v=`allowing switch ${t&&t.id||"null"} -> ${n.id}`;if(!t)return m(`${v} as current playlist is not set`),!0;if(n.id===t.id)return!1;const T=Boolean(Cu(e,i).length);if(!t.endList)return!T&&typeof t.partTargetDuration=="number"?(m(`not ${v} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(m(`${v} as current playlist is live`),!0);const O=TT(e,i),R=h?Ji.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ji.MAX_BUFFER_LOW_WATER_LINE;if(c<R)return m(`${v} as duration < max low water line (${c} < ${R})`),!0;const M=n.attributes.BANDWIDTH,z=t.attributes.BANDWIDTH;if(M<z&&(!h||O<u)){let j=`${v} as next bandwidth < current bandwidth (${M} < ${z})`;return h&&(j+=` and forwardBuffer < bufferHighWaterLine (${O} < ${u})`),m(j),!0}if((!h||M>z)&&O>=o){let j=`${v} as forwardBuffer >= bufferLowWaterLine (${O} >= ${o})`;return h&&(j+=` and next bandwidth > current bandwidth (${M} > ${z})`),m(j),!0}return m(`not ${v} as no switching criteria met`),!1};class t3 extends he.EventTarget{constructor(e){super();const{src:i,withCredentials:n,tech:o,bandwidth:u,externVhs:c,useCueTags:h,playlistExclusionDuration:m,enableLowInitialPlaylist:v,sourceType:T,cacheEncryptionKeys:O,bufferBasedABR:R,leastPixelDiffSelector:M,captionServices:z}=e;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:j}=e;(j===null||typeof j>"u")&&(j=1/0),sa=c,this.bufferBasedABR=Boolean(R),this.leastPixelDiffSelector=Boolean(M),this.withCredentials=n,this.tech_=o,this.vhs_=o.vhs,this.sourceType_=T,this.useCueTags_=h,this.playlistExclusionDuration=m,this.maxPlaylistRetries=j,this.enableLowInitialPlaylist=v,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:n,maxPlaylistRetries:j,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=Y8(),this.mediaSource=new Z.MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=_s(),this.hasPlayed_=!1,this.syncController_=new U8(e),this.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new $8,this.sourceUpdater_=new AI(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new B8;const q={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:z,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:u,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:O,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings};this.mainPlaylistLoader_=this.sourceType_==="dash"?new B0(i,this.vhs_,this.requestOptions_):new Au(i,this.vhs_,this.requestOptions_),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new $0(ui(q,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new $0(ui(q,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new L8(ui(q,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks}),e),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),J8.forEach(ee=>{this[ee+"_"]=Z8.bind(this,ee)}),this.logger_=or("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const W=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(W,()=>{const ee=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-ee,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return e===-1||i===-1?-1:e+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,e)}switchMedia_(e,i,n){const o=this.media(),u=o&&(o.id||o.uri),c=e.id||e.uri;u&&u!==c&&(this.logger_(`switch media ${u} -> ${c} from ${i}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${i}`})),this.mainPlaylistLoader_.media(e,n)}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=Z.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(Z.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),i=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return i;const n=e.mediaGroups.AUDIO,o=Object.keys(n);let u;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)u=this.mediaTypes_.AUDIO.activeTrack();else{const h=n.main||o.length&&n[o[0]];for(const m in h)if(h[m].default){u={label:m};break}}if(!u)return i;const c=[];for(const h in n)if(n[h][u.label]){const m=n[h][u.label];if(m.playlists&&m.playlists.length)c.push.apply(c,m.playlists);else if(m.uri)c.push(m);else if(e.playlists.length)for(let v=0;v<e.playlists.length;v++){const T=e.playlists[v];T.attributes&&T.attributes.AUDIO&&T.attributes.AUDIO===h&&c.push(T)}}return c.length?c:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;L0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),X8({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;L0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,i){const n=e.mediaGroups||{};let o=!0;const u=Object.keys(n.AUDIO);for(const c in n.AUDIO)for(const h in n.AUDIO[c])n.AUDIO[c][h].uri||(o=!1);o&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),sa.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),u.length&&Object.keys(n.AUDIO[u[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,n=this.tech_.currentTime(),o=this.bufferLowWaterLine(),u=this.bufferHighWaterLine(),c=this.tech_.buffered();return e3({buffered:c,currentTime:n,currentPlaylist:i,nextPlaylist:e,bufferLowWaterLine:o,bufferHighWaterLine:u,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:Q8}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{he.browser.IE_VERSION||he.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList){const i=this.seekable();if(!i.length)return!1;if(he.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay"),this.tech_.setCurrentTime(i.end(0)),this.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(i.end(0))}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,i=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===1/0?Number.MAX_VALUE:i}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const i=this.mainSegmentLoader_.getCurrentMediaInfo_();!i||i.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const n=this.syncController_.getExpiredTime(e,this.duration());if(n===null)return!1;const o=sa.Playlist.playlistEnd(e,n),u=this.tech_.currentTime(),c=this.tech_.buffered();if(!c.length)return o-u<=wr;const h=c.end(c.length-1);return h-u<=wr&&o-h<=wr}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:n}){if(e=e||this.mainPlaylistLoader_.media(),n=n||i.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const o=this.mainPlaylistLoader_.main.playlists,u=o.filter(Tg),c=u.length===1&&u[0]===e;if(o.length===1&&n!==1/0)return he.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(c);if(c){let M=!1;o.forEach(z=>{if(z===e)return;const j=z.excludeUntil;typeof j<"u"&&j!==1/0&&(M=!0,delete z.excludeUntil)}),M&&(he.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let h;e.playlistErrors_>this.maxPlaylistRetries?h=1/0:h=Date.now()+n*1e3,e.excludeUntil=h,i.reason&&(e.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const m=this.selectPlaylist();if(!m){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const v=i.internal?this.logger_:he.log.warn,T=i.message?" "+i.message:"";v(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${T} Switching to playlist ${m.id}.`),m.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),m.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const O=m.targetDuration/2*1e3||5*1e3,R=typeof m.lastRequest=="number"&&Date.now()-m.lastRequest<=O;return this.switchMedia_(m,"exclude",c||R)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,i){const n=[],o=e==="all";(o||e==="main")&&n.push(this.mainPlaylistLoader_);const u=[];(o||e==="audio")&&u.push("AUDIO"),(o||e==="subtitle")&&(u.push("CLOSED-CAPTIONS"),u.push("SUBTITLES")),u.forEach(c=>{const h=this.mediaTypes_[c]&&this.mediaTypes_[c].activePlaylistLoader;h&&n.push(h)}),["main","audio","subtitle"].forEach(c=>{const h=this[`${c}SegmentLoader_`];h&&(e===c||e==="all")&&n.push(h)}),n.forEach(c=>i.forEach(h=>{typeof c[h]=="function"&&c[h]()}))}setCurrentTime(e){const i=Cu(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(i&&i.length)return e;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:sa.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let i=this.mainPlaylistLoader_.media();if(!i)return;let n=this.syncController_.getExpiredTime(i,this.duration());if(n===null)return;const o=this.mainPlaylistLoader_.main,u=sa.Playlist.seekable(i,n,sa.Playlist.liveEdgeDelay(o,i));if(u.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),n=this.syncController_.getExpiredTime(i,this.duration()),n===null||(e=sa.Playlist.seekable(i,n,sa.Playlist.liveEdgeDelay(o,i)),e.length===0)))return;let c,h;this.seekable_&&this.seekable_.length&&(c=this.seekable_.end(0),h=this.seekable_.start(0)),e?e.start(0)>u.end(0)||u.start(0)>e.end(0)?this.seekable_=u:this.seekable_=_s([[e.start(0)>u.start(0)?e.start(0):u.start(0),e.end(0)<u.end(0)?e.end(0):u.end(0)]]):this.seekable_=u,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===c&&this.seekable_.start(0)===h)&&(this.logger_(`seekable updated [${qk(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const o=this.seekable();if(!o.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1));return}const i=this.tech_.buffered();let n=sa.Playlist.duration(this.mainPlaylistLoader_.media());i.length>0&&(n=Math.max(n,i.end(i.length-1))),this.mediaSource.duration!==n&&this.sourceUpdater_.setDuration(n)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const i=this.mediaTypes_[e].groups;for(const n in i)i[n].forEach(o=>{o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,i=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),n=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!i||!n)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};e.video=e.main;const i=nh(this.main(),this.media()),n={},o=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(n.video=i.video||e.main.videoCodec||MB),e.main.isMuxed&&(n.video+=`,${i.audio||e.main.audioCodec||Ex}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||o)&&(n.audio=i.audio||e.main.audioCodec||e.audio.audioCodec||Ex,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!n.audio&&!n.video){this.excludePlaylist({playlistToExclude:this.media(),error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const u=(m,v)=>m?Yp(v):Ny(v),c={};let h;if(["video","audio"].forEach(function(m){if(n.hasOwnProperty(m)&&!u(e[m].isFmp4,n[m])){const v=e[m].isFmp4?"browser":"muxer";c[v]=c[v]||[],c[v].push(n[m]),m==="audio"&&(h=v)}}),o&&h&&this.media().attributes.AUDIO){const m=this.media().attributes.AUDIO;this.main().playlists.forEach(v=>{(v.attributes&&v.attributes.AUDIO)===m&&v!==this.media()&&(v.excludeUntil=1/0)}),this.logger_(`excluding audio group ${m} as ${h} does not support codec(s): "${n.audio}"`)}if(Object.keys(c).length){const m=Object.keys(c).reduce((v,T)=>(v&&(v+=", "),v+=`${T} does not support codec(s): "${c[T].join(",")}"`,v),"")+".";this.excludePlaylist({playlistToExclude:this.media(),error:{internal:!0,message:m},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const m=[];if(["video","audio"].forEach(v=>{const T=(Tr(this.sourceUpdater_.codecs[v]||"")[0]||{}).type,O=(Tr(n[v]||"")[0]||{}).type;T&&O&&T.toLowerCase()!==O.toLowerCase()&&m.push(`"${this.sourceUpdater_.codecs[v]}" -> "${n[v]}"`)}),m.length){this.excludePlaylist({playlistToExclude:this.media(),error:{message:`Codec switching not supported: ${m.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return n}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}excludeUnsupportedVariants_(){const e=this.main().playlists,i=[];Object.keys(e).forEach(n=>{const o=e[n];if(i.indexOf(o.id)!==-1)return;i.push(o.id);const u=nh(this.main,o),c=[];u.audio&&!Ny(u.audio)&&!Yp(u.audio)&&c.push(`audio codec ${u.audio}`),u.video&&!Ny(u.video)&&!Yp(u.video)&&c.push(`video codec ${u.video}`),u.text&&u.text==="stpp.ttml.im1t"&&c.push(`text codec ${u.text}`),c.length&&(o.excludeUntil=1/0,this.logger_(`excluding ${o.id} for unsupported: ${c.join(", ")}`))})}excludeIncompatibleVariants_(e){const i=[],n=this.main().playlists,o=Nm(Tr(e)),u=ww(o),c=o.video&&Tr(o.video)[0]||null,h=o.audio&&Tr(o.audio)[0]||null;Object.keys(n).forEach(m=>{const v=n[m];if(i.indexOf(v.id)!==-1||v.excludeUntil===1/0)return;i.push(v.id);const T=[],O=nh(this.mainPlaylistLoader_.main,v),R=ww(O);if(!(!O.audio&&!O.video)){if(R!==u&&T.push(`codec count "${R}" !== "${u}"`),!this.sourceUpdater_.canChangeType()){const M=O.video&&Tr(O.video)[0]||null,z=O.audio&&Tr(O.audio)[0]||null;M&&c&&M.type.toLowerCase()!==c.type.toLowerCase()&&T.push(`video codec "${M.type}" !== "${c.type}"`),z&&h&&z.type.toLowerCase()!==h.type.toLowerCase()&&T.push(`audio codec "${z.type}" !== "${h.type}"`)}T.length&&(v.excludeUntil=1/0,this.logger_(`excluding ${v.id}: ${T.join(" && ")}`))}})}updateAdCues_(e){let i=0;const n=this.seekable();n.length&&(i=n.start(0)),R8(e,this.cueTagsTrack_,i)}goalBufferLength(){const e=this.tech_.currentTime(),i=Ji.GOAL_BUFFER_LENGTH,n=Ji.GOAL_BUFFER_LENGTH_RATE,o=Math.max(i,Ji.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*n,o)}bufferLowWaterLine(){const e=this.tech_.currentTime(),i=Ji.BUFFER_LOW_WATER_LINE,n=Ji.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(i,Ji.MAX_BUFFER_LOW_WATER_LINE),u=Math.max(i,Ji.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*n,this.bufferBasedABR?u:o)}bufferHighWaterLine(){return Ji.BUFFER_HIGH_WATER_LINE}}const i3=(t,e,i)=>n=>{const o=t.main.playlists[e],u=ET(o),c=Tg(o);return typeof n>"u"?c:(n?delete o.disabled:o.disabled=!0,n!==c&&!u&&(i(),n?t.trigger("renditionenabled"):t.trigger("renditiondisabled")),n)};class s3{constructor(e,i,n){const{playlistController_:o}=e,u=o.fastQualityChange_.bind(o);if(i.attributes){const c=i.attributes.RESOLUTION;this.width=c&&c.width,this.height=c&&c.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]}this.codecs=nh(o.main(),i),this.playlist=i,this.id=n,this.enabled=i3(e.playlists,i.id,u)}}const n3=function(t){t.representations=()=>{const e=t.playlistController_.main(),i=$h(e)?t.playlistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(n=>!ET(n)).map((n,o)=>new s3(t,n,n.id)):[]}},Uw=["seeking","seeked","pause","playing","error"];class r3{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=or("PlaybackWatcher"),this.logger_("initialize");const i=()=>this.monitorCurrentTime_(),n=()=>this.monitorCurrentTime_(),o=()=>this.techWaiting_(),u=()=>this.resetTimeUpdate_(),c=this.playlistController_,h=["main","subtitle","audio"],m={};h.forEach(T=>{m[T]={reset:()=>this.resetSegmentDownloads_(T),updateend:()=>this.checkSegmentDownloads_(T)},c[`${T}SegmentLoader_`].on("appendsdone",m[T].updateend),c[`${T}SegmentLoader_`].on("playlistupdate",m[T].reset),this.tech_.on(["seeked","seeking"],m[T].reset)});const v=T=>{["main","audio"].forEach(O=>{c[`${O}SegmentLoader_`][T]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),v("off"))},this.clearSeekingAppendCheck_=()=>v("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),v("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",o),this.tech_.on(Uw,u),this.tech_.on("canplay",n),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",o),this.tech_.off(Uw,u),this.tech_.off("canplay",n),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),h.forEach(T=>{c[`${T}SegmentLoader_`].off("appendsdone",m[T].updateend),c[`${T}SegmentLoader_`].off("playlistupdate",m[T].reset),this.tech_.off(["seeked","seeking"],m[T].reset)}),this.checkCurrentTimeTimeout_&&Z.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&Z.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=Z.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const i=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=i.buffered_()}checkSegmentDownloads_(e){const i=this.playlistController_,n=i[`${e}SegmentLoader_`],o=n.buffered_(),u=s4(this[`${e}Buffered_`],o);if(this[`${e}Buffered_`]=o,u){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:n.playlist_&&n.playlist_.id,buffered:Xo(o)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+wr>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),n=this.tech_.currentTime(),o=this.afterSeekableWindow_(i,n,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let u;if(o&&(u=i.end(i.length-1)),this.beforeSeekableWindow_(i,n)){const z=i.start(0);u=z+(z===i.end(0)?0:wr)}if(typeof u<"u")return this.logger_(`Trying to seek outside of seekable at time ${n} with seekable range ${qk(i)}. Seeking to ${u}.`),this.tech_.setCurrentTime(u),!0;const c=this.playlistController_.sourceUpdater_,h=this.tech_.buffered(),m=c.audioBuffer?c.audioBuffered():null,v=c.videoBuffer?c.videoBuffered():null,T=this.media(),O=T.partTargetDuration?T.partTargetDuration:(T.targetDuration-io)*2,R=[m,v];for(let z=0;z<R.length;z++){if(!R[z])continue;if(TT(R[z],n)<O)return!1}const M=Bp(h,n);return M.length===0?!1:(u=M.start(0)+wr,this.logger_(`Buffered region starts (${M.start(0)})  just beyond seek point (${n}). Seeking to ${u}.`),this.tech_.setCurrentTime(u),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),i=this.tech_.buffered(),n=Cu(i,e);if(n.length&&e+3<=n.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${n.start(0)} -> ${n.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,i)){const h=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${i}. Seeking to live point (seekable end) ${h}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(h),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const n=this.tech_.vhs.playlistController_.sourceUpdater_,o=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:n.audioBuffered(),videoBuffered:n.videoBuffered(),currentTime:i}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const c=Bp(o,i);return c.length>0?(this.logger_(`Stopped at ${i} and seeking to ${c.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(i),!0):!1}afterSeekableWindow_(e,i,n,o=!1){if(!e.length)return!1;let u=e.end(e.length-1)+wr;return!n.endList&&o&&(u=e.end(e.length-1)+n.targetDuration*3),i>u}beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:i,currentTime:n}){if(!e)return;let o;if(e.length&&i.length){const u=Cu(e,n-3),c=Cu(e,n),h=Cu(i,n);h.length&&!c.length&&u.length&&(o={start:u.end(0),end:h.end(0)})}else Bp(e,n).length||(o=this.gapFromVideoUnderflow_(e,n));return o?(this.logger_(`Encountered a gap in video from ${o.start} to ${o.end}. Seeking to current time ${n}`),!0):!1}skipTheGap_(e){const i=this.tech_.buffered(),n=this.tech_.currentTime(),o=Bp(i,n);this.resetTimeUpdate_(),!(o.length===0||n!==e)&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",o.start(0)),this.tech_.setCurrentTime(o.start(0)+io),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,i){const n=e4(e);for(let o=0;o<n.length;o++){const u=n.start(o),c=n.end(o);if(i-u<4&&i-u>2)return{start:u,end:c}}return null}}const a3={errorInterval:30,getSource(t){const i=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return t(i)}},II=function(t,e){let i=0,n=0;const o=ui(a3,e);t.ready(()=>{t.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const u=function(){n&&t.currentTime(n)},c=function(T){T!=null&&(n=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",u),t.src(T),t.trigger({type:"usage",name:"vhs-error-reload"}),t.play())},h=function(){if(Date.now()-i<o.errorInterval*1e3){t.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!o.getSource||typeof o.getSource!="function"){he.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),o.getSource.call(t,c)},m=function(){t.off("loadedmetadata",u),t.off("error",h),t.off("dispose",m)},v=function(T){m(),II(t,T)};t.on("error",h),t.on("dispose",m),t.reloadSourceOnError=v},o3=function(t){II(this,t)};var OI="3.0.0",l3="6.2.0",u3="1.0.1",c3="6.0.0",d3="4.0.1";const Ns={PlaylistLoader:Au,Playlist:Xs,utils:C4,STANDARD_PLAYLIST_SELECTOR:Aw,INITIAL_PLAYLIST_SELECTOR:h8,lastBandwidthSelector:Aw,movingAverageBandwidthSelector:c8,comparePlaylistBandwidth:CT,comparePlaylistResolution:u8,xhr:rI()};Object.keys(Ji).forEach(t=>{Object.defineProperty(Ns,t,{get(){return he.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),Ji[t]},set(e){if(he.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){he.log.warn(`value of Vhs.${t} must be greater than or equal to 0`);return}Ji[t]=e}})});const DI="videojs-vhs",PI=function(t,e){const i=e.media();let n=-1;for(let o=0;o<t.length;o++)if(t[o].id===i.id){n=o;break}t.selectedIndex_=n,t.trigger({selectedIndex:n,type:"change"})},h3=function(t,e){e.representations().forEach(i=>{t.addQualityLevel(i)}),PI(t,e.playlists)};Ns.canPlaySource=function(){return he.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const f3=(t,e,i)=>{if(!t)return t;let n={};e&&e.attributes&&e.attributes.CODECS&&(n=Nm(Tr(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(n.audio=i.attributes.CODECS);const o=dh(n.video),u=dh(n.audio),c={};for(const h in t)c[h]={},u&&(c[h].audioContentType=u),o&&(c[h].videoContentType=o),e.contentProtection&&e.contentProtection[h]&&e.contentProtection[h].pssh&&(c[h].pssh=e.contentProtection[h].pssh),typeof t[h]=="string"&&(c[h].url=t[h]);return ui(t,c)},p3=(t,e)=>t.reduce((i,n)=>{if(!n.contentProtection)return i;const o=e.reduce((u,c)=>{const h=n.contentProtection[c];return h&&h.pssh&&(u[c]={pssh:h.pssh}),u},{});return Object.keys(o).length&&i.push(o),i},[]),m3=({player:t,sourceKeySystems:e,audioMedia:i,mainPlaylists:n})=>{if(!t.eme.initializeMediaKeys)return Promise.resolve();const o=i?n.concat([i]):n,u=p3(o,Object.keys(e)),c=[],h=[];return u.forEach(m=>{h.push(new Promise((v,T)=>{t.tech_.one("keysessioncreated",v)})),c.push(new Promise((v,T)=>{t.eme.initializeMediaKeys({keySystems:m},O=>{if(O){T(O);return}v()})}))}),Promise.race([Promise.all(c),Promise.race(h)])},g3=({player:t,sourceKeySystems:e,media:i,audioMedia:n})=>{const o=f3(e,i,n);return o?(t.currentSource().keySystems=o,o&&!t.eme?(he.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},LI=()=>{if(!Z.localStorage)return null;const t=Z.localStorage.getItem(DI);if(!t)return null;try{return JSON.parse(t)}catch{return null}},_3=t=>{if(!Z.localStorage)return!1;let e=LI();e=e?ui(e,t):t;try{Z.localStorage.setItem(DI,JSON.stringify(e))}catch{return!1}return e},y3=t=>t.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(t.substring(t.indexOf(",")+1)):t;Ns.supportsNativeHls=function(){if(!$e||!$e.createElement)return!1;const t=$e.createElement("video");return he.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(t.canPlayType(i))}):!1}();Ns.supportsNativeDash=function(){return!$e||!$e.createElement||!he.getTech("Html5").isSupported()?!1:/maybe|probably/i.test($e.createElement("video").canPlayType("application/dash+xml"))}();Ns.supportsTypeNatively=t=>t==="hls"?Ns.supportsNativeHls:t==="dash"?Ns.supportsNativeDash:!1;Ns.isSupported=function(){return he.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const v3=he.getComponent("Component");class NI extends v3{constructor(e,i,n){if(super(i,n.vhs),typeof n.initialBandwidth=="number"&&(this.options_.bandwidth=n.initialBandwidth),this.logger_=or("VhsHandler"),i.options_&&i.options_.playerId){const o=he.getPlayer(i.options_.playerId);this.player_=o}if(this.tech_=i,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on($e,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],o=>{const u=$e.fullscreenElement||$e.webkitFullscreenElement||$e.mozFullScreenElement||$e.msFullscreenElement;u&&u.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const e=LI();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Ji.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ji.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(e=>{typeof this.source_[e]<"u"&&(this.options_[e]=this.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(e,i){if(!e)return;this.setOptions_(),this.options_.src=y3(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Ns,this.options_.sourceType=H1(i),this.options_.seekTo=u=>{this.tech_.setCurrentTime(u)},this.playlistController_=new t3(this.options_);const n=ui({liveRangeSafeTimeDelta:wr},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new r3(n),this.playlistController_.on("error",()=>{const u=he.players[this.tech_.options_.playerId];let c=this.playlistController_.error;typeof c=="object"&&!c.code?c.code=3:typeof c=="string"&&(c={message:c,code:3}),u.error(c)});const o=this.options_.bufferBasedABR?Ns.movingAverageBandwidthSelector(.55):Ns.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.playlistController_.selectInitialPlaylist=Ns.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(u){this.playlistController_.selectPlaylist=u.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(u){this.playlistController_.mainSegmentLoader_.throughput.rate=u,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let u=this.playlistController_.mainSegmentLoader_.bandwidth;const c=Z.navigator.connection||Z.navigator.mozConnection||Z.navigator.webkitConnection,h=1e7;if(this.options_.useNetworkInformationApi&&c){const m=c.downlink*1e3*1e3;m>=h&&u>=h?u=Math.max(u,m):u=m}return u},set(u){this.playlistController_.mainSegmentLoader_.bandwidth=u,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const u=1/(this.bandwidth||1);let c;return this.throughput>0?c=1/this.throughput:c=0,Math.floor(1/(u+c))},set(){he.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>Xo(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>Xo(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&_3({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{n3(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=Z.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),m3({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,i=g3({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",n=>{if(n.status!=="output-restricted")return;const o=this.playlistController_.main();if(!o||!o.playlists)return;const u=[];o.playlists.forEach(c=>{c&&c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.height>=720&&(!c.excludeUntil||c.excludeUntil<1/0)&&(c.excludeUntil=1/0,u.push(c))}),u.length&&(he.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...u),this.playlistController_.fastQualityChange_())}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),he.browser.IE_VERSION===11||!i){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=he.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{h3(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{PI(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":OI,"mux.js":l3,"mpd-parser":u3,"m3u8-parser":c3,"aes-decrypter":d3}}version(){return this.constructor.version()}canChangeType(){return AI.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&Z.URL.revokeObjectURL&&(Z.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,i){return L4({playlist:this.playlistController_.media(),time:e,callback:i})}seekToProgramTime(e,i,n=!0,o=2){return cI({programTime:e,playlist:this.playlistController_.media(),retryCount:o,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}}const AT={name:"videojs-http-streaming",VERSION:OI,canHandleSource(t,e={}){const i=ui(he.options,e);return AT.canPlayType(t.type,i)},handleSource(t,e,i={}){const n=ui(he.options,i);return e.vhs=new NI(t,e,n),e.vhs.xhr=rI(),e.vhs.src(t.src,t.type),e.vhs},canPlayType(t,e={}){const{vhs:{overrideNative:i=!he.browser.IS_ANY_SAFARI}={}}=ui(he.options,e),n=H1(t);return n&&(!Ns.supportsTypeNatively(n)||i)?"maybe":""}},T3=()=>Yp("avc1.4d400d,mp4a.40.2");T3()&&he.getTech("Html5").registerSourceHandler(AT,0);he.VhsHandler=NI;he.VhsSourceHandler=AT;he.Vhs=Ns;he.use||he.registerComponent("Vhs",Ns);he.options.vhs=he.options.vhs||{};(!he.getPlugin||!he.getPlugin("reloadSourceOnError"))&&he.registerPlugin("reloadSourceOnError",o3);var Bw={},b3={get exports(){return Bw},set exports(t){Bw=t}};/**
 * @license
 * Video.js 8.0.4 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */(function(t,e){(function(i,n){t.exports=n()})(Yn,function(){var i="8.0.4";const n={},o=function(a,s){return n[a]=n[a]||[],s&&(n[a]=n[a].concat(s)),n[a]};function u(a,s){return!((s=o(a).indexOf(s))<=-1||(n[a]=n[a].slice(),n[a].splice(s,1),0))}const c={prefixed:!0};var h=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],m=h[0];let v;for(let a=0;a<h.length;a++)if(h[a][1]in document){v=h[a];break}if(v){for(let a=0;a<v.length;a++)c[m[a]]=v[a];c.prefixed=v[0]!==m[0]}let T=[];function O(a){return W(a)?Object.keys(a):[]}const R=function a(s){let r="info",l;function d(...y){l("log",r,y)}var f,p;return l=(f=s,(y,L,A)=>{var P,L=p.levels[L],B=new RegExp(`^(${L})$`);if(y!=="log"&&A.unshift(y.toUpperCase()+":"),A.unshift(f+":"),T&&(T.push([].concat(A)),P=T.length-1e3,T.splice(0,0<P?P:0)),window.console){let F=window.console[y];(F=F||y!=="debug"?F:window.console.info||window.console.log)&&L&&B.test(y)&&F[Array.isArray(A)?"apply":"call"](window.console,A)}}),(p=d).createLogger=y=>a(s+": "+y),d.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},d.level=y=>{if(typeof y=="string"){if(!d.levels.hasOwnProperty(y))throw new Error(`"${y}" in not a valid log level`);r=y}return r},d.history=()=>T?[].concat(T):[],d.history.filter=y=>(T||[]).filter(S=>new RegExp(`.*${y}.*`).test(S[0])),d.history.clear=()=>{T&&(T.length=0)},d.history.disable=()=>{T!==null&&(T.length=0,T=null)},d.history.enable=()=>{T===null&&(T=[])},d.error=(...y)=>l("error",r,y),d.warn=(...y)=>l("warn",r,y),d.debug=(...y)=>l("debug",r,y),d}("VIDEOJS"),M=R.createLogger,z=Object.prototype.toString;function j(a,s){O(a).forEach(r=>s(a[r],r))}function q(a,s,r=0){return O(a).reduce((l,d)=>s(l,a[d],d),r)}function W(a){return!!a&&typeof a=="object"}function ee(a){return W(a)&&z.call(a)==="[object Object]"&&a.constructor===Object}function se(...a){const s={};return a.forEach(r=>{r&&j(r,(l,d)=>{ee(l)?(ee(s[d])||(s[d]={}),s[d]=se(s[d],l)):s[d]=l})}),s}function re(a,s,r,l=!0){const d=p=>Object.defineProperty(a,s,{value:p,enumerable:!0,writable:!0});var f={configurable:!0,enumerable:!0,get(){var p=r();return d(p),p}};return l&&(f.set=d),Object.defineProperty(a,s,f)}var ie=Object.freeze({__proto__:null,each:j,reduce:q,isObject:W,isPlain:ee,merge:se,defineLazyProperty:re});let ye=!1,Pe=null,Ie=!1,Be,Ve=!1,We=!1,it=!1,Le=!1,ct=null,Ht=null,Qe=null,Ze=!1,_t=!1,Vt=!1,mi=!1;const ei=Boolean(Ue()&&("ontouchstart"in window||window.navigator.maxTouchPoints||window.DocumentTouch&&window.document instanceof window.DocumentTouch));var Ft,Mt=window.navigator&&window.navigator.userAgentData;if(Mt&&(Ie=Mt.platform==="Android",We=Boolean(Mt.brands.find(a=>a.brand==="Microsoft Edge")),it=Boolean(Mt.brands.find(a=>a.brand==="Chromium")),Le=!We&&it,ct=Ht=(Mt.brands.find(a=>a.brand==="Chromium")||{}).version||null,_t=Mt.platform==="Windows"),!it){const a=window.navigator&&window.navigator.userAgent||"";ye=/iPod/i.test(a),Pe=(Mt=a.match(/OS (\d+)_/i))&&Mt[1]?Mt[1]:null,Ie=/Android/i.test(a),Be=(Mt=a.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(qt=Mt[1]&&parseFloat(Mt[1]),Ft=Mt[2]&&parseFloat(Mt[2]),qt&&Ft?parseFloat(Mt[1]+"."+Mt[2]):qt||null):null,Ve=/Firefox/i.test(a),We=/Edg/i.test(a),it=/Chrome/i.test(a)||/CriOS/i.test(a),Le=!We&&it,ct=Ht=(Ft=a.match(/(Chrome|CriOS)\/(\d+)/))&&Ft[2]?parseFloat(Ft[2]):null,Qe=function(){var s=/MSIE\s(\d+)\.\d/.exec(a);let r=s&&parseFloat(s[1]);return r=!r&&/Trident\/7.0/i.test(a)&&/rv:11.0/.test(a)?11:r}(),Ze=/Safari/i.test(a)&&!Le&&!Ie&&!We,_t=/Windows/i.test(a),Vt=/iPad/i.test(a)||Ze&&ei&&!/iPhone/i.test(a),mi=/iPhone/i.test(a)&&!Vt}const Qt=mi||Vt||ye,be=(Ze||Qt)&&!Le;Mt=Object.freeze({__proto__:null,get IS_IPOD(){return ye},get IOS_VERSION(){return Pe},get IS_ANDROID(){return Ie},get ANDROID_VERSION(){return Be},get IS_FIREFOX(){return Ve},get IS_EDGE(){return We},get IS_CHROMIUM(){return it},get IS_CHROME(){return Le},get CHROMIUM_VERSION(){return ct},get CHROME_VERSION(){return Ht},get IE_VERSION(){return Qe},get IS_SAFARI(){return Ze},get IS_WINDOWS(){return _t},get IS_IPAD(){return Vt},get IS_IPHONE(){return mi},TOUCH_ENABLED:ei,IS_IOS:Qt,IS_ANY_SAFARI:be});function He(a){return typeof a=="string"&&Boolean(a.trim())}function Ue(){return document===window.document}function Xe(a){return W(a)&&a.nodeType===1}function Ct(){try{return window.parent!==window.self}catch{return!0}}function Jt(a){return function(s,r){return He(s)?(r=Xe(r=He(r)?document.querySelector(r):r)?r:document)[a]&&r[a](s):document[a](null)}}function je(a="div",s={},r={},l){const d=document.createElement(a);return Object.getOwnPropertyNames(s).forEach(function(f){var p=s[f];f==="textContent"?X(d,p):d[f]===p&&f!=="tabIndex"||(d[f]=p)}),Object.getOwnPropertyNames(r).forEach(function(f){d.setAttribute(f,r[f])}),l&&en(d,l),d}function X(a,s){return typeof a.textContent>"u"?a.innerText=s:a.textContent=s,a}function ne(a,s){s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a)}function pe(a,s){if(0<=s.indexOf(" "))throw new Error("class has illegal whitespace characters");return a.classList.contains(s)}function _e(a,...s){return a.classList.add(...s.reduce((r,l)=>r.concat(l.split(/\s+/)),[])),a}function Ce(a,...s){return a?(a.classList.remove(...s.reduce((r,l)=>r.concat(l.split(/\s+/)),[])),a):(R.warn("removeClass was called with an element that doesn't exist"),null)}function Re(a,s,r){return typeof(r=typeof r=="function"?r(a,s):r)!="boolean"&&(r=void 0),s.split(/\s+/).forEach(l=>a.classList.toggle(l,r)),a}function Fe(a,s){Object.getOwnPropertyNames(s).forEach(function(r){var l=s[r];l===null||typeof l>"u"||l===!1?a.removeAttribute(r):a.setAttribute(r,l===!0?"":l)})}function Oe(a){var s={};if(a&&a.attributes&&0<a.attributes.length){var r=a.attributes;for(let d=r.length-1;0<=d;d--){var l=r[d].name;let f=r[d].value;typeof a[l]!="boolean"&&",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+l+",")===-1||(f=f!==null),s[l]=f}}return s}function Se(a,s){return a.getAttribute(s)}function ke(a,s,r){a.setAttribute(s,r)}function et(a,s){a.removeAttribute(s)}function Je(){document.body.focus(),document.onselectstart=function(){return!1}}function tt(){document.onselectstart=function(){return!0}}function rt(a){if(a&&a.getBoundingClientRect&&a.parentNode){const s=a.getBoundingClientRect(),r={};return["bottom","height","left","right","top","width"].forEach(l=>{s[l]!==void 0&&(r[l]=s[l])}),r.height||(r.height=parseFloat(Fi(a,"height"))),r.width||(r.width=parseFloat(Fi(a,"width"))),r}}function mt(a){if(!a||!a.offsetParent)return{left:0,top:0,width:0,height:0};var s=a.offsetWidth,r=a.offsetHeight;let l=0,d=0;for(;a.offsetParent&&a!==document[c.fullscreenElement];)l+=a.offsetLeft,d+=a.offsetTop,a=a.offsetParent;return{left:l,top:d,width:s,height:r}}function Dt(y,s){var r={x:0,y:0};if(Qt){let B=y;for(;B&&B.nodeName.toLowerCase()!=="html";){var l,d=Fi(B,"transform");/^matrix/.test(d)?(l=d.slice(7,-1).split(/,\s/).map(Number),r.x+=l[4],r.y+=l[5]):/^matrix3d/.test(d)&&(l=d.slice(9,-1).split(/,\s/).map(Number),r.x+=l[12],r.y+=l[13]),B=B.parentNode}}var f={},p=mt(s.target),y=mt(y),S=y.width,A=y.height;let P=s.offsetY-(y.top-p.top),L=s.offsetX-(y.left-p.left);return s.changedTouches&&(L=s.changedTouches[0].pageX-y.left,P=s.changedTouches[0].pageY+y.top,Qt)&&(L-=r.x,P-=r.y),f.y=1-Math.max(0,Math.min(1,P/A)),f.x=Math.max(0,Math.min(1,L/S)),f}function Pt(a){return W(a)&&a.nodeType===3}function ai(a){for(;a.firstChild;)a.removeChild(a.firstChild);return a}function es(a){return typeof a=="function"&&(a=a()),(Array.isArray(a)?a:[a]).map(s=>Xe(s=typeof s=="function"?s():s)||Pt(s)?s:typeof s=="string"&&/\S/.test(s)?document.createTextNode(s):void 0).filter(s=>s)}function en(a,s){return es(s).forEach(r=>a.appendChild(r)),a}function Xt(a,s){return en(ai(a),s)}function tn(a){return a.button===void 0&&a.buttons===void 0||a.button===0&&a.buttons===void 0||a.type==="mouseup"&&a.button===0&&a.buttons===0||a.button===0&&a.buttons===1}const us=Jt("querySelector"),Gi=Jt("querySelectorAll");function Fi(a,s){if(!a||!s||typeof window.getComputedStyle!="function")return"";{let r;try{r=window.getComputedStyle(a)}catch{return""}return r?r.getPropertyValue(s)||r[s]:""}}var co=Object.freeze({__proto__:null,isReal:Ue,isEl:Xe,isInFrame:Ct,createEl:je,textContent:X,prependTo:ne,hasClass:pe,addClass:_e,removeClass:Ce,toggleClass:Re,setAttributes:Fe,getAttributes:Oe,getAttribute:Se,setAttribute:ke,removeAttribute:et,blockTextSelection:Je,unblockTextSelection:tt,getBoundingClientRect:rt,findPosition:mt,getPointerPosition:Dt,isTextNode:Pt,emptyEl:ai,normalizeContent:es,appendContent:en,insertContent:Xt,isSingleLeftClick:tn,$:us,$$:Gi,computedStyle:Fi});let qh=!1,Ec;function Ng(){if(Ec.options.autoSetup!==!1){var a=Array.prototype.slice.call(document.getElementsByTagName("video")),s=Array.prototype.slice.call(document.getElementsByTagName("audio")),r=Array.prototype.slice.call(document.getElementsByTagName("video-js")),l=a.concat(s,r);if(l&&0<l.length)for(let f=0,p=l.length;f<p;f++){var d=l[f];if(!d||!d.getAttribute){Sc(1);break}d.player===void 0&&d.getAttribute("data-setup")!==null&&Ec(d)}else qh||Sc(1)}}function Sc(a,s){Ue()&&(s&&(Ec=s),window.setTimeout(Ng,a))}function xc(){qh=!0,window.removeEventListener("load",xc)}Ue()&&(document.readyState==="complete"?xc():window.addEventListener("load",xc));function Wh(a){var s=document.createElement("style");return s.className=a,s}function Gh(a,s){a.styleSheet?a.styleSheet.cssText=s:a.textContent=s}var ts=new WeakMap;let sn=3;function zh(a,s){var r;ts.has(a)&&((r=ts.get(a)).handlers[s].length===0&&(delete r.handlers[s],a.removeEventListener?a.removeEventListener(s,r.dispatcher,!1):a.detachEvent&&a.detachEvent("on"+s,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),Object.getOwnPropertyNames(r).length===0)&&ts.delete(a)}function wc(a,s,r,l){r.forEach(function(d){a(s,d,l)})}function hl(a){if(!a.fixed_){if(!a||!a.isPropagationStopped||!a.isImmediatePropagationStopped){const f=a||window.event;a={};for(const p in f)p==="layerX"||p==="layerY"||p==="keyLocation"||p==="webkitMovementX"||p==="webkitMovementY"||p==="path"||p==="returnValue"&&f.preventDefault||(a[p]=f[p]);var s,r;a.target||(a.target=a.srcElement||document),a.relatedTarget||(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement),a.preventDefault=function(){f.preventDefault&&f.preventDefault(),a.returnValue=!1,f.returnValue=!1,a.defaultPrevented=!0},a.defaultPrevented=!1,a.stopPropagation=function(){f.stopPropagation&&f.stopPropagation(),a.cancelBubble=!0,f.cancelBubble=!0,a.isPropagationStopped=l},a.isPropagationStopped=d,a.stopImmediatePropagation=function(){f.stopImmediatePropagation&&f.stopImmediatePropagation(),a.isImmediatePropagationStopped=l,a.stopPropagation()},a.isImmediatePropagationStopped=d,a.clientX!==null&&a.clientX!==void 0&&(s=document.documentElement,r=document.body,a.pageX=a.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),a.pageY=a.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),a.which=a.charCode||a.keyCode,a.button!==null&&a.button!==void 0&&(a.button=1&a.button?0:4&a.button?1:2&a.button?2:0)}a.fixed_=!0}return a;function l(){return!0}function d(){return!1}}let fl;const Rg=["touchstart","touchmove"];function cs(a,s,r){if(Array.isArray(s))return wc(cs,a,s,r);ts.has(a)||ts.set(a,{});const l=ts.get(a);if(l.handlers||(l.handlers={}),l.handlers[s]||(l.handlers[s]=[]),r.guid||(r.guid=sn++),l.handlers[s].push(r),l.dispatcher||(l.disabled=!1,l.dispatcher=function(d,f){if(!l.disabled){d=hl(d);var p=l.handlers[d.type];if(p){var y=p.slice(0);for(let S=0,A=y.length;S<A&&!d.isImmediatePropagationStopped();S++)try{y[S].call(a,d,f)}catch(P){R.error(P)}}}}),l.handlers[s].length===1)if(a.addEventListener){let d=!1;(function(){if(typeof fl!="boolean"){fl=!1;try{var f=Object.defineProperty({},"passive",{get(){fl=!0}});window.addEventListener("test",null,f),window.removeEventListener("test",null,f)}catch{}}return fl})()&&-1<Rg.indexOf(s)&&(d={passive:!0}),a.addEventListener(s,l.dispatcher,d)}else a.attachEvent&&a.attachEvent("on"+s,l.dispatcher)}function Ri(a,s,r){if(ts.has(a)){const f=ts.get(a);if(f.handlers){if(Array.isArray(s))return wc(Ri,a,s,r);var l=function(p,y){f.handlers[y]=[],zh(p,y)};if(s===void 0)for(const p in f.handlers)Object.prototype.hasOwnProperty.call(f.handlers||{},p)&&l(a,p);else{var d=f.handlers[s];if(d)if(r){if(r.guid)for(let p=0;p<d.length;p++)d[p].guid===r.guid&&d.splice(p--,1);zh(a,s)}else l(a,s)}}}}function Rn(a,s,r){var l=ts.has(a)?ts.get(a):{},d=a.parentNode||a.ownerDocument;return typeof s=="string"?s={type:s,target:a}:s.target||(s.target=a),s=hl(s),l.dispatcher&&l.dispatcher.call(a,s,r),d&&!s.isPropagationStopped()&&s.bubbles===!0?Rn.call(null,d,s,r):!d&&!s.defaultPrevented&&s.target&&s.target[s.type]&&(ts.has(s.target)||ts.set(s.target,{}),l=ts.get(s.target),s.target[s.type])&&(l.disabled=!0,typeof s.target[s.type]=="function"&&s.target[s.type](),l.disabled=!1),!s.defaultPrevented}function $i(a,s,r){if(Array.isArray(s))return wc($i,a,s,r);function l(){Ri(a,s,l),r.apply(this,arguments)}l.guid=r.guid=r.guid||sn++,cs(a,s,l)}function Cc(a,s,r){function l(){Ri(a,s,l),r.apply(this,arguments)}l.guid=r.guid=r.guid||sn++,cs(a,s,l)}var Mg=Object.freeze({__proto__:null,fixEvent:hl,on:cs,off:Ri,trigger:Rn,one:$i,any:Cc});function Yt(a,s,r){return s.guid||(s.guid=sn++),(a=s.bind(a)).guid=r?r+"_"+s.guid:s.guid,a}function Mi(a,s){let r=window.performance.now();return function(...l){var d=window.performance.now();d-r>=s&&(a(...l),r=d)}}function ho(a,s,r,l=window){let d;function f(){const p=this,y=arguments;let S=function(){d=null,S=null,r||a.apply(p,y)};!d&&r&&a.apply(p,y),l.clearTimeout(d),d=l.setTimeout(S,s)}return f.cancel=()=>{l.clearTimeout(d),d=null},f}var qt=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:30,bind_:Yt,throttle:Mi,debounce:ho});let fo;class is{on(s,r){var l=this.addEventListener;this.addEventListener=()=>{},cs(this,s,r),this.addEventListener=l}off(s,r){Ri(this,s,r)}one(s,r){var l=this.addEventListener;this.addEventListener=()=>{},$i(this,s,r),this.addEventListener=l}any(s,r){var l=this.addEventListener;this.addEventListener=()=>{},Cc(this,s,r),this.addEventListener=l}trigger(s){var r=s.type||s;s=hl(s=typeof s=="string"?{type:r}:s),this.allowedEvents_[r]&&this["on"+r]&&this["on"+r](s),Rn(this,s)}queueTrigger(s){fo=fo||new Map;const r=s.type||s;let l=fo.get(this);l||(l=new Map,fo.set(this,l));var d=l.get(r),d=(l.delete(r),window.clearTimeout(d),window.setTimeout(()=>{l.delete(r),l.size===0&&(l=null,fo.delete(this)),this.trigger(s)},0));l.set(r,d)}}is.prototype.allowedEvents_={},is.prototype.addEventListener=is.prototype.on,is.prototype.removeEventListener=is.prototype.off,is.prototype.dispatchEvent=is.prototype.trigger;const Fr=a=>typeof a.name=="function"?a.name():typeof a.name=="string"?a.name:a.name_||(a.constructor&&a.constructor.name?a.constructor.name:typeof a),Mn=a=>a instanceof is||!!a.eventBusEl_&&["on","one","off","trigger"].every(s=>typeof a[s]=="function"),Un=a=>typeof a=="string"&&/\S/.test(a)||Array.isArray(a)&&!!a.length,ti=(a,s,r)=>{if(!a||!a.nodeName&&!Mn(a))throw new Error(`Invalid target for ${Fr(s)}#${r}; must be a DOM node or evented object.`)},Ac=(a,s,r)=>{if(!Un(a))throw new Error(`Invalid event type for ${Fr(s)}#${r}; must be a non-empty string or array.`)},po=(a,s,r)=>{if(typeof a!="function")throw new Error(`Invalid listener for ${Fr(s)}#${r}; must be a function.`)},kc=(a,s,r)=>{var l=s.length<3||s[0]===a||s[0]===a.eventBusEl_;let d,f,p;return l?(d=a.eventBusEl_,3<=s.length&&s.shift(),[f,p]=s):[d,f,p]=s,ti(d,a,r),Ac(f,a,r),po(p,a,r),p=Yt(a,p),{isTargetingSelf:l,target:d,type:f,listener:p}},$r=(a,s,r,l)=>{ti(a,a,s),a.nodeName?Mg[s](a,r,l):a[s](r,l)},Ug={on(...a){const{isTargetingSelf:s,target:r,type:l,listener:d}=kc(this,a,"on");if($r(r,"on",l,d),!s){const f=()=>this.off(r,l,d);f.guid=d.guid,a=()=>this.off("dispose",f),a.guid=d.guid,$r(this,"on","dispose",f),$r(r,"on","dispose",a)}},one(...a){const{isTargetingSelf:s,target:r,type:l,listener:d}=kc(this,a,"one");if(s)$r(r,"one",l,d);else{const f=(...p)=>{this.off(r,l,f),d.apply(null,p)};f.guid=d.guid,$r(r,"one",l,f)}},any(...a){const{isTargetingSelf:s,target:r,type:l,listener:d}=kc(this,a,"any");if(s)$r(r,"any",l,d);else{const f=(...p)=>{this.off(r,l,f),d.apply(null,p)};f.guid=d.guid,$r(r,"any",l,f)}},off(a,s,r){!a||Un(a)?Ri(this.eventBusEl_,a,s):(a=a,s=s,ti(a,this,"off"),Ac(s,this,"off"),po(r,this,"off"),r=Yt(this,r),this.off("dispose",r),a.nodeName?(Ri(a,s,r),Ri(a,"dispose",r)):Mn(a)&&(a.off(s,r),a.off("dispose",r)))},trigger(a,s){ti(this.eventBusEl_,this,"trigger");var r=a&&typeof a!="string"?a.type:a;if(Un(r))return Rn(this.eventBusEl_,a,s);throw new Error(`Invalid event type for ${Fr(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`)}};function pl(a,s={}){if(s=s.eventBusKey,s){if(!a[s].nodeName)throw new Error(`The eventBusKey "${s}" does not refer to an element.`);a.eventBusEl_=a[s]}else a.eventBusEl_=je("span",{className:"vjs-event-bus"});Object.assign(a,Ug),a.eventedCallbacks&&a.eventedCallbacks.forEach(r=>{r()}),a.on("dispose",()=>{a.off(),[a,a.el_,a.eventBusEl_].forEach(function(r){r&&ts.has(r)&&ts.delete(r)}),window.setTimeout(()=>{a.eventBusEl_=null},0)})}const Ic={state:{},setState(a){typeof a=="function"&&(a=a());let s;return j(a,(r,l)=>{this.state[l]!==r&&((s=s||{})[l]={from:this.state[l],to:r}),this.state[l]=r}),s&&Mn(this)&&this.trigger({changes:s,type:"statechanged"}),s}};function ml(a,s){Object.assign(a,Ic),a.state=Object.assign({},a.state,s),typeof a.handleStateChanged=="function"&&Mn(a)&&a.on("statechanged",a.handleStateChanged)}function Aa(a){return typeof a!="string"?a:a.replace(/./,s=>s.toLowerCase())}function vi(a){return typeof a!="string"?a:a.replace(/./,s=>s.toUpperCase())}function Kh(a,s){return vi(a)===vi(s)}var Bg=Object.freeze({__proto__:null,toLowerCase:Aa,toTitleCase:vi,titleCaseEquals:Kh}),V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Yn<"u"?Yn:typeof self<"u"?self:{};function ka(a,s){return a(s={exports:{}},s.exports),s.exports}var ut=ka(function(a,s){function r(S){var A;return typeof(S=S&&typeof S=="object"&&(A=S.which||S.keyCode||S.charCode)?A:S)=="number"?y[S]:(A=String(S),l[A.toLowerCase()]||d[A.toLowerCase()]||(A.length===1?A.charCodeAt(0):void 0))}r.isEventKey=function(S,A){if(S&&typeof S=="object"){if(S=S.which||S.keyCode||S.charCode,S!=null){if(typeof A=="string"){var P=l[A.toLowerCase()];if(P||(P=d[A.toLowerCase()]))return P===S}else if(typeof A=="number")return A===S}return!1}};for(var l=(s=a.exports=r).code=s.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},d=s.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91},f=97;f<123;f++)l[String.fromCharCode(f)]=f-32;for(var f=48;f<58;f++)l[f-48]=f;for(f=1;f<13;f++)l["f"+f]=f+111;for(f=0;f<10;f++)l["numpad "+f]=f+96;var p,y=s.names=s.title={};for(f in l)y[l[f]]=f;for(p in d)l[p]=d[p]});ut.code,ut.codes,ut.aliases,ut.names,ut.title;class ve{constructor(s,r,l){!s&&this.play?this.player_=s=this:this.player_=s,this.isDisposed_=!1,this.parentComponent_=null,this.options_=se({},this.options_),r=this.options_=se(this.options_,r),this.id_=r.id||r.el&&r.el.id,this.id_||(s=s&&s.id&&s.id()||"no_player",this.id_=s+"_component_"+sn++),this.name_=r.name||null,r.el?this.el_=r.el:r.createEl!==!1&&(this.el_=this.createEl()),r.className&&this.el_&&r.className.split(" ").forEach(d=>this.addClass(d)),r.evented!==!1&&(pl(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),ml(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,(this.clearingTimersOnDispose_=!1)!==r.initChildren&&this.initChildren(),this.ready(l),r.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(s={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let r=this.children_.length-1;0<=r;r--)this.children_[r].dispose&&this.children_[r].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(s.restoreEl?this.el_.parentNode.replaceChild(s.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(s){return s&&(this.options_=se(this.options_,s)),this.options_}el(){return this.el_}createEl(s,r,l){return je(s,r,l)}localize(s,r,l=s){var f=this.player_.language&&this.player_.language(),p=this.player_.languages&&this.player_.languages(),d=p&&p[f],f=f&&f.split("-")[0],p=p&&p[f];let y=l;return d&&d[s]?y=d[s]:p&&p[s]&&(y=p[s]),y=r?y.replace(/\{(\d+)\}/g,function(S,A){return A=r[A-1],typeof A>"u"?S:A}):y}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(s){return this.childIndex_[s]}getChild(s){if(s)return this.childNameIndex_[s]}getDescendant(...s){s=s.reduce((l,d)=>l.concat(d),[]);let r=this;for(let l=0;l<s.length;l++)if(!(r=r.getChild(s[l]))||!r.getChild)return;return r}addChild(s,r={},l=this.children_.length){let d,f;if(typeof s=="string"){f=vi(s);var p=r.componentClass||f,y=(r.name=f,ve.getComponent(p));if(!y)throw new Error(`Component ${p} does not exist`);if(typeof y!="function")return null;d=new y(this.player_||this,r)}else d=s;if(d.parentComponent_&&d.parentComponent_.removeChild(d),this.children_.splice(l,0,d),d.parentComponent_=this,typeof d.id=="function"&&(this.childIndex_[d.id()]=d),(f=f||d.name&&vi(d.name()))&&(this.childNameIndex_[f]=d,this.childNameIndex_[Aa(f)]=d),typeof d.el=="function"&&d.el()){let S=null;this.children_[l+1]&&(this.children_[l+1].el_?S=this.children_[l+1].el_:Xe(this.children_[l+1])&&(S=this.children_[l+1])),this.contentEl().insertBefore(d.el(),S)}return d}removeChild(s){if((s=typeof s=="string"?this.getChild(s):s)&&this.children_){let l=!1;for(let d=this.children_.length-1;0<=d;d--)if(this.children_[d]===s){l=!0,this.children_.splice(d,1);break}var r;l&&(s.parentComponent_=null,this.childIndex_[s.id()]=null,this.childNameIndex_[vi(s.name())]=null,this.childNameIndex_[Aa(s.name())]=null,r=s.el())&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(s.el())}}initChildren(){const s=this.options_.children;if(s){const r=this.options_;let l;const d=ve.getComponent("Tech");(l=Array.isArray(s)?s:Object.keys(s)).concat(Object.keys(this.options_).filter(function(f){return!l.some(function(p){return typeof p=="string"?f===p:f===p.name})})).map(f=>{let p,y;return y=typeof f=="string"?(p=f,s[p]||this.options_[p]||{}):(p=f.name,f),{name:p,opts:y}}).filter(f=>(f=ve.getComponent(f.opts.componentClass||vi(f.name)),f&&!d.isTech(f))).forEach(f=>{var p=f.name;let y=f.opts;(y=r[p]!==void 0?r[p]:y)!==!1&&((y=y===!0?{}:y).playerOptions=this.options_.playerOptions,f=this.addChild(p,y))&&(this[p]=f)})}}buildCSSClass(){return""}ready(s,r=!1){s&&(this.isReady_?r?s.call(this):this.setTimeout(s,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(s)))}triggerReady(){this.isReady_=!0,this.setTimeout(function(){var s=this.readyQueue_;this.readyQueue_=[],s&&0<s.length&&s.forEach(function(r){r.call(this)},this),this.trigger("ready")},1)}$(s,r){return us(s,r||this.contentEl())}$$(s,r){return Gi(s,r||this.contentEl())}hasClass(s){return pe(this.el_,s)}addClass(...s){_e(this.el_,...s)}removeClass(...s){Ce(this.el_,...s)}toggleClass(s,r){Re(this.el_,s,r)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(s){return Se(this.el_,s)}setAttribute(s,r){ke(this.el_,s,r)}removeAttribute(s){et(this.el_,s)}width(s,r){return this.dimension("width",s,r)}height(s,r){return this.dimension("height",s,r)}dimensions(s,r){this.width(s,!0),this.height(r)}dimension(s,r,l){var d,f;if(r===void 0)return this.el_?(f=(d=this.el_.style[s]).indexOf("px"))!==-1?parseInt(d.slice(0,f),10):parseInt(this.el_["offset"+vi(s)],10):0;(""+(r=r!==null&&r==r?r:0)).indexOf("%")!==-1||(""+r).indexOf("px")!==-1?this.el_.style[s]=r:this.el_.style[s]=r==="auto"?"":r+"px",l||this.trigger("componentresize")}currentDimension(s){let r=0;if(s!=="width"&&s!=="height")throw new Error("currentDimension only accepts width or height value");return r=Fi(this.el_,s),(r=parseFloat(r))!==0&&!isNaN(r)||(s="offset"+vi(s),r=this.el_[s]),r}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(s){this.player_&&(ut.isEventKey(s,"Tab")||s.stopPropagation(),this.player_.handleKeyDown(s))}handleKeyPress(s){this.handleKeyDown(s)}emitTapEvents(){let s=0,r=null,l;this.on("touchstart",function(f){f.touches.length===1&&(r={pageX:f.touches[0].pageX,pageY:f.touches[0].pageY},s=window.performance.now(),l=!0)}),this.on("touchmove",function(f){var p;(1<f.touches.length||r&&(p=f.touches[0].pageX-r.pageX,f=f.touches[0].pageY-r.pageY,10<Math.sqrt(p*p+f*f)))&&(l=!1)});function d(){l=!1}this.on("touchleave",d),this.on("touchcancel",d),this.on("touchend",function(f){!(r=null)===l&&window.performance.now()-s<200&&(f.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){const r=Yt(this.player(),this.player().reportUserActivity);let l;this.on("touchstart",function(){r(),this.clearInterval(l),l=this.setInterval(r,250)});var s=function(d){r(),this.clearInterval(l)};this.on("touchmove",r),this.on("touchend",s),this.on("touchcancel",s)}}setTimeout(s,r){var l;return s=Yt(this,s),this.clearTimersOnDispose_(),l=window.setTimeout(()=>{this.setTimeoutIds_.has(l)&&this.setTimeoutIds_.delete(l),s()},r),this.setTimeoutIds_.add(l),l}clearTimeout(s){return this.setTimeoutIds_.has(s)&&(this.setTimeoutIds_.delete(s),window.clearTimeout(s)),s}setInterval(s,r){return s=Yt(this,s),this.clearTimersOnDispose_(),s=window.setInterval(s,r),this.setIntervalIds_.add(s),s}clearInterval(s){return this.setIntervalIds_.has(s)&&(this.setIntervalIds_.delete(s),window.clearInterval(s)),s}requestAnimationFrame(s){var r;return this.clearTimersOnDispose_(),s=Yt(this,s),r=window.requestAnimationFrame(()=>{this.rafIds_.has(r)&&this.rafIds_.delete(r),s()}),this.rafIds_.add(r),r}requestNamedAnimationFrame(s,r){var l;if(!this.namedRafs_.has(s))return this.clearTimersOnDispose_(),r=Yt(this,r),l=this.requestAnimationFrame(()=>{r(),this.namedRafs_.has(s)&&this.namedRafs_.delete(s)}),this.namedRafs_.set(s,l),s}cancelNamedAnimationFrame(s){this.namedRafs_.has(s)&&(this.cancelAnimationFrame(this.namedRafs_.get(s)),this.namedRafs_.delete(s))}cancelAnimationFrame(s){return this.rafIds_.has(s)&&(this.rafIds_.delete(s),window.cancelAnimationFrame(s)),s}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([s,r])=>{this[s].forEach((l,d)=>this[r](d))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(s,r){if(typeof s!="string"||!s)throw new Error(`Illegal component name, "${s}"; must be a non-empty string.`);var l=ve.getComponent("Tech"),l=l&&l.isTech(r),d=ve===r||ve.prototype.isPrototypeOf(r.prototype);if(l||!d){let f;throw f=l?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error(`Illegal component, "${s}"; ${f}.`)}if(s=vi(s),ve.components_||(ve.components_={}),d=ve.getComponent("Player"),s==="Player"&&d&&d.players){const f=d.players;if(l=Object.keys(f),f&&0<l.length&&l.map(p=>f[p]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return ve.components_[s]=r,ve.components_[Aa(s)]=r}static getComponent(s){if(s&&ve.components_)return ve.components_[s]}}function Oc(a,s,r,l){var d=l,f=r.length-1;if(typeof d!="number"||d<0||f<d)throw new Error(`Failed to execute '${a}' on 'TimeRanges': The index provided (${d}) is non-numeric or out of bounds (0-${f}).`);return r[l][s]}function jr(a){let s;return s=a===void 0||a.length===0?{length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:{length:a.length,start:Oc.bind(null,"start",0,a),end:Oc.bind(null,"end",1,a)},window.Symbol&&window.Symbol.iterator&&(s[window.Symbol.iterator]=()=>(a||[]).values()),s}function ds(a,s){return Array.isArray(a)?jr(a):a===void 0||s===void 0?jr():jr([[a,s]])}ve.registerComponent("Component",ve);function mo(a,p){a=a<0?0:a;let r=Math.floor(a%60),l=Math.floor(a/60%60),d=Math.floor(a/3600);var f=Math.floor(p/60%60),p=Math.floor(p/3600);return d=0<(d=!isNaN(a)&&a!==1/0?d:l=r="-")||0<p?d+":":"",l=((d||10<=f)&&l<10?"0"+l:l)+":",r=r<10?"0"+r:r,d+l+r}let Ia=mo;function go(a){Ia=a}function Xh(){Ia=mo}function Bn(a,s=a){return Ia(a,s)}var Dc=Object.freeze({__proto__:null,createTimeRanges:ds,createTimeRange:ds,setFormatTime:go,resetFormatTime:Xh,formatTime:Bn});function Bs(a,s){let r=0;var l;let d;if(!s)return 0;a&&a.length||(a=ds(0,0));for(let f=0;f<a.length;f++)l=a.start(f),(d=a.end(f))>s&&(d=s),r+=d-l;return r/s}function ss(a){if(a instanceof ss)return a;typeof a=="number"?this.code=a:typeof a=="string"?this.message=a:W(a)&&(typeof a.code=="number"&&(this.code=a.code),Object.assign(this,a)),this.message||(this.message=ss.defaultMessages[this.code]||"")}ss.prototype.code=0,ss.prototype.message="",ss.prototype.status=null,ss.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],ss.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let a=0;a<ss.errorTypes.length;a++)ss[ss.errorTypes[a]]=a,ss.prototype[ss.errorTypes[a]]=a;var gl=function(a,s){var r,l=null;try{r=JSON.parse(a,s)}catch(d){l=d}return[l,r]};function Fn(a){return a!=null&&typeof a.then=="function"}function Es(a){Fn(a)&&a.then(null,s=>{})}function Hr(a){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((s,r,l)=>(a[r]&&(s[r]=a[r]),s),{cues:a.cues&&Array.prototype.map.call(a.cues,function(s){return{startTime:s.startTime,endTime:s.endTime,text:s.text,id:s.id}})})}var Pc=function(a){var s=a.$$("track");const r=Array.prototype.map.call(s,l=>l.track);return Array.prototype.map.call(s,function(l){var d=Hr(l.track);return l.src&&(d.src=l.src),d}).concat(Array.prototype.filter.call(a.textTracks(),function(l){return r.indexOf(l)===-1}).map(Hr))},Yh=function(a,s){return a.forEach(function(r){const l=s.addRemoteTextTrack(r).track;!r.src&&r.cues&&r.cues.forEach(d=>l.addCue(d))}),s.textTracks()};const _o="vjs-modal-dialog";class Oa extends ve{constructor(s,r){super(s,r),this.handleKeyDown_=l=>this.handleKeyDown(l),this.close_=l=>this.close(l),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=je("div",{className:_o+"-content"},{role:"document"}),this.descEl_=je("p",{className:_o+"-description vjs-control-text",id:this.el().getAttribute("aria-describedby")}),X(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return _o+" vjs-hidden "+super.buildCSSClass()}label(){return this.localize(this.options_.label||"Modal Window")}description(){let s=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(s+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),s}open(){var s;this.opened_||(s=this.player(),this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!s.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&s.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=s.controls(),s.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0)}opened(s){return typeof s=="boolean"&&this[s?"open":"close"](),this.opened_}close(){var s;this.opened_&&(s=this.player(),this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&s.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&s.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary)&&this.dispose()}closeable(s){if(typeof s=="boolean"){var r,s=this.closeable_=!!s;let d=this.getChild("closeButton");s&&!d&&(r=this.contentEl_,this.contentEl_=this.el_,d=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(d,"close",this.close_)),!s&&d&&(this.off(d,"close",this.close_),this.removeChild(d),d.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(f){var r=this.contentEl(),l=r.parentNode,d=r.nextSibling,f=(this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,l.removeChild(r),this.empty(),Xt(r,f),this.trigger("modalfill"),d?l.insertBefore(r,d):l.appendChild(r),this.getChild("closeButton"));f&&l.appendChild(f.el_)}empty(){this.trigger("beforemodalempty"),ai(this.contentEl()),this.trigger("modalempty")}content(s){return typeof s<"u"&&(this.content_=s),this.content_}conditionalFocus_(){var s=document.activeElement,r=this.player_.el_;this.previouslyActiveEl_=null,!r.contains(s)&&r!==s||(this.previouslyActiveEl_=s,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(s){if(s.stopPropagation(),ut.isEventKey(s,"Escape")&&this.closeable())s.preventDefault(),this.close();else if(ut.isEventKey(s,"Tab")){var r=this.focusableEls_(),l=this.el_.querySelector(":focus");let d;for(let f=0;f<r.length;f++)if(l===r[f]){d=f;break}document.activeElement===this.el_&&(d=0),s.shiftKey&&d===0?(r[r.length-1].focus(),s.preventDefault()):s.shiftKey||d!==r.length-1||(r[0].focus(),s.preventDefault())}}focusableEls_(){var s=this.el_.querySelectorAll("*");return Array.prototype.filter.call(s,r=>(r instanceof window.HTMLAnchorElement||r instanceof window.HTMLAreaElement)&&r.hasAttribute("href")||(r instanceof window.HTMLInputElement||r instanceof window.HTMLSelectElement||r instanceof window.HTMLTextAreaElement||r instanceof window.HTMLButtonElement)&&!r.hasAttribute("disabled")||r instanceof window.HTMLIFrameElement||r instanceof window.HTMLObjectElement||r instanceof window.HTMLEmbedElement||r.hasAttribute("tabindex")&&r.getAttribute("tabindex")!==-1||r.hasAttribute("contenteditable"))}}Oa.prototype.options_={pauseOnOpen:!0,temporary:!0},ve.registerComponent("ModalDialog",Oa);class yo extends is{constructor(s=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let r=0;r<s.length;r++)this.addTrack(s[r])}addTrack(s){const r=this.tracks_.length;""+r in this||Object.defineProperty(this,r,{get(){return this.tracks_[r]}}),this.tracks_.indexOf(s)===-1&&(this.tracks_.push(s),this.trigger({track:s,type:"addtrack",target:this})),s.labelchange_=()=>{this.trigger({track:s,type:"labelchange",target:this})},Mn(s)&&s.addEventListener("labelchange",s.labelchange_)}removeTrack(s){let r;for(let l=0,d=this.length;l<d;l++)if(this[l]===s){(r=this[l]).off&&r.off(),this.tracks_.splice(l,1);break}r&&this.trigger({track:r,type:"removetrack",target:this})}getTrackById(s){let r=null;for(let d=0,f=this.length;d<f;d++){var l=this[d];if(l.id===s){r=l;break}}return r}}for(const a in yo.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"})yo.prototype["on"+a]=null;function Lc(a,s){for(let r=0;r<a.length;r++)Object.keys(a[r]).length&&s.id!==a[r].id&&(a[r].enabled=!1)}function Da(a,s){for(let r=0;r<a.length;r++)Object.keys(a[r]).length&&s.id!==a[r].id&&(a[r].selected=!1)}class Nc extends yo{addTrack(s){super.addTrack(s),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),s.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(s.kind)===-1&&s.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(s){super.removeTrack(s),s.removeEventListener&&(this.queueChange_&&s.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_)&&s.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}}class _l{constructor(s){_l.prototype.setCues_.call(this,s),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(s){var r=this.length||0;let l=0;function d(p){""+p in this||Object.defineProperty(this,""+p,{get(){return this.cues_[p]}})}var f=s.length;if(this.cues_=s,this.length_=s.length,r<f)for(l=r;l<f;l++)d.call(this,l)}getCueById(s){let r=null;for(let d=0,f=this.length;d<f;d++){var l=this[d];if(l.id===s){r=l;break}}return r}}const Qh={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Fg={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Jh={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Zh={disabled:"disabled",hidden:"hidden",showing:"showing"};class Pa extends is{constructor(s={}){super();const r={id:s.id||"vjs_track_"+sn++,kind:s.kind||"",language:s.language||""};let l=s.label||"";for(const d in r)Object.defineProperty(this,d,{get(){return r[d]},set(){}});Object.defineProperty(this,"label",{get(){return l},set(d){d!==l&&(l=d,this.trigger("labelchange"))}})}}function Vr(a){var s=["protocol","hostname","port","pathname","search","hash","host"],r=document.createElement("a"),l=(r.href=a,{});for(let d=0;d<s.length;d++)l[s[d]]=r[s[d]];return l.protocol==="http:"&&(l.host=l.host.replace(/:80$/,"")),l.protocol==="https:"&&(l.host=l.host.replace(/:443$/,"")),l.protocol||(l.protocol=window.location.protocol),l.host||(l.host=window.location.host),l}function Rc(a){var s;return a.match(/^https?:\/\//)||((s=document.createElement("a")).href=a,a=s.href),a}function yl(a,s=window.location){return((a=Vr(a)).protocol===":"?s:a).protocol+a.host!==s.protocol+s.host}const Mc=function(a){return typeof a=="string"&&(a=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(a),a)?a.pop().toLowerCase():""};var ef=Object.freeze({__proto__:null,parseUrl:Vr,getAbsoluteURL:Rc,getFileExtension:Mc,isCrossOrigin:yl}),gi=typeof window<"u"?window:typeof V<"u"?V:typeof self<"u"?self:{},Ss=gi,tf=ka(function(a){function s(){return a.exports=s=Object.assign?Object.assign.bind():function(r){for(var l=1;l<arguments.length;l++){var d,f=arguments[l];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&(r[d]=f[d])}return r},a.exports.__esModule=!0,a.exports.default=a.exports,s.apply(this,arguments)}a.exports=s,a.exports.__esModule=!0,a.exports.default=a.exports}),qr=(gi=tf)&&gi.__esModule&&Object.prototype.hasOwnProperty.call(gi,"default")?gi.default:gi,$g=function(a){var s;return!!a&&((s=jg.call(a))==="[object Function]"||typeof a=="function"&&s!=="[object RegExp]"||typeof window<"u"&&(a===window.setTimeout||a===window.alert||a===window.confirm||a===window.prompt))},jg=Object.prototype.toString;nn.httpHandler=function(a,s){return s===void 0&&(s=!1),function(r,l,d){if(r)a(r);else if(400<=l.statusCode&&l.statusCode<=599){if(r=d,s)if(Ss.TextDecoder){l=function(f){return f===void 0&&(f=""),f.toLowerCase().split(";").reduce(function(p,A){var A=A.split("="),S=A[0],A=A[1];return S.trim()==="charset"?A.trim():p},"utf-8")}(l.headers&&l.headers["content-type"]);try{r=new TextDecoder(l).decode(d)}catch{}}else r=String.fromCharCode.apply(null,new Uint8Array(d));a({cause:r})}else a(null,d)}};for(var Hg=function(s){var r={};return s&&s.trim().split(`
`).forEach(function(p){var d=p.indexOf(":"),f=p.slice(0,d).trim().toLowerCase(),p=p.slice(d+1).trim();typeof r[f]>"u"?r[f]=p:Array.isArray(r[f])?r[f].push(p):r[f]=[r[f],p]}),r},Uc=nn,gi=nn,sf=(nn.XMLHttpRequest=Ss.XMLHttpRequest||function(){},nn.XDomainRequest="withCredentials"in new nn.XMLHttpRequest?nn.XMLHttpRequest:Ss.XDomainRequest,["get","put","post","patch","head","delete"]),Vg=function(s){nn[s==="delete"?"del":s]=function(r,l,d){return(l=nf(r,l,d)).method=s.toUpperCase(),To(l)}},vo=0;vo<sf.length;vo++)Vg(sf[vo]);function nf(a,s,r){var l=a;return $g(s)?(r=s,typeof a=="string"&&(l={uri:a})):l=tf({},s,{uri:a}),l.callback=r,l}function nn(a,s,r){return To(s=nf(a,s,r))}function To(a){if(typeof a.callback>"u")throw new Error("callback argument missing");var s=!1,r=function(te,ce,de){s||(s=!0,a.callback(te,ce,de))};function l(){var te=void 0,te=A.response||A.responseText||function(ce){try{if(ce.responseType==="document")return ce.responseXML;var de=ce.responseXML&&ce.responseXML.documentElement.nodeName==="parsererror";if(ce.responseType===""&&!de)return ce.responseXML}catch{}return null}(A);if(Q)try{te=JSON.parse(te)}catch{}return te}function d(te){return clearTimeout(S),(te=te instanceof Error?te:new Error(""+(te||"Unknown XMLHttpRequest Error"))).statusCode=0,r(te,oe)}function f(){var te,ce,de;if(!y)return clearTimeout(S),te=a.useXDR&&A.status===void 0?200:A.status===1223?204:A.status,ce=oe,de=null,te!==0?(ce={body:l(),statusCode:te,method:L,headers:{},url:P,rawRequest:A},A.getAllResponseHeaders&&(ce.headers=Hg(A.getAllResponseHeaders()))):de=new Error("Internal XMLHttpRequest Error"),r(de,ce,ce.body)}var p,y,S,A=a.xhr||null,P=(A=A||new(a.cors||a.useXDR?nn.XDomainRequest:nn.XMLHttpRequest)).url=a.uri||a.url,L=A.method=a.method||"GET",B=a.body||a.data,F=A.headers=a.headers||{},K=!!a.sync,Q=!1,oe={body:void 0,headers:{},statusCode:0,method:L,url:P,rawRequest:A};if("json"in a&&a.json!==!1&&(Q=!0,F.accept||F.Accept||(F.Accept="application/json"),L!=="GET")&&L!=="HEAD"&&(F["content-type"]||F["Content-Type"]||(F["Content-Type"]="application/json"),B=JSON.stringify(a.json===!0?B:a.json)),A.onreadystatechange=function(){A.readyState===4&&setTimeout(f,0)},A.onload=f,A.onerror=d,A.onprogress=function(){},A.onabort=function(){y=!0},A.ontimeout=d,A.open(L,P,!K,a.username,a.password),K||(A.withCredentials=!!a.withCredentials),!K&&0<a.timeout&&(S=setTimeout(function(){var te;y||(y=!0,A.abort("timeout"),(te=new Error("XMLHttpRequest timeout")).code="ETIMEDOUT",d(te))},a.timeout)),A.setRequestHeader)for(p in F)F.hasOwnProperty(p)&&A.setRequestHeader(p,F[p]);else if(a.headers&&!function(te){for(var ce in te)if(te.hasOwnProperty(ce))return;return 1}(a.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in a&&(A.responseType=a.responseType),"beforeSend"in a&&typeof a.beforeSend=="function"&&a.beforeSend(A),A.send(B||null),A}Uc.default=gi;function rf(a,s){var r=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());const l=[];r.oncue=function(d){s.addCue(d)},r.onparsingerror=function(d){l.push(d)},r.onflush=function(){s.trigger({type:"loadeddata",target:s})},r.parse(a),0<l.length&&(window.console&&window.console.groupCollapsed&&window.console.groupCollapsed("Text Track parsing errors for "+s.src),l.forEach(d=>R.error(d)),window.console)&&window.console.groupEnd&&window.console.groupEnd(),r.flush()}function af(a,s){var r={uri:a};(a=yl(a))&&(r.cors=a),(a=s.tech_.crossOrigin()==="use-credentials")&&(r.withCredentials=a),Uc(r,Yt(this,function(l,d,f){if(l)return R.error(l,d);s.loaded_=!0,typeof window.WebVTT!="function"?s.tech_&&s.tech_.any(["vttjsloaded","vttjserror"],p=>{if(p.type!=="vttjserror")return rf(f,s);R.error("vttjs failed to load, stopping trying to process "+s.src)}):rf(f,s)}))}class bo extends Pa{constructor(s={}){if(!s.tech)throw new Error("A tech was not provided.");s=se(s,{kind:Jh[s.kind]||"subtitles",language:s.language||s.srclang||""});let r=Zh[s.mode]||"disabled";const l=s.default,d=(s.kind!=="metadata"&&s.kind!=="chapters"||(r="hidden"),super(s),this.tech_=s.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1,new _l(this.cues_)),f=new _l(this.activeCues_);let p=!1;this.timeupdateHandler=Yt(this,function(y={}){this.tech_.isDisposed()||(this.tech_.isReady_&&(this.activeCues=this.activeCues,p)&&(this.trigger("cuechange"),p=!1),y.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))}),this.tech_.one("dispose",()=>{this.stopTracking()}),r!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return l},set(){}},mode:{get(){return r},set(y){Zh[y]&&r!==y&&(r=y,this.preload_||r==="disabled"||this.cues.length!==0||af(this.src,this),this.stopTracking(),r!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?d:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length!==0){var y=this.tech_.currentTime(),S=[];for(let P=0,L=this.cues.length;P<L;P++){var A=this.cues[P];A.startTime<=y&&A.endTime>=y&&S.push(A)}if(p=!1,S.length!==this.activeCues_.length)p=!0;else for(let P=0;P<S.length;P++)this.activeCues_.indexOf(S[P])===-1&&(p=!0);this.activeCues_=S,f.setCues_(this.activeCues_)}return f},set(){}}}),s.src?(this.src=s.src,this.preload_||(this.loaded_=!0),(this.preload_||s.kind!=="subtitles"&&s.kind!=="captions")&&af(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(s){let r=s;if(window.vttjs&&!(s instanceof window.vttjs.VTTCue)){r=new window.vttjs.VTTCue(s.startTime,s.endTime,s.text);for(const d in s)d in r||(r[d]=s[d]);r.id=s.id,r.originalCue_=s}var l=this.tech_.textTracks();for(let d=0;d<l.length;d++)l[d]!==this&&l[d].removeCue(r);this.cues_.push(r),this.cues.setCues_(this.cues_)}removeCue(s){let r=this.cues_.length;for(;r--;){var l=this.cues_[r];if(l===s||l.originalCue_&&l.originalCue_===s){this.cues_.splice(r,1),this.cues.setCues_(this.cues_);break}}}}bo.prototype.allowedEvents_={cuechange:"cuechange"};class of extends Pa{constructor(s={}){s=se(s,{kind:Fg[s.kind]||""}),super(s);let r=!1;Object.defineProperty(this,"enabled",{get(){return r},set(l){typeof l=="boolean"&&l!==r&&(r=l,this.trigger("enabledchange"))}}),s.enabled&&(this.enabled=s.enabled),this.loaded_=!0}}class lf extends Pa{constructor(s={}){s=se(s,{kind:Qh[s.kind]||""}),super(s);let r=!1;Object.defineProperty(this,"selected",{get(){return r},set(l){typeof l=="boolean"&&l!==r&&(r=l,this.trigger("selectedchange"))}}),s.selected&&(this.selected=s.selected)}}class Fs extends is{constructor(s={}){super();let r;const l=new bo(s);this.kind=l.kind,this.src=l.src,this.srclang=l.language,this.label=l.label,this.default=l.default,Object.defineProperties(this,{readyState:{get(){return r}},track:{get(){return l}}}),r=Fs.NONE,l.addEventListener("loadeddata",()=>{r=Fs.LOADED,this.trigger({type:"load",target:this})})}}Fs.prototype.allowedEvents_={load:"load"},Fs.NONE=0,Fs.LOADING=1,Fs.LOADED=2,Fs.ERROR=3;const zi={audio:{ListClass:class extends yo{constructor(a=[]){for(let s=a.length-1;0<=s;s--)if(a[s].enabled){Lc(a,a[s]);break}super(a),this.changing_=!1}addTrack(a){a.enabled&&Lc(this,a),super.addTrack(a),a.addEventListener&&(a.enabledChange_=()=>{this.changing_||(this.changing_=!0,Lc(this,a),this.changing_=!1,this.trigger("change"))},a.addEventListener("enabledchange",a.enabledChange_))}removeTrack(a){super.removeTrack(a),a.removeEventListener&&a.enabledChange_&&(a.removeEventListener("enabledchange",a.enabledChange_),a.enabledChange_=null)}},TrackClass:of,capitalName:"Audio"},video:{ListClass:class extends yo{constructor(a=[]){for(let s=a.length-1;0<=s;s--)if(a[s].selected){Da(a,a[s]);break}super(a),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let s=0;s<this.length;s++)if(this[s].selected)return s;return-1},set(){}})}addTrack(a){a.selected&&Da(this,a),super.addTrack(a),a.addEventListener&&(a.selectedChange_=()=>{this.changing_||(this.changing_=!0,Da(this,a),this.changing_=!1,this.trigger("change"))},a.addEventListener("selectedchange",a.selectedChange_))}removeTrack(a){super.removeTrack(a),a.removeEventListener&&a.selectedChange_&&(a.removeEventListener("selectedchange",a.selectedChange_),a.selectedChange_=null)}},TrackClass:lf,capitalName:"Video"},text:{ListClass:Nc,TrackClass:bo,capitalName:"Text"}},Tn=(Object.keys(zi).forEach(function(a){zi[a].getterName=a+"Tracks",zi[a].privateName=a+"Tracks_"}),{remoteText:{ListClass:Nc,TrackClass:bo,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:class{constructor(a=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let s=0,r=a.length;s<r;s++)this.addTrackElement_(a[s])}addTrackElement_(a){const s=this.trackElements_.length;""+s in this||Object.defineProperty(this,s,{get(){return this.trackElements_[s]}}),this.trackElements_.indexOf(a)===-1&&this.trackElements_.push(a)}getTrackElementByTrack_(a){let s;for(let r=0,l=this.trackElements_.length;r<l;r++)if(a===this.trackElements_[r].track){s=this.trackElements_[r];break}return s}removeTrackElement_(a){for(let s=0,r=this.trackElements_.length;s<r;s++)if(a===this.trackElements_[s]){this.trackElements_[s].track&&typeof this.trackElements_[s].track.off=="function"&&this.trackElements_[s].track.off(),typeof this.trackElements_[s].off=="function"&&this.trackElements_[s].off(),this.trackElements_.splice(s,1);break}}},TrackClass:Fs,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}}),Ui=Object.assign({},zi,Tn);Tn.names=Object.keys(Tn),zi.names=Object.keys(zi),Ui.names=[].concat(Tn.names).concat(zi.names);var gi=typeof V<"u"?V:typeof window<"u"?window:{},$=typeof document<"u"?document:($=gi["__GLOBAL_DOCUMENT_CACHE@4"])||(gi["__GLOBAL_DOCUMENT_CACHE@4"]={}),V=$,rn=Object.create||function(a){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return Eo.prototype=a,new Eo};function Eo(){}function $s(a,s){this.name="ParsingError",this.code=a.code,this.message=s||a.message}function Bc(a){function s(r,l,d,f){return 3600*(0|r)+60*(0|l)+(0|d)+(0|f)/1e3}return a=a.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/),a?a[3]?s(a[1],a[2],a[3].replace(":",""),a[4]):59<a[1]?s(a[1],a[2],0,a[4]):s(0,a[1],a[2],a[4]):null}function So(){this.values=rn(null)}function xo(a,s,r,l){var d,f,p=l?a.split(l):[a];for(d in p)typeof p[d]=="string"&&(f=p[d].split(r)).length===2&&s(f[0].trim(),f[1].trim())}(($s.prototype=rn(Error.prototype)).constructor=$s).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},So.prototype={set:function(a,s){this.get(a)||s===""||(this.values[a]=s)},get:function(a,s,r){return r?this.has(a)?this.values[a]:s[r]:this.has(a)?this.values[a]:s},has:function(a){return a in this.values},alt:function(a,s,r){for(var l=0;l<r.length;++l)if(s===r[l]){this.set(a,s);break}},integer:function(a,s){/^-?\d+$/.test(s)&&this.set(a,parseInt(s,10))},percent:function(a,s){return!!(s.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(s=parseFloat(s))&&s<=100)&&(this.set(a,s),!0)}};var Fc=V.createElement&&V.createElement("textarea"),$c={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},vl={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},wo={v:"title",lang:"lang"},Wr={rt:"ruby"};function Co(a,s){for(var r,l,d,f,p,y,S=a.document.createElement("div"),A=S,P=[];y=void 0,(y=s?(y=(y=s.match(/^([^<]*)(<[^>]*>?)?/))[1]||y[2],s=s.substr(y.length),y):null)!==null;)y[0]==="<"?y[1]==="/"?P.length&&P[P.length-1]===y.substr(2).replace(">","")&&(P.pop(),A=A.parentNode):(l=Bc(y.substr(1,y.length-2)))?(r=a.document.createProcessingInstruction("timestamp",l),A.appendChild(r)):(l=y.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/))&&(d=l[1],f=l[3],p=void 0,p=$c[d],r=p?(p=a.document.createElement(p),(d=wo[d])&&f&&(p[d]=f.trim()),p):null)&&(d=A,Wr[(f=r).localName]&&Wr[f.localName]!==d.localName||(l[2]&&((p=l[2].split(".")).forEach(function(F){var B=/^bg_/.test(F),F=B?F.slice(3):F;vl.hasOwnProperty(F)&&(F=vl[F],r.style[B?"background-color":"color"]=F)}),r.className=p.join(" ")),P.push(l[1]),A.appendChild(r),A=r)):A.appendChild(a.document.createTextNode((f=y,Fc.innerHTML=f,f=Fc.textContent,Fc.textContent="",f)));return S}var lr=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function qg(a){var s=[],r="";if(a&&a.childNodes){for(d(s,a);r=function f(p){var y,S,A;return p&&p.length?(S=(y=p.pop()).textContent||y.innerText)?(A=S.match(/^.*(\n|\r)/))?A[p.length=0]:S:y.tagName==="ruby"?f(p):y.childNodes?(d(p,y),f(p)):void 0:null}(s);)for(var l=0;l<r.length;l++)if(function(f){for(var p=0;p<lr.length;p++){var y=lr[p];if(f>=y[0]&&f<=y[1])return 1}}(r.charCodeAt(l)))return"rtl"}return"ltr";function d(f,p){for(var y=p.childNodes.length-1;0<=y;y--)f.push(p.childNodes[y])}}function Ao(){}function Tl(a,s,r){Ao.call(this),this.cue=s,this.cueDiv=Co(a,s.text);var l={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:s.vertical===""?"horizontal-tb":s.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"},d=(this.applyStyles(l,this.cueDiv),this.div=a.document.createElement("div"),l={direction:qg(this.cueDiv),writingMode:s.vertical===""?"horizontal-tb":s.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:s.align==="middle"?"center":s.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(l),this.div.appendChild(this.cueDiv),0);switch(s.positionAlign){case"start":d=s.position;break;case"center":d=s.position-s.size/2;break;case"end":d=s.position-s.size}s.vertical===""?this.applyStyles({left:this.formatStyle(d,"%"),width:this.formatStyle(s.size,"%")}):this.applyStyles({top:this.formatStyle(d,"%"),height:this.formatStyle(s.size,"%")}),this.move=function(f){this.applyStyles({top:this.formatStyle(f.top,"px"),bottom:this.formatStyle(f.bottom,"px"),left:this.formatStyle(f.left,"px"),right:this.formatStyle(f.right,"px"),height:this.formatStyle(f.height,"px"),width:this.formatStyle(f.width,"px")})}}function ji(a){var s,r,l,d;a.div&&(s=a.div.offsetHeight,r=a.div.offsetWidth,l=a.div.offsetTop,d=(d=(d=a.div.childNodes)&&d[0])&&d.getClientRects&&d.getClientRects(),a=a.div.getBoundingClientRect(),d=d?Math.max(d[0]&&d[0].height||0,a.height/d.length):0),this.left=a.left,this.right=a.right,this.top=a.top||l,this.height=a.height||s,this.bottom=a.bottom||l+(a.height||s),this.width=a.width||r,this.lineHeight=d!==void 0?d:a.lineHeight}function Wg(a,s,r,l){var d,f=new ji(s),p=s.cue,y=function(K){if(typeof K.line=="number"&&(K.snapToLines||0<=K.line&&K.line<=100))return K.line;if(!K.track||!K.track.textTrackList||!K.track.textTrackList.mediaElement)return-1;for(var Q=K.track,oe=Q.textTrackList,te=0,ce=0;ce<oe.length&&oe[ce]!==Q;ce++)oe[ce].mode==="showing"&&te++;return-1*++te}(p),S=[];if(p.snapToLines){switch(p.vertical){case"":S=["+y","-y"],d="height";break;case"rl":S=["+x","-x"],d="width";break;case"lr":S=["-x","+x"],d="width"}var A=f.lineHeight,P=A*Math.round(y),L=r[d]+A,B=S[0];Math.abs(P)>L&&(P=P<0?-1:1,P*=Math.ceil(L/A)*A),y<0&&(P+=p.vertical===""?r.height:r.width,S=S.reverse()),f.move(B,P)}else{var F=f.lineHeight/r.height*100;switch(p.lineAlign){case"center":y-=F/2;break;case"end":y-=F}switch(p.vertical){case"":s.applyStyles({top:s.formatStyle(y,"%")});break;case"rl":s.applyStyles({left:s.formatStyle(y,"%")});break;case"lr":s.applyStyles({right:s.formatStyle(y,"%")})}S=["+y","-x","+x","-y"],f=new ji(s)}L=function(K,Q){for(var oe,te=new ji(K),ce=1,de=0;de<Q.length;de++){for(;K.overlapsOppositeAxis(r,Q[de])||K.within(r)&&K.overlapsAny(l);)K.move(Q[de]);if(K.within(r))return K;var xe=K.intersectPercentage(r);xe<ce&&(oe=new ji(K),ce=xe),K=new ji(te)}return oe||te}(f,S),s.move(L.toCSSCompatValues(r))}function ko(){}Ao.prototype.applyStyles=function(a,s){for(var r in s=s||this.div,a)a.hasOwnProperty(r)&&(s.style[r]=a[r])},Ao.prototype.formatStyle=function(a,s){return a===0?0:a+s},(Tl.prototype=rn(Ao.prototype)).constructor=Tl,ji.prototype.move=function(a,s){switch(s=s!==void 0?s:this.lineHeight,a){case"+x":this.left+=s,this.right+=s;break;case"-x":this.left-=s,this.right-=s;break;case"+y":this.top+=s,this.bottom+=s;break;case"-y":this.top-=s,this.bottom-=s}},ji.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top},ji.prototype.overlapsAny=function(a){for(var s=0;s<a.length;s++)if(this.overlaps(a[s]))return!0;return!1},ji.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right},ji.prototype.overlapsOppositeAxis=function(a,s){switch(s){case"+x":return this.left<a.left;case"-x":return this.right>a.right;case"+y":return this.top<a.top;case"-y":return this.bottom>a.bottom}},ji.prototype.intersectPercentage=function(a){return Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left))*Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top))/(this.height*this.width)},ji.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}},ji.getSimpleBoxPosition=function(a){var s=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,r=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,l=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;return{left:(a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a).left,right:a.right,top:a.top||l,height:a.height||s,bottom:a.bottom||l+(a.height||s),width:a.width||r}},ko.StringDecoder=function(){return{decode:function(a){if(!a)return"";if(typeof a!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}},ko.convertCueToDOMTree=function(a,s){return a&&s?Co(a,s):null},ko.processCues=function(a,s,r){if(!a||!s||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var l=a.document.createElement("div");if(l.style.position="absolute",l.style.left="0",l.style.right="0",l.style.top="0",l.style.bottom="0",l.style.margin="1.5%",r.appendChild(l),function(L){for(var B=0;B<L.length;B++)if(L[B].hasBeenReset||!L[B].displayState)return 1}(s))for(var d,f,p=[],y=ji.getSimpleBoxPosition(l),S={font:Math.round(.05*y.height*100)/100+"px sans-serif"},A=0;A<s.length;A++)f=s[A],d=new Tl(a,f,S),l.appendChild(d.div),Wg(0,d,y,p),f.displayState=d.div,p.push(ji.getSimpleBoxPosition(d));else for(var P=0;P<s.length;P++)l.appendChild(s[P].displayState)},(ko.Parser=function(a,s,r){r||(r=s,s={}),s=s||{},this.window=a,this.vttjs=s,this.state="INITIAL",this.buffer="",this.decoder=r||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(a){if(!(a instanceof $s))throw a;this.onparsingerror&&this.onparsingerror(a)},parse:function(a){var s=this;function r(){for(var S=s.buffer,A=0;A<S.length&&S[A]!=="\r"&&S[A]!==`
`;)++A;var P=S.substr(0,A);return S[A]==="\r"&&++A,S[A]===`
`&&++A,s.buffer=S.substr(A),P}function l(S){S.match(/X-TIMESTAMP-MAP/)?xo(S,function(A,P){var L;A==="X-TIMESTAMP-MAP"&&(A=P,L=new So,xo(A,function(B,F){switch(B){case"MPEGT":L.integer(B+"S",F);break;case"LOCA":L.set(B+"L",Bc(F))}},/[^\d]:/,/,/),s.ontimestampmap)&&s.ontimestampmap({MPEGTS:L.get("MPEGTS"),LOCAL:L.get("LOCAL")})},/=/):xo(S,function(A,P){var L;A==="Region"&&(A=P,L=new So,xo(A,function(B,F){switch(B){case"id":L.set(B,F);break;case"width":L.percent(B,F);break;case"lines":L.integer(B,F);break;case"regionanchor":case"viewportanchor":var K,Q=F.split(",");Q.length===2&&((K=new So).percent("x",Q[0]),K.percent("y",Q[1]),K.has("x")&&K.has("y"))&&(L.set(B+"X",K.get("x")),L.set(B+"Y",K.get("y")));break;case"scroll":L.alt(B,F,["up"])}},/=/,/\s/),L.has("id"))&&((A=new(s.vttjs.VTTRegion||s.window.VTTRegion)).width=L.get("width",100),A.lines=L.get("lines",3),A.regionAnchorX=L.get("regionanchorX",0),A.regionAnchorY=L.get("regionanchorY",100),A.viewportAnchorX=L.get("viewportanchorX",0),A.viewportAnchorY=L.get("viewportanchorY",100),A.scroll=L.get("scroll",""),s.onregion&&s.onregion(A),s.regionList.push({id:L.get("id"),region:A}))},/:/)}a&&(s.buffer+=s.decoder.decode(a,{stream:!0}));try{if(s.state==="INITIAL"){if(!/\r\n|\n/.test(s.buffer))return this;var d,f=(d=r()).match(/^WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new $s($s.Errors.BadSignature);s.state="HEADER"}for(var p=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(p?p=!1:d=r(),s.state){case"HEADER":/:/.test(d)?l(d):d||(s.state="ID");continue;case"NOTE":d||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){s.state="NOTE";break}if(!d)continue;s.cue=new(s.vttjs.VTTCue||s.window.VTTCue)(0,0,"");try{s.cue.align="center"}catch{s.cue.align="middle"}if(s.state="CUE",d.indexOf("-->")===-1){s.cue.id=d;continue}case"CUE":try{(function(S,A,P){var L=S;function B(){var oe=Bc(S);if(oe===null)throw new $s($s.Errors.BadTimeStamp,"Malformed timestamp: "+L);return S=S.replace(/^[^\sa-zA-Z-]+/,""),oe}function F(){S=S.replace(/^\s+/,"")}if(F(),A.startTime=B(),F(),S.substr(0,3)!=="-->")throw new $s($s.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+L);S=S.substr(3),F(),A.endTime=B(),F();var K=S,Q=new So;xo(K,function(oe,te){switch(oe){case"region":for(var ce=P.length-1;0<=ce;ce--)if(P[ce].id===te){Q.set(oe,P[ce].region);break}break;case"vertical":Q.alt(oe,te,["rl","lr"]);break;case"line":var de=te.split(","),xe=de[0];Q.integer(oe,xe),Q.percent(oe,xe)&&Q.set("snapToLines",!1),Q.alt(oe,xe,["auto"]),de.length===2&&Q.alt("lineAlign",de[1],["start","center","end"]);break;case"position":de=te.split(","),Q.percent(oe,de[0]),de.length===2&&Q.alt("positionAlign",de[1],["start","center","end"]);break;case"size":Q.percent(oe,te);break;case"align":Q.alt(oe,te,["start","center","end","left","right"])}},/:/,/\s/),A.region=Q.get("region",null),A.vertical=Q.get("vertical","");try{A.line=Q.get("line","auto")}catch{}A.lineAlign=Q.get("lineAlign","start"),A.snapToLines=Q.get("snapToLines",!0),A.size=Q.get("size",100);try{A.align=Q.get("align","center")}catch{A.align=Q.get("align","middle")}try{A.position=Q.get("position","auto")}catch{A.position=Q.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},A.align)}A.positionAlign=Q.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},A.align)})(d,s.cue,s.regionList)}catch(S){s.reportOrThrowError(S),s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var y=d.indexOf("-->")!==-1;if(!d||y&&(p=!0)){s.oncue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}s.cue.text&&(s.cue.text+=`
`),s.cue.text+=d.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":d||(s.state="ID");continue}}}catch(S){s.reportOrThrowError(S),s.state==="CUETEXT"&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state=s.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),!a.cue&&a.state!=="HEADER"||(a.buffer+=`

`,a.parse()),a.state==="INITIAL")throw new $s($s.Errors.BadSignature)}catch(s){a.reportOrThrowError(s)}return a.onflush&&a.onflush(),this}};var Gg=ko,bl={"":1,lr:1,rl:1},zg={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function El(a){return typeof a=="string"&&!!zg[a.toLowerCase()]&&a.toLowerCase()}function uf(a,s,r){this.hasBeenReset=!1;var l="",d=!1,f=a,p=s,y=r,S=null,A="",P=!0,L="auto",B="start",F="auto",K="auto",Q=100,oe="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return l},set:function(te){l=""+te}},pauseOnExit:{enumerable:!0,get:function(){return d},set:function(te){d=!!te}},startTime:{enumerable:!0,get:function(){return f},set:function(te){if(typeof te!="number")throw new TypeError("Start time must be set to a number.");f=te,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return p},set:function(te){if(typeof te!="number")throw new TypeError("End time must be set to a number.");p=te,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return y},set:function(te){y=""+te,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return S},set:function(te){S=te,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return A},set:function(te){if(te=typeof(te=te)=="string"&&!!bl[te.toLowerCase()]&&te.toLowerCase(),te===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");A=te,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return P},set:function(te){P=!!te,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return L},set:function(te){if(typeof te!="number"&&te!=="auto")throw new SyntaxError("Line: an invalid number or illegal string was specified.");L=te,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return B},set:function(te){te=El(te),te&&(B=te,this.hasBeenReset=!0)}},position:{enumerable:!0,get:function(){return F},set:function(te){if(te<0||100<te)throw new Error("Position must be between 0 and 100.");F=te,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return K},set:function(te){te=El(te),te&&(K=te,this.hasBeenReset=!0)}},size:{enumerable:!0,get:function(){return Q},set:function(te){if(te<0||100<te)throw new Error("Size must be between 0 and 100.");Q=te,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return oe},set:function(te){if(te=El(te),!te)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");oe=te,this.hasBeenReset=!0}}}),this.displayState=void 0}uf.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Kg=uf,cf={"":!0,up:!0};function La(a){return typeof a=="number"&&0<=a&&a<=100}function Xg(){var a=100,s=3,r=0,l=100,d=0,f=100,p="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(y){if(!La(y))throw new Error("Width must be between 0 and 100.");a=y}},lines:{enumerable:!0,get:function(){return s},set:function(y){if(typeof y!="number")throw new TypeError("Lines must be set to a number.");s=y}},regionAnchorY:{enumerable:!0,get:function(){return l},set:function(y){if(!La(y))throw new Error("RegionAnchorX must be between 0 and 100.");l=y}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(y){if(!La(y))throw new Error("RegionAnchorY must be between 0 and 100.");r=y}},viewportAnchorY:{enumerable:!0,get:function(){return f},set:function(y){if(!La(y))throw new Error("ViewportAnchorY must be between 0 and 100.");f=y}},viewportAnchorX:{enumerable:!0,get:function(){return d},set:function(y){if(!La(y))throw new Error("ViewportAnchorX must be between 0 and 100.");d=y}},scroll:{enumerable:!0,get:function(){return p},set:function(y){y=typeof(y=y)=="string"&&!!cf[y.toLowerCase()]&&y.toLowerCase(),y!==!1&&(p=y)}}})}var Io=ka(function(s){var s=s.exports={WebVTT:Gg,VTTCue:Kg,VTTRegion:Xg},r=(Ss.vttjs=s,Ss.WebVTT=s.WebVTT,s.VTTCue),l=s.VTTRegion,d=Ss.VTTCue,f=Ss.VTTRegion;s.shim=function(){Ss.VTTCue=r,Ss.VTTRegion=l},s.restore=function(){Ss.VTTCue=d,Ss.VTTRegion=f},Ss.VTTCue||s.shim()});Io.WebVTT,Io.VTTCue,Io.VTTRegion;class Et extends ve{constructor(s={},r=function(){}){s.reportTouchActivity=!1,super(null,s,r),this.onDurationChange_=l=>this.onDurationChange(l),this.trackProgress_=l=>this.trackProgress(l),this.trackCurrentTime_=l=>this.trackCurrentTime(l),this.stopTrackingCurrentTime_=l=>this.stopTrackingCurrentTime(l),this.disposeSourceHandler_=l=>this.disposeSourceHandler(l),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Ui.names.forEach(l=>{l=Ui[l],s&&s[l.getterName]&&(this[l.privateName]=s[l.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(l=>{s[`native${l}Tracks`]===!1&&(this[`featuresNative${l}Tracks`]=!1)}),s.nativeCaptions===!1||s.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:s.nativeCaptions!==!0&&s.nativeTextTracks!==!0||(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=s.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Ui.text.ListClass,this.initTrackListeners(),s.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(s){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(s),1)),this.trigger({src:s,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(s){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Yt(this,function(){var r=this.bufferedPercent();this.bufferedPercent_!==r&&this.trigger("progress"),(this.bufferedPercent_=r)===1&&this.stopTrackingProgress()}),500)}onDurationChange(s){this.duration_=this.duration()}buffered(){return ds(0,0)}bufferedPercent(){return Bs(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(zi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(s){(s=[].concat(s)).forEach(r=>{var l=this[r+"Tracks"]()||[];let d=l.length;for(;d--;){var f=l[d];r==="text"&&this.removeRemoteTextTrack(f),l.removeTrack(f)}})}cleanupAutoTextTracks(){var s=this.autoRemoteTextTracks_||[];let r=s.length;for(;r--;){var l=s[r];this.removeRemoteTextTrack(l)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(s){return s!==void 0&&(this.error_=new ss(s),this.trigger("error")),this.error_}played(){return this.hasStarted_?ds(0,0):ds()}play(){}setScrubbing(){}scrubbing(){}setCurrentTime(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){zi.names.forEach(s=>{var r=zi[s];const l=()=>{this.trigger(s+"trackchange")},d=this[r.getterName]();d.addEventListener("removetrack",l),d.addEventListener("addtrack",l),this.on("dispose",()=>{d.removeEventListener("removetrack",l),d.removeEventListener("addtrack",l)})})}addWebVttScript_(){if(!window.WebVTT)if(document.body.contains(this.el()))if(!this.options_["vtt.js"]&&ee(Io)&&0<Object.keys(Io).length)this.trigger("vttjsloaded");else{const s=document.createElement("script");s.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",s.onload=()=>{this.trigger("vttjsloaded")},s.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{s.onload=null,s.onerror=null}),window.WebVTT=!0,this.el().parentNode.appendChild(s)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const s=this.textTracks(),r=this.remoteTextTracks(),l=y=>s.addTrack(y.track),d=y=>s.removeTrack(y.track),f=(r.on("addtrack",l),r.on("removetrack",d),this.addWebVttScript_(),()=>this.trigger("texttrackchange")),p=()=>{f();for(let S=0;S<s.length;S++){var y=s[S];y.removeEventListener("cuechange",f),y.mode==="showing"&&y.addEventListener("cuechange",f)}};p(),s.addEventListener("change",p),s.addEventListener("addtrack",p),s.addEventListener("removetrack",p),this.on("dispose",function(){r.off("addtrack",l),r.off("removetrack",d),s.removeEventListener("change",p),s.removeEventListener("addtrack",p),s.removeEventListener("removetrack",p);for(let y=0;y<s.length;y++)s[y].removeEventListener("cuechange",f)})}addTextTrack(s,r,l){if(s)return s=s,r=r,l=l,f={},p=(d=this).textTracks(),f.kind=s,r&&(f.label=r),l&&(f.language=l),f.tech=d,s=new Ui.text.TrackClass(f),p.addTrack(s),s;throw new Error("TextTrack kind is required but was not provided");var d,f,p}createRemoteTextTrack(s){return s=se(s,{tech:this}),new Tn.remoteTextEl.TrackClass(s)}addRemoteTextTrack(s={},r){const l=this.createRemoteTextTrack(s);return typeof r!="boolean"&&(r=!1),this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack(l.track),r===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(l.track)),l}removeRemoteTextTrack(s){var r=this.remoteTextTrackEls().getTrackElementByTrack_(s);this.remoteTextTrackEls().removeTrackElement_(r),this.remoteTextTracks().removeTrack(s),this.autoRemoteTextTracks_.removeTrack(s)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(s){const r=sn++;return!this.isReady_||this.paused()?(this.queuedHanders_.add(r),this.one("playing",()=>{this.queuedHanders_.has(r)&&(this.queuedHanders_.delete(r),s())})):this.requestNamedAnimationFrame(r,s),r}cancelVideoFrameCallback(s){this.queuedHanders_.has(s)?this.queuedHanders_.delete(s):this.cancelNamedAnimationFrame(s)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(){}overrideNativeVideoTracks(){}canPlayType(){return""}static canPlayType(){return""}static canPlaySource(s,r){return Et.canPlayType(s.type)}static isTech(s){return s.prototype instanceof Et||s instanceof Et||s===Et}static registerTech(s,r){if(Et.techs_||(Et.techs_={}),!Et.isTech(r))throw new Error(`Tech ${s} must be a Tech`);if(!Et.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(Et.canPlaySource)return s=vi(s),Et.techs_[s]=r,Et.techs_[Aa(s)]=r,s!=="Tech"&&Et.defaultTechOrder_.push(s),r;throw new Error("Techs must have a static canPlaySource method on them")}static getTech(s){if(s)return Et.techs_&&Et.techs_[s]?Et.techs_[s]:(s=vi(s),window&&window.videojs&&window.videojs[s]?(R.warn(`The ${s} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),window.videojs[s]):void 0)}}Ui.names.forEach(function(a){const s=Ui[a];Et.prototype[s.getterName]=function(){return this[s.privateName]=this[s.privateName]||new s.ListClass,this[s.privateName]}}),Et.prototype.featuresVolumeControl=!0,Et.prototype.featuresMuteControl=!0,Et.prototype.featuresFullscreenResize=!1,Et.prototype.featuresPlaybackRate=!1,Et.prototype.featuresProgressEvents=!1,Et.prototype.featuresSourceset=!1,Et.prototype.featuresTimeupdateEvents=!1,Et.prototype.featuresNativeTextTracks=!1,Et.prototype.featuresVideoFrameCallback=!1,Et.withSourceHandlers=function(a){a.registerSourceHandler=function(s,r){let l=a.sourceHandlers;l=l||(a.sourceHandlers=[]),r===void 0&&(r=l.length),l.splice(r,0,s)},a.canPlayType=function(s){var r,l=a.sourceHandlers||[];for(let d=0;d<l.length;d++)if(r=l[d].canPlayType(s))return r;return""},a.selectSourceHandler=function(s,r){var l=a.sourceHandlers||[];for(let d=0;d<l.length;d++)if(l[d].canHandleSource(s,r))return l[d];return null},a.canPlaySource=function(s,r){var l=a.selectSourceHandler(s,r);return l?l.canHandleSource(s,r):""},["seekable","seeking","duration"].forEach(function(s){const r=this[s];typeof r=="function"&&(this[s]=function(){return this.sourceHandler_&&this.sourceHandler_[s]?this.sourceHandler_[s].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},a.prototype),a.prototype.setSource=function(s){let r=a.selectSourceHandler(s,this.options_);r||(a.nativeSourceHandler?r=a.nativeSourceHandler:R.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==a.nativeSourceHandler&&(this.currentSource_=s),this.sourceHandler_=r.handleSource(s,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},a.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},ve.registerComponent("Tech",Et),Et.registerTech("Tech",Et),Et.defaultTechOrder_=[];const ur={},jc={},Sl={};function df(a,s,r){a.setTimeout(()=>function l(d={},f=[],p,y,S=[],A=!1){const[P,...L]=f;if(typeof P=="string")l(d,ur[P],p,y,S,A);else if(P){const B=pf(y,P);if(!B.setSource)return S.push(B),l(d,L,p,y,S,A);B.setSource(Object.assign({},d),function(F,K){if(F)return l(d,L,p,y,S,A);S.push(B),l(K,d.type===K.type?L:ur[K.type],p,y,S,A)})}else L.length?l(d,L,p,y,S,A):A?p(d,S):l(d,ur["*"],p,y,S,!0)}(s,ur[s.type],r,a),1)}function hf(a,p,r,f=null){var d="call"+vi(r),d=a.reduce(Gr(d),f),f=d===Sl,p=f?null:p[r](d),y=a,S=r,A=p,P=f;for(let B=y.length-1;0<=B;B--){var L=y[B];L[S]&&L[S](P,A)}return p}const ff={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Yg={setCurrentTime:1,setMuted:1,setVolume:1},Hc={play:1,pause:1};function Gr(a){return(s,r)=>s===Sl?Sl:r[a]?r[a](s):s}function pf(a,s){var r=jc[a.id()];let l=null;if(r==null)l=s(a),jc[a.id()]=[[s,l]];else{for(let p=0;p<r.length;p++){var[d,f]=r[p];d===s&&(l=f)}l===null&&(l=s(a),r.push([s,l]))}return l}function mf(a){if(Array.isArray(a)){let s=[];a.forEach(function(r){r=mf(r),Array.isArray(r)?s=s.concat(r):W(r)&&s.push(r)}),a=s}else a=typeof a=="string"&&a.trim()?[gf({src:a})]:W(a)&&typeof a.src=="string"&&a.src&&a.src.trim()?[gf(a)]:[];return a}const Qg={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},cr=function(a=""){return a=Mc(a),Qg[a.toLowerCase()]||""};function gf(a){var s;return a.type||(s=cr(a.src))&&(a.type=s),a}class Jg extends ve{constructor(s,r,l){if(super(s,se({createEl:!1},r),l),r.playerOptions.sources&&r.playerOptions.sources.length!==0)s.src(r.playerOptions.sources);else for(let f=0,p=r.playerOptions.techOrder;f<p.length;f++){var d=vi(p[f]);let y=Et.getTech(d);if((y=d?y:ve.getComponent(d))&&y.isSupported()){s.loadTech_(d);break}}}}ve.registerComponent("MediaLoader",Jg);class xl extends ve{constructor(s,r){super(s,r),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=l=>this.handleMouseOver(l),this.handleMouseOut_=l=>this.handleMouseOut(l),this.handleClick_=l=>this.handleClick(l),this.handleKeyDown_=l=>this.handleKeyDown(l),this.emitTapEvents(),this.enable()}createEl(s="div",r={},l={}){return r=Object.assign({className:this.buildCSSClass(),tabIndex:0},r),s==="button"&&R.error(`Creating a ClickableComponent with an HTML element of ${s} is not supported; use a Button instead.`),l=Object.assign({role:"button"},l),this.tabIndex_=r.tabIndex,s=je(s,r,l),s.appendChild(je("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(s),s}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(s){return this.controlTextEl_=je("span",{className:"vjs-control-text"},{"aria-live":"polite"}),s&&s.appendChild(this.controlTextEl_),this.controlText(this.controlText_,s),this.controlTextEl_}controlText(s,r=this.el()){if(s===void 0)return this.controlText_||"Need Text";var l=this.localize(s);this.controlText_=s,X(this.controlTextEl_,l),this.nonIconControl||this.player_.options_.noUITitleAttributes||r.setAttribute("title",l)}buildCSSClass(){return"vjs-control vjs-button "+super.buildCSSClass()}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(s){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(s){ut.isEventKey(s,"Space")||ut.isEventKey(s,"Enter")?(s.preventDefault(),s.stopPropagation(),this.trigger("click")):super.handleKeyDown(s)}}ve.registerComponent("ClickableComponent",xl);class wl extends xl{constructor(s,r){super(s,r),this.update(),this.update_=l=>this.update(l),s.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return je("picture",{className:"vjs-poster",tabIndex:-1},{},je("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))}crossOrigin(s){if(typeof s>"u")return this.el_?this.el_.querySelector("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;s!==null&&s!=="anonymous"&&s!=="use-credentials"?this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${s}"`):this.el_.querySelector("img").crossOrigin=s}update(s){var r=this.player().poster();this.setSrc(r),r?this.show():this.hide()}setSrc(s){this.el_.querySelector("img").src=s}handleClick(s){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Es(this.player_.play()):this.player_.pause())}}wl.prototype.crossorigin=wl.prototype.crossOrigin,ve.registerComponent("PosterImage",wl);const Zg={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Vc(a,s){let r;if(a.length===4)r=a[1]+a[1]+a[2]+a[2]+a[3]+a[3];else{if(a.length!==7)throw new Error("Invalid color code provided, "+a+"; must be formatted as e.g. #f0e or #f604e2.");r=a.slice(1)}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+s+")"}function qc(a,s,r){try{a.style[s]=r}catch{}}class e_ extends ve{constructor(s,r,l){super(s,r,l);const d=f=>this.updateDisplay(f);s.on("loadstart",f=>this.toggleDisplay(f)),s.on("texttrackchange",d),s.on("loadedmetadata",f=>this.preselectTrack(f)),s.ready(Yt(this,function(){if(s.tech_&&s.tech_.featuresNativeTextTracks)this.hide();else{s.on("fullscreenchange",d),s.on("playerresize",d);const p=window.screen.orientation||window,y=window.screen.orientation?"change":"orientationchange";p.addEventListener(y,d),s.on("dispose",()=>p.removeEventListener(y,d));var f=this.options_.playerOptions.tracks||[];for(let S=0;S<f.length;S++)this.player_.addRemoteTextTrack(f[S],!0);this.preselectTrack()}}))}preselectTrack(){var s={captions:1,subtitles:1},r=this.player_.textTracks(),l=this.player_.cache_.selectedLanguage;let d,f,p;for(let S=0;S<r.length;S++){var y=r[S];l&&l.enabled&&l.language&&l.language===y.language&&y.kind in s?p=y.kind!==l.kind&&p||y:l&&!l.enabled?(p=null,d=null,f=null):y.default&&(y.kind!=="descriptions"||d?y.kind in s&&!f&&(f=y):d=y)}p?p.mode="showing":f?f.mode="showing":d&&(d.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof window.WebVTT=="function"&&window.WebVTT.processCues(window,[],this.el_)}updateDisplay(){var s=this.player_.textTracks(),r=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),r){var l=[];for(let p=0;p<s.length;++p){var d=s[p];d.mode==="showing"&&l.push(d)}this.updateForTrack(l)}else{let p=null,y=null,S=s.length;for(;S--;){var f=s[S];f.mode==="showing"&&(f.kind==="descriptions"?p=f:y=f)}y?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(y)):p&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(p))}}updateDisplayState(s){var r=this.player_.textTrackSettings.getValues(),l=s.activeCues;let d=l.length;for(;d--;){var f,p=l[d];p&&(p=p.displayState,r.color&&(p.firstChild.style.color=r.color),r.textOpacity&&qc(p.firstChild,"color",Vc(r.color||"#fff",r.textOpacity)),r.backgroundColor&&(p.firstChild.style.backgroundColor=r.backgroundColor),r.backgroundOpacity&&qc(p.firstChild,"backgroundColor",Vc(r.backgroundColor||"#000",r.backgroundOpacity)),r.windowColor&&(r.windowOpacity?qc(p,"backgroundColor",Vc(r.windowColor,r.windowOpacity)):p.style.backgroundColor=r.windowColor),r.edgeStyle&&(r.edgeStyle==="dropshadow"?p.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":r.edgeStyle==="raised"?p.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":r.edgeStyle==="depressed"?p.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":r.edgeStyle==="uniform"&&(p.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),r.fontPercent&&r.fontPercent!==1&&(f=window.parseFloat(p.style.fontSize),p.style.fontSize=f*r.fontPercent+"px",p.style.height="auto",p.style.top="auto"),r.fontFamily)&&r.fontFamily!=="default"&&(r.fontFamily==="small-caps"?p.firstChild.style.fontVariant="small-caps":p.firstChild.style.fontFamily=Zg[r.fontFamily])}}updateForTrack(s){if(Array.isArray(s)||(s=[s]),typeof window.WebVTT=="function"&&!s.every(p=>!p.activeCues)){var r=[];for(let p=0;p<s.length;++p){var l=s[p];for(let y=0;y<l.activeCues.length;++y)r.push(l.activeCues[y])}window.WebVTT.processCues(window,r,this.el_);for(let p=0;p<s.length;++p){var d=s[p];for(let y=0;y<d.activeCues.length;++y){var f=d.activeCues[y].displayState;_e(f,"vjs-text-track-cue","vjs-text-track-cue-"+(d.language||p)),d.language&&ke(f,"lang",d.language)}this.player_.textTrackSettings&&this.updateDisplayState(d)}}}}ve.registerComponent("TextTrackDisplay",e_);class t_ extends ve{createEl(){var s=this.player_.isAudio(),s=this.localize(s?"Audio Player":"Video Player"),s=je("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[s])}),r=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(s),r}}ve.registerComponent("LoadingSpinner",t_);class an extends xl{createEl(s,r={},l={}){return r=je("button",r=Object.assign({className:this.buildCSSClass()},r),l=Object.assign({type:"button"},l)),r.appendChild(je("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(r),r}addChild(s,r={}){var l=this.constructor.name;return R.warn(`Adding an actionable (user controllable) child to a Button (${l}) is not supported; use a ClickableComponent instead.`),ve.prototype.addChild.call(this,s,r)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(s){ut.isEventKey(s,"Space")||ut.isEventKey(s,"Enter")?s.stopPropagation():super.handleKeyDown(s)}}ve.registerComponent("Button",an);class _f extends an{constructor(s,r){super(s,r),this.mouseused_=!1,this.on("mousedown",l=>this.handleMouseDown(l))}buildCSSClass(){return"vjs-big-play-button"}handleClick(s){var r=this.player_.play();if(this.mouseused_&&s.clientX&&s.clientY)Es(r),this.player_.tech(!0)&&this.player_.tech(!0).focus();else{var s=this.player_.getChild("controlBar");const d=s&&s.getChild("playToggle");d?(s=()=>d.focus(),Fn(r)?r.then(s,()=>{}):this.setTimeout(s,1)):this.player_.tech(!0).focus()}}handleKeyDown(s){this.mouseused_=!1,super.handleKeyDown(s)}handleMouseDown(s){this.mouseused_=!0}}_f.prototype.controlText_="Play Video",ve.registerComponent("BigPlayButton",_f),ve.registerComponent("CloseButton",class extends an{constructor(a,s){super(a,s),this.controlText(s&&s.controlText||this.localize("Close"))}buildCSSClass(){return"vjs-close-button "+super.buildCSSClass()}handleClick(a){this.trigger({type:"close",bubbles:!1})}handleKeyDown(a){ut.isEventKey(a,"Esc")?(a.preventDefault(),a.stopPropagation(),this.trigger("click")):super.handleKeyDown(a)}});class Oo extends an{constructor(s,r={}){super(s,r),r.replay=r.replay===void 0||r.replay,this.on(s,"play",l=>this.handlePlay(l)),this.on(s,"pause",l=>this.handlePause(l)),r.replay&&this.on(s,"ended",l=>this.handleEnded(l))}buildCSSClass(){return"vjs-play-control "+super.buildCSSClass()}handleClick(s){this.player_.paused()?Es(this.player_.play()):this.player_.pause()}handleSeeked(s){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(s):this.handlePlay(s)}handlePlay(s){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")}handlePause(s){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")}handleEnded(s){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",r=>this.handleSeeked(r))}}Oo.prototype.controlText_="Play",ve.registerComponent("PlayToggle",Oo);class bn extends ve{constructor(s,r){super(s,r),this.on(s,["timeupdate","ended"],l=>this.updateContent(l)),this.updateTextNode_()}createEl(){var s=this.buildCSSClass(),r=super.createEl("div",{className:s+" vjs-time-control vjs-control"}),l=je("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+""},{role:"presentation"});return r.appendChild(l),this.contentEl_=je("span",{className:s+"-display"},{"aria-live":"off",role:"presentation"}),r.appendChild(this.contentEl_),r}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(s=0){s=Bn(s),this.formattedTime_!==s&&(this.formattedTime_=s,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(this.contentEl_){let r=this.textNode_;r&&this.contentEl_.firstChild!==r&&(r=null,R.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=document.createTextNode(this.formattedTime_),this.textNode_&&(r?this.contentEl_.replaceChild(this.textNode_,r):this.contentEl_.appendChild(this.textNode_))}}))}updateContent(s){}}bn.prototype.labelText_="Time",bn.prototype.controlText_="Time",ve.registerComponent("TimeDisplay",bn);class Ti extends bn{buildCSSClass(){return"vjs-current-time"}updateContent(s){let r;r=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(r)}}Ti.prototype.labelText_="Current Time",Ti.prototype.controlText_="Current Time",ve.registerComponent("CurrentTimeDisplay",Ti);class dr extends bn{constructor(s,r){super(s,r),r=l=>this.updateContent(l),this.on(s,"durationchange",r),this.on(s,"loadstart",r),this.on(s,"loadedmetadata",r)}buildCSSClass(){return"vjs-duration"}updateContent(s){var r=this.player_.duration();this.updateTextNode_(r)}}dr.prototype.labelText_="Duration",dr.prototype.controlText_="Duration",ve.registerComponent("DurationDisplay",dr);class i_ extends ve{createEl(){var s=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),r=super.createEl("div"),l=super.createEl("span",{textContent:"/"});return r.appendChild(l),s.appendChild(r),s}}ve.registerComponent("TimeDivider",i_);class Wc extends bn{constructor(s,r){super(s,r),this.on(s,"durationchange",l=>this.updateContent(l))}buildCSSClass(){return"vjs-remaining-time"}createEl(){var s=super.createEl();return this.options_.displayNegative!==!1&&s.insertBefore(je("span",{},{"aria-hidden":!0},"-"),this.contentEl_),s}updateContent(s){if(typeof this.player_.duration()=="number"){let r;r=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(r)}}}Wc.prototype.labelText_="Remaining Time",Wc.prototype.controlText_="Remaining Time",ve.registerComponent("RemainingTimeDisplay",Wc);class s_ extends ve{constructor(s,r){super(s,r),this.updateShowing(),this.on(this.player(),"durationchange",l=>this.updateShowing(l))}createEl(){var s=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=je("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(je("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+""})),this.contentEl_.appendChild(document.createTextNode(this.localize("LIVE"))),s.appendChild(this.contentEl_),s}dispose(){this.contentEl_=null,super.dispose()}updateShowing(s){this.player().duration()===1/0?this.show():this.hide()}}ve.registerComponent("LiveDisplay",s_);class yf extends an{constructor(s,r){super(s,r),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=l=>this.updateLiveEdgeStatus(l),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){var s=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=je("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),s.appendChild(this.textEl_),s}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}function Na(a,s,r){return a=Number(a),Math.min(r,Math.max(s,isNaN(a)?s:a))}yf.prototype.controlText_="Seek to live, currently playing live",ve.registerComponent("SeekToLive",yf),gi=Object.freeze({__proto__:null,clamp:Na});class Cl extends ve{constructor(s,r){super(s,r),this.handleMouseDown_=l=>this.handleMouseDown(l),this.handleMouseUp_=l=>this.handleMouseUp(l),this.handleKeyDown_=l=>this.handleKeyDown(l),this.handleClick_=l=>this.handleClick(l),this.handleMouseMove_=l=>this.handleMouseMove(l),this.update_=l=>this.update(l),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){var s;this.enabled()&&(s=this.bar.el_.ownerDocument,this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1)}createEl(s,r={},l={}){return r.className=r.className+" vjs-slider",r=Object.assign({tabIndex:0},r),l=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},l),super.createEl(s,r,l)}handleMouseDown(s){var r=this.bar.el_.ownerDocument;s.type==="mousedown"&&s.preventDefault(),s.type!=="touchstart"||Le||s.preventDefault(),Je(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(r,"mousemove",this.handleMouseMove_),this.on(r,"mouseup",this.handleMouseUp_),this.on(r,"touchmove",this.handleMouseMove_),this.on(r,"touchend",this.handleMouseUp_),this.handleMouseMove(s,!0)}handleMouseMove(s){}handleMouseUp(){var s=this.bar.el_.ownerDocument;tt(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.update()}update(){if(this.el_&&this.bar){const s=this.getProgress();return s!==this.progress_&&(this.progress_=s,this.requestNamedAnimationFrame("Slider#update",()=>{var r=this.vertical()?"height":"width";this.bar.el().style[r]=(100*s).toFixed(2)+"%"})),s}}getProgress(){return Number(Na(this.getPercent(),0,1).toFixed(4))}calculateDistance(s){return s=Dt(this.el_,s),this.vertical()?s.y:s.x}handleKeyDown(s){ut.isEventKey(s,"Left")||ut.isEventKey(s,"Down")?(s.preventDefault(),s.stopPropagation(),this.stepBack()):ut.isEventKey(s,"Right")||ut.isEventKey(s,"Up")?(s.preventDefault(),s.stopPropagation(),this.stepForward()):super.handleKeyDown(s)}handleClick(s){s.stopPropagation(),s.preventDefault()}vertical(s){if(s===void 0)return this.vertical_||!1;this.vertical_=!!s,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}ve.registerComponent("Slider",Cl);const Al=(a,s)=>Na(a/s*100,0,100).toFixed(2)+"%";class vf extends ve{constructor(s,r){super(s,r),this.partEls_=[],this.on(s,"progress",l=>this.update(l))}createEl(){var s=super.createEl("div",{className:"vjs-load-progress"}),r=je("span",{className:"vjs-control-text"}),l=je("span",{textContent:this.localize("Loaded")}),d=document.createTextNode(": ");return this.percentageEl_=je("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),s.appendChild(r),r.appendChild(l),r.appendChild(d),r.appendChild(this.percentageEl_),s}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(s){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{var f=this.player_.liveTracker,r=this.player_.buffered(),f=f&&f.isLive()?f.seekableEnd():this.player_.duration(),l=this.player_.bufferedEnd(),d=this.partEls_,f=Al(l,f);this.percent_!==f&&(this.el_.style.width=f,X(this.percentageEl_,f),this.percent_=f);for(let S=0;S<r.length;S++){var p=r.start(S),y=r.end(S);let A=d[S];A||(A=this.el_.appendChild(je()),d[S]=A),A.dataset.start===p&&A.dataset.end===y||(A.dataset.start=p,A.dataset.end=y,A.style.left=Al(p,l),A.style.width=Al(y-p,l))}for(let S=d.length;S>r.length;S--)this.el_.removeChild(d[S-1]);d.length=r.length})}}ve.registerComponent("LoadProgressBar",vf);class Tf extends ve{constructor(s,r){super(s,r),this.update=Mi(Yt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(s,p,l){var d=mt(this.el_),f=rt(this.player_.el()),p=s.width*p;if(f&&d){var y=s.left-f.left+p,p=s.width-p+(f.right-s.right);let A=d.width/2;y<A?A+=A-y:p<A&&(A=p),A<0?A=0:A>d.width&&(A=d.width),A=Math.round(A),this.el_.style.right=`-${A}px`,this.write(l)}}write(s){X(this.el_,s)}updateTime(s,r,l,d){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let f;var p,y,S=this.player_.duration();f=this.player_.liveTracker&&this.player_.liveTracker.isLive()?((y=(p=this.player_.liveTracker.liveWindow())-r*p)<1?"":"-")+Bn(y,p):Bn(l,S),this.update(s,r,f),d&&d()})}}ve.registerComponent("TimeTooltip",Tf);class Do extends ve{constructor(s,r){super(s,r),this.update=Mi(Yt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(s,r){var l,d=this.getChild("timeTooltip");d&&(l=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),d.updateTime(s,r,l))}}Do.prototype.options_={children:[]},Qt||Ie||Do.prototype.options_.children.push("timeTooltip"),ve.registerComponent("PlayProgressBar",Do);class kl extends ve{constructor(s,r){super(s,r),this.update=Mi(Yt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(s,r){var l=r*this.player_.duration();this.getChild("timeTooltip").updateTime(s,r,l,()=>{this.el_.style.left=s.width*r+"px"})}}kl.prototype.options_={children:["timeTooltip"]},ve.registerComponent("MouseTimeDisplay",kl);class Il extends Cl{constructor(s,r){super(s,r),this.setEventHandlers_()}setEventHandlers_(){this.update_=Yt(this,this.update),this.update=Mi(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=s=>this.enableInterval_(s),this.disableIntervalHandler_=s=>this.disableInterval_(s),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.on(document,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(s){document.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(s)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))}disableInterval_(s){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&s&&s.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(s){if(document.visibilityState!=="hidden"){const r=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{var l=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),d=this.player_.liveTracker;let f=this.player_.duration();d&&d.isLive()&&(f=this.player_.liveTracker.liveCurrentTime()),this.percent_!==r&&(this.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),this.percent_=r),this.currentTime_===l&&this.duration_===f||(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Bn(l,f),Bn(f,f)],"{1} of {2}")),this.currentTime_=l,this.duration_=f),this.bar&&this.bar.update(rt(this.el()),this.getProgress())}),r}}userSeek_(s){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(s)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){var s=this.getCurrentTime_();let r;var l=this.player_.liveTracker;return l&&l.isLive()?(r=(s-l.seekableStart())/l.liveWindow(),l.atLiveEdge()&&(r=1)):r=s/this.player_.duration(),r}handleMouseDown(s){tn(s)&&(s.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(s))}handleMouseMove(s,r=!1){if(tn(s)){r||this.player_.scrubbing()||this.player_.scrubbing(!0);let f;if(r=this.calculateDistance(s),s=this.player_.liveTracker,s&&s.isLive()){if(.99<=r)return void s.seekToLiveEdge();var l=s.seekableStart(),d=s.liveCurrentTime();if((f=(f=(f=l+r*s.liveWindow())>=d?d:f)<=l?l+.1:f)===1/0)return}else(f=r*this.player_.duration())===this.player_.duration()&&(f-=.1);this.userSeek_(f)}}enable(){super.enable();var s=this.getChild("mouseTimeDisplay");s&&s.show()}disable(){super.disable();var s=this.getChild("mouseTimeDisplay");s&&s.hide()}handleMouseUp(s){super.handleMouseUp(s),s&&s.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Es(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(s){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(s){var r,l=this.player_.liveTracker;ut.isEventKey(s,"Space")||ut.isEventKey(s,"Enter")?(s.preventDefault(),s.stopPropagation(),this.handleAction(s)):ut.isEventKey(s,"Home")?(s.preventDefault(),s.stopPropagation(),this.userSeek_(0)):ut.isEventKey(s,"End")?(s.preventDefault(),s.stopPropagation(),l&&l.isLive()?this.userSeek_(l.liveCurrentTime()):this.userSeek_(this.player_.duration())):/^[0-9]$/.test(ut(s))?(s.preventDefault(),s.stopPropagation(),r=10*(ut.codes[ut(s)]-ut.codes[0])/100,l&&l.isLive()?this.userSeek_(l.seekableStart()+l.liveWindow()*r):this.userSeek_(this.player_.duration()*r)):ut.isEventKey(s,"PgDn")?(s.preventDefault(),s.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):ut.isEventKey(s,"PgUp")?(s.preventDefault(),s.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(s)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.off(document,"visibilitychange",this.toggleVisibility_),super.dispose()}}Il.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Qt||Ie||Il.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),ve.registerComponent("SeekBar",Il);class Ol extends ve{constructor(s,r){super(s,r),this.handleMouseMove=Mi(Yt(this,this.handleMouseMove),30),this.throttledHandleMouseSeek=Mi(Yt(this,this.handleMouseSeek),30),this.handleMouseUpHandler_=l=>this.handleMouseUp(l),this.handleMouseDownHandler_=l=>this.handleMouseDown(l),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(s){var r,l,d,f,p=this.getChild("seekBar");p&&(r=p.getChild("playProgressBar"),l=p.getChild("mouseTimeDisplay"),r||l)&&(d=mt(f=p.el()),f=Na(f=Dt(f,s).x,0,1),l&&l.update(d,f),r)&&r.update(d,p.getProgress())}handleMouseSeek(s){var r=this.getChild("seekBar");r&&r.handleMouseMove(s)}enabled(){return this.enabled_}disable(){var s;this.children().forEach(r=>r.disable&&r.disable()),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())&&(s=this.getChild("seekBar"),this.player_.scrubbing(!1),s.videoWasPlaying)&&Es(this.player_.play())}enable(){this.children().forEach(s=>s.enable&&s.enable()),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){var s=this.el_.ownerDocument;this.off(s,"mousemove",this.throttledHandleMouseSeek),this.off(s,"touchmove",this.throttledHandleMouseSeek),this.off(s,"mouseup",this.handleMouseUpHandler_),this.off(s,"touchend",this.handleMouseUpHandler_)}handleMouseDown(s){var r=this.el_.ownerDocument,l=this.getChild("seekBar");l&&l.handleMouseDown(s),this.on(r,"mousemove",this.throttledHandleMouseSeek),this.on(r,"touchmove",this.throttledHandleMouseSeek),this.on(r,"mouseup",this.handleMouseUpHandler_),this.on(r,"touchend",this.handleMouseUpHandler_)}handleMouseUp(s){var r=this.getChild("seekBar");r&&r.handleMouseUp(s),this.removeListenersAddedOnMousedownAndTouchstart()}}Ol.prototype.options_={children:["seekBar"]},ve.registerComponent("ProgressControl",Ol);class Gc extends an{constructor(s,r){super(s,r),this.on(s,["enterpictureinpicture","leavepictureinpicture"],l=>this.handlePictureInPictureChange(l)),this.on(s,["disablepictureinpicturechanged","loadedmetadata"],l=>this.handlePictureInPictureEnabledChange(l)),this.on(s,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{s.currentType().substring(0,5)==="audio"||s.audioPosterMode()||s.audioOnlyMode()?(s.isInPictureInPicture()&&s.exitPictureInPicture(),this.hide()):this.show()}),this.disable()}buildCSSClass(){return"vjs-picture-in-picture-control "+super.buildCSSClass()}handlePictureInPictureEnabledChange(){document.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()}handlePictureInPictureChange(s){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()}handleClick(s){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}Gc.prototype.controlText_="Picture-in-Picture",ve.registerComponent("PictureInPictureToggle",Gc);class Po extends an{constructor(s,r){super(s,r),this.on(s,"fullscreenchange",l=>this.handleFullscreenChange(l)),document[s.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return"vjs-fullscreen-control "+super.buildCSSClass()}handleFullscreenChange(s){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(s){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}Po.prototype.controlText_="Fullscreen",ve.registerComponent("FullscreenToggle",Po);class Dl extends ve{createEl(){var s=super.createEl("div",{className:"vjs-volume-level"});return s.appendChild(super.createEl("span",{className:"vjs-control-text"})),s}}ve.registerComponent("VolumeLevel",Dl);class n_ extends ve{constructor(s,r){super(s,r),this.update=Mi(Yt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(s,r,l,d){if(!l){var l=rt(this.el_),f=rt(this.player_.el()),r=s.width*r;if(!f||!l)return;var p=s.left-f.left+r,r=s.width-r+(f.right-s.right);let A=l.width/2;p<A?A+=A-p:r<A&&(A=r),A<0?A=0:A>l.width&&(A=l.width),this.el_.style.right=`-${A}px`}this.write(d+"%")}write(s){X(this.el_,s)}updateVolume(s,r,l,d,f){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(s,r,l,d.toFixed(0)),f&&f()})}}ve.registerComponent("VolumeLevelTooltip",n_);class bf extends ve{constructor(s,r){super(s,r),this.update=Mi(Yt(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(s,r,l){var d=100*r;this.getChild("volumeLevelTooltip").updateVolume(s,r,l,d,()=>{l?this.el_.style.bottom=s.height*r+"px":this.el_.style.left=s.width*r+"px"})}}bf.prototype.options_={children:["volumeLevelTooltip"]},ve.registerComponent("MouseVolumeLevelDisplay",bf);class Pl extends Cl{constructor(s,r){super(s,r),this.on("slideractive",l=>this.updateLastVolume_(l)),this.on(s,"volumechange",l=>this.updateARIAAttributes(l)),s.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(s){tn(s)&&super.handleMouseDown(s)}handleMouseMove(s){var r,l,d,f=this.getChild("mouseVolumeLevelDisplay");f&&(r=rt(d=this.el()),l=this.vertical(),d=Dt(d,s),d=Na(d=l?d.y:d.x,0,1),f.update(r,d,l)),tn(s)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(s)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(s){var r=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",r),this.el_.setAttribute("aria-valuetext",r+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){const s=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(s)})}}Pl.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Qt||Ie||Pl.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Pl.prototype.playerEvent="volumechange",ve.registerComponent("VolumeBar",Pl);class Ef extends ve{constructor(s,r={}){var l,d;r.vertical=r.vertical||!1,typeof r.volumeBar<"u"&&!ee(r.volumeBar)||(r.volumeBar=r.volumeBar||{},r.volumeBar.vertical=r.vertical),super(s,r),l=this,(d=s).tech_&&!d.tech_.featuresVolumeControl&&l.addClass("vjs-hidden"),l.on(d,"loadstart",function(){d.tech_.featuresVolumeControl?l.removeClass("vjs-hidden"):l.addClass("vjs-hidden")}),this.throttledHandleMouseMove=Mi(Yt(this,this.handleMouseMove),30),this.handleMouseUpHandler_=f=>this.handleMouseUp(f),this.on("mousedown",f=>this.handleMouseDown(f)),this.on("touchstart",f=>this.handleMouseDown(f)),this.on("mousemove",f=>this.handleMouseMove(f)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let s="vjs-volume-horizontal";return this.options_.vertical&&(s="vjs-volume-vertical"),super.createEl("div",{className:"vjs-volume-control vjs-control "+s})}handleMouseDown(s){var r=this.el_.ownerDocument;this.on(r,"mousemove",this.throttledHandleMouseMove),this.on(r,"touchmove",this.throttledHandleMouseMove),this.on(r,"mouseup",this.handleMouseUpHandler_),this.on(r,"touchend",this.handleMouseUpHandler_)}handleMouseUp(s){var r=this.el_.ownerDocument;this.off(r,"mousemove",this.throttledHandleMouseMove),this.off(r,"touchmove",this.throttledHandleMouseMove),this.off(r,"mouseup",this.handleMouseUpHandler_),this.off(r,"touchend",this.handleMouseUpHandler_)}handleMouseMove(s){this.volumeBar.handleMouseMove(s)}}Ef.prototype.options_={children:["volumeBar"]},ve.registerComponent("VolumeControl",Ef);class Sf extends an{constructor(s,r){var l,d;super(s,r),l=this,(d=s).tech_&&!d.tech_.featuresMuteControl&&l.addClass("vjs-hidden"),l.on(d,"loadstart",function(){d.tech_.featuresMuteControl?l.removeClass("vjs-hidden"):l.addClass("vjs-hidden")}),this.on(s,["loadstart","volumechange"],f=>this.update(f))}buildCSSClass(){return"vjs-mute-control "+super.buildCSSClass()}handleClick(s){var r=this.player_.volume(),l=this.player_.lastVolume_();r===0?(this.player_.volume(l<.1?.1:l),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())}update(s){this.updateIcon_(),this.updateControlText_()}updateIcon_(){var s=this.player_.volume();let r=3;Qt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),s===0||this.player_.muted()?r=0:s<.33?r=1:s<.67&&(r=2),Ce(this.el_,[0,1,2,3].reduce((l,d)=>l+`${d?" ":""}vjs-vol-`+d,"")),_e(this.el_,"vjs-vol-"+r)}updateControlText_(){var s=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==s&&this.controlText(s)}}Sf.prototype.controlText_="Mute",ve.registerComponent("MuteToggle",Sf);class Ll extends ve{constructor(s,r={}){typeof r.inline<"u"?r.inline=r.inline:r.inline=!0,typeof r.volumeControl<"u"&&!ee(r.volumeControl)||(r.volumeControl=r.volumeControl||{},r.volumeControl.vertical=!r.inline),super(s,r),this.handleKeyPressHandler_=l=>this.handleKeyPress(l),this.on(s,["loadstart"],l=>this.volumePanelState_(l)),this.on(this.muteToggle,"keyup",l=>this.handleKeyPress(l)),this.on(this.volumeControl,"keyup",l=>this.handleVolumeControlKeyUp(l)),this.on("keydown",l=>this.handleKeyPress(l)),this.on("mouseover",l=>this.handleMouseOver(l)),this.on("mouseout",l=>this.handleMouseOut(l)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let s="vjs-volume-panel-horizontal";return this.options_.inline||(s="vjs-volume-panel-vertical"),super.createEl("div",{className:"vjs-volume-panel vjs-control "+s})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(s){ut.isEventKey(s,"Esc")&&this.muteToggle.focus()}handleMouseOver(s){this.addClass("vjs-hover"),cs(document,"keyup",this.handleKeyPressHandler_)}handleMouseOut(s){this.removeClass("vjs-hover"),Ri(document,"keyup",this.handleKeyPressHandler_)}handleKeyPress(s){ut.isEventKey(s,"Esc")&&this.handleMouseOut()}}Ll.prototype.options_={children:["muteToggle","volumeControl"]},ve.registerComponent("VolumePanel",Ll);class xf extends ve{constructor(s,r){super(s,r),r&&(this.menuButton_=r.menuButton),this.focusedChild_=-1,this.on("keydown",l=>this.handleKeyDown(l)),this.boundHandleBlur_=l=>this.handleBlur(l),this.boundHandleTapClick_=l=>this.handleTapClick(l)}addEventListenerForItem(s){s instanceof ve&&(this.on(s,"blur",this.boundHandleBlur_),this.on(s,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(s){s instanceof ve&&(this.off(s,"blur",this.boundHandleBlur_),this.off(s,["tap","click"],this.boundHandleTapClick_))}removeChild(s){typeof s=="string"&&(s=this.getChild(s)),this.removeEventListenerForItem(s),super.removeChild(s)}addItem(s){s=this.addChild(s),s&&this.addEventListenerForItem(s)}createEl(){var s=this.options_.contentElType||"ul",s=(this.contentEl_=je(s,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu"),super.createEl("div",{append:this.contentEl_,className:"vjs-menu"}));return s.appendChild(this.contentEl_),cs(s,"click",function(r){r.preventDefault(),r.stopImmediatePropagation()}),s}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(s){const r=s.relatedTarget||document.activeElement;this.children().some(l=>l.el()===r)||(s=this.menuButton_)&&s.buttonPressed_&&r!==s.el().firstChild&&s.unpressButton()}handleTapClick(s){var r;this.menuButton_&&(this.menuButton_.unpressButton(),r=this.children(),Array.isArray(r))&&(r=r.filter(l=>l.el()===s.target)[0])&&r.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}handleKeyDown(s){ut.isEventKey(s,"Left")||ut.isEventKey(s,"Down")?(s.preventDefault(),s.stopPropagation(),this.stepForward()):(ut.isEventKey(s,"Right")||ut.isEventKey(s,"Up"))&&(s.preventDefault(),s.stopPropagation(),this.stepBack())}stepForward(){let s=0;this.focusedChild_!==void 0&&(s=this.focusedChild_+1),this.focus(s)}stepBack(){let s=0;this.focusedChild_!==void 0&&(s=this.focusedChild_-1),this.focus(s)}focus(s=0){var r=this.children().slice();r.length&&r[0].hasClass("vjs-menu-title")&&r.shift(),0<r.length&&(s<0?s=0:s>=r.length&&(s=r.length-1),r[this.focusedChild_=s].el_.focus())}}ve.registerComponent("Menu",xf);class zc extends ve{constructor(s,r={}){super(s,r),this.menuButton_=new an(s,r),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true"),s=an.prototype.buildCSSClass(),this.menuButton_.el_.className=this.buildCSSClass()+" "+s,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0,r=l=>this.handleClick(l),this.handleMenuKeyUp_=l=>this.handleMenuKeyUp(l),this.on(this.menuButton_,"tap",r),this.on(this.menuButton_,"click",r),this.on(this.menuButton_,"keydown",l=>this.handleKeyDown(l)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),cs(document,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",l=>this.handleMouseLeave(l)),this.on("keydown",l=>this.handleSubmenuKeyDown(l))}update(){var s=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=s,this.addChild(s),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){var s,r=new xf(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title&&(s=je("li",{className:"vjs-menu-title",textContent:vi(this.options_.title),tabIndex:-1}),s=new ve(this.player_,{el:s}),r.addItem(s)),this.items=this.createItems(),this.items)for(let l=0;l<this.items.length;l++)r.addItem(this.items[l]);return r}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let s="vjs-menu-button";this.options_.inline===!0?s+="-inline":s+="-popup";var r=an.prototype.buildCSSClass();return`vjs-menu-button ${s} ${r} `+super.buildCSSClass()}buildCSSClass(){let s="vjs-menu-button";return this.options_.inline===!0?s+="-inline":s+="-popup",`vjs-menu-button ${s} `+super.buildCSSClass()}controlText(s,r=this.menuButton_.el()){return this.menuButton_.controlText(s,r)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(s){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(s){this.removeClass("vjs-hover"),Ri(document,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(s){ut.isEventKey(s,"Esc")||ut.isEventKey(s,"Tab")?(this.buttonPressed_&&this.unpressButton(),ut.isEventKey(s,"Tab")||(s.preventDefault(),this.menuButton_.focus())):!ut.isEventKey(s,"Up")&&!ut.isEventKey(s,"Down")||this.buttonPressed_||(s.preventDefault(),this.pressButton())}handleMenuKeyUp(s){(ut.isEventKey(s,"Esc")||ut.isEventKey(s,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(s){this.handleSubmenuKeyDown(s)}handleSubmenuKeyDown(s){(ut.isEventKey(s,"Esc")||ut.isEventKey(s,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),ut.isEventKey(s,"Tab")||(s.preventDefault(),this.menuButton_.focus()))}pressButton(){this.enabled_&&(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Qt&&Ct()||this.menu.focus())}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}ve.registerComponent("MenuButton",zc);class Nl extends zc{constructor(s,r){const l=r.tracks;if(super(s,r),this.items.length<=1&&this.hide(),l){const d=Yt(this,this.update);l.addEventListener("removetrack",d),l.addEventListener("addtrack",d),l.addEventListener("labelchange",d),this.player_.on("ready",d),this.player_.on("dispose",function(){l.removeEventListener("removetrack",d),l.removeEventListener("addtrack",d),l.removeEventListener("labelchange",d)})}}}ve.registerComponent("TrackButton",Nl);const Ra=["Tab","Esc","Up","Down","Right","Left"];class Ut extends xl{constructor(s,r){super(s,r),this.selectable=r.selectable,this.isSelected_=r.selected||!1,this.multiSelectable=r.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(s,r,l){return this.nonIconControl=!0,r=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},r),l),r.replaceChild(je("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),r.querySelector(".vjs-icon-placeholder")),r}handleKeyDown(s){Ra.some(r=>ut.isEventKey(s,r))||super.handleKeyDown(s)}handleClick(s){this.selected(!0)}selected(s){this.selectable&&(s?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}ve.registerComponent("MenuItem",Ut);class on extends Ut{constructor(s,r){var l=r.track;const d=s.textTracks(),f=(r.label=l.label||l.language||"Unknown",r.selected=l.mode==="showing",super(s,r),this.track=l,this.kinds=(r.kinds||[r.kind||this.track.kind]).filter(Boolean),(...y)=>{this.handleTracksChange.apply(this,y)}),p=(...y)=>{this.handleSelectedLanguageChange.apply(this,y)};if(s.on(["loadstart","texttrackchange"],f),d.addEventListener("change",f),d.addEventListener("selectedlanguagechange",p),this.on("dispose",function(){s.off(["loadstart","texttrackchange"],f),d.removeEventListener("change",f),d.removeEventListener("selectedlanguagechange",p)}),d.onchange===void 0){let y;this.on(["tap","click"],function(){if(typeof window.Event!="object")try{y=new window.Event("change")}catch{}y||(y=document.createEvent("Event")).initEvent("change",!0,!0),d.dispatchEvent(y)})}this.handleTracksChange()}handleClick(s){var r=this.track,l=this.player_.textTracks();if(super.handleClick(s),l)for(let f=0;f<l.length;f++){var d=l[f];this.kinds.indexOf(d.kind)!==-1&&(d===r?d.mode!=="showing"&&(d.mode="showing"):d.mode!=="disabled"&&(d.mode="disabled"))}}handleTracksChange(s){var r=this.track.mode==="showing";r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(s){var r;this.track.mode!=="showing"||(r=this.player_.cache_.selectedLanguage)&&r.enabled&&r.language===this.track.language&&r.kind!==this.track.kind||(this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind})}dispose(){this.track=null,super.dispose()}}ve.registerComponent("TextTrackMenuItem",on);class Ki extends on{constructor(s,r){r.track={player:s,kind:r.kind,kinds:r.kinds,default:!1,mode:"disabled"},r.kinds||(r.kinds=[r.kind]),r.label?r.track.label=r.label:r.track.label=r.kinds.join(" and ")+" off",r.selectable=!0,r.multiSelectable=!1,super(s,r)}handleTracksChange(s){var r=this.player().textTracks();let l=!0;for(let f=0,p=r.length;f<p;f++){var d=r[f];if(-1<this.options_.kinds.indexOf(d.kind)&&d.mode==="showing"){l=!1;break}}l!==this.isSelected_&&this.selected(l)}handleSelectedLanguageChange(s){var r=this.player().textTracks();let l=!0;for(let f=0,p=r.length;f<p;f++){var d=r[f];if(-1<["captions","descriptions","subtitles"].indexOf(d.kind)&&d.mode==="showing"){l=!1;break}}l&&(this.player_.cache_.selectedLanguage={enabled:!1})}}ve.registerComponent("OffTextTrackMenuItem",Ki);class ns extends Nl{constructor(s,r={}){r.tracks=s.textTracks(),super(s,r)}createItems(s=[],r=on){let l;this.label_&&(l=this.label_+" off"),s.push(new Ki(this.player_,{kinds:this.kinds_,kind:this.kind_,label:l})),this.hideThreshold_+=1;var d=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let y=0;y<d.length;y++){var f,p=d[y];-1<this.kinds_.indexOf(p.kind)&&((f=new r(this.player_,{track:p,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1})).addClass(`vjs-${p.kind}-menu-item`),s.push(f))}return s}}ve.registerComponent("TextTrackButton",ns);class wf extends Ut{constructor(s,r){var l=r.track,d=r.cue,f=s.currentTime();r.selectable=!0,r.multiSelectable=!1,r.label=d.text,r.selected=d.startTime<=f&&f<d.endTime,super(s,r),this.track=l,this.cue=d}handleClick(s){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}ve.registerComponent("ChaptersTrackMenuItem",wf);class Rl extends ns{constructor(s,r,l){super(s,r,l),this.selectCurrentItem_=()=>{this.items.forEach(d=>{d.selected(this.track_.activeCues[0]===d.cue)})}}buildCSSClass(){return"vjs-chapters-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-chapters-button "+super.buildWrapperCSSClass()}update(s){s&&s.track&&s.track.kind!=="chapters"||((s=this.findChaptersTrack())!==this.track_?(this.setTrack(s),super.update()):(!this.items||s&&s.cues&&s.cues.length!==this.items.length)&&super.update())}setTrack(s){var r;this.track_!==s&&(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_&&((r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&r.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null),this.track_=s,this.track_)&&(this.track_.mode="hidden",(r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_))&&r.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_))}findChaptersTrack(){var s=this.player_.textTracks()||[];for(let l=s.length-1;0<=l;l--){var r=s[l];if(r.kind===this.kind_)return r}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(vi(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){var s=[];if(this.track_){var r=this.track_.cues;if(r)for(let d=0,f=r.length;d<f;d++){var l=r[d],l=new wf(this.player_,{track:this.track_,cue:l});s.push(l)}}return s}}Rl.prototype.kind_="chapters",Rl.prototype.controlText_="Chapters",ve.registerComponent("ChaptersButton",Rl);class Kc extends ns{constructor(s,r,l){super(s,r,l);const d=s.textTracks(),f=Yt(this,this.handleTracksChange);d.addEventListener("change",f),this.on("dispose",function(){d.removeEventListener("change",f)})}handleTracksChange(s){var r=this.player().textTracks();let l=!1;for(let f=0,p=r.length;f<p;f++){var d=r[f];if(d.kind!==this.kind_&&d.mode==="showing"){l=!0;break}}l?this.disable():this.enable()}buildCSSClass(){return"vjs-descriptions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-descriptions-button "+super.buildWrapperCSSClass()}}Kc.prototype.kind_="descriptions",Kc.prototype.controlText_="Descriptions",ve.registerComponent("DescriptionsButton",Kc);class Xc extends ns{constructor(s,r,l){super(s,r,l)}buildCSSClass(){return"vjs-subtitles-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subtitles-button "+super.buildWrapperCSSClass()}}Xc.prototype.kind_="subtitles",Xc.prototype.controlText_="Subtitles",ve.registerComponent("SubtitlesButton",Xc);class Yc extends on{constructor(s,r){r.track={player:s,kind:r.kind,label:r.kind+" settings",selectable:!1,default:!1,mode:"disabled"},r.selectable=!1,r.name="CaptionSettingsMenuItem",super(s,r),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+r.kind+" settings dialog")}handleClick(s){this.player().getChild("textTrackSettings").open()}}ve.registerComponent("CaptionSettingsMenuItem",Yc);class Qc extends ns{constructor(s,r,l){super(s,r,l)}buildCSSClass(){return"vjs-captions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-captions-button "+super.buildWrapperCSSClass()}createItems(){var s=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(s.push(new Yc(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(s)}}Qc.prototype.kind_="captions",Qc.prototype.controlText_="Captions",ve.registerComponent("CaptionsButton",Qc);class Cf extends on{createEl(s,r,l){return s=super.createEl(s,r,l),r=s.querySelector(".vjs-menu-item-text"),this.options_.track.kind==="captions"&&(r.appendChild(je("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(je("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),s}}ve.registerComponent("SubsCapsMenuItem",Cf);class Jc extends ns{constructor(s,r={}){super(s,r),this.label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)&&(this.label_="captions"),this.menuButton_.controlText(vi(this.label_))}buildCSSClass(){return"vjs-subs-caps-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subs-caps-button "+super.buildWrapperCSSClass()}createItems(){let s=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(s.push(new Yc(this.player_,{kind:this.label_})),this.hideThreshold_+=1),s=super.createItems(s,Cf)}}Jc.prototype.kinds_=["captions","subtitles"],Jc.prototype.controlText_="Subtitles",ve.registerComponent("SubsCapsButton",Jc);class Af extends Ut{constructor(s,r){var l=r.track;const d=s.audioTracks(),f=(r.label=l.label||l.language||"Unknown",r.selected=l.enabled,super(s,r),this.track=l,this.addClass(`vjs-${l.kind}-menu-item`),(...p)=>{this.handleTracksChange.apply(this,p)});d.addEventListener("change",f),this.on("dispose",()=>{d.removeEventListener("change",f)})}createEl(s,r,l){return s=super.createEl(s,r,l),r=s.querySelector(".vjs-menu-item-text"),this.options_.track.kind==="main-desc"&&(r.appendChild(je("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(je("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),s}handleClick(s){if(super.handleClick(s),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){var r=this.player_.audioTracks();for(let d=0;d<r.length;d++){var l=r[d];l!==this.track&&(l.enabled=l===this.track)}}}handleTracksChange(s){this.selected(this.track.enabled)}}ve.registerComponent("AudioTrackMenuItem",Af);class Zc extends Nl{constructor(s,r={}){r.tracks=s.audioTracks(),super(s,r)}buildCSSClass(){return"vjs-audio-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-audio-button "+super.buildWrapperCSSClass()}createItems(s=[]){this.hideThreshold_=1;var r=this.player_.audioTracks();for(let d=0;d<r.length;d++){var l=r[d];s.push(new Af(this.player_,{track:l,selectable:!0,multiSelectable:!1}))}return s}}Zc.prototype.controlText_="Audio Track",ve.registerComponent("AudioTrackButton",Zc);class g extends Ut{constructor(s,r){var l=r.rate,d=parseFloat(l,10);r.label=l,r.selected=d===s.playbackRate(),r.selectable=!0,r.multiSelectable=!1,super(s,r),this.label=l,this.rate=d,this.on(s,"ratechange",f=>this.update(f))}handleClick(s){super.handleClick(),this.player().playbackRate(this.rate)}update(s){this.selected(this.player().playbackRate()===this.rate)}}g.prototype.contentElType="button",ve.registerComponent("PlaybackRateMenuItem",g);class b extends zc{constructor(s,r){super(s,r),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(s,"loadstart",l=>this.updateVisibility(l)),this.on(s,"ratechange",l=>this.updateLabel(l)),this.on(s,"playbackrateschange",l=>this.handlePlaybackRateschange(l))}createEl(){var s=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=je("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),s.appendChild(this.labelEl_),s}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return"vjs-playback-rate "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-playback-rate "+super.buildWrapperCSSClass()}createItems(){var s=this.playbackRates(),r=[];for(let l=s.length-1;0<=l;l--)r.push(new g(this.player(),{rate:s[l]+"x"}));return r}handlePlaybackRateschange(s){this.update()}playbackRates(){var s=this.player();return s.playbackRates&&s.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length}updateVisibility(s){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(s){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}b.prototype.controlText_="Playback Rate",ve.registerComponent("PlaybackRateMenuButton",b);class w extends ve{buildCSSClass(){return"vjs-spacer "+super.buildCSSClass()}createEl(s="div",r={},l={}){return r.className||(r.className=this.buildCSSClass()),super.createEl(s,r,l)}}ve.registerComponent("Spacer",w),ve.registerComponent("CustomControlSpacer",class extends w{buildCSSClass(){return"vjs-custom-control-spacer "+super.buildCSSClass()}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:""})}});class x extends ve{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}x.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in document&&x.prototype.options_.children.splice(x.prototype.options_.children.length-1,0,"pictureInPictureToggle"),ve.registerComponent("ControlBar",x);class I extends Oa{constructor(s,r){super(s,r),this.on(s,"error",l=>this.open(l))}buildCSSClass(){return"vjs-error-display "+super.buildCSSClass()}content(){var s=this.player().error();return s?this.localize(s.message):""}}I.prototype.options_=Object.assign({},Oa.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),ve.registerComponent("ErrorDisplay",I);const N="vjs-text-track-settings";var $=["#000","Black"],V=["#00F","Blue"],Hf=["#0FF","Cyan"],Fl=["#0F0","Green"],Hi=["#F0F","Magenta"],Y=["#F00","Red"],J=["#FFF","White"],as=["#FF0","Yellow"],Kl=["1","Opaque"],Wl=["0.5","Semi-Transparent"],ql=["0","Transparent"];const le={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[$,J,Y,Fl,V,as,Hi,Hf]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Kl,Wl,ql]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[J,$,Y,Fl,V,as,Hi,Hf]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:a=>a==="1.00"?null:Number(a)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Kl,Wl]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[ql,Wl,Kl]}};function me(a,s){if((a=s?s(a):a)&&a!=="none")return a}le.windowColor.options=le.backgroundColor.options;class Ke extends Oa{constructor(s,r){r.temporary=!1,super(s,r),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=je("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),r.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),j(le,l=>{this.on(this.$(l.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(s,r="",l="label"){s=le[s];const d=s.id.replace("%s",this.id_),f=[r,d].join(" ").trim();return[`<${l} id="${d}" class="${l==="label"?"vjs-label":""}">`,this.localize(s.label),`</${l}>`,`<select aria-labelledby="${f}">`].concat(s.options.map(p=>{var y=d+"-"+p[1].replace(/\W+/g,"");return[`<option id="${y}" value="${p[0]}" `,`aria-labelledby="${f} ${y}">`,this.localize(p[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){var s="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">',`<legend id="${s}">`,this.localize("Text"),"</legend>",this.createElSelect_("color",s),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",s),"</span>","</fieldset>"].join("")}createElBgColor_(){var s="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">',`<legend id="${s}">`,this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",s),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",s),"</span>","</fieldset>"].join("")}createElWinColor_(){var s="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">',`<legend id="${s}">`,this.localize("Window"),"</legend>",this.createElSelect_("windowColor",s),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",s),"</span>","</fieldset>"].join("")}createElColors_(){return je("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return je("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){var s=this.localize("restore all settings to the default values");return je("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${s}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${s}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return q(le,(s,r,l)=>{d=this.$(r.selector),r=r.parser;var d=me(d.options[d.options.selectedIndex].value,r);return d!==void 0&&(s[l]=d),s},{})}setValues(s){j(le,(r,l)=>{var d=this.$(r.selector),f=s[l],p=r.parser;if(f){for(let y=0;y<d.options.length;y++)if(me(d.options[y].value,p)===f){d.selectedIndex=y;break}}})}setDefaults(){j(le,s=>{var r=s.hasOwnProperty("default")?s.default:0;this.$(s.selector).selectedIndex=r})}restoreSettings(){let s;try{s=JSON.parse(window.localStorage.getItem(N))}catch(r){R.warn(r)}s&&this.setValues(s)}saveSettings(){if(this.options_.persistTextTrackSettings){var s=this.getValues();try{Object.keys(s).length?window.localStorage.setItem(N,JSON.stringify(s)):window.localStorage.removeItem(N)}catch(r){R.warn(r)}}}updateDisplay(){var s=this.player_.getChild("textTrackDisplay");s&&s.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;var r=this.player_.controlBar,s=r&&r.subsCapsButton,r=r&&r.captionsButton;s?s.focus():r&&r.focus()}}ve.registerComponent("TextTrackSettings",Ke);class Ae extends ve{constructor(s,r){let l=r.ResizeObserver||window.ResizeObserver;super(s,se({createEl:!(l=r.ResizeObserver===null?!1:l),reportTouchActivity:!1},r)),this.ResizeObserver=r.ResizeObserver||window.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=ho(()=>{this.resizeHandler()},100,!1,this),l?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(s.el())):(this.loadListener_=()=>{if(this.el_&&this.el_.contentWindow){const d=this.debouncedHandler_;let f=this.unloadListener_=function(){Ri(this,"resize",d),Ri(this,"unload",f),f=null};cs(this.el_.contentWindow,"unload",f),cs(this.el_.contentWindow,"resize",d)}},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}ve.registerComponent("ResizeManager",Ae);const ft={trackingThreshold:20,liveTolerance:15};class yt extends ve{constructor(s,r){super(s,se(ft,r,{createEl:!1})),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=l=>this.handlePlay(l),this.handleFirstTimeupdate_=l=>this.handleFirstTimeupdate(l),this.handleSeeked_=l=>this.handleSeeked(l),this.seekToLiveEdge_=l=>this.seekToLiveEdge(l),this.reset_(),this.on(this.player_,"durationchange",l=>this.handleDurationchange(l)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){var s=this.player_.seekable();if(s&&s.length){var s=Number(window.performance.now().toFixed(4)),r=this.lastTime_===-1?0:(s-this.lastTime_)/1e3,s=(this.lastTime_=s,this.pastSeekEnd_=this.pastSeekEnd()+r,this.liveCurrentTime()),r=this.player_.currentTime();let d=this.player_.paused()||this.seekedBehindLive_||Math.abs(s-r)>this.options_.liveTolerance;(d=this.timeupdateSeen_&&s!==1/0?d:!1)!==this.behindLiveEdge_&&(this.behindLiveEdge_=d,this.trigger("liveedgechange"))}}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){var s=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&2<s,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){var s=this.player_.seekable(),r=[];let l=s?s.length:0;for(;l--;)r.push(s.end(l));return r.length?r.sort()[r.length-1]:1/0}seekableStart(){var s=this.player_.seekable(),r=[];let l=s?s.length:0;for(;l--;)r.push(s.start(l));return r.length?r.sort()[0]:0}liveWindow(){var s=this.liveCurrentTime();return s===1/0?0:s-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){var s=this.seekableEnd();return this.lastSeekEnd_!==-1&&s!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=s,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}ve.registerComponent("LiveTracker",yt);class ki extends ve{constructor(s,r){super(s,r),this.on("statechanged",l=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:je("div",{className:"vjs-title-bar-title",id:"vjs-title-bar-title-"+sn++}),description:je("div",{className:"vjs-title-bar-description",id:"vjs-title-bar-description-"+sn++})},je("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){var s=this.player_.tech_;const r=s&&s.el_,l={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(y=>{var f=this.state[y],p=this.els[y],y=l[y];ai(p),f&&X(p,f),r&&(r.removeAttribute(y),f)&&r.setAttribute(y,p.id)}),this.state.title||this.state.description?this.show():this.hide()}update(s){this.setState(s)}dispose(){var s=this.player_.tech_,s=s&&s.el_;s&&(s.removeAttribute("aria-labelledby"),s.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}ve.registerComponent("TitleBar",ki);function xs(a){const s=a.el();if(!s.resetSourceWatch_){const r={},l=td(a),d=f=>(...p)=>(p=f.apply(s,p),Ml(a),p);["append","appendChild","insertAdjacentHTML"].forEach(f=>{s[f]&&(r[f]=s[f],s[f]=d(r[f]))}),Object.defineProperty(s,"innerHTML",se(l,{set:d(l.set)})),s.resetSourceWatch_=()=>{s.resetSourceWatch_=null,Object.keys(r).forEach(f=>{s[f]=r[f]}),Object.defineProperty(s,"innerHTML",l)},a.one("sourceset",s.resetSourceWatch_)}}function zr(a){if(a.featuresSourceset){const r=a.el();if(!r.resetSourceset_){s=a;const l=ed([s.el(),window.HTMLMediaElement.prototype,If],"src");var s;const d=r.setAttribute,f=r.load;Object.defineProperty(r,"src",se(l,{set:p=>(p=l.set.call(r,p),a.triggerSourceset(r.src),p)})),r.setAttribute=(p,y)=>(y=d.call(r,p,y),/src/i.test(p)&&a.triggerSourceset(r.src),y),r.load=()=>{var p=f.call(r);return Ml(a)||(a.triggerSourceset(""),xs(a)),p},r.currentSrc?a.triggerSourceset(r.currentSrc):Ml(a)||xs(a),r.resetSourceset_=()=>{r.resetSourceset_=null,r.load=f,r.setAttribute=d,Object.defineProperty(r,"src",l),r.resetSourceWatch_&&r.resetSourceWatch_()}}}}const Ml=a=>{var s=a.el();if(s.hasAttribute("src"))a.triggerSourceset(s.src);else{var r=a.$$("source"),l=[];let f="";if(!r.length)return!1;for(let p=0;p<r.length;p++){var d=r[p].src;d&&l.indexOf(d)===-1&&l.push(d)}if(!l.length)return!1;l.length===1&&(f=l[0]),a.triggerSourceset(f)}return!0},kf=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(a){for(var s=document.createElement(this.nodeName.toLowerCase()),r=(s.innerHTML=a,document.createDocumentFragment());s.childNodes.length;)r.appendChild(s.childNodes[0]);return this.innerText="",window.Element.prototype.appendChild.call(this,r),this.innerHTML}}),ed=(a,s)=>{let r={};for(let l=0;l<a.length&&!((r=Object.getOwnPropertyDescriptor(a[l],s))&&r.set&&r.get);l++);return r.enumerable=!0,r.configurable=!0,r},td=a=>ed([a.el(),window.HTMLMediaElement.prototype,window.Element.prototype,kf],"innerHTML"),If=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?Rc(window.Element.prototype.getAttribute.call(this,"src")):""},set(a){return window.Element.prototype.setAttribute.call(this,"src",a),a}});class Ne extends Et{constructor(s,r){super(s,r),r=s.source;let l=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",r&&(this.el_.currentSrc!==r.src||s.tag&&s.tag.initNetworkState_===3)?this.setSource(r):this.handleLateInit_(this.el_),s.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){var d=this.el_.childNodes;let y=d.length;for(var f=[];y--;){var p=d[y];p.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(p),this.remoteTextTracks().addTrack(p.track),this.textTracks().addTrack(p.track),l||this.el_.hasAttribute("crossorigin")||!yl(p.src)||(l=!0)):f.push(p))}for(let S=0;S<f.length;S++)this.el_.removeChild(f[S])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&l&&R.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(ei||mi)&&s.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Ne.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){zr(this)}restoreMetadataTracksInIOSNativePlayer_(){const s=this.textTracks();let r;const l=()=>{r=[];for(let p=0;p<s.length;p++){var f=s[p];f.kind==="metadata"&&r.push({track:f,storedMode:f.mode})}},d=(l(),s.addEventListener("change",l),this.on("dispose",()=>s.removeEventListener("change",l)),()=>{for(let p=0;p<r.length;p++){var f=r[p];f.track.mode==="disabled"&&f.track.mode!==f.storedMode&&(f.track.mode=f.storedMode)}s.removeEventListener("change",d)});this.on("webkitbeginfullscreen",()=>{s.removeEventListener("change",l),s.removeEventListener("change",d),s.addEventListener("change",d)}),this.on("webkitendfullscreen",()=>{s.removeEventListener("change",l),s.addEventListener("change",l),s.removeEventListener("change",d)})}overrideNative_(s,r){if(r===this[`featuresNative${s}Tracks`]){const l=s.toLowerCase();this[l+"TracksListeners_"]&&Object.keys(this[l+"TracksListeners_"]).forEach(d=>{this.el()[l+"Tracks"].removeEventListener(d,this[l+"TracksListeners_"][d])}),this[`featuresNative${s}Tracks`]=!r,this[l+"TracksListeners_"]=null,this.proxyNativeTracksForType_(l)}}overrideNativeAudioTracks(s){this.overrideNative_("Audio",s)}overrideNativeVideoTracks(s){this.overrideNative_("Video",s)}proxyNativeTracksForType_(s){var r=zi[s];const l=this.el()[r.getterName],d=this[r.getterName]();if(this[`featuresNative${r.capitalName}Tracks`]&&l&&l.addEventListener){const f={change:y=>{var S={type:"change",target:d,currentTarget:d,srcElement:d};d.trigger(S),s==="text"&&this[Tn.remoteText.getterName]().trigger(S)},addtrack(y){d.addTrack(y.track)},removetrack(y){d.removeTrack(y.track)}},p=function(){var y=[];for(let S=0;S<d.length;S++){let A=!1;for(let P=0;P<l.length;P++)if(l[P]===d[S]){A=!0;break}A||y.push(d[S])}for(;y.length;)d.removeTrack(y.shift())};this[r.getterName+"Listeners_"]=f,Object.keys(f).forEach(y=>{const S=f[y];l.addEventListener(y,S),this.on("dispose",A=>l.removeEventListener(y,S))}),this.on("loadstart",p),this.on("dispose",y=>this.off("loadstart",p))}}proxyNativeTracks_(){zi.names.forEach(s=>{this.proxyNativeTracksForType_(s)})}createEl(){let s=this.options_.tag;s&&(this.options_.playerElIngest||this.movingMediaElementInDOM)||(s?(r=s.cloneNode(!0),s.parentNode&&s.parentNode.insertBefore(r,s),Ne.disposeMediaElement(s),s=r):(s=document.createElement("video"),r=se({},this.options_.tag&&Oe(this.options_.tag)),ei&&this.options_.nativeControlsForTouch===!0||delete r.controls,Fe(s,Object.assign(r,{id:this.options_.techId,class:"vjs-tech"}))),s.playerId=this.options_.playerId),typeof this.options_.preload<"u"&&ke(s,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(s.disablePictureInPicture=this.options_.disablePictureInPicture);var r,l=["loop","muted","playsinline","autoplay"];for(let p=0;p<l.length;p++){var d=l[p],f=this.options_[d];typeof f<"u"&&(f?ke(s,d,d):et(s,d),s[d]=f)}return s}handleLateInit_(s){if(s.networkState!==0&&s.networkState!==3)if(s.readyState===0){let r=!1;const l=function(){r=!0},d=(this.on("loadstart",l),function(){r||this.trigger("loadstart")});this.on("loadedmetadata",d),this.ready(function(){this.off("loadstart",l),this.off("loadedmetadata",d),r||this.trigger("loadstart")})}else{const r=["loadstart"];r.push("loadedmetadata"),2<=s.readyState&&r.push("loadeddata"),3<=s.readyState&&r.push("canplay"),4<=s.readyState&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(l){this.trigger(l)},this)})}}setScrubbing(s){this.isScrubbing_=s}scrubbing(){return this.isScrubbing_}setCurrentTime(s){try{this.isScrubbing_&&this.el_.fastSeek&&be?this.el_.fastSeek(s):this.el_.currentTime=s}catch(r){R(r,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Ie&&Le&&this.el_.currentTime===0){const s=()=>{0<this.el_.currentTime&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",s))};return this.on("timeupdate",s),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if("webkitDisplayingFullscreen"in this.el_){const s=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},r=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",s),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",r),this.on("dispose",()=>{this.off("webkitbeginfullscreen",r),this.off("webkitendfullscreen",s)})}}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const s=this.el_;if(s.paused&&s.networkState<=s.HAVE_METADATA)Es(this.el_.play()),this.setTimeout(function(){s.pause();try{s.webkitEnterFullScreen()}catch(r){this.trigger("fullscreenerror",r)}},0);else try{s.webkitEnterFullScreen()}catch(r){this.trigger("fullscreenerror",r)}}exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(s){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(s):super.requestVideoFrameCallback(s)}cancelVideoFrameCallback(s){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(s):super.cancelVideoFrameCallback(s)}src(s){if(s===void 0)return this.el_.src;this.setSrc(s)}reset(){Ne.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(s){this.el_.controls=!!s}addTextTrack(s,r,l){return this.featuresNativeTextTracks?this.el_.addTextTrack(s,r,l):super.addTextTrack(s,r,l)}createRemoteTextTrack(s){var r;return this.featuresNativeTextTracks?(r=document.createElement("track"),s.kind&&(r.kind=s.kind),s.label&&(r.label=s.label),(s.language||s.srclang)&&(r.srclang=s.language||s.srclang),s.default&&(r.default=s.default),s.id&&(r.id=s.id),s.src&&(r.src=s.src),r):super.createRemoteTextTrack(s)}addRemoteTextTrack(s,r){return s=super.addRemoteTextTrack(s,r),this.featuresNativeTextTracks&&this.el().appendChild(s),s}removeRemoteTextTrack(s){if(super.removeRemoteTextTrack(s),this.featuresNativeTextTracks){var r=this.$$("track");let l=r.length;for(;l--;)s!==r[l]&&s!==r[l].track||this.el().removeChild(r[l])}}getVideoPlaybackQuality(){var s;return typeof this.el().getVideoPlaybackQuality=="function"?this.el().getVideoPlaybackQuality():(s={},typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(s.droppedVideoFrames=this.el().webkitDroppedFrameCount,s.totalVideoFrames=this.el().webkitDecodedFrameCount),window.performance&&(s.creationTime=window.performance.now()),s)}}re(Ne,"TEST_VID",function(){var a,s;if(Ue())return a=document.createElement("video"),(s=document.createElement("track")).kind="captions",s.srclang="en",s.label="English",a.appendChild(s),a}),Ne.isSupported=function(){try{Ne.TEST_VID.volume=.5}catch{return!1}return!(!Ne.TEST_VID||!Ne.TEST_VID.canPlayType)},Ne.canPlayType=function(a){return Ne.TEST_VID.canPlayType(a)},Ne.canPlaySource=function(a,s){return Ne.canPlayType(a.type)},Ne.canControlVolume=function(){try{const s=Ne.TEST_VID.volume;Ne.TEST_VID.volume=s/2+.1;var a=s!==Ne.TEST_VID.volume;return a&&Qt?(window.setTimeout(()=>{Ne&&Ne.prototype&&(Ne.prototype.featuresVolumeControl=s!==Ne.TEST_VID.volume)}),!1):a}catch{return!1}},Ne.canMuteVolume=function(){try{var a=Ne.TEST_VID.muted;return Ne.TEST_VID.muted=!a,Ne.TEST_VID.muted?ke(Ne.TEST_VID,"muted","muted"):et(Ne.TEST_VID,"muted"),a!==Ne.TEST_VID.muted}catch{return!1}},Ne.canControlPlaybackRate=function(){if(Ie&&Le&&Ht<58)return!1;try{var a=Ne.TEST_VID.playbackRate;return Ne.TEST_VID.playbackRate=a/2+.1,a!==Ne.TEST_VID.playbackRate}catch{return!1}},Ne.canOverrideAttributes=function(){try{var a=()=>{};Object.defineProperty(document.createElement("video"),"src",{get:a,set:a}),Object.defineProperty(document.createElement("audio"),"src",{get:a,set:a}),Object.defineProperty(document.createElement("video"),"innerHTML",{get:a,set:a}),Object.defineProperty(document.createElement("audio"),"innerHTML",{get:a,set:a})}catch{return!1}return!0},Ne.supportsNativeTextTracks=function(){return be||Qt&&Le},Ne.supportsNativeVideoTracks=function(){return!(!Ne.TEST_VID||!Ne.TEST_VID.videoTracks)},Ne.supportsNativeAudioTracks=function(){return!(!Ne.TEST_VID||!Ne.TEST_VID.audioTracks)},Ne.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([a,s]){re(Ne.prototype,a,()=>Ne[s](),!0)}),Ne.prototype.featuresVolumeControl=Ne.canControlVolume(),Ne.prototype.movingMediaElementInDOM=!Qt,Ne.prototype.featuresFullscreenResize=!0,Ne.prototype.featuresProgressEvents=!0,Ne.prototype.featuresTimeupdateEvents=!0,Ne.prototype.featuresVideoFrameCallback=!(!Ne.TEST_VID||!Ne.TEST_VID.requestVideoFrameCallback),Ne.disposeMediaElement=function(a){if(a){for(a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);if(a.removeAttribute("src"),typeof a.load=="function")try{a.load()}catch{}}},Ne.resetMediaElement=function(a){if(a){var s=a.querySelectorAll("source");let r=s.length;for(;r--;)a.removeChild(s[r]);if(a.removeAttribute("src"),typeof a.load=="function")try{a.load()}catch{}}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(a){Ne.prototype[a]=function(){return this.el_[a]||this.el_.hasAttribute(a)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(a){Ne.prototype["set"+vi(a)]=function(s){(this.el_[a]=s)?this.el_.setAttribute(a,a):this.el_.removeAttribute(a)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(a){Ne.prototype[a]=function(){return this.el_[a]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(a){Ne.prototype["set"+vi(a)]=function(s){this.el_[a]=s}}),["pause","load","play"].forEach(function(a){Ne.prototype[a]=function(){return this.el_[a]()}}),Et.withSourceHandlers(Ne),Ne.nativeSourceHandler={},Ne.nativeSourceHandler.canPlayType=function(a){try{return Ne.TEST_VID.canPlayType(a)}catch{return""}},Ne.nativeSourceHandler.canHandleSource=function(a,s){return a.type?Ne.nativeSourceHandler.canPlayType(a.type):a.src?(a=Mc(a.src),Ne.nativeSourceHandler.canPlayType("video/"+a)):""},Ne.nativeSourceHandler.handleSource=function(a,s,r){s.setSrc(a.src)},Ne.nativeSourceHandler.dispose=function(){},Ne.registerSourceHandler(Ne.nativeSourceHandler),Et.registerTech("Html5",Ne);const id=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],$n={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},r_=["tiny","xsmall","small","medium","large","xlarge","huge"],Of={},JO=(r_.forEach(a=>{var s=a.charAt(0)==="x"?"x-"+a.substring(1):a;Of[a]="vjs-layout-"+s}),{tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0});class ci extends ve{constructor(s,r,f){if(s.id=s.id||r.id||"vjs_video_"+sn++,(r=Object.assign(ci.getTagSettings(s),r)).initChildren=!1,r.createEl=!1,r.evented=!1,r.reportTouchActivity=!1,r.language||(d=s.closest("[lang]"))&&(r.language=d.getAttribute("lang")),super(null,r,f),this.boundDocumentFullscreenChange_=p=>this.documentFullscreenChange_(p),this.boundFullWindowOnEscKey_=p=>this.fullWindowOnEscKey(p),this.boundUpdateStyleEl_=p=>this.updateStyleEl_(p),this.boundApplyInitTime_=p=>this.applyInitTime_(p),this.boundUpdateCurrentBreakpoint_=p=>this.updateCurrentBreakpoint_(p),this.boundHandleTechClick_=p=>this.handleTechClick_(p),this.boundHandleTechDoubleClick_=p=>this.handleTechDoubleClick_(p),this.boundHandleTechTouchStart_=p=>this.handleTechTouchStart_(p),this.boundHandleTechTouchMove_=p=>this.handleTechTouchMove_(p),this.boundHandleTechTouchEnd_=p=>this.handleTechTouchEnd_(p),this.boundHandleTechTap_=p=>this.handleTechTap_(p),this.isFullscreen_=!1,this.log=M(this.id_),this.fsApi_=c,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=s,this.tagAttributes=s&&Oe(s),this.language(this.options_.language),r.languages){const p={};Object.getOwnPropertyNames(r.languages).forEach(function(y){p[y.toLowerCase()]=r.languages[y]}),this.languages_=p}else this.languages_=ci.prototype.options_.languages;this.resetCache_(),this.poster_=r.poster||"",this.controls_=!!r.controls,s.controls=!1,s.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],s.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),r.plugins&&Object.keys(r.plugins).forEach(p=>{if(typeof this[p]!="function")throw new Error(`plugin "${p}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),pl(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(cs(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);var d=se(this.options_),f=(r.plugins&&Object.keys(r.plugins).forEach(p=>{this[p](r.plugins[p])}),r.debug&&this.debug(!0),this.options_.playerOptions=d,this.middleware_=[],this.playbackRates(r.playbackRates),this.initChildren(),this.isAudio(s.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),ei&&this.addClass("vjs-touch-enabled"),Qt||this.addClass("vjs-workinghover"),ci.players[this.id_]=this,i.split(".")[0]);this.addClass("vjs-v"+f),this.userActive(!0),this.reportUserActivity(),this.one("play",p=>this.listenForUserActivity_(p)),this.on("keydown",p=>this.handleKeyDown(p)),this.on("languagechange",p=>this.handleLanguagechange(p)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){var s;this.trigger("dispose"),this.off("dispose"),Ri(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Ri(document,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),ci.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),s=this,jc[s.id()]=null,Ui.names.forEach(r=>{r=this[Ui[r].getterName](),r&&r.off&&r.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let s=this.tag,r,l=this.playerElIngest_=s.parentNode&&s.parentNode.hasAttribute&&s.parentNode.hasAttribute("data-vjs-player");const d=this.tag.tagName.toLowerCase()==="video-js",f=(l?r=this.el_=s.parentNode:d||(r=this.el_=super.createEl("div")),Oe(s));if(d){for(r=this.el_=s,s=this.tag=document.createElement("video");r.children.length;)s.appendChild(r.firstChild);pe(r,"video-js")||_e(r,"video-js"),r.appendChild(s),l=this.playerElIngest_=r,Object.keys(r).forEach(P=>{try{s[P]=r[P]}catch{}})}s.setAttribute("tabindex","-1"),f.tabindex="-1",Le&&_t&&(s.setAttribute("role","application"),f.role="application"),s.removeAttribute("width"),s.removeAttribute("height"),"width"in f&&delete f.width,"height"in f&&delete f.height,Object.getOwnPropertyNames(f).forEach(function(P){d&&P==="class"||r.setAttribute(P,f[P]),d&&s.setAttribute(P,f[P])}),s.playerId=s.id,s.id+="_html5_api",s.className="vjs-tech",(s.player=r.player=this).addClass("vjs-paused"),window.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&(this.styleEl_=Wh("vjs-styles-dimensions"),p=us(".vjs-styles-defaults"),(y=us("head")).insertBefore(this.styleEl_,p?p.nextSibling:y.firstChild)),this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);var p,y,S=s.getElementsByTagName("a");for(let P=0;P<S.length;P++){var A=S.item(P);_e(A,"vjs-hidden"),A.setAttribute("hidden","hidden")}return s.initNetworkState_=s.networkState,s.parentNode&&!l&&s.parentNode.insertBefore(r,s),ne(s,r),this.children_.unshift(s),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=r}crossOrigin(s){if(typeof s>"u")return this.techGet_("crossOrigin");s!==null&&s!=="anonymous"&&s!=="use-credentials"?R.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${s}"`):(this.techCall_("setCrossOrigin",s),this.posterImage&&this.posterImage.crossOrigin(s))}width(s){return this.dimension("width",s)}height(s){return this.dimension("height",s)}dimension(s,r){var l,d=s+"_";if(r===void 0)return this[d]||0;r===""||r==="auto"?(this[d]=void 0,this.updateStyleEl_()):(l=parseFloat(r),isNaN(l)?R.error(`Improper value "${r}" supplied for for `+s):(this[d]=l,this.updateStyleEl_()))}fluid(s){if(s===void 0)return!!this.fluid_;var r;this.fluid_=!!s,Mn(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),s?(this.addClass("vjs-fluid"),this.fill(!1),s=this,r=()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)},Mn(s)?r():(s.eventedCallbacks||(s.eventedCallbacks=[]),s.eventedCallbacks.push(r))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(s){if(s===void 0)return!!this.fill_;this.fill_=!!s,s?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(s){if(s===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(s))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=s,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(window.VIDEOJS_NO_DYNAMIC_STYLE===!0){const r=typeof this.width_=="number"?this.width_:this.options_.width,l=typeof this.height_=="number"?this.height_:this.options_.height;var s=this.tech_&&this.tech_.el();s&&(0<=r&&(s.width=r),0<=l)&&(s.height=l)}else{let r,l,d;s=(this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),s=s[1]/s[0],r=this.width_!==void 0?this.width_:this.height_!==void 0?this.height_/s:this.videoWidth()||300,l=this.height_!==void 0?this.height_:r*s,d=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(d),Gh(this.styleEl_,`
      .${d} {
        width: ${r}px;
        height: ${l}px;
      }

      .${d}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${100*s}%;
      }
    `)}}loadTech_(s,r){this.tech_&&this.unloadTech_();var l=vi(s),d=s.charAt(0).toLowerCase()+s.slice(1);l!=="Html5"&&this.tag&&(Et.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=l,this.isReady_=!1;let f=this.autoplay();const p={source:r,autoplay:f=typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay?!1:f,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+`_${d}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};if(Ui.names.forEach(y=>{y=Ui[y],p[y.getterName]=this[y.privateName]}),Object.assign(p,this.options_[l]),Object.assign(p,this.options_[d]),Object.assign(p,this.options_[s.toLowerCase()]),this.tag&&(p.tag=this.tag),r&&r.src===this.cache_.src&&0<this.cache_.currentTime&&(p.startTime=this.cache_.currentTime),d=Et.getTech(s),!d)throw new Error(`No Tech named '${l}' exists! '${l}' should be registered using videojs.registerTech()'`);this.tech_=new d(p),this.tech_.ready(Yt(this,this.handleTechReady_),!0),Yh(this.textTracksJson_||[],this.tech_),id.forEach(y=>{this.on(this.tech_,y,S=>this[`handleTech${vi(y)}_`](S))}),Object.keys($n).forEach(y=>{this.on(this.tech_,y,S=>{this.tech_.playbackRate()===0&&this.tech_.seeking()?this.queuedCallbacks_.push({callback:this[`handleTech${$n[y]}_`].bind(this),event:S}):this[`handleTech${$n[y]}_`](S)})}),this.on(this.tech_,"loadstart",y=>this.handleTechLoadStart_(y)),this.on(this.tech_,"sourceset",y=>this.handleTechSourceset_(y)),this.on(this.tech_,"waiting",y=>this.handleTechWaiting_(y)),this.on(this.tech_,"ended",y=>this.handleTechEnded_(y)),this.on(this.tech_,"seeking",y=>this.handleTechSeeking_(y)),this.on(this.tech_,"play",y=>this.handleTechPlay_(y)),this.on(this.tech_,"pause",y=>this.handleTechPause_(y)),this.on(this.tech_,"durationchange",y=>this.handleTechDurationChange_(y)),this.on(this.tech_,"fullscreenchange",(y,S)=>this.handleTechFullscreenChange_(y,S)),this.on(this.tech_,"fullscreenerror",(y,S)=>this.handleTechFullscreenError_(y,S)),this.on(this.tech_,"enterpictureinpicture",y=>this.handleTechEnterPictureInPicture_(y)),this.on(this.tech_,"leavepictureinpicture",y=>this.handleTechLeavePictureInPicture_(y)),this.on(this.tech_,"error",y=>this.handleTechError_(y)),this.on(this.tech_,"posterchange",y=>this.handleTechPosterChange_(y)),this.on(this.tech_,"textdata",y=>this.handleTechTextData_(y)),this.on(this.tech_,"ratechange",y=>this.handleTechRateChange_(y)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||l==="Html5"&&this.tag||ne(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Ui.names.forEach(s=>{s=Ui[s],this[s.privateName]=this[s.getterName]()}),this.textTracksJson_=Pc(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(s){return s===void 0&&R.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()&&this.hasStarted(!1),this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(s){if(this.tech_&&typeof s=="string"){var r=()=>{const d=this.muted(),f=(this.muted(!0),()=>{this.muted(d)});this.playTerminatedQueue_.push(f);var p=this.play();if(Fn(p))return p.catch(y=>{throw f(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(y||""))})};let l;if(s!=="any"||this.muted()?l=s!=="muted"||this.muted()?this.play():r():Fn(l=this.play())&&(l=l.catch(r)),Fn(l))return l.then(()=>{this.trigger({type:"autoplay-success",autoplay:s})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:s})})}}updateSourceCaches_(d=""){let r=d,l="";typeof r!="string"&&(r=d.src,l=d.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],r&&!l&&(l=((A,P)=>{if(!P)return"";if(A.cache_.source.src===P&&A.cache_.source.type)return A.cache_.source.type;var L=A.cache_.sources.filter(K=>K.src===P);if(L.length)return L[0].type;var B=A.$$("source");for(let K=0;K<B.length;K++){var F=B[K];if(F.type&&F.src&&F.src===P)return F.type}return cr(P)})(this,r)),this.cache_.source=se({},d,{src:r,type:l});var d=this.cache_.sources.filter(A=>A.src&&A.src===r),f=[],p=this.$$("source"),y=[];for(let A=0;A<p.length;A++){var S=Oe(p[A]);f.push(S),S.src&&S.src===r&&y.push(S.src)}y.length&&!d.length?this.cache_.sources=f:d.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=r}handleTechSourceset_(s){if(!this.changingSrc_){let d=f=>this.updateSourceCaches_(f);var r=this.currentSource().src,l=s.src;(d=!r||/^blob:/.test(r)||!/^blob:/.test(l)||this.lastSource_&&(this.lastSource_.tech===l||this.lastSource_.player===r)?d:()=>{})(l),s.src||this.tech_.any(["sourceset","loadstart"],f=>{f.type!=="sourceset"&&(f=this.techGet("currentSrc"),this.lastSource_.tech=f,this.updateSourceCaches_(f))})}this.lastSource_={player:this.currentSource().src,tech:s.src},this.trigger({src:s.src,type:"sourceset"})}hasStarted(s){if(s===void 0)return this.hasStarted_;s!==this.hasStarted_&&(this.hasStarted_=s,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){0<this.tech_.playbackRate()&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(s=>s.callback(s.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const s=this.currentTime(),r=()=>{s!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",r))};this.on("timeupdate",r)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(s){!this.controls_||this.options_!==void 0&&this.options_.userActions!==void 0&&this.options_.userActions.click!==void 0&&this.options_.userActions.click===!1||(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,s):this.paused()?Es(this.play()):this.pause())}handleTechDoubleClick_(s){!this.controls_||Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),r=>r.contains(s.target))||this.options_!==void 0&&this.options_.userActions!==void 0&&this.options_.userActions.doubleClick!==void 0&&this.options_.userActions.doubleClick===!1||(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,s):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(s){s.cancelable&&s.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(s){if(s=s.target.player,!s||s===this){s=this.el();let r=document[this.fsApi_.fullscreenElement]===s;!r&&s.matches?r=s.matches(":"+this.fsApi_.fullscreen):!r&&s.msMatchesSelector&&(r=s.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}}handleTechFullscreenChange_(s,r){r&&(r.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(r.isFullscreen))}handleTechFullscreenError_(s,r){this.trigger("fullscreenerror",r)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(s){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(s){this.isInPictureInPicture(!1)}handleTechError_(){var s=this.tech_.error();this.error(s)}handleTechTextData_(){let s=1<arguments.length?arguments[1]:null;this.trigger("textdata",s)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(s,r){this.ready(function(){if(s in Yg)return l=this.middleware_,this.tech_[s](l.reduce(Gr(s),r));if(s in Hc)return hf(this.middleware_,this.tech_,s,r);var l;try{this.tech_&&this.tech_[s](r)}catch(d){throw R(d),d}},!0)}techGet_(s){if(this.tech_&&this.tech_.isReady_){if(s in ff)return r=this.middleware_,l=this.tech_,r.reduceRight(Gr(s),l[s]());if(s in Hc)return hf(this.middleware_,this.tech_,s);var r,l;try{return this.tech_[s]()}catch(d){throw this.tech_[s]===void 0?R(`Video.js: ${s} method not defined for ${this.techName_} playback technology.`,d):d.name==="TypeError"?(R(`Video.js: ${s} unavailable on ${this.techName_} playback technology element.`,d),this.tech_.isReady_=!1):R(d),d}}}play(){return new Promise(s=>{this.play_(s)})}play_(l=Es){this.playCallbacks_.push(l);var r,l=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),this.isReady_&&l?(r=this.techGet_("play"))===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r):(this.waitToPlay_=d=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),l||!be&&!Qt||this.load())}runPlayTerminatedQueue_(){var s=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],s.forEach(function(r){r()})}runPlayCallbacks_(s){var r=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],r.forEach(function(l){l(s)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||ds(0,0)}scrubbing(s){if(typeof s>"u")return this.scrubbing_;this.scrubbing_=!!s,this.techCall_("setScrubbing",this.scrubbing_),s?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(s){return typeof s<"u"?(s<0&&(s=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",s),void(this.cache_.initTime=0)):(this.cache_.initTime=s,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(s){if(s===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;(s=(s=parseFloat(s))<0?1/0:s)!==this.cache_.duration&&((this.cache_.duration=s)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(s)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let s=this.techGet_("buffered");return s=s&&s.length?s:ds(0,0)}bufferedPercent(){return Bs(this.buffered(),this.duration())}bufferedEnd(){var s=this.buffered(),r=this.duration();let l=s.end(s.length-1);return l=l>r?r:l}volume(s){let r;if(s===void 0)return r=parseFloat(this.techGet_("volume")),isNaN(r)?1:r;r=Math.max(0,Math.min(1,parseFloat(s))),this.cache_.volume=r,this.techCall_("setVolume",r),0<r&&this.lastVolume_(r)}muted(s){if(s===void 0)return this.techGet_("muted")||!1;this.techCall_("setMuted",s)}defaultMuted(s){return s!==void 0?this.techCall_("setDefaultMuted",s):this.techGet_("defaultMuted")||!1}lastVolume_(s){if(s===void 0||s===0)return this.cache_.lastVolume;this.cache_.lastVolume=s}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(s){var r;if(s===void 0)return this.isFullscreen_;r=this.isFullscreen_,this.isFullscreen_=Boolean(s),this.isFullscreen_!==r&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_()}requestFullscreen(s){this.isInPictureInPicture()&&this.exitPictureInPicture();const r=this;return new Promise((l,d)=>{function f(){r.off("fullscreenerror",y),r.off("fullscreenchange",p)}function p(){f(),l()}function y(A,P){f(),d(P)}r.one("fullscreenchange",p),r.one("fullscreenerror",y);var S=r.requestFullscreenHelper_(s);S&&(S.then(f,f),S.then(l,d))})}requestFullscreenHelper_(s){let r;if(this.fsApi_.prefixed||(r=this.options_.fullscreen&&this.options_.fullscreen.options||{},s!==void 0&&(r=s)),this.fsApi_.requestFullscreen)return(s=this.el_[this.fsApi_.requestFullscreen](r))&&s.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),s;this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const s=this;return new Promise((r,l)=>{function d(){s.off("fullscreenerror",p),s.off("fullscreenchange",f)}function f(){d(),r()}function p(S,A){d(),l(A)}s.one("fullscreenchange",f),s.one("fullscreenerror",p);var y=s.exitFullscreenHelper_();y&&(y.then(d,d),y.then(r,l))})}exitFullscreenHelper_(){var s;if(this.fsApi_.requestFullscreen)return(s=document[this.fsApi_.exitFullscreen]())&&Es(s.then(()=>this.isFullscreen(!1))),s;this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,cs(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow="hidden",_e(document.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(s){ut.isEventKey(s,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,Ri(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow=this.docOrigOverflow,Ce(document.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(s){if(s===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",s),this.options_.disablePictureInPicture=s,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(s){if(s===void 0)return!!this.isInPictureInPicture_;this.isInPictureInPicture_=!!s,this.togglePictureInPictureClass_()}requestPictureInPicture(){if("pictureInPictureEnabled"in document&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")}exitPictureInPicture(){if("pictureInPictureEnabled"in document)return document.exitPictureInPicture()}handleKeyDown(s){var r,l,d=this.options_.userActions;d&&d.hotkeys&&(r=this.el_.ownerDocument.activeElement,l=r.tagName.toLowerCase(),r.isContentEditable||(l==="input"?["button","checkbox","hidden","radio","reset","submit"].indexOf(r.type)===-1:["textarea"].indexOf(l)!==-1)||(typeof d.hotkeys=="function"?d.hotkeys.call(this,s):this.handleHotkeys(s)))}handleHotkeys(s){var{fullscreenKey:r=f=>ut.isEventKey(f,"f"),muteKey:l=f=>ut.isEventKey(f,"m"),playPauseKey:d=f=>ut.isEventKey(f,"k")||ut.isEventKey(f,"Space")}=this.options_.userActions?this.options_.userActions.hotkeys:{};r.call(this,s)?(s.preventDefault(),s.stopPropagation(),r=ve.getComponent("FullscreenToggle"),document[this.fsApi_.fullscreenEnabled]!==!1&&r.prototype.handleClick.call(this,s)):l.call(this,s)?(s.preventDefault(),s.stopPropagation(),ve.getComponent("MuteToggle").prototype.handleClick.call(this,s)):d.call(this,s)&&(s.preventDefault(),s.stopPropagation(),ve.getComponent("PlayToggle").prototype.handleClick.call(this,s))}canPlayType(s){var r;for(let d=0,f=this.options_.techOrder;d<f.length;d++){var l=f[d];let p=Et.getTech(l);if(p=p||ve.getComponent(l)){if(p.isSupported()&&(r=p.canPlayType(s)))return r}else R.error(`The "${l}" tech is undefined. Skipped browser support check for that tech.`)}return""}selectSource(s){function r(p,y,S){let A;return p.some(P=>y.some(L=>{if(A=S(P,L))return!0})),A}var l=this.options_.techOrder.map(p=>[p,Et.getTech(p)]).filter(([p,y])=>y?y.isSupported():(R.error(`The "${p}" tech is undefined. Skipped browser support check for that tech.`),!1)),d,f=([p,y],S)=>{if(y.canPlaySource(S,this.options_[p.toLowerCase()]))return{source:S,tech:p}};return(this.options_.sourceOrder?r(s,l,(d=f,(p,y)=>d(y,p))):r(l,s,f))||!1}handleSrc_(s,r){if(typeof s>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const l=mf(s);if(l.length){if(this.changingSrc_=!0,r||(this.cache_.sources=l),this.updateSourceCaches_(l[0]),df(this,l[0],(d,f)=>{var p;if(this.middleware_=f,r||(this.cache_.sources=l),this.updateSourceCaches_(d),this.src_(d))return 1<l.length?this.handleSrc_(l.slice(1)):(this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),void this.triggerReady());p=this.tech_,f.forEach(y=>y.setTech&&y.setTech(p))}),1<l.length){const d=()=>{this.error(null),this.handleSrc_(l.slice(1),!0)},f=()=>{this.off("error",d)};this.one("error",d),this.one("playing",f),this.resetRetryOnError_=()=>{this.off("error",d),this.off("playing",f)}}}else this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0)}src(s){return this.handleSrc_(s,!1)}src_(s){var r=this.selectSource([s]);return!r||(Kh(r.tech,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",s):this.techCall_("src",s.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready(()=>{this.changingSrc_=!1})),!1)}load(){this.techCall_("load")}reset(){this.paused()?this.doReset_():Es(this.play().then(()=>this.doReset_()))}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Mn(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);var{durationDisplay:s,remainingTimeDisplay:r}=this.controlBar||{};s&&s.updateContent(),r&&r.updateContent()}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){var s=this.currentSource(),r=[];return Object.keys(s).length!==0&&r.push(s),this.cache_.sources||r}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(s){if(s===void 0)return this.techGet_("preload");this.techCall_("setPreload",s),this.options_.preload=s}autoplay(s){if(s===void 0)return this.options_.autoplay||!1;let r;typeof s=="string"&&/(any|play|muted)/.test(s)||s===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=s,this.manualAutoplay_(typeof s=="string"?s:"play"),r=!1):this.options_.autoplay=!!s,r=typeof r>"u"?this.options_.autoplay:r,this.tech_&&this.techCall_("setAutoplay",r)}playsinline(s){return s!==void 0?(this.techCall_("setPlaysinline",s),this.options_.playsinline=s,this):this.techGet_("playsinline")}loop(s){if(s===void 0)return this.techGet_("loop");this.techCall_("setLoop",s),this.options_.loop=s}poster(s){if(s===void 0)return this.poster_;(s=s||"")!==this.poster_&&(this.poster_=s,this.techCall_("setPoster",s),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){var s;(!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster&&(s=this.tech_.poster()||"")!==this.poster_&&(this.poster_=s,this.isPosterFromTech_=!0,this.trigger("posterchange"))}controls(s){if(s===void 0)return!!this.controls_;this.controls_!==(s=!!s)&&(this.controls_=s,this.usingNativeControls()&&this.techCall_("setControls",s),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(s){if(s===void 0)return!!this.usingNativeControls_;this.usingNativeControls_!==(s=!!s)&&(this.usingNativeControls_=s,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(s){if(s===void 0)return this.error_||null;if(o("beforeerror").forEach(r=>{r=r(this,s),W(r)&&!Array.isArray(r)||typeof r=="string"||typeof r=="number"||r===null?s=r:this.log.error("please return a value that MediaError expects in beforeerror hooks")}),this.options_.suppressNotSupportedError&&s&&s.code===4){const r=function(){this.error(s)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],r),this.one("loadstart",function(){this.off(["click","touchstart"],r)})}else s===null?(this.error_=s,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close()):(this.error_=new ss(s),this.addClass("vjs-error"),R.error(`(CODE:${this.error_.code} ${ss.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),o("error").forEach(r=>r(this,this.error_)))}reportUserActivity(s){this.userActivity_=!0}userActive(s){if(s===void 0)return this.userActive_;(s=!!s)!==this.userActive_&&(this.userActive_=s,this.userActive_?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.tech_&&this.tech_.one("mousemove",function(r){r.stopPropagation(),r.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")))}listenForUserActivity_(){let s,r,l;const d=Yt(this,this.reportUserActivity);function f(S){d(),this.clearInterval(s)}this.on("mousedown",function(){d(),this.clearInterval(s),s=this.setInterval(d,250)}),this.on("mousemove",function(S){S.screenX===r&&S.screenY===l||(r=S.screenX,l=S.screenY,d())}),this.on("mouseup",f),this.on("mouseleave",f);var p=this.getChild("controlBar");!p||Qt||Ie||(p.on("mouseenter",function(S){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),p.on("mouseleave",function(S){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",d),this.on("keyup",d);let y;this.setInterval(function(){var S;this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),this.clearTimeout(y),(S=this.options_.inactivityTimeout)<=0||(y=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},S)))},250)}playbackRate(s){if(s===void 0)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",s)}defaultPlaybackRate(s){return s!==void 0?this.techCall_("setDefaultPlaybackRate",s):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(s){if(s===void 0)return!!this.isAudio_;this.isAudio_=!!s}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");var s=this.children();const r=this.getChild("ControlBar");var l=r&&r.currentHeight();s.forEach(d=>{d!==r&&d.el_&&!d.hasClass("vjs-hidden")&&(d.hide(),this.audioOnlyCache_.hiddenChildren.push(d))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(l),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(s=>s.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(s){return typeof s!="boolean"||s===this.audioOnlyMode_?this.audioOnlyMode_:(this.audioOnlyMode_=s)?(s=[],this.isInPictureInPicture()&&s.push(this.exitPictureInPicture()),this.isFullscreen()&&s.push(this.exitFullscreen()),this.audioPosterMode()&&s.push(this.audioPosterMode(!1)),Promise.all(s).then(()=>this.enableAudioOnlyUI_())):Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(s){return typeof s!="boolean"||s===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=s)?(this.audioOnlyMode()?this.audioOnlyMode(!1):Promise.resolve()).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()})}addTextTrack(s,r,l){if(this.tech_)return this.tech_.addTextTrack(s,r,l)}addRemoteTextTrack(s,r){if(this.tech_)return this.tech_.addRemoteTextTrack(s,r)}removeRemoteTextTrack(s={}){let r=s.track;if(r=r||s,this.tech_)return this.tech_.removeRemoteTextTrack(r)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(s){if(s===void 0)return this.language_;this.language_!==String(s).toLowerCase()&&(this.language_=String(s).toLowerCase(),Mn(this))&&this.trigger("languagechange")}languages(){return se(ci.prototype.options_.languages,this.languages_)}toJSON(){var s=se(this.options_),r=s.tracks;s.tracks=[];for(let d=0;d<r.length;d++){var l=r[d];(l=se(l)).player=void 0,s.tracks[d]=l}return s}createModal(s,r){(r=r||{}).content=s||"";const l=new Oa(this,r);return this.addChild(l),l.on("dispose",()=>{this.removeChild(l)}),l.open(),l}updateCurrentBreakpoint_(){if(this.responsive()){var s=this.currentBreakpoint(),r=this.currentWidth();for(let d=0;d<r_.length;d++){var l=r_[d];if(r<=this.breakpoints_[l]){if(s===l)return;s&&this.removeClass(Of[s]),this.addClass(Of[l]),this.breakpoint_=l;break}}}}removeCurrentBreakpoint_(){var s=this.currentBreakpointClass();this.breakpoint_="",s&&this.removeClass(s)}breakpoints(s){return s!==void 0&&(this.breakpoint_="",this.breakpoints_=Object.assign({},JO,s),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}responsive(s){return s===void 0?this.responsive_:(s=Boolean(s))!==this.responsive_?((this.responsive_=s)?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),s):void 0}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Of[this.breakpoint_]||""}loadMedia(s,r){var l,d,f,p,y,S;s&&typeof s=="object"&&(this.reset(),this.cache_.media=se(s),{artist:s,artwork:l,description:d,poster:f,src:p,textTracks:y,title:S}=this.cache_.media,!l&&f&&(this.cache_.media.artwork=[{src:f,type:cr(f)}]),p&&this.src(p),f&&this.poster(f),Array.isArray(y)&&y.forEach(A=>this.addRemoteTextTrack(A,!1)),this.titleBar&&this.titleBar.update({title:S,description:d||s||""}),this.ready(r))}getMedia(){var s,r;return this.cache_.media?se(this.cache_.media):(s=this.poster(),r={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),l=>({kind:l.kind,label:l.label,language:l.language,src:l.src}))},s&&(r.poster=s,r.artwork=[{src:r.poster,type:cr(r.poster)}]),r)}static getTagSettings(s){var r,l={sources:[],tracks:[]},d=Oe(s),f=d["data-setup"];if(pe(s,"vjs-fill")&&(d.fill=!0),pe(s,"vjs-fluid")&&(d.fluid=!0),f!==null&&([f,r]=gl(f||"{}"),f&&R.error(f),Object.assign(d,r)),Object.assign(l,d),s.hasChildNodes()){var p=s.childNodes;for(let A=0,P=p.length;A<P;A++){var y=p[A],S=y.nodeName.toLowerCase();S==="source"?l.sources.push(Oe(y)):S==="track"&&l.tracks.push(Oe(y))}}return l}debug(s){if(s===void 0)return this.debugEnabled_;s?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(s){if(s===void 0)return this.cache_.playbackRates;Array.isArray(s)&&s.every(r=>typeof r=="number")&&(this.cache_.playbackRates=s,this.trigger("playbackrateschange"))}}Ui.names.forEach(function(a){const s=Ui[a];ci.prototype[s.getterName]=function(){return this.tech_?this.tech_[s.getterName]():(this[s.privateName]=this[s.privateName]||new s.ListClass,this[s.privateName])}}),ci.prototype.crossorigin=ci.prototype.crossOrigin,ci.players={},J=window.navigator,ci.prototype.options_={techOrder:Et.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:J&&(J.languages&&J.languages[0]||J.userLanguage||J.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(a){ci.prototype[a]=function(){return this.techGet_(a)}}),id.forEach(function(a){ci.prototype[`handleTech${vi(a)}_`]=function(){return this.trigger(a)}}),ve.registerComponent("Player",ci);function ZO(a,s){function r(){Nf(this,{name:a,plugin:s,instance:null},!0);var l=s.apply(this,arguments);return KT(this,a),Nf(this,{name:a,plugin:s,instance:l}),l}return Object.keys(s).forEach(function(l){r[l]=s[l]}),r}const Df="plugin",Ul="activePlugins_",Bl={},Pf=a=>Bl.hasOwnProperty(a),Lf=a=>Pf(a)?Bl[a]:void 0,KT=(a,s)=>{a[Ul]=a[Ul]||{},a[Ul][s]=!0},Nf=(a,s,r)=>{r=(r?"before":"")+"pluginsetup",a.trigger(r,s),a.trigger(r+":"+s.name,s)},XT=(a,s)=>(s.prototype.name=a,function(...r){Nf(this,{name:a,plugin:s,instance:null},!0);const l=new s(this,...r);return this[a]=()=>l,Nf(this,l.getEventHash()),l});class js{constructor(s){if(this.constructor===js)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=s,this.log||(this.log=this.player.log.createLogger(this.name)),pl(this),delete this.trigger,ml(this,this.constructor.defaultState),KT(s,this.name),this.dispose=this.dispose.bind(this),s.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(s={}){return s.name=this.name,s.plugin=this.constructor,s.instance=this,s}trigger(s,r={}){return Rn(this.eventBusEl_,s,this.getEventHash(r))}handleStateChanged(s){}dispose(){var{name:s,player:r}=this;this.trigger("dispose"),this.off(),r.off("dispose",this.dispose),r[Ul][s]=!1,this.player=this.state=null,r[s]=XT(s,Bl[s])}static isBasic(s){return s=typeof s=="string"?Lf(s):s,typeof s=="function"&&!js.prototype.isPrototypeOf(s.prototype)}static registerPlugin(s,r){if(typeof s!="string")throw new Error(`Illegal plugin name, "${s}", must be a string, was ${typeof s}.`);if(Pf(s))R.warn(`A plugin named "${s}" already exists. You may want to avoid re-registering plugins!`);else if(ci.prototype.hasOwnProperty(s))throw new Error(`Illegal plugin name, "${s}", cannot share a name with an existing player method!`);if(typeof r!="function")throw new Error(`Illegal plugin for "${s}", must be a function, was ${typeof r}.`);return Bl[s]=r,s!==Df&&(js.isBasic(r)?ci.prototype[s]=ZO(s,r):ci.prototype[s]=XT(s,r)),r}static deregisterPlugin(s){if(s===Df)throw new Error("Cannot de-register base plugin.");Pf(s)&&(delete Bl[s],delete ci.prototype[s])}static getPlugins(s=Object.keys(Bl)){let r;return s.forEach(l=>{var d=Lf(l);d&&((r=r||{})[l]=d)}),r}static getPluginVersion(s){return s=Lf(s),s&&s.VERSION||""}}function jn(a,s,r,l){{var d=s+` is deprecated and will be removed in ${a}.0; please use ${r} instead.`,f=l;let p=!1;return function(...y){return p||R.warn(d),p=!0,f.apply(this,y)}}}js.getPlugin=Lf,js.BASE_PLUGIN_NAME=Df,js.registerPlugin(Df,js),ci.prototype.usingPlugin=function(a){return!!this[Ul]&&this[Ul][a]===!0},ci.prototype.hasPlugin=function(a){return!!Pf(a)};const YT=a=>a.indexOf("#")===0?a.slice(1):a;function fe(a,s,r){let l=fe.getPlayer(a);if(l)s&&R.warn(`Player "${a}" is already initialised. Options will not be applied.`),r&&l.ready(r);else{const d=typeof a=="string"?us("#"+YT(a)):a;if(!Xe(d))throw new TypeError("The element or ID supplied is not valid. (videojs)");d.ownerDocument.defaultView&&d.ownerDocument.body.contains(d)||R.warn("The element supplied is not included in the DOM"),(s=s||{}).restoreEl===!0&&(s.restoreEl=(d.parentNode&&d.parentNode.hasAttribute("data-vjs-player")?d.parentNode:d).cloneNode(!0)),o("beforesetup").forEach(f=>{f=f(d,se(s)),!W(f)||Array.isArray(f)?R.error("please return an object in beforesetup hooks"):s=se(s,f)}),a=ve.getComponent("Player"),l=new a(d,s,r),o("setup").forEach(f=>f(l))}return l}fe.hooks_=n,fe.hooks=o,fe.hook=function(a,s){o(a,s)},fe.hookOnce=function(a,s){o(a,[].concat(s).map(r=>{const l=(...d)=>(u(a,l),r(...d));return l}))},fe.removeHook=u,window.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Ue()&&!($=us(".vjs-styles-defaults"))&&($=Wh("vjs-styles-defaults"),(Y=us("head"))&&Y.insertBefore($,Y.firstChild),Gh($,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)),Sc(1,fe),fe.VERSION=i,fe.options=ci.prototype.options_,fe.getPlayers=()=>ci.players,fe.getPlayer=a=>{var s=ci.players;let r;if(typeof a=="string"){var l=YT(a),d=s[l];if(d)return d;r=us("#"+l)}else r=a;if(Xe(r)){var{player:d,playerId:l}=r;if(d||s[l])return d||s[l]}},fe.getAllPlayers=()=>Object.keys(ci.players).map(a=>ci.players[a]).filter(Boolean),fe.players=ci.players,fe.getComponent=ve.getComponent,fe.registerComponent=(a,s)=>{Et.isTech(s)&&R.warn(`The ${a} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),ve.registerComponent.call(ve,a,s)},fe.getTech=Et.getTech,fe.registerTech=Et.registerTech,fe.use=function(a,s){ur[a]=ur[a]||[],ur[a].push(s)},Object.defineProperty(fe,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(fe.middleware,"TERMINATOR",{value:Sl,writeable:!1,enumerable:!0}),fe.browser=Mt,fe.obj=ie,fe.mergeOptions=jn(9,"videojs.mergeOptions","videojs.obj.merge",se),fe.defineLazyProperty=jn(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",re),fe.bind=jn(9,"videojs.bind","native Function.prototype.bind",Yt),fe.registerPlugin=js.registerPlugin,fe.deregisterPlugin=js.deregisterPlugin,fe.plugin=(a,s)=>(R.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),js.registerPlugin(a,s)),fe.getPlugins=js.getPlugins,fe.getPlugin=js.getPlugin,fe.getPluginVersion=js.getPluginVersion,fe.addLanguage=function(a,s){return a=(""+a).toLowerCase(),fe.options.languages=se(fe.options.languages,{[a]:s}),fe.options.languages[a]},fe.log=R,fe.createLogger=M,fe.time=Dc,fe.createTimeRange=jn(9,"videojs.createTimeRange","videojs.time.createTimeRanges",ds),fe.createTimeRanges=jn(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",ds),fe.formatTime=jn(9,"videojs.formatTime","videojs.time.formatTime",Bn),fe.setFormatTime=jn(9,"videojs.setFormatTime","videojs.time.setFormatTime",go),fe.resetFormatTime=jn(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Xh),fe.parseUrl=jn(9,"videojs.parseUrl","videojs.url.parseUrl",Vr),fe.isCrossOrigin=jn(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",yl),fe.EventTarget=is,fe.any=Cc,fe.on=cs,fe.one=$i,fe.off=Ri,fe.trigger=Rn,fe.xhr=Uc,fe.TextTrack=bo,fe.AudioTrack=of,fe.VideoTrack=lf,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(a=>{fe[a]=function(){return R.warn(`videojs.${a}() is deprecated; use videojs.dom.${a}() instead`),co[a].apply(null,arguments)}}),fe.computedStyle=jn(9,"videojs.computedStyle","videojs.dom.computedStyle",Fi),fe.dom=co,fe.fn=qt,fe.num=gi,fe.str=Bg,fe.url=ef,ka(function(a,s){/*! @name videojs-contrib-quality-levels @version 3.0.0 @license Apache-2.0 */a.exports=function(r){function l(L){return L&&typeof L=="object"&&"default"in L?L:{default:L}}var d=l(r);class f{constructor(B){let F=this;return F.id=B.id,F.label=F.id,F.width=B.width,F.height=B.height,F.bitrate=B.bandwidth,F.frameRate=B.frameRate,F.enabled_=B.enabled,Object.defineProperty(F,"enabled",{get(){return F.enabled_()},set(K){F.enabled_(K)}}),F}}class p extends d.default.EventTarget{constructor(){super();let B=this;return B.levels_=[],B.selectedIndex_=-1,Object.defineProperty(B,"selectedIndex",{get(){return B.selectedIndex_}}),Object.defineProperty(B,"length",{get(){return B.levels_.length}}),B}addQualityLevel(B){let F=this.getQualityLevelById(B.id);if(F)return F;const K=this.levels_.length;return F=new f(B),""+K in this||Object.defineProperty(this,K,{get(){return this.levels_[K]}}),this.levels_.push(F),this.trigger({qualityLevel:F,type:"addqualitylevel"}),F}removeQualityLevel(B){let F=null;for(let K=0,Q=this.length;K<Q;K++)if(this[K]===B){F=this.levels_.splice(K,1)[0],this.selectedIndex_===K?this.selectedIndex_=-1:this.selectedIndex_>K&&this.selectedIndex_--;break}return F&&this.trigger({qualityLevel:B,type:"removequalitylevel"}),F}getQualityLevelById(B){for(let F=0,K=this.length;F<K;F++){const Q=this[F];if(Q.id===B)return Q}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}p.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const L in p.prototype.allowedEvents_)p.prototype["on"+L]=null;var y="3.0.0";const S=d.default.registerPlugin||d.default.plugin,A=function(L,B){const F=L.qualityLevels,K=new p,Q=function(){K.dispose(),L.qualityLevels=F,L.off("dispose",Q)};return L.on("dispose",Q),L.qualityLevels=()=>K,L.qualityLevels.VERSION=y,K},P=function(L){return A(this,d.default.mergeOptions({},L))};return S("qualityLevels",P),P.VERSION=y,P}(fe)});var Rf=ka(function(a,s){var r,l,d,f,p;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,l=/^(?=([^\/?#]*))\1([^]*)$/,d=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(B,S,A){if(A=A||{},B=B.trim(),!(S=S.trim())){if(!A.alwaysNormalize)return B;var P=p.parseURL(B);if(P)return P.path=p.normalizePath(P.path),p.buildURLFromParts(P);throw new Error("Error trying to parse base URL.")}if(P=p.parseURL(S),!P)throw new Error("Error trying to parse relative URL.");if(P.scheme)return A.alwaysNormalize?(P.path=p.normalizePath(P.path),p.buildURLFromParts(P)):S;if(S=p.parseURL(B),!S)throw new Error("Error trying to parse base URL.");!S.netLoc&&S.path&&S.path[0]!=="/"&&(B=l.exec(S.path),S.netLoc=B[1],S.path=B[2]),S.netLoc&&!S.path&&(S.path="/");var L,B={scheme:S.scheme,netLoc:P.netLoc,path:null,params:P.params,query:P.query,fragment:P.fragment};return P.netLoc||(B.netLoc=S.netLoc,P.path[0]!=="/"&&(P.path?(L=(L=S.path).substring(0,L.lastIndexOf("/")+1)+P.path,B.path=p.normalizePath(L)):(B.path=S.path,P.params||(B.params=S.params,P.query)||(B.query=S.query)))),B.path===null&&(B.path=A.alwaysNormalize?p.normalizePath(P.path):P.path),p.buildURLFromParts(B)},parseURL:function(y){return y=r.exec(y),y?{scheme:y[1]||"",netLoc:y[2]||"",path:y[3]||"",params:y[4]||"",query:y[5]||"",fragment:y[6]||""}:null},normalizePath:function(y){for(y=y.split("").reverse().join("").replace(d,"");y.length!==(y=y.replace(f,"")).length;);return y.split("").reverse().join("")},buildURLFromParts:function(y){return y.scheme+y.netLoc+y.path+y.params+y.query+y.fragment}},a.exports=p}),QT="http://example.com",Fl=function(){function a(){this.listeners={}}var s=a.prototype;return s.on=function(r,l){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(l)},s.off=function(r,l){return!!this.listeners[r]&&(l=this.listeners[r].indexOf(l),this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(l,1),-1<l)},s.trigger=function(r){var l=this.listeners[r];if(l)if(arguments.length===2)for(var d=l.length,f=0;f<d;++f)l[f].call(this,arguments[1]);else for(var p=Array.prototype.slice.call(arguments,1),y=l.length,S=0;S<y;++S)l[S].apply(this,p)},s.dispose=function(){this.listeners={}},s.pipe=function(r){this.on("data",function(l){r.push(l)})},a}();function eD(a){a=a;for(var s=window.atob?window.atob(a):Buffer.from(a,"base64").toString("binary"),r=new Uint8Array(s.length),l=0;l<s.length;l++)r[l]=s.charCodeAt(l);return r}/*! @name m3u8-parser @version 6.0.0 @license Apache-2.0 */class tD extends Fl{constructor(){super(),this.buffer=""}push(s){let r;for(this.buffer+=s,r=this.buffer.indexOf(`
`);-1<r;r=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,r)),this.buffer=this.buffer.substring(r+1)}}function a_(s){var s=/([0-9.]*)?@?([0-9.]*)?/.exec(s||""),r={};return s[1]&&(r.length=parseInt(s[1],10)),s[2]&&(r.offset=parseInt(s[2],10)),r}function Hn(a){var s={};if(a){var r,l=a.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let d=l.length;for(;d--;)l[d]!==""&&((r=/([^=]*)=(.*)/.exec(l[d]).slice(1))[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),s[r[0]]=r[1])}return s}const iD=String.fromCharCode(9);class sD extends Fl{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(s){let r,l;(s=s.trim()).length!==0&&(s[0]!=="#"?this.trigger("data",{type:"uri",uri:s}):this.tagMappers.reduce((d,f)=>(f=f(s),f===s?d:d.concat([f])),[s]).forEach(d=>{for(let y=0;y<this.customParsers.length;y++)if(this.customParsers[y].call(this,d))return;var f,p;d.indexOf("#EXT")!==0?this.trigger("data",{type:"comment",text:d.slice(1)}):(d=d.replace("\r",""),(r=/^#EXTM3U/.exec(d))?this.trigger("data",{type:"tag",tagType:"m3u"}):(r=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(d))?(l={type:"tag",tagType:"inf"},r[1]&&(l.duration=parseFloat(r[1])),r[2]&&(l.title=r[2]),this.trigger("data",l)):(r=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(d))?(l={type:"tag",tagType:"targetduration"},r[1]&&(l.duration=parseInt(r[1],10)),this.trigger("data",l)):(r=/^#EXT-X-VERSION:([0-9.]*)?/.exec(d))?(l={type:"tag",tagType:"version"},r[1]&&(l.version=parseInt(r[1],10)),this.trigger("data",l)):(r=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(d))?(l={type:"tag",tagType:"media-sequence"},r[1]&&(l.number=parseInt(r[1],10)),this.trigger("data",l)):(r=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(d))?(l={type:"tag",tagType:"discontinuity-sequence"},r[1]&&(l.number=parseInt(r[1],10)),this.trigger("data",l)):(r=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(d))?(l={type:"tag",tagType:"playlist-type"},r[1]&&(l.playlistType=r[1]),this.trigger("data",l)):(r=/^#EXT-X-BYTERANGE:(.*)?$/.exec(d))?(l=qr(a_(r[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",l)):(r=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(d))?(l={type:"tag",tagType:"allow-cache"},r[1]&&(l.allowed=!/NO/.test(r[1])),this.trigger("data",l)):(r=/^#EXT-X-MAP:(.*)$/.exec(d))?(l={type:"tag",tagType:"map"},r[1]&&((p=Hn(r[1])).URI&&(l.uri=p.URI),p.BYTERANGE)&&(l.byterange=a_(p.BYTERANGE)),this.trigger("data",l)):(r=/^#EXT-X-STREAM-INF:(.*)$/.exec(d))?(l={type:"tag",tagType:"stream-inf"},r[1]&&(l.attributes=Hn(r[1]),l.attributes.RESOLUTION&&(p={},(f=l.attributes.RESOLUTION.split("x"))[0]&&(p.width=parseInt(f[0],10)),f[1]&&(p.height=parseInt(f[1],10)),l.attributes.RESOLUTION=p),l.attributes.BANDWIDTH&&(l.attributes.BANDWIDTH=parseInt(l.attributes.BANDWIDTH,10)),l.attributes["FRAME-RATE"]&&(l.attributes["FRAME-RATE"]=parseFloat(l.attributes["FRAME-RATE"])),l.attributes["PROGRAM-ID"])&&(l.attributes["PROGRAM-ID"]=parseInt(l.attributes["PROGRAM-ID"],10)),this.trigger("data",l)):(r=/^#EXT-X-MEDIA:(.*)$/.exec(d))?(l={type:"tag",tagType:"media"},r[1]&&(l.attributes=Hn(r[1])),this.trigger("data",l)):(r=/^#EXT-X-ENDLIST/.exec(d))?this.trigger("data",{type:"tag",tagType:"endlist"}):(r=/^#EXT-X-DISCONTINUITY/.exec(d))?this.trigger("data",{type:"tag",tagType:"discontinuity"}):(r=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(d))?(l={type:"tag",tagType:"program-date-time"},r[1]&&(l.dateTimeString=r[1],l.dateTimeObject=new Date(r[1])),this.trigger("data",l)):(r=/^#EXT-X-KEY:(.*)$/.exec(d))?(l={type:"tag",tagType:"key"},r[1]&&(l.attributes=Hn(r[1]),l.attributes.IV)&&(l.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(l.attributes.IV=l.attributes.IV.substring(2)),l.attributes.IV=l.attributes.IV.match(/.{8}/g),l.attributes.IV[0]=parseInt(l.attributes.IV[0],16),l.attributes.IV[1]=parseInt(l.attributes.IV[1],16),l.attributes.IV[2]=parseInt(l.attributes.IV[2],16),l.attributes.IV[3]=parseInt(l.attributes.IV[3],16),l.attributes.IV=new Uint32Array(l.attributes.IV)),this.trigger("data",l)):(r=/^#EXT-X-START:(.*)$/.exec(d))?(l={type:"tag",tagType:"start"},r[1]&&(l.attributes=Hn(r[1]),l.attributes["TIME-OFFSET"]=parseFloat(l.attributes["TIME-OFFSET"]),l.attributes.PRECISE=/YES/.test(l.attributes.PRECISE)),this.trigger("data",l)):(r=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(d))?(l={type:"tag",tagType:"cue-out-cont"},r[1]?l.data=r[1]:l.data="",this.trigger("data",l)):(r=/^#EXT-X-CUE-OUT:(.*)?$/.exec(d))?(l={type:"tag",tagType:"cue-out"},r[1]?l.data=r[1]:l.data="",this.trigger("data",l)):(r=/^#EXT-X-CUE-IN:(.*)?$/.exec(d))?(l={type:"tag",tagType:"cue-in"},r[1]?l.data=r[1]:l.data="",this.trigger("data",l)):(r=/^#EXT-X-SKIP:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"skip"}).attributes=Hn(r[1]),l.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(l.attributes["SKIPPED-SEGMENTS"]=parseInt(l.attributes["SKIPPED-SEGMENTS"],10)),l.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(l.attributes["RECENTLY-REMOVED-DATERANGES"]=l.attributes["RECENTLY-REMOVED-DATERANGES"].split(iD)),this.trigger("data",l)):(r=/^#EXT-X-PART:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"part"}).attributes=Hn(r[1]),["DURATION"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=parseFloat(l.attributes[y]))}),["INDEPENDENT","GAP"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=/YES/.test(l.attributes[y]))}),l.attributes.hasOwnProperty("BYTERANGE")&&(l.attributes.byterange=a_(l.attributes.BYTERANGE)),this.trigger("data",l)):(r=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"server-control"}).attributes=Hn(r[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=parseFloat(l.attributes[y]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=/YES/.test(l.attributes[y]))}),this.trigger("data",l)):(r=/^#EXT-X-PART-INF:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"part-inf"}).attributes=Hn(r[1]),["PART-TARGET"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=parseFloat(l.attributes[y]))}),this.trigger("data",l)):(r=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"preload-hint"}).attributes=Hn(r[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(y){var S;l.attributes.hasOwnProperty(y)&&(l.attributes[y]=parseInt(l.attributes[y],10),S=y==="BYTERANGE-LENGTH"?"length":"offset",l.attributes.byterange=l.attributes.byterange||{},l.attributes.byterange[S]=l.attributes[y],delete l.attributes[y])}),this.trigger("data",l)):(r=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(d))&&r[1]?((l={type:"tag",tagType:"rendition-report"}).attributes=Hn(r[1]),["LAST-MSN","LAST-PART"].forEach(function(y){l.attributes.hasOwnProperty(y)&&(l.attributes[y]=parseInt(l.attributes[y],10))}),this.trigger("data",l)):this.trigger("data",{type:"tag",data:d.slice(4)}))}))}addParser({expression:s,customType:r,dataParser:l,segment:d}){typeof l!="function"&&(l=f=>f),this.customParsers.push(f=>{if(s.exec(f))return this.trigger("data",{type:"custom",data:l(f),customType:r,segment:d}),!0})}addTagMapper({expression:s,map:r}){this.tagMappers.push(l=>s.test(l)?r(l):l)}}function $l(a){const s={};return Object.keys(a).forEach(function(r){s[r.toLowerCase().replace(/-(\w)/g,l=>l[1].toUpperCase())]=a[r]}),s}function o_(p){var s,r,l,d,f,{serverControl:p,targetDuration:y,partTargetDuration:S}=p;p&&(s="#EXT-X-SERVER-CONTROL",r="holdBack",l="partHoldBack",d=y&&3*y,f=S&&2*S,y&&!p.hasOwnProperty(r)&&(p[r]=d,this.trigger("info",{message:s+` defaulting HOLD-BACK to targetDuration * 3 (${d}).`})),d&&p[r]<d&&(this.trigger("warn",{message:s+` clamping HOLD-BACK (${p[r]}) to targetDuration * 3 (${d})`}),p[r]=d),S&&!p.hasOwnProperty(l)&&(p[l]=3*S,this.trigger("info",{message:s+` defaulting PART-HOLD-BACK to partTargetDuration * 3 (${p[l]}).`})),S)&&p[l]<f&&(this.trigger("warn",{message:s+` clamping PART-HOLD-BACK (${p[l]}) to partTargetDuration * 2 (${f}).`}),p[l]=f)}class nD extends Fl{constructor(){super(),this.lineStream=new tD,this.parseStream=new sD,this.lineStream.pipe(this.parseStream);const s=this,r=[];let l={},d,f,p=!1;const y={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let S=0,A=(this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},0),P=0;this.on("end",()=>{l.uri||!l.parts&&!l.preloadHints||(!l.map&&d&&(l.map=d),!l.key&&f&&(l.key=f),l.timeline||typeof S!="number"||(l.timeline=S),this.manifest.preloadSegment=l)}),this.parseStream.on("data",function(L){let B,F;({tag(){({version(){L.version&&(this.manifest.version=L.version)},"allow-cache"(){this.manifest.allowCache=L.allowed,"allowed"in L||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){var K={};"length"in L&&((l.byterange=K).length=L.length,"offset"in L||(L.offset=A)),"offset"in L&&((l.byterange=K).offset=L.offset),A=K.offset+K.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<L.duration&&(l.duration=L.duration),L.duration===0&&(l.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key(){if(L.attributes)if(L.attributes.METHOD==="NONE")f=null;else if(L.attributes.URI)if(L.attributes.KEYFORMAT==="com.apple.streamingkeydelivery")this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:L.attributes};else if(L.attributes.KEYFORMAT==="com.microsoft.playready")this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:L.attributes.URI};else{if(L.attributes.KEYFORMAT==="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed")return["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(L.attributes.METHOD)===-1?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):(L.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),L.attributes.URI.substring(0,23)!=="data:text/plain;base64,"?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):L.attributes.KEYID&&L.attributes.KEYID.substring(0,2)==="0x"?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:L.attributes.KEYFORMAT,keyId:L.attributes.KEYID.substring(2)},pssh:eD(L.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));L.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),f={method:L.attributes.METHOD||"AES-128",uri:L.attributes.URI},typeof L.attributes.IV<"u"&&(f.iv=L.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(L.number)?this.manifest.mediaSequence=L.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+L.number})},"discontinuity-sequence"(){isFinite(L.number)?(this.manifest.discontinuitySequence=L.number,S=L.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+L.number})},"playlist-type"(){/VOD|EVENT/.test(L.playlistType)?this.manifest.playlistType=L.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+L.playlist})},map(){d={},L.uri&&(d.uri=L.uri),L.byterange&&(d.byterange=L.byterange),f&&(d.key=f)},"stream-inf"(){this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||y,L.attributes?(l.attributes||(l.attributes={}),qr(l.attributes,L.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){var K;this.manifest.mediaGroups=this.manifest.mediaGroups||y,L.attributes&&L.attributes.TYPE&&L.attributes["GROUP-ID"]&&L.attributes.NAME?((K=this.manifest.mediaGroups[L.attributes.TYPE])[L.attributes["GROUP-ID"]]=K[L.attributes["GROUP-ID"]]||{},B=K[L.attributes["GROUP-ID"]],(F={default:/yes/i.test(L.attributes.DEFAULT)}).default?F.autoselect=!0:F.autoselect=/yes/i.test(L.attributes.AUTOSELECT),L.attributes.LANGUAGE&&(F.language=L.attributes.LANGUAGE),L.attributes.URI&&(F.uri=L.attributes.URI),L.attributes["INSTREAM-ID"]&&(F.instreamId=L.attributes["INSTREAM-ID"]),L.attributes.CHARACTERISTICS&&(F.characteristics=L.attributes.CHARACTERISTICS),L.attributes.FORCED&&(F.forced=/yes/i.test(L.attributes.FORCED)),B[L.attributes.NAME]=F):this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity(){S+=1,l.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=L.dateTimeString,this.manifest.dateTimeObject=L.dateTimeObject),l.dateTimeString=L.dateTimeString,l.dateTimeObject=L.dateTimeObject},targetduration(){!isFinite(L.duration)||L.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+L.duration}):(this.manifest.targetDuration=L.duration,o_.call(this,this.manifest))},start(){!L.attributes||isNaN(L.attributes["TIME-OFFSET"])?this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"}):this.manifest.start={timeOffset:L.attributes["TIME-OFFSET"],precise:L.attributes.PRECISE}},"cue-out"(){l.cueOut=L.data},"cue-out-cont"(){l.cueOutCont=L.data},"cue-in"(){l.cueIn=L.data},skip(){this.manifest.skip=$l(L.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",L.attributes,["SKIPPED-SEGMENTS"])},part(){p=!0;var K=this.manifest.segments.length,Q=$l(L.attributes),Q=(l.parts=l.parts||[],l.parts.push(Q),Q.byterange&&(Q.byterange.hasOwnProperty("offset")||(Q.byterange.offset=P),P=Q.byterange.offset+Q.byterange.length),l.parts.length-1);this.warnOnMissingAttributes_(`#EXT-X-PART #${Q} for segment #`+K,L.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((oe,te)=>{oe.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${te} lacks required attribute(s): LAST-PART`})})},"server-control"(){var K=this.manifest.serverControl=$l(L.attributes);K.hasOwnProperty("canBlockReload")||(K.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),o_.call(this,this.manifest),K.canSkipDateranges&&!K.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){var K=this.manifest.segments.length,Q=$l(L.attributes),oe=Q.type&&Q.type==="PART",te=(l.preloadHints=l.preloadHints||[],l.preloadHints.push(Q),!Q.byterange||Q.byterange.hasOwnProperty("offset")||(Q.byterange.offset=oe?P:0,oe&&(P=Q.byterange.offset+Q.byterange.length)),l.preloadHints.length-1);if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${te} for segment #`+K,L.attributes,["TYPE","URI"]),Q.type)for(let de=0;de<l.preloadHints.length-1;de++){var ce=l.preloadHints[de];ce.type&&ce.type===Q.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${te} for segment #${K} has the same TYPE ${Q.type} as preload hint #`+de})}},"rendition-report"(){var K=$l(L.attributes),K=(this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(K),this.manifest.renditionReports.length-1),Q=["LAST-MSN","URI"];p&&Q.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+K,L.attributes,Q)},"part-inf"(){this.manifest.partInf=$l(L.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",L.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),o_.call(this,this.manifest)}}[L.tagType]||function(){}).call(s)},uri(){l.uri=L.uri,r.push(l),!this.manifest.targetDuration||"duration"in l||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),l.duration=this.manifest.targetDuration),f&&(l.key=f),l.timeline=S,d&&(l.map=d),P=0,l={}},comment(){},custom(){L.segment?(l.custom=l.custom||{},l.custom[L.customType]=L.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[L.customType]=L.data)}})[L.type].call(s)})}warnOnMissingAttributes_(s,r,l){const d=[];l.forEach(function(f){r.hasOwnProperty(f)||d.push(f)}),d.length&&this.trigger("warn",{message:s+" lacks required attribute(s): "+d.join(", ")})}push(s){this.lineStream.push(s)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(s){this.parseStream.addParser(s)}addTagMapper(s){this.parseStream.addTagMapper(s)}}function JT(a){return Lo.audio.test((a=a===void 0?"":a).trim().toLowerCase())}function Mf(a){return a===void 0&&(a=""),window.MediaSource&&window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported(sd(a))||!1}function l_(a){return(a=a===void 0?"":a).toLowerCase().split(",").every(function(s){s=s.trim();for(var r=0;r<tb.length;r++){var l=tb[r];if(Lo["muxer"+l].test(s))return!0}return!1})}function ZT(a){return oD.test(a)?"hls":lD.test(a)?"dash":a==="application/vnd.videojs.vhs+json"?"vhs-json":null}function rD(a,s){for(var r=(s=(s===void 0?{}:s).le)!==void 0&&s,l=(a=rs(a=typeof a!="bigint"&&typeof a!="number"||typeof a=="number"&&a!=a?0:a),s=a,Math.ceil(s.toString(2).length/8)),d=new Uint8Array(new ArrayBuffer(l)),f=0;f<l;f++){var p=r?f:Math.abs(f+1-d.length);d[p]=Number(a/c_[f]&rs(255)),a<0&&(d[p]=Math.abs(~d[p]),d[p]-=f===0?1:2)}return d}function eb(a,s){if(typeof(a=typeof a!="string"&&a&&typeof a.toString=="function"?a.toString():a)!="string")return new Uint8Array;s||(a=unescape(encodeURIComponent(a)));for(var r=new Uint8Array(a.length),l=0;l<a.length;l++)r[l]=a.charCodeAt(l);return r}function u_(a,s){if(/^[a-z]+:/i.test(s))return s;/^data:/.test(a)&&(a=window.location&&window.location.href||"");var r=typeof window.URL=="function",l=/^\/\//.test(a),d=!window.location&&!/\/\//i.test(a);return r?a=new window.URL(a,window.location||rb):/\/\//i.test(a)||(a=Rf.buildAbsoluteURL(window.location&&window.location.href||"",a)),r?(r=new URL(s,a),d?r.href.slice(rb.length):l?r.href.slice(r.protocol.length):r.href):Rf.buildAbsoluteURL(a,s)}var Lo={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},aD=["video","audio","text"],tb=["Video","Audio","Text"],ib=function(a){return a&&a.replace(/avc1\.(\d+)\.(\d+)/i,function(s,r,l){return"avc1."+("00"+Number(r).toString(16)).slice(-2)+"00"+("00"+Number(l).toString(16)).slice(-2)})},hr=function(s){var s=(s=s===void 0?"":s).split(","),r=[];return s.forEach(function(l){var d;l=l.trim(),aD.forEach(function(f){var p,y=Lo[f].exec(l.toLowerCase());!y||y.length<=1||(d=f,y=l.substring(0,y[1].length),p=l.replace(y,""),r.push({type:y,details:p,mediaType:f}))}),d||r.push({type:l,details:"",mediaType:"unknown"})}),r},sd=function(a){var s,r,l;if(a&&typeof a=="string")return r="video",(s=a.toLowerCase().split(",").map(function(d){return ib(d.trim())})).length===1&&JT(s[0])?r="audio":s.length===1&&(l=s[0],Lo.text.test((l=l===void 0?"":l).trim().toLowerCase()))&&(r="application"),l="mp4",s.every(function(d){return Lo.mp4.test(d)})?l="mp4":s.every(function(d){return Lo.webm.test(d)})?l="webm":s.every(function(d){return Lo.ogg.test(d)})&&(l="ogg"),r+"/"+l+';codecs="'+a+'"'},sb="mp4a.40.2",oD=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,lD=/^application\/dash\+xml/i,nb=function(a){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer},dt=function(a){return a instanceof Uint8Array?a:(Array.isArray(a)||nb(a)||a instanceof ArrayBuffer||(a=typeof a!="number"||typeof a=="number"&&a!=a?0:[a]),new Uint8Array(a&&a.buffer||a,a&&a.byteOffset||0,a&&a.byteLength||0))},rs=window.BigInt||Number,c_=[rs("0x1"),rs("0x100"),rs("0x10000"),rs("0x1000000"),rs("0x100000000"),rs("0x10000000000"),rs("0x1000000000000"),rs("0x100000000000000"),rs("0x10000000000000000")],uD=(V=new Uint16Array([65484]),(V=new Uint8Array(V.buffer,V.byteOffset,V.byteLength))[0]!==255&&V[0],function(a,d){var d=d===void 0?{}:d,r=d.signed,r=r!==void 0&&r,d=d.le,l=d!==void 0&&d,d=(a=dt(a),l?"reduce":"reduceRight"),d=(a[d]||Array.prototype[d]).call(a,function(f,p,y){return y=l?y:Math.abs(y+1-a.length),f+rs(p)*c_[y]},rs(0));return r&&(r=c_[a.length]/rs(2)-rs(1))<(d=rs(d))&&(d=(d=d-r-r)-rs(2)),Number(d)}),bi=function(a,s,p){var p=p===void 0?{}:p,d=p.offset,l=d===void 0?0:d,d=p.mask,f=d===void 0?[]:d,p=(a=dt(a),(s=dt(s)).every||Array.prototype.every);return s.length&&a.length-l>=s.length&&p.call(s,function(y,S){return y===(f[S]?f[S]&a[l+S]:a[l+S])})},rb="http://example.com";function cD(a){a=a;for(var s=window.atob?window.atob(a):Buffer.from(a,"base64").toString("binary"),r=new Uint8Array(s.length),l=0;l<s.length;l++)r[l]=s.charCodeAt(l);return r}function d_(a,s){return(s=s===void 0?Object:s)&&typeof s.freeze=="function"?s.freeze(a):a}var ab=d_({HTML:"text/html",isHTML:function(a){return a===ab.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),ob=d_({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(a){return a===ob.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"}),nd={assign:function(a,s){if(a===null||typeof a!="object")throw new TypeError("target is not an object");for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(a[r]=s[r]);return a},find:function(a,s,r){if(r===void 0&&(r=Array.prototype),a&&typeof r.find=="function")return r.find.call(a,s);for(var l=0;l<a.length;l++)if(Object.prototype.hasOwnProperty.call(a,l)){var d=a[l];if(s.call(void 0,d,l,a))return d}},freeze:d_,MIME_TYPE:ab,NAMESPACE:ob},fr=nd.find,rd=nd.NAMESPACE;function dD(a){return a!==""}function hD(a,s){return a.hasOwnProperty(s)||(a[s]=!0),a}function lb(a){return a?(a=(a=a)?a.split(/[\t\n\f\r ]+/).filter(dD):[],Object.keys(a.reduce(hD,{}))):[]}function ad(a,s){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}function Hs(a,s){var r=a.prototype;function l(){}r instanceof s||(l.prototype=s.prototype,ad(r,l=new l),a.prototype=r=l),r.constructor!=a&&(r.constructor=a)}var as={},Hi=(as.ELEMENT_NODE=1,as.ATTRIBUTE_NODE=2,as.TEXT_NODE=3,as.CDATA_SECTION_NODE=4,as.ENTITY_REFERENCE_NODE=5,as.ENTITY_NODE=6,as.PROCESSING_INSTRUCTION_NODE=7,as.COMMENT_NODE=8,as.DOCUMENT_NODE=9,as.DOCUMENT_TYPE_NODE=10,as.DOCUMENT_FRAGMENT_NODE=11,as.NOTATION_NODE=12,{}),Xi={},Vs=(Hi.INDEX_SIZE_ERR=(Xi[1]="Index size error",1),Hi.DOMSTRING_SIZE_ERR=(Xi[2]="DOMString size error",2),Hi.HIERARCHY_REQUEST_ERR=(Xi[3]="Hierarchy request error",3)),ub=(Hi.WRONG_DOCUMENT_ERR=(Xi[4]="Wrong document",4),Hi.INVALID_CHARACTER_ERR=(Xi[5]="Invalid character",5),Hi.NO_DATA_ALLOWED_ERR=(Xi[6]="No data allowed",6),Hi.NO_MODIFICATION_ALLOWED_ERR=(Xi[7]="No modification allowed",7),Hi.NOT_FOUND_ERR=(Xi[8]="Not found",8));Hi.NOT_SUPPORTED_ERR=(Xi[9]="Not supported",9),Hi.INUSE_ATTRIBUTE_ERR=(Xi[10]="Attribute in use",10);function Ii(a,s){var r;return s instanceof Error?r=s:(r=this,Error.call(this,Xi[a]),this.message=Xi[a],Error.captureStackTrace&&Error.captureStackTrace(this,Ii)),r.code=a,s&&(this.message=this.message+": "+s),r}function Kr(){}function jl(a,s){this._node=a,this._refresh=s,h_(this)}function h_(a){var s,r=a._node._inc||a._node.ownerDocument._inc;a._inc!=r&&(s=a._refresh(a._node),wb(a,"length",s.length),ad(s,a),a._inc=r)}function Uf(){}function cb(a,s){for(var r=a.length;r--;)if(a[r]===s)return r}function db(a,s,r,l){l?s[cb(s,l)]=r:s[s.length++]=r,a&&(s=(r.ownerElement=a).ownerDocument)&&(l&&mb(s,a,l),l=a,a=r,(r=s)&&r._inc++,a.namespaceURI===rd.XMLNS)&&(l._nsMap[a.prefix?a.localName:""]=a.value)}function hb(a,s,r){var l=cb(s,r);if(!(0<=l))throw new Ii(ub,new Error(a.tagName+"@"+r));for(var d,f=s.length-1;l<f;)s[l]=s[++l];s.length=f,a&&(d=a.ownerDocument)&&(mb(d,a,r),r.ownerElement=null)}function fb(){}function ii(){}function pb(a){return(a=="<"?"&lt;":a==">"&&"&gt;")||(a=="&"?"&amp;":a=='"'&&"&quot;")||"&#"+a.charCodeAt()+";"}function od(a,s){if(s(a))return 1;if(a=a.firstChild)do if(od(a,s))return 1;while(a=a.nextSibling)}function ld(){this.ownerDocument=this}function mb(a,s,r){a&&a._inc++,r.namespaceURI===rd.XMLNS&&delete s._nsMap[r.prefix?r.localName:""]}function f_(a,s,r){if(a&&a._inc){a._inc++;var l=s.childNodes;if(r)l[l.length++]=r;else{for(var d=s.firstChild,f=0;d;)d=(l[f++]=d).nextSibling;l.length=f,delete l[l.length]}}}function gb(a,s){var r=s.previousSibling,l=s.nextSibling;return r?r.nextSibling=l:a.firstChild=l,l?l.previousSibling=r:a.lastChild=r,s.parentNode=null,s.previousSibling=null,s.nextSibling=null,f_(a.ownerDocument,a),s}function Xr(a){return a&&a.nodeType===ii.DOCUMENT_TYPE_NODE}function pr(a){return a&&a.nodeType===ii.ELEMENT_NODE}function p_(a){return a&&a.nodeType===ii.TEXT_NODE}function _b(l,s){var r,l=l.childNodes||[];if(!fr(l,pr)&&!Xr(s))return r=fr(l,Xr),!(s&&r&&l.indexOf(r)>l.indexOf(s))}function yb(l,s){var r,l=l.childNodes||[];if(!fr(l,function(d){return pr(d)&&d!==s}))return r=fr(l,Xr),!(s&&r&&l.indexOf(r)>l.indexOf(s))}function fD(a,s,r){if(!(l=a)||l.nodeType!==ii.DOCUMENT_NODE&&l.nodeType!==ii.DOCUMENT_FRAGMENT_NODE&&l.nodeType!==ii.ELEMENT_NODE)throw new Ii(Vs,"Unexpected parent node type "+a.nodeType);var l;if(r&&r.parentNode!==a)throw new Ii(ub,"child not in parent");if(!(l=s)||!(pr(l)||p_(l)||Xr(l)||l.nodeType===ii.DOCUMENT_FRAGMENT_NODE||l.nodeType===ii.COMMENT_NODE||l.nodeType===ii.PROCESSING_INSTRUCTION_NODE)||Xr(s)&&a.nodeType!==ii.DOCUMENT_NODE)throw new Ii(Vs,"Unexpected node type "+s.nodeType+" for parent node type "+a.nodeType)}function pD(a,s,r){var l=a.childNodes||[],d=s.childNodes||[];if(s.nodeType===ii.DOCUMENT_FRAGMENT_NODE){var f=d.filter(pr);if(1<f.length||fr(d,p_))throw new Ii(Vs,"More than one element or text in fragment");if(f.length===1&&!_b(a,r))throw new Ii(Vs,"Element in fragment can not be inserted before doctype")}if(pr(s)&&!_b(a,r))throw new Ii(Vs,"Only one element can be added and only after doctype");if(Xr(s)){if(fr(l,Xr))throw new Ii(Vs,"Only one doctype is allowed");if(d=fr(l,pr),r&&l.indexOf(d)<l.indexOf(r))throw new Ii(Vs,"Doctype can only be inserted before an element");if(!r&&d)throw new Ii(Vs,"Doctype can not be appended since element is present")}}function vb(a,s,r){var l=a.childNodes||[],d=s.childNodes||[];if(s.nodeType===ii.DOCUMENT_FRAGMENT_NODE){var f=d.filter(pr);if(1<f.length||fr(d,p_))throw new Ii(Vs,"More than one element or text in fragment");if(f.length===1&&!yb(a,r))throw new Ii(Vs,"Element in fragment can not be inserted before doctype")}if(pr(s)&&!yb(a,r))throw new Ii(Vs,"Only one element can be added and only after doctype");if(Xr(s)){if(fr(l,function(p){return Xr(p)&&p!==r}))throw new Ii(Vs,"Only one doctype is allowed");if(d=fr(l,pr),r&&l.indexOf(d)<l.indexOf(r))throw new Ii(Vs,"Doctype can only be inserted before an element")}}function Bf(a,s,r,l){if(fD(a,s,r),a.nodeType===ii.DOCUMENT_NODE&&(l||pD)(a,s,r),l=s.parentNode,l&&l.removeChild(s),s.nodeType===11){var d=s.firstChild;if(d==null)return s;var f=s.lastChild}else d=f=s;for(l=r?r.previousSibling:a.lastChild,d.previousSibling=l,f.nextSibling=r,l?l.nextSibling=d:a.firstChild=d,r==null?a.lastChild=f:r.previousSibling=f;d.parentNode=a,d!==f&&(d=d.nextSibling););return f_(a.ownerDocument||a,a),s.nodeType==11&&(s.firstChild=s.lastChild=null),s}function Hl(){this._nsMap={}}function Ff(){}function ud(){}function m_(){}function g_(){}function __(){}function $f(){}function Tb(){}function bb(){}function y_(){}function jf(){}function v_(){}function Eb(){}function Sb(a,s){var r,l=[],d=this.nodeType==9&&this.documentElement||this,f=d.prefix,p=d.namespaceURI;return Vl(this,l,a,s,r=p&&f==null&&d.lookupPrefix(p)==null?[{namespace:p,prefix:null}]:r),l.join("")}function xb(a,s,r){var l=a.prefix||"",d=a.namespaceURI;if(d&&(l!=="xml"||d!==rd.XML)&&d!==rd.XMLNS){for(var f=r.length;f--;){var p=r[f];if(p.prefix===l)return p.namespace!==d}return 1}}function T_(a,s,r){a.push(" ",s,'="',r.replace(/[<>&"\t\n\r]/g,pb),'"')}function Vl(a,s,r,l,d){if(d=d||[],l){if(!(a=l(a)))return;if(typeof a=="string")return void s.push(a)}switch(a.nodeType){case 1:var f=a.attributes,p=f.length,y=a.firstChild,S=a.tagName,A=S;if(!(r=rd.isHTML(a.namespaceURI)||r)&&!a.prefix&&a.namespaceURI){for(var P,L=0;L<f.length;L++)if(f.item(L).name==="xmlns"){P=f.item(L).value;break}if(!P){for(var B=d.length-1;0<=B;B--)if((F=d[B]).prefix===""&&F.namespace===a.namespaceURI){P=F.namespace;break}}if(P!==a.namespaceURI){for(var F,B=d.length-1;0<=B;B--)if((F=d[B]).namespace===a.namespaceURI){F.prefix&&(A=F.prefix+":"+S);break}}}s.push("<",A);for(var K=0;K<p;K++)(Q=f.item(K)).prefix=="xmlns"?d.push({prefix:Q.localName,namespace:Q.value}):Q.nodeName=="xmlns"&&d.push({prefix:"",namespace:Q.value});for(var Q,oe,te,K=0;K<p;K++)xb(Q=f.item(K),0,d)&&(T_(s,(oe=Q.prefix||"")?"xmlns:"+oe:"xmlns",te=Q.namespaceURI),d.push({prefix:oe,namespace:te})),Vl(Q,s,r,l,d);if(S===A&&xb(a,0,d)&&(T_(s,(oe=a.prefix||"")?"xmlns:"+oe:"xmlns",te=a.namespaceURI),d.push({prefix:oe,namespace:te})),y||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(S)){if(s.push(">"),r&&/^script$/i.test(S))for(;y;)y.data?s.push(y.data):Vl(y,s,r,l,d.slice()),y=y.nextSibling;else for(;y;)Vl(y,s,r,l,d.slice()),y=y.nextSibling;s.push("</",A,">")}else s.push("/>");return;case 9:case 11:for(y=a.firstChild;y;)Vl(y,s,r,l,d.slice()),y=y.nextSibling;return;case 2:return T_(s,a.name,a.value);case 3:return s.push(a.data.replace(/[<&>]/g,pb));case 4:return s.push("<![CDATA[",a.data,"]]>");case 8:return s.push("<!--",a.data,"-->");case 10:var ce=a.publicId,de=a.systemId;return s.push("<!DOCTYPE ",a.name),void(ce?(s.push(" PUBLIC ",ce),de&&de!="."&&s.push(" ",de),s.push(">")):de&&de!="."?s.push(" SYSTEM ",de,">"):((ce=a.internalSubset)&&s.push(" [",ce,"]"),s.push(">")));case 7:return s.push("<?",a.target," ",a.data,"?>");case 5:return s.push("&",a.nodeName,";");default:s.push("??",a.nodeName)}}function wb(a,s,r){a[s]=r}Hi.INVALID_STATE_ERR=(Xi[11]="Invalid state",11),Hi.SYNTAX_ERR=(Xi[12]="Syntax error",12),Hi.INVALID_MODIFICATION_ERR=(Xi[13]="Invalid modification",13),Hi.NAMESPACE_ERR=(Xi[14]="Invalid namespace",14),Hi.INVALID_ACCESS_ERR=(Xi[15]="Invalid access",15),Ii.prototype=Error.prototype,ad(Hi,Ii),Kr.prototype={length:0,item:function(a){return this[a]||null},toString:function(a,s){for(var r=[],l=0;l<this.length;l++)Vl(this[l],r,a,s);return r.join("")},filter:function(a){return Array.prototype.filter.call(this,a)},indexOf:function(a){return Array.prototype.indexOf.call(this,a)}},jl.prototype.item=function(a){return h_(this),this[a]},Hs(jl,Kr),Uf.prototype={length:0,item:Kr.prototype.item,getNamedItem:function(a){for(var s=this.length;s--;){var r=this[s];if(r.nodeName==a)return r}},setNamedItem:function(a){var s=a.ownerElement;if(s&&s!=this._ownerElement)throw new Ii(10);return s=this.getNamedItem(a.nodeName),db(this._ownerElement,this,a,s),s},setNamedItemNS:function(a){var s=a.ownerElement;if(s&&s!=this._ownerElement)throw new Ii(10);return s=this.getNamedItemNS(a.namespaceURI,a.localName),db(this._ownerElement,this,a,s),s},removeNamedItem:function(a){return a=this.getNamedItem(a),hb(this._ownerElement,this,a),a},removeNamedItemNS:function(a,s){return a=this.getNamedItemNS(a,s),hb(this._ownerElement,this,a),a},getNamedItemNS:function(a,s){for(var r=this.length;r--;){var l=this[r];if(l.localName==s&&l.namespaceURI==a)return l}return null}},fb.prototype={hasFeature:function(a,s){return!0},createDocument:function(a,s,r){var l=new ld;return l.implementation=this,l.childNodes=new Kr,l.doctype=r||null,r&&l.appendChild(r),s&&(r=l.createElementNS(a,s),l.appendChild(r)),l},createDocumentType:function(a,s,r){var l=new $f;return l.name=a,l.nodeName=a,l.publicId=s||"",l.systemId=r||"",l}},ii.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(a,s){return Bf(this,a,s)},replaceChild:function(a,s){Bf(this,a,s,vb),s&&this.removeChild(s)},removeChild:function(a){return gb(this,a)},appendChild:function(a){return this.insertBefore(a,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(a){return function s(r,l,d){var f=new l.constructor;for(var p in l){var y;Object.prototype.hasOwnProperty.call(l,p)&&typeof(y=l[p])!="object"&&y!=f[p]&&(f[p]=y)}switch(l.childNodes&&(f.childNodes=new Kr),f.ownerDocument=r,f.nodeType){case 1:var S=l.attributes,A=f.attributes=new Uf,P=S.length;A._ownerElement=f;for(var L=0;L<P;L++)f.setAttributeNode(s(r,S.item(L),!0));break;case 2:d=!0}if(d)for(var B=l.firstChild;B;)f.appendChild(s(r,B,d)),B=B.nextSibling;return f}(this.ownerDocument||this,this,a)},normalize:function(){for(var a=this.firstChild;a;){var s=a.nextSibling;s&&s.nodeType==3&&a.nodeType==3?(this.removeChild(s),a.appendData(s.data)):(a.normalize(),a=s)}},isSupported:function(a,s){return this.ownerDocument.implementation.hasFeature(a,s)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(a){for(var s=this;s;){var r=s._nsMap;if(r){for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)&&r[l]===a)return l}s=s.nodeType==2?s.ownerDocument:s.parentNode}return null},lookupNamespaceURI:function(a){for(var s=this;s;){var r=s._nsMap;if(r&&Object.prototype.hasOwnProperty.call(r,a))return r[a];s=s.nodeType==2?s.ownerDocument:s.parentNode}return null},isDefaultNamespace:function(a){return this.lookupPrefix(a)==null}},ad(as,ii),ad(as,ii.prototype),ld.prototype={nodeName:"#document",nodeType:9,doctype:null,documentElement:null,_inc:1,insertBefore:function(a,s){if(a.nodeType==11)for(var r=a.firstChild;r;){var l=r.nextSibling;this.insertBefore(r,s),r=l}else Bf(this,a,s),(a.ownerDocument=this).documentElement===null&&a.nodeType===1&&(this.documentElement=a);return a},removeChild:function(a){return this.documentElement==a&&(this.documentElement=null),gb(this,a)},replaceChild:function(a,s){Bf(this,a,s,vb),a.ownerDocument=this,s&&this.removeChild(s),pr(a)&&(this.documentElement=a)},importNode:function(a,s){return function r(l,d,f){var p;switch(d.nodeType){case 1:(p=d.cloneNode(!1)).ownerDocument=l;case 11:break;case 2:f=!0}if(p=p||d.cloneNode(!1),p.ownerDocument=l,p.parentNode=null,f)for(var y=d.firstChild;y;)p.appendChild(r(l,y,f)),y=y.nextSibling;return p}(this,a,s)},getElementById:function(a){var s=null;return od(this.documentElement,function(r){if(r.nodeType==1&&r.getAttribute("id")==a)return s=r,!0}),s},getElementsByClassName:function(a){var s=lb(a);return new jl(this,function(r){var l=[];return 0<s.length&&od(r.documentElement,function(d){var f,p,y;d!==r&&d.nodeType===1&&(f=d.getAttribute("class"))&&((p=a===f)||(f=lb(f),p=s.every((y=f,function(S){return y&&y.indexOf(S)!==-1}))),p)&&l.push(d)}),l})},createElement:function(a){var s=new Hl;return s.ownerDocument=this,s.nodeName=a,s.tagName=a,s.localName=a,s.childNodes=new Kr,(s.attributes=new Uf)._ownerElement=s},createDocumentFragment:function(){var a=new jf;return a.ownerDocument=this,a.childNodes=new Kr,a},createTextNode:function(a){var s=new m_;return s.ownerDocument=this,s.appendData(a),s},createComment:function(a){var s=new g_;return s.ownerDocument=this,s.appendData(a),s},createCDATASection:function(a){var s=new __;return s.ownerDocument=this,s.appendData(a),s},createProcessingInstruction:function(a,s){var r=new v_;return r.ownerDocument=this,r.tagName=r.target=a,r.nodeValue=r.data=s,r},createAttribute:function(a){var s=new Ff;return s.ownerDocument=this,s.name=a,s.nodeName=a,s.localName=a,s.specified=!0,s},createEntityReference:function(a){var s=new y_;return s.ownerDocument=this,s.nodeName=a,s},createElementNS:function(a,s){var r=new Hl,l=s.split(":"),d=r.attributes=new Uf;return r.childNodes=new Kr,r.ownerDocument=this,r.nodeName=s,r.tagName=s,r.namespaceURI=a,l.length==2?(r.prefix=l[0],r.localName=l[1]):r.localName=s,d._ownerElement=r},createAttributeNS:function(a,s){var r=new Ff,l=s.split(":");return r.ownerDocument=this,r.nodeName=s,r.name=s,r.namespaceURI=a,r.specified=!0,l.length==2?(r.prefix=l[0],r.localName=l[1]):r.localName=s,r}},Hs(ld,ii),ld.prototype.getElementsByTagName=(Hl.prototype={nodeType:1,hasAttribute:function(a){return this.getAttributeNode(a)!=null},getAttribute:function(a){return a=this.getAttributeNode(a),a&&a.value||""},getAttributeNode:function(a){return this.attributes.getNamedItem(a)},setAttribute:function(a,s){a=this.ownerDocument.createAttribute(a),a.value=a.nodeValue=""+s,this.setAttributeNode(a)},removeAttribute:function(a){a=this.getAttributeNode(a),a&&this.removeAttributeNode(a)},appendChild:function(a){return a.nodeType===11?this.insertBefore(a,null):(s=this,(a=a).parentNode&&a.parentNode.removeChild(a),a.parentNode=s,a.previousSibling=s.lastChild,a.nextSibling=null,a.previousSibling?a.previousSibling.nextSibling=a:s.firstChild=a,s.lastChild=a,f_(s.ownerDocument,s,a),a);var s},setAttributeNode:function(a){return this.attributes.setNamedItem(a)},setAttributeNodeNS:function(a){return this.attributes.setNamedItemNS(a)},removeAttributeNode:function(a){return this.attributes.removeNamedItem(a.nodeName)},removeAttributeNS:function(a,s){a=this.getAttributeNodeNS(a,s),a&&this.removeAttributeNode(a)},hasAttributeNS:function(a,s){return this.getAttributeNodeNS(a,s)!=null},getAttributeNS:function(a,s){return a=this.getAttributeNodeNS(a,s),a&&a.value||""},setAttributeNS:function(a,s,r){a=this.ownerDocument.createAttributeNS(a,s),a.value=a.nodeValue=""+r,this.setAttributeNode(a)},getAttributeNodeNS:function(a,s){return this.attributes.getNamedItemNS(a,s)},getElementsByTagName:function(a){return new jl(this,function(s){var r=[];return od(s,function(l){l===s||l.nodeType!=1||a!=="*"&&l.tagName!=a||r.push(l)}),r})},getElementsByTagNameNS:function(a,s){return new jl(this,function(r){var l=[];return od(r,function(d){d===r||d.nodeType!==1||a!=="*"&&d.namespaceURI!==a||s!=="*"&&d.localName!=s||l.push(d)}),l})}}).getElementsByTagName,ld.prototype.getElementsByTagNameNS=Hl.prototype.getElementsByTagNameNS,Hs(Hl,ii),Ff.prototype.nodeType=2,Hs(Ff,ii),ud.prototype={data:"",substringData:function(a,s){return this.data.substring(a,a+s)},appendData:function(a){a=this.data+a,this.nodeValue=this.data=a,this.length=a.length},insertData:function(a,s){this.replaceData(a,0,s)},appendChild:function(a){throw new Error(Xi[Vs])},deleteData:function(a,s){this.replaceData(a,s,"")},replaceData:function(d,s,r){var l=this.data.substring(0,d),d=this.data.substring(d+s);this.nodeValue=this.data=r=l+r+d,this.length=r.length}},Hs(ud,ii),m_.prototype={nodeName:"#text",nodeType:3,splitText:function(l){var s=(r=this.data).substring(l),r=r.substring(0,l),l=(this.data=this.nodeValue=r,this.length=r.length,this.ownerDocument.createTextNode(s));return this.parentNode&&this.parentNode.insertBefore(l,this.nextSibling),l}},Hs(m_,ud),g_.prototype={nodeName:"#comment",nodeType:8},Hs(g_,ud),__.prototype={nodeName:"#cdata-section",nodeType:4},Hs(__,ud),$f.prototype.nodeType=10,Hs($f,ii),Tb.prototype.nodeType=12,Hs(Tb,ii),bb.prototype.nodeType=6,Hs(bb,ii),y_.prototype.nodeType=5,Hs(y_,ii),jf.prototype.nodeName="#document-fragment",jf.prototype.nodeType=11,Hs(jf,ii),v_.prototype.nodeType=7,Hs(v_,ii),Eb.prototype.serializeToString=function(a,s,r){return Sb.call(a,s,r)},ii.prototype.toString=Sb;try{Object.defineProperty&&(Object.defineProperty(jl.prototype,"length",{get:function(){return h_(this),this.$$length}}),Object.defineProperty(ii.prototype,"textContent",{get:function(){return function a(s){switch(s.nodeType){case 1:case 11:var r=[];for(s=s.firstChild;s;)s.nodeType!==7&&s.nodeType!==8&&r.push(a(s)),s=s.nextSibling;return r.join("");default:return s.nodeValue}}(this)},set:function(a){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(a||String(a))&&this.appendChild(this.ownerDocument.createTextNode(a));break;default:this.data=a,this.value=a,this.nodeValue=a}}}),wb=function(a,s,r){a["$$"+s]=r})}catch{}var Hf={DocumentType:$f,DOMException:Ii,DOMImplementation:fb,Element:Hl,Node:ii,NodeList:Kr,XMLSerializer:Eb},cd=ka(function(a,s){var r=nd.freeze;s.XML_ENTITIES=r({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),s.HTML_ENTITIES=r({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}),s.entityMap=s.HTML_ENTITIES}),dd=(cd.XML_ENTITIES,cd.HTML_ENTITIES,cd.entityMap,nd.NAMESPACE),ql=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Wl=new RegExp("[\\-\\.0-9"+ql.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Cb=new RegExp("^"+ql.source+Wl.source+"*(?::"+ql.source+Wl.source+"*)?$"),hd=0,Ma=1,Gl=2,Vf=3,zl=4,fd=5,pd=6,qf=7;function md(a,s){this.message=a,this.locator=s,Error.captureStackTrace&&Error.captureStackTrace(this,md)}function Ab(){}function kb(a,s){return s.lineNumber=a.lineNumber,s.columnNumber=a.columnNumber,s}function Ib(a,s,r){for(var l=a.tagName,d=null,f=a.length;f--;){var p=a[f],S=p.qName,y=p.value,S=0<(P=S.indexOf(":"))?(A=p.prefix=S.slice(0,P),L=S.slice(P+1),A==="xmlns"&&L):(A=null,(L=S)==="xmlns"&&"");p.localName=L,S!==!1&&(d==null&&(d={},Ob(r,r={})),r[S]=d[S]=y,p.uri=dd.XMLNS,s.startPrefixMapping(S,y))}for(var A,f=a.length;f--;)(A=(p=a[f]).prefix)&&(A==="xml"&&(p.uri=dd.XML),A!=="xmlns")&&(p.uri=r[A||""]);var P,L=0<(P=l.indexOf(":"))?(A=a.prefix=l.slice(0,P),a.localName=l.slice(P+1)):(A=null,a.localName=l),B=a.uri=r[A||""];if(s.startElement(B,L,l,a),!a.closed)return a.currentNSMap=r,a.localNSMap=d,1;if(s.endElement(B,L,l),d)for(A in d)Object.prototype.hasOwnProperty.call(d,A)&&s.endPrefixMapping(A)}function Ob(a,s){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}function Db(){this.attributeNames={}}(md.prototype=new Error).name=md.name,Ab.prototype={parse:function(a,s,r){var l=this.domBuilder;l.startDocument(),Ob(s,s={}),function(d,f,p,y,S){function A(Ge){var ze=Ge.slice(1,-1);return Object.hasOwnProperty.call(p,ze)?p[ze]:ze.charAt(0)==="#"?65535<(ze=parseInt(ze.substr(1).replace("x","0x")))?(ze-=65536,String.fromCharCode(55296+(ze>>10),56320+(1023&ze))):String.fromCharCode(ze):(S.error("entity not found:"+Ge),Ge)}function P(Ge){var ze;ce<Ge&&(ze=d.substring(ce,Ge).replace(/&#?\w+;/g,A),Q&&L(ce),y.characters(ze,0,Ge-ce),ce=Ge)}function L(Ge,ze){for(;F<=Ge&&(ze=K.exec(d));)B=ze.index,F=B+ze[0].length,Q.lineNumber++;Q.columnNumber=Ge-B+1}for(var B=0,F=0,K=/.*(?:\r\n?|\n)|.*$/g,Q=y.locator,oe=[{currentNSMap:f}],te={},ce=0;;){try{var de,xe,ge=d.indexOf("<",ce);if(ge<0)return d.substr(ce).match(/^\s*$/)||(de=y.doc,xe=de.createTextNode(d.substr(ce)),de.appendChild(xe),y.currentElement=xe);switch(ce<ge&&P(ge),d.charAt(ge+1)){case"/":var st=d.indexOf(">",ge+3),Me=d.substring(ge+2,st).replace(/[ \t\n\r]+$/g,""),xt=oe.pop(),qe=(st<0?(Me=d.substring(ge+2).replace(/[\s<].*/,""),S.error("end tag name: "+Me+" is not complete:"+xt.tagName),st=ge+1+Me.length):Me.match(/\s</)&&(Me=Me.replace(/[\s<].*/,""),S.error("end tag name: "+Me+" maybe not complete"),st=ge+1+Me.length),xt.localNSMap),nt=xt.tagName==Me;if(nt||xt.tagName&&xt.tagName.toLowerCase()==Me.toLowerCase()){if(y.endElement(xt.uri,xt.localName,Me),qe)for(var Tt in qe)Object.prototype.hasOwnProperty.call(qe,Tt)&&y.endPrefixMapping(Tt);nt||S.fatalError("end tag name: "+Me+" is not match the current start tagName:"+xt.tagName)}else oe.push(xt);st++;break;case"?":Q&&L(ge),st=function(Ge,ze,$t){var Wt=Ge.indexOf("?>",ze);return Wt&&(Ge=Ge.substring(ze,Wt).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/),Ge)?(Ge[0].length,$t.processingInstruction(Ge[1],Ge[2]),Wt+2):-1}(d,ge,y);break;case"!":Q&&L(ge),st=function(Ge,ze,$t,Wt){{if(Ge.charAt(ze+2)==="-")return Ge.charAt(ze+3)==="-"?(Zt=Ge.indexOf("-->",ze+4),ze<Zt?($t.comment(Ge,ze+4,Zt-ze-4),Zt+3):(Wt.error("Unclosed comment"),-1)):-1;if(Ge.substr(ze+3,6)=="CDATA[")return Zt=Ge.indexOf("]]>",ze+9),$t.startCDATA(),$t.characters(Ge,ze+9,Zt-ze-9),$t.endCDATA(),Zt+3;var Di,Wt=function(Ei,Gt){var zt,At=[],pt=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(pt.lastIndex=Gt,pt.exec(Ei);zt=pt.exec(Ei);)if(At.push(zt),zt[1])return At}(Ge,ze),Zt=Wt.length;if(1<Zt&&/!doctype/i.test(Wt[0][0]))return Ge=Wt[1][0],Di=ze=!1,3<Zt&&(/^public$/i.test(Wt[2][0])?(ze=Wt[3][0],Di=4<Zt&&Wt[4][0]):/^system$/i.test(Wt[2][0])&&(Di=Wt[3][0])),Wt=Wt[Zt-1],$t.startDTD(Ge,ze,Di),$t.endDTD(),Wt.index+Wt[0].length}return-1}(d,ge,y,S);break;default:Q&&L(ge);var gt=new Db,Ci=oe[oe.length-1].currentNSMap,st=function(Ge,ze,$t,Wt,Di,Zt){function As(Wn,dn,Jr){$t.attributeNames.hasOwnProperty(Wn)&&Zt.fatalError("Attribute "+Wn+" redefined"),$t.addValue(Wn,dn.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,Di),Jr)}for(var Ei,Gt=++ze,zt=hd;;){var At=Ge.charAt(Gt);switch(At){case"=":if(zt===Ma)Ei=Ge.slice(ze,Gt);else if(zt!==Gl)throw new Error("attribute equal must after attrName");zt=Vf;break;case"'":case'"':if(zt===Vf||zt===Ma){if(zt===Ma&&(Zt.warning('attribute value must after "="'),Ei=Ge.slice(ze,Gt)),ze=Gt+1,!(0<(Gt=Ge.indexOf(At,ze))))throw new Error("attribute value no end '"+At+"' match");pt=Ge.slice(ze,Gt),As(Ei,pt,ze-1)}else{if(zt!=zl)throw new Error('attribute value must after "="');pt=Ge.slice(ze,Gt),As(Ei,pt,ze),Zt.warning('attribute "'+Ei+'" missed start quot('+At+")!!"),ze=Gt+1}zt=fd;break;case"/":switch(zt){case hd:$t.setTagName(Ge.slice(ze,Gt));case fd:case pd:case qf:zt=qf,$t.closed=!0;case zl:case Ma:case Gl:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Zt.error("unexpected end of input"),zt==hd&&$t.setTagName(Ge.slice(ze,Gt)),Gt;case">":switch(zt){case hd:$t.setTagName(Ge.slice(ze,Gt));case fd:case pd:case qf:break;case zl:case Ma:(pt=Ge.slice(ze,Gt)).slice(-1)==="/"&&($t.closed=!0,pt=pt.slice(0,-1));case Gl:zt===Gl&&(pt=Ei),zt==zl?(Zt.warning('attribute "'+pt+'" missed quot(")!'),As(Ei,pt,ze)):(dd.isHTML(Wt[""])&&pt.match(/^(?:disabled|checked|selected)$/i)||Zt.warning('attribute "'+pt+'" missed value!! "'+pt+'" instead!!'),As(pt,pt,ze));break;case Vf:throw new Error("attribute value missed!!")}return Gt;case"":At=" ";default:if(At<=" ")switch(zt){case hd:$t.setTagName(Ge.slice(ze,Gt)),zt=pd;break;case Ma:Ei=Ge.slice(ze,Gt),zt=Gl;break;case zl:var pt=Ge.slice(ze,Gt);Zt.warning('attribute "'+pt+'" missed quot(")!!'),As(Ei,pt,ze);case fd:zt=pd}else switch(zt){case Gl:$t.tagName,dd.isHTML(Wt[""])&&Ei.match(/^(?:disabled|checked|selected)$/i)||Zt.warning('attribute "'+Ei+'" missed value!! "'+Ei+'" instead2!!'),As(Ei,Ei,ze),ze=Gt,zt=Ma;break;case fd:Zt.warning('attribute space is required"'+Ei+'"!!');case pd:zt=Ma,ze=Gt;break;case Vf:zt=zl,ze=Gt;break;case qf:throw new Error("elements closed character '/' and '>' must be connected to")}}Gt++}}(d,ge,gt,Ci,A,S),Lt=gt.length;if(!gt.closed&&function(Ge,ze,$t,Wt){var Di=Wt[$t];return Di==null&&((Di=Ge.lastIndexOf("</"+$t+">"))<ze&&(Di=Ge.lastIndexOf("</"+$t)),Wt[$t]=Di),Di<ze}(d,st,gt.tagName,te)&&(gt.closed=!0,p.nbsp||S.warning("unclosed xml attribute")),Q&&Lt){for(var Nt=kb(Q,{}),Vi=0;Vi<Lt;Vi++){var cn=gt[Vi];L(cn.offset),cn.locator=kb(Q,{})}y.locator=Nt,Ib(gt,y,Ci)&&oe.push(gt),y.locator=Q}else Ib(gt,y,Ci)&&oe.push(gt);dd.isHTML(gt.uri)&&!gt.closed?st=function(Ge,ze,$t,Wt,Di){if(/^(?:script|textarea)$/i.test($t)){var Zt=Ge.indexOf("</"+$t+">",ze),Ge=Ge.substring(ze+1,Zt);if(/[&<]/.test(Ge))return/^script$/i.test($t)||(Ge=Ge.replace(/&#?\w+;/g,Wt)),Di.characters(Ge,0,Ge.length),Zt}return ze+1}(d,st,gt.tagName,A,y):st++}}catch(Ge){if(Ge instanceof md)throw Ge;S.error("element parse error: "+Ge),st=-1}ce<st?ce=st:P(Math.max(ge,ce)+1)}}(a,s,r,l,this.errorHandler),l.endDocument()}},Db.prototype={setTagName:function(a){if(!Cb.test(a))throw new Error("invalid tagName:"+a);this.tagName=a},addValue:function(a,s,r){if(!Cb.test(a))throw new Error("invalid attribute:"+a);this.attributeNames[a]=this.length,this[this.length++]={qName:a,value:s,offset:r}},length:0,getLocalName:function(a){return this[a].localName},getLocator:function(a){return this[a].locator},getQName:function(a){return this[a].qName},getURI:function(a){return this[a].uri},getValue:function(a){return this[a].value}};var Kl={XMLReader:Ab,ParseError:md},mD=Hf.DOMImplementation,Pb=nd.NAMESPACE,gD=Kl.ParseError,_D=Kl.XMLReader;function Lb(a){return a.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function Nb(a){this.options=a||{locator:{}}}function gd(){this.cdata=!1}function Xl(a,s){s.lineNumber=a.lineNumber,s.columnNumber=a.columnNumber}function yD(a){if(a)return`
@`+(a.systemId||"")+"#[line:"+a.lineNumber+",col:"+a.columnNumber+"]"}function Rb(a,s,r){return typeof a=="string"?a.substr(s,r):a.length>=s+r||s?new java.lang.String(a,s,r)+"":a}function Wf(a,s){(a.currentElement||a.doc).appendChild(s)}Nb.prototype.parseFromString=function(a,y){var r=this.options,l=new _D,d=r.domBuilder||new gd,A=r.errorHandler,f=r.locator,p=r.xmlns||{},y=/\/x?html?$/.test(y),S=y?cd.HTML_ENTITIES:cd.XML_ENTITIES,A=(f&&d.setDocumentLocator(f),l.errorHandler=function(P,L,B){if(!P){if(L instanceof gd)return L;P=L}var F={},K=P instanceof Function;function Q(oe){var te=P[oe];!te&&K&&(te=P.length==2?function(ce){P(oe,ce)}:P),F[oe]=te?function(ce){te("[xmldom "+oe+"]	"+ce+yD(B))}:function(){}}return B=B||{},Q("warning"),Q("error"),Q("fatalError"),F}(A,d,f),l.domBuilder=r.domBuilder||d,y&&(p[""]=Pb.HTML),p.xml=p.xml||Pb.XML,r.normalizeLineEndings||Lb);return a&&typeof a=="string"?l.parse(A(a),p,S):l.errorHandler.error("invalid doc source"),d.doc},gd.prototype={startDocument:function(){this.doc=new mD().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(a,s,r,l){var d=this.doc,f=d.createElementNS(a,r||s),p=l.length;Wf(this,f),this.currentElement=f,this.locator&&Xl(this.locator,f);for(var y=0;y<p;y++){var a=l.getURI(y),S=l.getValue(y),r=l.getQName(y),A=d.createAttributeNS(a,r);this.locator&&Xl(l.getLocator(y),A),A.value=A.nodeValue=S,f.setAttributeNode(A)}},endElement:function(a,s,r){var l=this.currentElement;l.tagName,this.currentElement=l.parentNode},startPrefixMapping:function(a,s){},endPrefixMapping:function(a){},processingInstruction:function(a,s){a=this.doc.createProcessingInstruction(a,s),this.locator&&Xl(this.locator,a),Wf(this,a)},ignorableWhitespace:function(a,s,r){},characters:function(a,s,r){var l;(a=Rb.apply(this,arguments))&&(l=this.cdata?this.doc.createCDATASection(a):this.doc.createTextNode(a),this.currentElement?this.currentElement.appendChild(l):/^\s*$/.test(a)&&this.doc.appendChild(l),this.locator)&&Xl(this.locator,l)},skippedEntity:function(a){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(a){(this.locator=a)&&(a.lineNumber=0)},comment:function(a,s,r){a=Rb.apply(this,arguments),a=this.doc.createComment(a),this.locator&&Xl(this.locator,a),Wf(this,a)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(a,s,r){var l=this.doc.implementation;l&&l.createDocumentType&&(l=l.createDocumentType(a,s,r),this.locator&&Xl(this.locator,l),Wf(this,l),this.doc.doctype=l)},warning:function(a){},error:function(a){},fatalError:function(a){throw new gD(a,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(a){gd.prototype[a]=function(){return null}});var vD=Nb;/*! @name mpd-parser @version 1.0.1 @license Apache-2.0 */const Mb=a=>!!a&&typeof a=="object",hs=(...a)=>a.reduce((s,r)=>(typeof r=="object"&&Object.keys(r).forEach(l=>{Array.isArray(s[l])&&Array.isArray(r[l])?s[l]=s[l].concat(r[l]):Mb(s[l])&&Mb(r[l])?s[l]=hs(s[l],r[l]):s[l]=r[l]}),s),{}),Ub=a=>Object.keys(a).map(s=>a[s]),Gf=a=>a.reduce((s,r)=>s.concat(r),[]),Bb=a=>{if(!a.length)return[];var s=[];for(let r=0;r<a.length;r++)s.push(a[r]);return s};var Yl={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const _d=({baseUrl:a="",source:s="",range:r="",indexRange:l=""})=>{if(a={uri:s,resolvedUri:u_(a||"",s)},r||l){s=(r||l).split("-");let d=window.BigInt?window.BigInt(s[0]):parseInt(s[0],10),f=window.BigInt?window.BigInt(s[1]):parseInt(s[1],10);d<Number.MAX_SAFE_INTEGER&&typeof d=="bigint"&&(d=Number(d)),f<Number.MAX_SAFE_INTEGER&&typeof f=="bigint"&&(f=Number(f));let p;typeof(p=typeof f=="bigint"||typeof d=="bigint"?window.BigInt(f)-window.BigInt(d)+window.BigInt(1):f-d+1)=="bigint"&&p<Number.MAX_SAFE_INTEGER&&(p=Number(p)),a.byterange={length:p,offset:d}}return a},Fb=a=>(a&&typeof a!="number"&&(a=parseInt(a,10)),isNaN(a)?null:a),TD={static(d){var{duration:f,timescale:s=1,sourceDuration:r,periodDuration:l}=d,d=Fb(d.endNumber),f=f/s;return typeof d=="number"?{start:0,end:d}:typeof l=="number"?{start:0,end:l/f}:{start:0,end:r/f}},dynamic(d){var{NOW:f,clientOffset:p,availabilityStartTime:y,timescale:s=1,duration:r,periodStart:S=0,minimumUpdatePeriod:A=0,timeShiftBufferDepth:l=1/0}=d,d=Fb(d.endNumber),f=(f+p)/1e3,p=y+S,y=Math.ceil((f+A-p)*s/r),S=Math.floor((f-p-l)*s/r),A=Math.floor((f-p)*s/r);return{start:Math.max(0,S),end:typeof d=="number"?d:Math.min(y,A)}}},b_=a=>{var s,{type:r,duration:l,timescale:d=1,periodDuration:f,sourceDuration:p}=a,{start:S,end:y}=TD[r](a),S=((A,P)=>{var L=[];for(let B=A;B<P;B++)L.push(B);return L})(S,y).map((s=a,A=>{var{duration:P,timescale:L=1,periodStart:B,startNumber:F=1}=s;return{number:F+A,duration:P/L,timeline:B,time:A*P}}));return r==="static"&&(S[y=S.length-1].duration=(typeof f=="number"?f:p)-l/d*y),S},$b=a=>{var{baseUrl:s,initialization:r={},sourceDuration:l,indexRange:d="",periodStart:f,presentationTime:p,number:y=0,duration:S}=a;if(s)return r=_d({baseUrl:s,source:r.sourceURL,range:r.range}),(s=_d({baseUrl:s,source:s,indexRange:d})).map=r,S?(d=b_(a)).length&&(s.duration=d[0].duration,s.timeline=d[0].timeline):l&&(s.duration=l,s.timeline=f),s.presentationTime=p||f,s.number=y,[s];throw new Error(Yl.NO_BASE_URL)},E_=(a,s,r)=>{var l=a.sidx.map||null,d=a.sidx.duration,f=a.timeline||0,p=a.sidx.byterange,p=p.offset+p.length,y=s.timescale,S=s.references.filter(ce=>ce.referenceType!==1),A=[],P=a.endList?"static":"dynamic",L=a.sidx.timeline;let B=L,F=a.mediaSequence||0,K;K=typeof s.firstOffset=="bigint"?window.BigInt(p)+s.firstOffset:p+s.firstOffset;for(let ce=0;ce<S.length;ce++){var oe=s.references[ce],Q=oe.referencedSize,oe=oe.subsegmentDuration;let de;de=typeof K=="bigint"?K+window.BigInt(Q)-window.BigInt(1):K+Q-1;var te=K+"-"+de,te={baseUrl:r,timescale:y,timeline:f,periodStart:L,presentationTime:B,number:F,duration:oe,sourceDuration:d,indexRange:te,type:P},te=$b(te)[0];l&&(te.map=l),A.push(te),typeof K=="bigint"?K+=window.BigInt(Q):K+=Q,B+=oe/y,F++}return a.segments=A,a},bD=["AUDIO","SUBTITLES"],jb=a=>{return a=a,s=({timeline:r})=>r,Ub(a.reduce((r,l)=>(l.forEach(d=>{r[s(d)]=d}),r),{})).sort((r,l)=>r.timeline>l.timeline?1:-1);var s},Hb=a=>{let s=[];var r,l;return r=a,a=bD,l=(d,f,p,y)=>{s=s.concat(d.playlists||[])},a.forEach(function(d){for(var f in r.mediaGroups[d])for(var p in r.mediaGroups[d][f]){var y=r.mediaGroups[d][f][p];l(y,d,f,p)}}),s},Vb=({playlist:a,mediaSequence:s})=>{a.mediaSequence=s,a.segments.forEach((r,l)=>{r.number=a.mediaSequence+l})},ED=({oldManifest:a,newManifest:s})=>{var r,l,d=a.playlists.concat(Hb(a)),f=s.playlists.concat(Hb(s));return s.timelineStarts=jb([a.timelineStarts,s.timelineStarts]),{oldPlaylists:r,newPlaylists:a,timelineStarts:l}=[{oldPlaylists:d,newPlaylists:f,timelineStarts:s.timelineStarts}][0],a.forEach(p=>{p.discontinuitySequence=l.findIndex(function({timeline:A}){return A===p.timeline});var y=((A,P)=>{for(let L=0;L<A.length;L++)if(A[L].attributes.NAME===P)return A[L];return null})(r,p.attributes.NAME);if(y&&!p.sidx){const A=p.segments[0];var S=y.segments.findIndex(function(P){return Math.abs(P.presentationTime-A.presentationTime)<1/60});S===-1?(Vb({playlist:p,mediaSequence:y.mediaSequence+y.segments.length}),p.segments[0].discontinuity=!0,p.discontinuityStarts.unshift(0),(!y.segments.length&&p.timeline>y.timeline||y.segments.length&&p.timeline>y.segments[y.segments.length-1].timeline)&&p.discontinuitySequence--):(y.segments[S].discontinuity&&!A.discontinuity&&(A.discontinuity=!0,p.discontinuityStarts.unshift(0),p.discontinuitySequence--),Vb({playlist:p,mediaSequence:y.segments[S].number}))}}),s},zf=a=>a&&a.uri+"-"+(s=>{let r;return r=typeof s.offset=="bigint"||typeof s.length=="bigint"?window.BigInt(s.offset)+window.BigInt(s.length)-window.BigInt(1):s.offset+s.length-1,s.offset+"-"+r})(a.byterange),S_=a=>Ub(a.reduce((s,r)=>{var l=r.attributes.id+(r.attributes.lang||"");return s[l]?(r.segments&&(r.segments[0]&&(r.segments[0].discontinuity=!0),s[l].segments.push(...r.segments)),r.attributes.contentProtection&&(s[l].attributes.contentProtection=r.attributes.contentProtection)):(s[l]=r,s[l].attributes.timelineStarts=[]),s[l].attributes.timelineStarts.push({start:r.attributes.periodStart,timeline:r.attributes.periodStart}),s},{})).map(s=>{var r,l;return s.discontinuityStarts=(r=s.segments||[],l="discontinuity",r.reduce((d,f,p)=>(f[l]&&d.push(p),d),[])),s}),x_=(a,l)=>{var r=zf(a.sidx),l=r&&l[r]&&l[r].sidx;return l&&E_(a,l,a.sidx.resolvedUri),a},SD=(a,s={})=>a.reduce((r,l)=>{var d,f,p,y,S=l.attributes.lang||"text";return r[S]||(r[S]={language:S,default:!1,autoselect:!1,playlists:[],uri:""}),r[S].playlists.push(x_(({attributes:S,segments:l,mediaSequence:d,discontinuityStarts:f,discontinuitySequence:p}=[l][0],typeof l>"u"&&(l=[{uri:S.baseUrl,timeline:S.periodStart,resolvedUri:S.baseUrl||"",duration:S.sourceDuration,number:0}],S.duration=S.sourceDuration),y={NAME:S.id,BANDWIDTH:S.bandwidth,"PROGRAM-ID":1},S.codecs&&(y.CODECS=S.codecs),{attributes:y,uri:"",endList:S.type==="static",timeline:S.periodStart,resolvedUri:S.baseUrl||"",targetDuration:S.duration,timelineStarts:S.timelineStarts,discontinuityStarts:f,discontinuitySequence:p,mediaSequence:d,segments:l}),s)),r},{}),xD=({attributes:a,segments:s,sidx:r,discontinuityStarts:l})=>(l={attributes:{NAME:a.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:a.width,height:a.height},CODECS:a.codecs,BANDWIDTH:a.bandwidth,"PROGRAM-ID":1},uri:"",endList:a.type==="static",timeline:a.periodStart,resolvedUri:"",targetDuration:a.duration,discontinuityStarts:l,timelineStarts:a.timelineStarts,segments:s},a.frameRate&&(l.attributes["FRAME-RATE"]=a.frameRate),a.contentProtection&&(l.contentProtection=a.contentProtection),r&&(l.sidx=r),l),wD=({attributes:a})=>a.mimeType==="video/mp4"||a.mimeType==="video/webm"||a.contentType==="video",CD=({attributes:a})=>a.mimeType==="audio/mp4"||a.mimeType==="audio/webm"||a.contentType==="audio",AD=({attributes:a})=>a.mimeType==="text/vtt"||a.contentType==="text",qb=a=>a?Object.keys(a).reduce((s,r)=>(r=a[r],s.concat(r.playlists)),[]):[],kD=({dashPlaylists:a,locations:s,sidxMapping:r={},previousManifest:l})=>{var d,f,p,y,S,A,P,L;return a.length?({sourceDuration:p,type:S,suggestedPresentationDelay:A,minimumUpdatePeriod:y}=a[0].attributes,d=S_(a.filter(wD)).map(xD),P=S_(a.filter(CD)),f=S_(a.filter(AD)),a=a.map(B=>B.attributes.captionServices).filter(Boolean),p={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:p,playlists:((B,F={})=>{if(Object.keys(F).length)for(const K in B)B[K]=x_(B[K],F);return B})(d,r)},0<=y&&(p.minimumUpdatePeriod=1e3*y),s&&(p.locations=s),S==="dynamic"&&(p.suggestedPresentationDelay=A),y=p.playlists.length===0,s=P.length?((B,F={},K)=>{let Q;return B=B.reduce((oe,te)=>{var ce=te.attributes.role&&te.attributes.role.value||"",de=te.attributes.lang||"";let xe=te.attributes.label||"main";return oe[xe=de&&!te.attributes.label?te.attributes.lang+(ce?` (${ce})`:""):xe]||(oe[xe]={language:de,autoselect:!0,default:ce==="main",playlists:[],uri:""}),de=x_((({attributes:ge,segments:Me,sidx:xt,mediaSequence:qe,discontinuitySequence:nt,discontinuityStarts:Tt},gt)=>(nt={attributes:{NAME:ge.id,BANDWIDTH:ge.bandwidth,CODECS:ge.codecs,"PROGRAM-ID":1},uri:"",endList:ge.type==="static",timeline:ge.periodStart,resolvedUri:"",targetDuration:ge.duration,discontinuitySequence:nt,discontinuityStarts:Tt,timelineStarts:ge.timelineStarts,mediaSequence:qe,segments:Me},ge.contentProtection&&(nt.contentProtection=ge.contentProtection),xt&&(nt.sidx=xt),gt&&(nt.attributes.AUDIO="audio",nt.attributes.SUBTITLES="subs"),nt))(te,K),F),oe[xe].playlists.push(de),typeof Q>"u"&&ce==="main"&&((Q=te).default=!0),oe},{}),Q||(B[Object.keys(B)[0]].default=!0),B})(P,r,y):null,S=f.length?SD(f,r):null,P=(A=d.concat(qb(s),qb(S))).map(({timelineStarts:B})=>B),p.timelineStarts=jb(P),L=p.timelineStarts,A.forEach(B=>{B.mediaSequence=0,B.discontinuitySequence=L.findIndex(function({timeline:F}){return F===B.timeline}),B.segments&&B.segments.forEach((F,K)=>{F.number=K})}),s&&(p.mediaGroups.AUDIO.audio=s),S&&(p.mediaGroups.SUBTITLES.subs=S),a.length&&(p.mediaGroups["CLOSED-CAPTIONS"].cc=a.reduce((B,F)=>(F&&F.forEach(K=>{var{channel:Q,language:oe}=K;B[oe]={autoselect:!1,default:!1,instreamId:Q,language:oe},K.hasOwnProperty("aspectRatio")&&(B[oe].aspectRatio=K.aspectRatio),K.hasOwnProperty("easyReader")&&(B[oe].easyReader=K.easyReader),K.hasOwnProperty("3D")&&(B[oe]["3D"]=K["3D"])}),B),{})),l?ED({oldManifest:l,newManifest:p}):p):{}},Wb=(a,s)=>{var{type:r,minimumUpdatePeriod:l=0,media:d="",sourceDuration:f,timescale:p=1,startNumber:y=1,periodStart:S}=a,A=[];let P=-1;for(let Q=0;Q<s.length;Q++){var F=s[Q],L=F.d,B=F.r||0,F=F.t||0;P<0&&(P=F),F&&F>P&&(P=F);let oe;oe=B<0?(F=Q+1)===s.length?r==="dynamic"&&0<l&&0<d.indexOf("$Number$")?((ge,de,xe)=>{var{NOW:ge,clientOffset:Me,availabilityStartTime:xt,timescale:qe=1,periodStart:nt=0,minimumUpdatePeriod:Tt=0}=ge;return Math.ceil((((ge+Me)/1e3+Tt-(xt+nt))*qe-de)/xe)})(a,P,L):(f*p-P)/L:(s[F].t-P)/L:B+1;var K=y+A.length+oe;let te=y+A.length;for(;te<K;)A.push({number:te,duration:L/p,time:P,timeline:S}),P+=L,te++}return A},ID=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Gb=(a,s)=>{return a.replace(ID,(r=s,(l,d,f,p)=>l==="$$"?"$":typeof r[d]>"u"?l:(l=""+r[d],d==="RepresentationID"||(p=f?parseInt(p,10):1)<=l.length?l:new Array(p-l.length+1).join("0")+l)));var r},OD=(a,s)=>{const r={RepresentationID:a.id,Bandwidth:a.bandwidth||0};var{initialization:l={sourceURL:"",range:""}}=a;const d=_d({baseUrl:a.baseUrl,source:Gb(l.sourceURL,r),range:l.range});return l=s,((s=a).duration||l?s.duration?b_(s):Wb(s,l):[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodStart}]).map(f=>{r.Number=f.number,r.Time=f.time;var p=Gb(a.media||"",r),y=a.timescale||1,S=a.presentationTimeOffset||0,S=a.periodStart+(f.time-S)/y;return{uri:p,timeline:f.timeline,duration:f.duration,resolvedUri:u_(a.baseUrl||"",p),map:d,number:f.number,presentationTime:S}})},DD=(a,s)=>{const{duration:r,segmentUrls:l=[],periodStart:d}=a;if(!r&&!s||r&&s)throw new Error(Yl.SEGMENT_TIME_UNSPECIFIED);const f=l.map(y=>{var{baseUrl:S,initialization:A={}}=S=a,A=_d({baseUrl:S,source:A.sourceURL,range:A.range});return(S=_d({baseUrl:S,source:y.media,range:y.mediaRange})).map=A,S});let p;return r&&(p=b_(a)),(p=s?Wb(a,s):p).map((y,S)=>{var A,P;if(f[S])return S=f[S],A=a.timescale||1,P=a.presentationTimeOffset||0,S.timeline=y.timeline,S.duration=y.duration,S.number=y.number,S.presentationTime=d+(y.time-P)/A,S}).filter(y=>y)},PD=({attributes:y,segmentInfo:s})=>{let r,l;s.template?(l=OD,r=hs(y,s.template)):s.base?(l=$b,r=hs(y,s.base)):s.list&&(l=DD,r=hs(y,s.list));var d,f,p,y={attributes:y};return l&&(d=l(r,s.segmentTimeline),r.duration?({duration:f,timescale:p=1}=r,r.duration=f/p):d.length?r.duration=d.reduce((S,A)=>Math.max(S,Math.ceil(A.duration)),0):r.duration=0,y.attributes=r,y.segments=d,s.base)&&r.indexRange&&(y.sidx=d[0],y.segments=[]),y},LD=a=>a.map(PD),Oi=(a,s)=>Bb(a.childNodes).filter(({tagName:r})=>r===s),w_=a=>a.textContent.trim(),Ql=p=>{var s,r,l,d,f,p=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(p);return p?([p,s,r,l,d,f]=p.slice(1),31536e3*parseFloat(p||0)+2592e3*parseFloat(s||0)+86400*parseFloat(r||0)+3600*parseFloat(l||0)+60*parseFloat(d||0)+parseFloat(f||0)):0},zb={mediaPresentationDuration(a){return Ql(a)},availabilityStartTime(a){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(a=a)&&(a+="Z"),Date.parse(a)/1e3},minimumUpdatePeriod(a){return Ql(a)},suggestedPresentationDelay(a){return Ql(a)},type(a){return a},timeShiftBufferDepth(a){return Ql(a)},start(a){return Ql(a)},width(a){return parseInt(a,10)},height(a){return parseInt(a,10)},bandwidth(a){return parseInt(a,10)},frameRate(a){return parseFloat(a.split("/").reduce((s,r)=>s/r))},startNumber(a){return parseInt(a,10)},timescale(a){return parseInt(a,10)},presentationTimeOffset(a){return parseInt(a,10)},duration(a){var s=parseInt(a,10);return isNaN(s)?Ql(a):s},d(a){return parseInt(a,10)},t(a){return parseInt(a,10)},r(a){return parseInt(a,10)},DEFAULT(a){return a}},fs=a=>a&&a.attributes?Bb(a.attributes).reduce((s,r)=>{var l=zb[r.name]||zb.DEFAULT;return s[r.name]=l(r.value),s},{}):{},ND={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Kf=(a,s)=>s.length?Gf(a.map(function(r){return s.map(function(l){return u_(r,w_(l))})})):a,C_=l=>{var p=Oi(l,"SegmentTemplate")[0],s=Oi(l,"SegmentList")[0],r=s&&Oi(s,"SegmentURL").map(S=>hs({tag:"SegmentURL"},fs(S))),l=Oi(l,"SegmentBase")[0],d=s||p,d=d&&Oi(d,"SegmentTimeline")[0],f=s||l||p,f=f&&Oi(f,"Initialization")[0],p=p&&fs(p);p&&f?p.initialization=f&&fs(f):p&&p.initialization&&(p.initialization={sourceURL:p.initialization});const y={template:p,segmentTimeline:d&&Oi(d,"S").map(S=>fs(S)),list:s&&hs(fs(s),{segmentUrls:r,initialization:fs(f)}),base:l&&hs(fs(l),{initialization:fs(f)})};return Object.keys(y).forEach(S=>{y[S]||delete y[S]}),y},RD=(a,s,r)=>L=>{var A=fs(L),d=Kf(s,Oi(L,"BaseURL")),P=Oi(L,"Role")[0],P={role:fs(P)};let f=hs(a,A,P);var p,y,S,A=Oi(L,"Accessibility")[0],A=(P=fs(A)).schemeIdUri==="urn:scte:dash:cc:cea-608:2015"?(typeof P.value!="string"?[]:P.value.split(";")).map(B=>{let F,K;return K=B,/^CC\d=/.test(B)?[F,K]=B.split("="):/^CC\d$/.test(B)&&(F=B),{channel:F,language:K}}):P.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"?(typeof P.value!="string"?[]:P.value.split(";")).map(B=>{const F={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};var K,Q;return/=/.test(B)?([K,Q=""]=B.split("="),F.channel=K,F.language=B,Q.split(",").forEach(te=>{var[te,ce]=te.split(":");te==="lang"?F.language=ce:te==="er"?F.easyReader=Number(ce):te==="war"?F.aspectRatio=Number(ce):te==="3D"&&(F["3D"]=Number(ce))})):F.language=B,F.channel&&(F.channel="SERVICE"+F.channel),F}):void 0,P=(A&&(f=hs(f,{captionServices:A})),Oi(L,"Label")[0]),P=(P&&P.childNodes.length&&(A=P.childNodes[0].nodeValue.trim(),f=hs(f,{label:A})),Oi(L,"ContentProtection").reduce((B,F)=>{var K=fs(F),Q=(K.schemeIdUri&&(K.schemeIdUri=K.schemeIdUri.toLowerCase()),ND[K.schemeIdUri]);return Q&&(B[Q]={attributes:K},K=Oi(F,"cenc:pssh")[0])&&(F=w_(K),B[Q].pssh=F&&cD(F)),B},{})),A=(Object.keys(P).length&&(f=hs(f,{contentProtection:P})),C_(L)),P=Oi(L,"Representation"),L=hs(r,A);return Gf(P.map((p=f,y=d,S=L,B=>{var F=Oi(B,"BaseURL"),F=Kf(y,F);const K=hs(p,fs(B)),Q=C_(B);return F.map(oe=>({segmentInfo:hs(S,Q),attributes:hs(K,{baseUrl:oe})}))})))},MD=(a,A={})=>{var{manifestUri:A="",NOW:r=Date.now(),clientOffset:l=0}=A,d=Oi(a,"Period");if(!d.length)throw new Error(Yl.INVALID_NUMBER_OF_PERIOD);var f=Oi(a,"Location");const p=fs(a);var y,S,A=Kf([A],Oi(a,"BaseURL"));p.type=p.type||"static",p.sourceDuration=p.mediaPresentationDuration||0,p.NOW=r,p.clientOffset=l,f.length&&(p.locations=f.map(w_));const P=[];return d.forEach((L,oe)=>{var F,K,Q=fs(L),oe=P[oe-1];Q.start=({attributes:oe,priorPeriodAttributes:F,mpdType:K}=[{attributes:Q,priorPeriodAttributes:oe?oe.attributes:null,mpdType:p.type}][0],typeof oe.start=="number"?oe.start:F&&typeof F.start=="number"&&typeof F.duration=="number"?F.start+F.duration:F||K!=="static"?null:0),P.push({node:L,attributes:Q})}),{locations:p.locations,representationInfo:Gf(P.map((y=p,S=A,(oe,B)=>{var F=Kf(S,Oi(oe.node,"BaseURL")),K=hs(y,{periodStart:oe.attributes.start}),Q=(typeof oe.attributes.duration=="number"&&(K.periodDuration=oe.attributes.duration),Oi(oe.node,"AdaptationSet")),oe=C_(oe.node);return Gf(Q.map(RD(K,F,oe)))})))}},Kb=a=>{if(a==="")throw new Error(Yl.DASH_EMPTY_MANIFEST);var s,r=new vD;let l;try{s=r.parseFromString(a,"application/xml"),l=s&&s.documentElement.tagName==="MPD"?s.documentElement:null}catch{}if(!l||l&&0<l.getElementsByTagName("parsererror").length)throw new Error(Yl.DASH_INVALID_XML);return l},UD=a=>{if(a=Kb(a),!(a=Oi(a,"UTCTiming")[0]))return null;var s=fs(a);switch(s.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":s.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":s.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":s.method="DIRECT",s.value=Date.parse(s.value);break;default:throw new Error(Yl.UNSUPPORTED_UTC_TIMING_SCHEME)}return s};function Jl(a,s){var r,l,d;return s===void 0&&(s=0),(a=dt(a)).length-s<10||!bi(a,$D,{offset:s})?s:(s+=((l=s)===void 0&&(l=0),d=(r=dt(r=a))[l+5],r=r[l+6]<<21|r[l+7]<<14|r[l+8]<<7|r[l+9],(16&d)>>4?20+r:10+r),Jl(a,s))}function Xb(a){return typeof a=="string"?eb(a):a}function Yb(a,s,r){r===void 0&&(r=!1),l=s,s=Array.isArray(l)?l.map(Xb):[Xb(l)],a=dt(a);var l,d=[];if(s.length)for(var f=0;f<a.length;){var p=(a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3])>>>0,y=a.subarray(f+4,f+8);if(p==0)break;if(p=f+p,p>a.length){if(r)break;p=a.length}var S=a.subarray(f+8,p);bi(y,s[0])&&(s.length===1?d.push(S):d.push.apply(d,Yb(S,s.slice(1),r))),f=p}return d}function Qb(a,s,r){var l;return r>=s.length?s.length:(l=Yf(s,r,!1),bi(a.bytes,l.bytes)?r:Qb(a,s,r+(a=Yf(s,r+l.length)).length+a.value+l.length))}function A_(a,s){r=s,s=Array.isArray(r)?r.map(function(A){return eE(A)}):[eE(r)],a=dt(a);var r,l=[];if(s.length)for(var d=0;d<a.length;){var f=Yf(a,d,!1),p=Yf(a,d+f.length),S=d+f.length+p.length,y=(p.value===127&&(p.value=Qb(f,a,S),p.value!==a.length)&&(p.value-=S),S+p.value>a.length?a.length:S+p.value),S=a.subarray(S,y);bi(s[0],f.bytes)&&(s.length===1?l.push(S):l=l.concat(A_(S,s.slice(1)))),d+=f.length+p.length+S.length}return l}function Jb(a,s,r,l){l===void 0&&(l=1/0),a=dt(a),r=[].concat(r);for(var d,f=0,p=0;f<a.length&&(p<l||d);){var y=void 0;if(bi(a.subarray(f),HD)?y=4:bi(a.subarray(f),VD)&&(y=3),y){if(p++,d)return WD(a.subarray(d,f));var S=void 0;s==="h264"?S=31&a[f+y]:s==="h265"&&(S=a[f+y]>>1&63),r.indexOf(S)!==-1&&(d=f+y),f+=y+(s==="h264"?1:2)}else f++}return a.subarray(0,0)}function k_(a){a=dt(a);for(var s=0;s<O_.length;s++){var r=O_[s];if(GD[r](a))return r}return""}var BD=Math.pow(2,32),Zb=function(r){var s,r=new DataView(r.buffer,r.byteOffset,r.byteLength);return r.getBigUint64?(s=r.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:r.getUint32(0)*BD+r.getUint32(4)},FD=function(a){var s=new DataView(a.buffer,a.byteOffset,a.byteLength),r={version:a[0],flags:new Uint8Array(a.subarray(1,4)),references:[],referenceId:s.getUint32(4),timescale:s.getUint32(8)},l=12,d=(r.version===0?(r.earliestPresentationTime=s.getUint32(l),r.firstOffset=s.getUint32(l+4),l+=8):(r.earliestPresentationTime=Zb(a.subarray(l)),r.firstOffset=Zb(a.subarray(l+8)),l+=16),s.getUint16(l+=2));for(l+=2;0<d;l+=12,d--)r.references.push({referenceType:(128&a[l])>>>7,referencedSize:2147483647&s.getUint32(l),subsegmentDuration:s.getUint32(l+4),startsWithSap:!!(128&a[l+8]),sapType:(112&a[l+8])>>>4,sapDeltaTime:268435455&s.getUint32(l+8)});return r},$D=dt([73,68,51]),Xf={EBML:dt([26,69,223,163]),DocType:dt([66,130]),Segment:dt([24,83,128,103]),SegmentInfo:dt([21,73,169,102]),Tracks:dt([22,84,174,107]),Track:dt([174]),TrackNumber:dt([215]),DefaultDuration:dt([35,227,131]),TrackEntry:dt([174]),TrackType:dt([131]),FlagDefault:dt([136]),CodecID:dt([134]),CodecPrivate:dt([99,162]),VideoTrack:dt([224]),AudioTrack:dt([225]),Cluster:dt([31,67,182,117]),Timestamp:dt([231]),TimestampScale:dt([42,215,177]),BlockGroup:dt([160]),BlockDuration:dt([155]),Block:dt([161]),SimpleBlock:dt([163])},I_=[128,64,32,16,8,4,2,1],jD=function(a){for(var s=1,r=0;r<I_.length&&!(a&I_[r]);r++)s++;return s},Yf=function(a,s,r,l){r===void 0&&(r=!0),l===void 0&&(l=!1);var d=jD(a[s]),f=a.subarray(s,s+d);return r&&((f=Array.prototype.slice.call(a,s,s+d))[0]^=I_[d-1]),{length:d,value:uD(f,{signed:l}),bytes:f}},eE=function a(s){return typeof s=="string"?s.match(/.{1,2}/g).map(a):typeof s=="number"?rD(s):s},HD=dt([0,0,0,1]),VD=dt([0,0,1]),qD=dt([0,0,3]),WD=function(a){for(var s=[],r=1;r<a.length-2;)bi(a.subarray(r,r+3),qD)&&(s.push(r+2),r++),r++;if(s.length===0)return a;for(var l=a.length-s.length,d=new Uint8Array(l),f=0,r=0;r<l;f++,r++)f===s[0]&&(f++,s.shift()),d[r]=a[f];return d},ws={webm:dt([119,101,98,109]),matroska:dt([109,97,116,114,111,115,107,97]),flac:dt([102,76,97,67]),ogg:dt([79,103,103,83]),ac3:dt([11,119]),riff:dt([82,73,70,70]),avi:dt([65,86,73]),wav:dt([87,65,86,69]),"3gp":dt([102,116,121,112,51,103]),mp4:dt([102,116,121,112]),fmp4:dt([115,116,121,112]),mov:dt([102,116,121,112,113,116]),moov:dt([109,111,111,118]),moof:dt([109,111,111,102])},Zl={aac:function(a){var s=Jl(a);return bi(a,[255,16],{offset:s,mask:[255,22]})},mp3:function(a){var s=Jl(a);return bi(a,[255,2],{offset:s,mask:[255,6]})},webm:function(a){return a=A_(a,[Xf.EBML,Xf.DocType])[0],bi(a,ws.webm)},mkv:function(a){return a=A_(a,[Xf.EBML,Xf.DocType])[0],bi(a,ws.matroska)},mp4:function(a){return!Zl["3gp"](a)&&!Zl.mov(a)&&(!!(bi(a,ws.mp4,{offset:4})||bi(a,ws.fmp4,{offset:4})||bi(a,ws.moof,{offset:4})||bi(a,ws.moov,{offset:4}))||void 0)},mov:function(a){return bi(a,ws.mov,{offset:4})},"3gp":function(a){return bi(a,ws["3gp"],{offset:4})},ac3:function(a){var s=Jl(a);return bi(a,ws.ac3,{offset:s})},ts:function(a){if(a.length<189&&1<=a.length)return a[0]===71;for(var s=0;s+188<a.length&&s<188;){if(a[s]===71&&a[s+188]===71)return!0;s+=1}return!1},flac:function(a){var s=Jl(a);return bi(a,ws.flac,{offset:s})},ogg:function(a){return bi(a,ws.ogg)},avi:function(a){return bi(a,ws.riff)&&bi(a,ws.avi,{offset:8})},wav:function(a){return bi(a,ws.riff)&&bi(a,ws.wav,{offset:8})},h264:function(a){return Jb(a,"h264",7,3).length},h265:function(a){return Jb(a,"h265",[32,33],3).length}},O_=Object.keys(Zl).filter(function(a){return a!=="ts"&&a!=="h264"&&a!=="h265"}).concat(["ts","h264","h265"]),GD=(O_.forEach(function(a){var s=Zl[a];Zl[a]=function(r){return s(dt(r))}}),Zl),Qf=9e4;/*! @name @videojs/http-streaming @version 3.0.0 @license Apache-2.0 */const Vn=function(a,s){if(/^[a-z]+:/i.test(s))return s;/^data:/.test(a)&&(a=window.location&&window.location.href||"");var r=typeof window.URL=="function",l=/^\/\//.test(a),d=!window.location&&!/\/\//i.test(a);return r?a=new window.URL(a,window.location||QT):/\/\//i.test(a)||(a=Rf.buildAbsoluteURL(window.location&&window.location.href||"",a)),r?(r=new URL(s,a),d?r.href.slice(QT.length):l?r.href.slice(r.protocol.length):r.href):Rf.buildAbsoluteURL(a,s)},Jf=(a,s)=>s&&s.responseURL&&a!==s.responseURL?s.responseURL:a,qn=a=>fe.log.debug?fe.log.debug.bind(fe,"VHS:",a+" >"):function(){};function oi(...a){var s=fe.obj||fe;return(s.merge||s.mergeOptions).apply(s,a)}function qs(...a){var s=fe.time||fe;return(s.createTimeRanges||s.createTimeRanges).apply(s,a)}function eu(a,s){return sE(a,function(r,l){return r-mr<=s&&l+mr>=s})}function Zf(a,s){return sE(a,function(r){return r-Ua>=s})}function tE(a){if(a&&a.length&&a.end)return a.end(a.length-1)}function D_(a,s){let r=0;if(a&&a.length)for(let f=0;f<a.length;f++){var l=a.start(f),d=a.end(f);d<s||(r+=l<s&&s<=d?d-s:d-l)}return r}function yd({defaultDuration:a,durationList:s,startIndex:r,endIndex:l}){let d=0;if(l<r&&([r,l]=[l,r]),r<0){for(let f=r;f<Math.min(0,l);f++)d+=a;r=0}for(let f=r;f<l;f++)d+=s[f].duration;return d}function iE(a,s,r,l){if(!a||!a.segments)return null;if(a.endList)return uE(a);if(s===null)return null;s=s||0;let d=lE(a,a.mediaSequence+a.segments.length,s);return r&&(l=typeof l=="number"?l:oE(null,a),d-=l),Math.max(0,d)}const Ua=1/30,mr=3*Ua,sE=function(a,s){var r=[];let l;if(a&&a.length)for(l=0;l<a.length;l++)s(a.start(l),a.end(l))&&r.push([a.start(l),a.end(l)]);return qs(r)},nE=a=>{var s=[];if(!a||!a.length)return"";for(let r=0;r<a.length;r++)s.push(a.start(r)+" => "+a.end(r));return s.join(", ")},No=a=>{var s=[];for(let r=0;r<a.length;r++)s.push({start:a.start(r),end:a.end(r)});return s},P_=(a,s)=>{if(!s.preload)return s.duration;let r=0;return(s.parts||[]).forEach(function(l){r+=l.duration}),(s.preloadHints||[]).forEach(function(l){l.type==="PART"&&(r+=a.partTargetDuration)}),r},L_=a=>(a.segments||[]).reduce((s,r,l)=>(r.parts?r.parts.forEach(function(d,f){s.push({duration:d.duration,segmentIndex:l,partIndex:f,part:d,segment:r})}):s.push({duration:r.duration,segmentIndex:l,partIndex:null,segment:r,part:null}),s),[]),rE=a=>(a=a.segments&&a.segments.length&&a.segments[a.segments.length-1],a&&a.parts||[]),aE=({preloadSegment:a})=>{var s;if(a)return{parts:a,preloadHints:s}=a,(s||[]).reduce((r,l)=>r+(l.type==="PART"?1:0),0)+(a&&a.length?a.length:0)},oE=(a,s)=>s.endList?0:a&&a.suggestedPresentationDelay?a.suggestedPresentationDelay:(a=0<rE(s).length)&&s.serverControl&&s.serverControl.partHoldBack?s.serverControl.partHoldBack:a&&s.partTargetDuration?3*s.partTargetDuration:s.serverControl&&s.serverControl.holdBack?s.serverControl.holdBack:s.targetDuration?3*s.targetDuration:0,zD=function(a,s){let r=0,l=s-a.mediaSequence,d=a.segments[l];if(d){if(typeof d.start<"u")return{result:d.start,precise:!0};if(typeof d.end<"u")return{result:d.end-d.duration,precise:!0}}for(;l--;){if(typeof(d=a.segments[l]).end<"u")return{result:r+d.end,precise:!0};if(r+=P_(a,d),typeof d.start<"u")return{result:r+d.start,precise:!0}}return{result:r,precise:!1}},KD=function(a,s){let r=0;var l;let d=s-a.mediaSequence;for(;d<a.segments.length;d++){if(typeof(l=a.segments[d]).start<"u")return{result:l.start-r,precise:!0};if(r+=P_(a,l),typeof l.end<"u")return{result:l.end-r,precise:!0}}return{result:-1,precise:!1}},lE=function(a,s,r){var l;return(s=typeof s>"u"?a.mediaSequence+a.segments.length:s)<a.mediaSequence?0:(l=zD(a,s)).precise?l.result:(a=KD(a,s)).precise?a.result:l.result+r},uE=function(a,s,r){if(!a)return 0;if(typeof r!="number"&&(r=0),typeof s>"u"){if(a.totalDuration)return a.totalDuration;if(!a.endList)return window.Infinity}return lE(a,s,r)};function cE(a){return a.excludeUntil&&a.excludeUntil>Date.now()}function N_(a){return a.excludeUntil&&a.excludeUntil===1/0}function ep(a){var s=cE(a);return!a.disabled&&!s}function dE(a,s){return s.attributes&&s.attributes[a]}function hE(a,s){var r=a&&a.mediaGroups&&a.mediaGroups.AUDIO||{};let l=!1;for(const d in r){for(const f in r[d])if(l=s(r[d][f]))break;if(l)break}return!!l}const R_=(a,s)=>{if(a.playlists.length===1)return!0;const r=s.attributes.BANDWIDTH||Number.MAX_VALUE;return a.playlists.filter(l=>!!ep(l)&&(l.attributes.BANDWIDTH||0)<r).length===0},M_=(a,s)=>!(!a&&!s||!a&&s||a&&!s||a!==s&&(!a.id||!s.id||a.id!==s.id)&&(!a.resolvedUri||!s.resolvedUri||a.resolvedUri!==s.resolvedUri)&&(!a.uri||!s.uri||a.uri!==s.uri)),vd=a=>{if(!a||!a.playlists||!a.playlists.length)return hE(a,r=>r.playlists&&r.playlists.length||r.uri);for(let r=0;r<a.playlists.length;r++){const l=a.playlists[r];var s=l.attributes&&l.attributes.CODECS;if((!s||!s.split(",").every(d=>JT(d)))&&(s=hE(a,d=>M_(l,d)),!s))return!1}return!0};var Ws={liveEdgeDelay:oE,duration:uE,seekable:function(d,s,r){var l=s||0,d=iE(d,s,!0,r);return d===null?qs():qs(l,d)},getMediaInfoForTime:function({playlist:a,currentTime:s,startingSegmentIndex:r,startingPartIndex:l,startTime:d,exactManifestTimings:f}){let p=s-d;var y=L_(a);let S=0;for(let B=0;B<y.length;B++){var A=y[B];if(r===A.segmentIndex&&(typeof l!="number"||typeof A.partIndex!="number"||l===A.partIndex)){S=B;break}}if(p<0){if(0<S)for(let B=S-1;0<=B;B--){var P=y[B];if(p+=P.duration,f){if(p<0)continue}else if(p+Ua<=0)continue;return{partIndex:P.partIndex,segmentIndex:P.segmentIndex,startTime:d-yd({defaultDuration:a.targetDuration,durationList:y,startIndex:S,endIndex:B})}}return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:s}}if(S<0){for(let B=S;B<0;B++)if((p-=a.targetDuration)<0)return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:s};S=0}for(let B=S;B<y.length;B++){var L=y[B];if(p-=L.duration,f){if(0<p)continue}else if(0<=p-Ua)continue;return{partIndex:L.partIndex,segmentIndex:L.segmentIndex,startTime:d+yd({defaultDuration:a.targetDuration,durationList:y,startIndex:S,endIndex:B})}}return{segmentIndex:y[y.length-1].segmentIndex,partIndex:y[y.length-1].partIndex,startTime:s}},isEnabled:ep,isDisabled:function(a){return a.disabled},isExcluded:cE,isIncompatible:N_,playlistEnd:iE,isAes:function(a){for(let s=0;s<a.segments.length;s++)if(a.segments[s].key)return!0;return!1},hasAttribute:dE,estimateSegmentRequestTime:function(a,s,r,l=0){return dE("BANDWIDTH",r)?(a*r.attributes.BANDWIDTH-8*l)/s:NaN},isLowestEnabledRendition:R_,isAudioOnly:vd,playlistMatch:M_,segmentDurationWithParts:P_};const fE=fe.log,U_=(a,s)=>a+"-"+s,Td=(a,s)=>{a.mediaGroups&&["AUDIO","SUBTITLES"].forEach(r=>{if(a.mediaGroups[r])for(const d in a.mediaGroups[r])for(const f in a.mediaGroups[r][d]){var l=a.mediaGroups[r][d][f];s(l,r,d,f)}})},pE=({playlist:a,uri:s,id:r})=>{a.id=r,a.playlistErrors_=0,s&&(a.uri=s),a.attributes=a.attributes||{}},mE=(a,s)=>{a.uri=s;for(let y=0;y<a.playlists.length;y++){var r;a.playlists[y].uri||(r="placeholder-uri-"+y,a.playlists[y].uri=r)}const l=vd(a);Td(a,(y,S,A,P)=>{const L=`placeholder-uri-${S}-${A}-`+P;if(!y.playlists||!y.playlists.length){if(l&&S==="AUDIO"&&!y.uri)for(let F=0;F<a.playlists.length;F++){var B=a.playlists[F];if(B.attributes&&B.attributes.AUDIO&&B.attributes.AUDIO===A)return}y.playlists=[qr({},y)]}y.playlists.forEach(function(F,K){var Q=U_(K,L);F.uri?F.resolvedUri=F.resolvedUri||Vn(a.uri,F.uri):(F.uri=K===0?L:Q,F.resolvedUri=F.uri),F.id=F.id||Q,F.attributes=F.attributes||{},a.playlists[F.id]=F,a.playlists[F.uri]=F})});{var d=a;let y=d.playlists.length;for(;y--;){var f=d.playlists[y];pE({playlist:f,id:U_(y,f.uri)}),f.resolvedUri=Vn(d.uri,f.uri),d.playlists[f.id]=f,(d.playlists[f.uri]=f).attributes.BANDWIDTH||fE.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}var p;p=a,Td(p,y=>{y.uri&&(y.resolvedUri=Vn(p.uri,y.uri))})};J=fe.EventTarget;function gE(a){var s=a.segments||[],r=a.preloadSegment;if(r&&r.parts&&r.parts.length){if(r.preloadHints){for(let l=0;l<r.preloadHints.length;l++)if(r.preloadHints[l].type==="MAP")return s}r.duration=a.targetDuration,r.preload=!0,s.push(r)}return s}const XD=(a,s)=>{if(!a)return s;var r=oi(a,s);if(a.preloadHints&&!s.preloadHints&&delete r.preloadHints,a.parts&&!s.parts)delete r.parts;else if(a.parts&&s.parts)for(let l=0;l<s.parts.length;l++)a.parts&&a.parts[l]&&(r.parts[l]=oi(a.parts[l],s.parts[l]));return!a.skipped&&s.skipped&&(r.skipped=!1),a.preload&&!s.preload&&(r.preload=!1),r},_E=(a,s)=>{!a.resolvedUri&&a.uri&&(a.resolvedUri=Vn(s,a.uri)),a.key&&!a.key.resolvedUri&&(a.key.resolvedUri=Vn(s,a.key.uri)),a.map&&!a.map.resolvedUri&&(a.map.resolvedUri=Vn(s,a.map.uri)),a.map&&a.map.key&&!a.map.key.resolvedUri&&(a.map.key.resolvedUri=Vn(s,a.map.key.uri)),a.parts&&a.parts.length&&a.parts.forEach(r=>{r.resolvedUri||(r.resolvedUri=Vn(s,r.uri))}),a.preloadHints&&a.preloadHints.length&&a.preloadHints.forEach(r=>{r.resolvedUri||(r.resolvedUri=Vn(s,r.uri))})},yE=(a,s)=>a===s||a.segments&&s.segments&&a.segments.length===s.segments.length&&a.endList===s.endList&&a.mediaSequence===s.mediaSequence&&a.preloadSegment===s.preloadSegment,B_=(a,s,r=yE)=>{var l=oi(a,{}),d=l.playlists[s.id];if(!d||r(d,s))return null;s.segments=gE(s);const f=oi(d,s);if(f.preloadSegment&&!s.preloadSegment&&delete f.preloadSegment,d.segments){if(s.skip){s.segments=s.segments||[];for(let p=0;p<s.skip.skippedSegments;p++)s.segments.unshift({skipped:!0})}f.segments=((p,y,S)=>{var A=p.slice(),P=y.slice(),L=(S=S||0,[]);let B;for(let Q=0;Q<P.length;Q++){var F=A[Q+S],K=P[Q];F?(B=F.map||B,L.push(XD(F,K))):(B&&!K.map&&(K.map=B),L.push(K))}return L})(d.segments,s.segments,s.mediaSequence-d.mediaSequence)}f.segments.forEach(p=>{_E(p,f.resolvedUri)});for(let p=0;p<l.playlists.length;p++)l.playlists[p].id===s.id&&(l.playlists[p]=f);return l.playlists[s.id]=f,l.playlists[s.uri]=f,Td(a,(p,y,S,A)=>{if(p.playlists)for(let P=0;P<p.playlists.length;P++)s.id===p.playlists[P].id&&(p.playlists[P]=f)}),l},F_=(a,s)=>{var r=a.segments||[],r=r[r.length-1],l=r&&r.parts&&r.parts[r.parts.length-1],l=l&&l.duration||r&&r.duration;return s&&l?1e3*l:500*(a.partTargetDuration||a.targetDuration||10)};class tu extends J{constructor(f,r,d={}){if(super(),!f)throw new Error("A non-empty playlist URL or object is required");this.logger_=qn("PlaylistLoader");var{withCredentials:d=!1}=d,f=(this.src=f,this.vhs_=r,this.withCredentials=d,r.options_);this.customTagParsers=f&&f.customTagParsers||[],this.customTagMappers=f&&f.customTagMappers||[],this.llhls=f&&f.llhls,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if(this.state==="HAVE_METADATA"){var s=this.media();let r=Vn(this.main.uri,s.uri);this.llhls&&(r=((l,d)=>{if(!d.endList&&d.serverControl){const y={};if(d.serverControl.canBlockReload){var f,p=d.preloadSegment;let S=d.mediaSequence+d.segments.length;p&&(p=p.parts||[],-1<(f=aE(d)-1)&&f!=p.length-1&&(y._HLS_part=f),-1<f||p.length)&&S--,y._HLS_msn=S}if(d.serverControl&&d.serverControl.canSkipUntil&&(y._HLS_skip=d.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(y).length){const S=new window.URL(l);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(A){y.hasOwnProperty(A)&&S.searchParams.set(A,y[A])}),l=S.toString()}}return l})(r,s)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:r,withCredentials:this.withCredentials},(l,d)=>{if(this.request)return l?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):void this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})})}}playlistRequestError(s,d,l){var{uri:d,id:f}=d;this.request=null,l&&(this.state=l),this.error={playlist:this.main.playlists[f],status:s.status,message:`HLS playlist request error at URL: ${d}.`,responseText:s.responseText,code:500<=s.status?4:2},this.trigger("error")}parseManifest_({url:s,manifestString:r}){{var[{onwarn:r,oninfo:l,manifestString:d,customTagParsers:f=[],customTagMappers:p=[],llhls:y}]=[{onwarn:({message:L})=>this.logger_(`m3u8-parser warn for ${s}: `+L),oninfo:({message:L})=>this.logger_(`m3u8-parser info for ${s}: `+L),manifestString:r,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls}];const A=new nD,P=(r&&A.on("warn",r),l&&A.on("info",l),f.forEach(L=>A.addParser(L)),p.forEach(L=>A.addTagMapper(L)),A.push(d),A.end(),A.manifest);if(y||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(L){P.hasOwnProperty(L)&&delete P[L]}),P.segments&&P.segments.forEach(function(L){["parts","preloadHints"].forEach(function(B){L.hasOwnProperty(B)&&delete L[B]})})),!P.targetDuration){let L=10;P.segments&&P.segments.length&&(L=P.segments.reduce((B,F)=>Math.max(B,F.duration),0)),r&&r("manifest has no targetDuration defaulting to "+L),P.targetDuration=L}return(l=rE(P)).length&&!P.partTargetDuration&&(f=l.reduce((L,B)=>Math.max(L,B.duration),0),r&&(r("manifest has no partTargetDuration defaulting to "+f),fE.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),P.partTargetDuration=f),P}}haveMetadata({playlistString:s,playlistObject:r,url:l,id:d}){this.request=null,this.state="HAVE_METADATA",r=r||this.parseManifest_({url:l,manifestString:s}),r.lastRequest=Date.now(),pE({playlist:r,uri:l,id:d}),s=B_(this.main,r),this.targetDuration=r.partTargetDuration||r.targetDuration,this.pendingMedia_=null,s?(this.main=s,this.media_=this.main.playlists[d]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(F_(this.media(),!!s)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),window.clearTimeout(this.finalRenditionTimeout),this.off()}stopRequest(){var s;this.request&&(s=this.request,this.request=null,s.onreadystatechange=null,s.abort())}media(s,r){if(!s)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof s=="string"){if(!this.main.playlists[s])throw new Error("Unknown playlist URI: "+s);s=this.main.playlists[s]}if(window.clearTimeout(this.finalRenditionTimeout),r)r=(s.partTargetDuration||s.targetDuration)/2*1e3||5e3,this.finalRenditionTimeout=window.setTimeout(this.media.bind(this,s,!1),r);else{const d=this.state;var r=!this.media_||s.id!==this.media_.id,l=this.main.playlists[s.id];if(l&&l.endList||s.endList&&s.segments.length)this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=s,r&&(this.trigger("mediachanging"),d==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));else if(this.updateMediaUpdateTimeout_(F_(s,!0)),r){if(this.state="SWITCHING_MEDIA",this.request){if(s.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=s,this.request=this.vhs_.xhr({uri:s.resolvedUri,withCredentials:this.withCredentials},(p,y)=>{if(this.request){if(s.lastRequest=Date.now(),s.resolvedUri=Jf(s.resolvedUri,y),p)return this.playlistRequestError(this.request,s,d);this.haveMetadata({playlistString:y.responseText,url:s.uri,id:s.id}),d==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}}pause(){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(s){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var r=this.media();s?(s=r?(r.partTargetDuration||r.targetDuration)/2*1e3:5e3,this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},s)):this.started?r&&!r.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(s){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(s)},s))}start(){this.started=!0,typeof this.src=="object"?(this.src.uri||(this.src.uri=window.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0)):this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(s,r)=>{if(this.request){if(this.request=null,s)return this.error={status:r.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:r.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=Jf(this.src,r),s=this.parseManifest_({manifestString:r.responseText,url:this.src}),this.setupInitialPlaylist(s)}})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(s){var r,l,d,f;this.state="HAVE_MAIN_MANIFEST",s.playlists?(this.main=s,mE(this.main,this.srcUri()),s.playlists.forEach(p=>{p.segments=gE(p),p.segments.forEach(y=>{_E(y,p.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0])):(r=this.srcUri()||window.location.href,this.main=(l=r,d=U_(0,l),(f={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:window.location.href,resolvedUri:window.location.href,playlists:[{uri:l,id:d,resolvedUri:l,attributes:{}}]}).playlists[d]=f.playlists[0],f.playlists[l]=f.playlists[0],f),this.haveMetadata({playlistObject:s,url:r,id:this.main.playlists[0].id}),this.trigger("loadedmetadata"))}}function $_(a,s,r,l){var d=a.responseType==="arraybuffer"?a.response:a.responseText;!s&&d&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=d.byteLength||d.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),r.headers&&(a.responseHeaders=r.headers),s&&s.code==="ETIMEDOUT"&&(a.timedout=!0),l(s=s||a.aborted||r.statusCode===200||r.statusCode===206||r.statusCode===0?s:new Error("XHR Failed with a response of: "+(a&&(d||a.responseText))),a)}function vE(){function a(s,r){s=oi({timeout:45e3},s);var l=a.beforeRequest||fe.Vhs.xhr.beforeRequest;l&&typeof l=="function"&&(l=l(s))&&(s=l);const d=(fe.Vhs.xhr.original===!0?JD:fe.Vhs.xhr)(s,function(p,y){return $_(d,p,y,r)}),f=d.abort;return d.abort=function(){return d.aborted=!0,f.apply(d,arguments)},d.uri=s.uri,d.requestTime=Date.now(),d}return a.original=!0,a}function j_(a){var s={};return a.byterange&&(s.Range=function(r){return"bytes="+r.offset+"-"+(typeof r.offset=="bigint"||typeof r.length=="bigint"?window.BigInt(r.offset)+window.BigInt(r.length)-window.BigInt(1):r.offset+r.length-1)}(a.byterange)),s}function YD(a,s){return a=a.toString(16),"00".substring(0,2-a.length)+a+(s%2?" ":"")}function QD(a){return 32<=a&&a<126?String.fromCharCode(a):"."}function TE(a){const s={};return Object.keys(a).forEach(r=>{var l=a[r];nb(l)?s[r]={bytes:l.buffer,byteOffset:l.byteOffset,byteLength:l.byteLength}:s[r]=l}),s}function tp(a){var s=a.byterange||{length:1/0,offset:0};return[s.length,s.offset,a.resolvedUri].join(",")}function bE(a){return a.resolvedUri}const JD=fe.xhr,EE=a=>{var s,r,l=Array.prototype.slice.call(a);let d="";for(let f=0;f<l.length/16;f++)s=l.slice(16*f,16*f+16).map(YD).join(""),r=l.slice(16*f,16*f+16).map(QD).join(""),d+=s+" "+r+`
`;return d};Y=Object.freeze({__proto__:null,createTransferableMessage:TE,initSegmentId:tp,segmentKeyId:bE,hexDump:EE,tagDump:({bytes:a})=>EE(a),textRanges:a=>{let s="",r;for(r=0;r<a.length;r++)s+=(l=a,d=r,l.start(d)+"-"+l.end(d)+" ");var l,d;return s}});const SE=.25,ZD=a=>a.transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds,eP=({playlist:a,time:s=void 0,callback:r})=>{var l,d;if(r)return a&&s!==void 0?(a=((f,p)=>{if(!p||!p.segments||p.segments.length===0)return null;let y=0,S;for(let P=0;P<p.segments.length&&(S=p.segments[P],!(f<=(y=S.videoTimingInfo?S.videoTimingInfo.transmuxedPresentationEnd:y+S.duration)));P++);var A=p.segments[p.segments.length-1];if(A.videoTimingInfo&&A.videoTimingInfo.transmuxedPresentationEnd<f)return null;if(f>y){if(f>y+A.duration*SE)return null;S=A}return{segment:S,estimatedStart:S.videoTimingInfo?S.videoTimingInfo.transmuxedPresentationStart:y-S.duration,type:S.videoTimingInfo?"accurate":"estimate"}})(s,a))?a.type==="estimate"?r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart}):(l={mediaSeconds:s},s=s,(d=(a=a.segment).dateTimeObject?(d=a.videoTimingInfo.transmuxerPrependedSeconds,s=s-(a.videoTimingInfo.transmuxedPresentationStart+d),new Date(a.dateTimeObject.getTime()+1e3*s)):null)&&(l.programDateTime=d.toISOString()),r(null,l)):r({message:"valid programTime was not found"}):r({message:"getProgramTime: playlist and time must be provided"});throw new Error("getProgramTime: callback must be provided")},xE=({programTime:a,playlist:s,retryCount:r=2,seekTo:l,pauseAfterSeek:d=!0,tech:f,callback:p})=>{var y,S,A;if(p)return typeof a<"u"&&s&&l?s.endList||f.hasStarted_?(P=>{if(!P.segments||P.segments.length===0)return!1;for(let L=0;L<P.segments.length;L++)if(!P.segments[L].dateTimeObject)return!1;return!0})(s)?(A=((Q,L)=>{let B;try{B=new Date(Q)}catch{return null}if(!L||!L.segments||L.segments.length===0)return null;let F=L.segments[0];if(B<F.dateTimeObject)return null;for(let ce=0;ce<L.segments.length-1;ce++){F=L.segments[ce];var K=L.segments[ce+1].dateTimeObject;if(B<K)break}var Q=L.segments[L.segments.length-1],oe=Q.dateTimeObject,te=Q.videoTimingInfo?ZD(Q.videoTimingInfo):Q.duration+Q.duration*SE,te=new Date(oe.getTime()+1e3*te);return B>te?null:{segment:F=B>oe?Q:F,estimatedStart:F.videoTimingInfo?F.videoTimingInfo.transmuxedPresentationStart:Ws.duration(L,L.mediaSequence+L.segments.indexOf(F)),type:F.videoTimingInfo?"accurate":"estimate"}})(a,s))?(S=((P,L)=>{let B,F;try{B=new Date(P),F=new Date(L)}catch{}return P=B.getTime(),(F.getTime()-P)/1e3})((y=A.segment).dateTimeObject,a),A.type==="estimate"?r===0?p({message:a+" is not buffered yet. Try again"}):(l(A.estimatedStart+S),void f.one("seeked",()=>{xE({programTime:a,playlist:s,retryCount:r-1,seekTo:l,pauseAfterSeek:d,tech:f,callback:p})})):(A=y.start+S,f.one("seeked",()=>p(null,f.currentTime())),d&&f.pause(),void l(A))):p({message:a+" was not found in the stream"}):p({message:"programDateTime tags must be provided in the manifest "+s.resolvedUri}):p({message:"player must be playing a live stream to start buffering"}):p({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});throw new Error("seekToProgramTime: callback must be provided")},tP=(a,s)=>{if(a.readyState===4)return s()},iP=(a,s,r)=>{let l=[],d,f=!1;function p(A,P,L,B){return P.abort(),f=!0,r(A,P,L,B)}function y(A,P){var L;if(!f)return A?p(A,P,"",l):(L=P.responseText.substring(l&&l.byteLength||0,P.responseText.length),l=function(){for(var B,F,K,Q=arguments.length,oe=new Array(Q),te=0;te<Q;te++)oe[te]=arguments[te];return(oe=oe.filter(function(ce){return ce&&(ce.byteLength||ce.length)&&typeof ce!="string"})).length<=1?dt(oe[0]):(B=oe.reduce(function(ce,de,xe){return ce+(de.byteLength||de.length)},0),F=new Uint8Array(B),K=0,oe.forEach(function(ce){ce=dt(ce),F.set(ce,K),K+=ce.byteLength}),F)}(l,eb(L,!0)),d=d||Jl(l),l.length<10||d&&l.length<d+2||(L=k_(l))==="ts"&&l.length<188||!L&&l.length<376?tP(P,()=>p(A,P,"",l)):p(null,P,L,l))}const S=s({uri:a,beforeSend(A){A.overrideMimeType("text/plain; charset=x-user-defined"),A.addEventListener("progress",function({}){return $_(A,null,{statusCode:A.status},y)})}},function(A,P){return $_(S,A,P,y)});return S};$=fe.EventTarget;function wE(a,s){if(!yE(a,s)||a.sidx&&s.sidx&&(a.sidx.offset!==s.sidx.offset||a.sidx.length!==s.sidx.length)||!a.sidx&&s.sidx||a.sidx&&!s.sidx||a.segments&&!s.segments||!a.segments&&s.segments)return!1;if(a.segments||s.segments)for(let d=0;d<a.segments.length;d++){var r=a.segments[d],l=s.segments[d];if(r.uri!==l.uri||(r.byterange||l.byterange)&&(r=r.byterange,l=l.byterange,r&&!l||!r&&l||r.offset!==l.offset||r.length!==l.length))return!1}return!0}const sP=({mainXml:a,srcUrl:s,clientOffset:r,sidxMapping:l,previousManifest:d})=>(a=a,r={manifestUri:s,clientOffset:r,sidxMapping:l,previousManifest:d},a=MD(Kb(a),r),l=LD(a.representationInfo),d=kD({dashPlaylists:l,locations:a.locations,sidxMapping:r.sidxMapping,previousManifest:r.previousManifest}),mE(d,s),d),nP=(a,s)=>(Boolean(!a.map&&!s.map)||Boolean(a.map&&s.map&&a.map.byterange.offset===s.map.byterange.offset&&a.map.byterange.length===s.map.byterange.length))&&a.uri===s.uri&&a.byterange.offset===s.byterange.offset&&a.byterange.length===s.byterange.length,CE=(a,s)=>{var r={};for(const p in a){var l=a[p].sidx;if(l){var d=zf(l);if(!s[d])break;var f=s[d].sidxInfo;nP(f,l)&&(r[d]=s[d])}}return r};class H_ extends ${constructor(s,r,l={},f){super(),this.mainPlaylistLoader_=f||this,f||(this.isMain_=!0);var{withCredentials:f=!1}=l;if(this.vhs_=r,this.withCredentials=f,!s)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=qn("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=s,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=s}requestErrored_(s,r,l){return!this.request||(this.request=null,s?(this.error=typeof s!="object"||s instanceof Error?{status:r.status,message:"DASH request error at URL: "+r.uri,response:r.response,code:2}:s,l&&(this.state=l),this.trigger("error"),!0):void 0)}addSidxSegments_(s,r,l){const d=s.sidx&&zf(s.sidx);if(s.sidx&&d&&!this.mainPlaylistLoader_.sidxMapping_[d]){const f=Jf(s.sidx.resolvedUri),p=(y,S)=>{if(!this.requestErrored_(y,S,r)){y=this.mainPlaylistLoader_.sidxMapping_;let A;try{A=FD(dt(S.response).subarray(8))}catch(P){return void this.requestErrored_(P,S,r)}return y[d]={sidxInfo:s.sidx,sidx:A},E_(s,A,s.sidx.resolvedUri),l(!0)}};this.request=iP(f,this.vhs_.xhr,(y,S,A,P)=>{var L,B;return y?p(y,S):A&&A==="mp4"?({offset:L,length:B}=s.sidx.byterange,P.length>=B+L?p(y,{response:P.subarray(L,L+B),status:S.status,uri:S.uri}):void(this.request=this.vhs_.xhr({uri:f,responseType:"arraybuffer",headers:j_({byterange:s.sidx.byterange})},p))):p({status:S.status,message:`Unsupported ${A||"unknown"} container type for sidx segment at URL: `+f,response:"",playlist:s,internal:!0,playlistExclusionDuration:1/0,code:2},S)})}else this.mediaRequest_=window.setTimeout(()=>l(!1),0)}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},window.clearTimeout(this.minimumUpdatePeriodTimeout_),window.clearTimeout(this.mediaRequest_),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){var s;this.request&&(s=this.request,this.request=null,s.onreadystatechange=null,s.abort())}media(s){if(!s)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const r=this.state;if(typeof s=="string"){if(!this.mainPlaylistLoader_.main.playlists[s])throw new Error("Unknown playlist URI: "+s);s=this.mainPlaylistLoader_.main.playlists[s]}var l=!this.media_||s.id!==this.media_.id;l&&this.loadedPlaylists_[s.id]&&this.loadedPlaylists_[s.id].endList?(this.state="HAVE_METADATA",this.media_=s,l&&(this.trigger("mediachanging"),this.trigger("mediachange"))):l&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(s,r,d=>{this.haveMetadata({startingState:r,playlist:s})}))}haveMetadata({startingState:s,playlist:r}){this.state="HAVE_METADATA",this.loadedPlaylists_[r.id]=r,this.mediaRequest_=null,this.refreshMedia_(r.id),s==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(window.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(s){window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var r=this.media();s?(s=r?r.targetDuration/2*1e3:5e3,this.mediaUpdateTimeout=window.setTimeout(()=>this.load(),s)):this.started?r&&!r.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){this.started=!0,this.isMain_?this.requestMain_((s,r)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}):this.mediaRequest_=window.setTimeout(()=>this.haveMain_(),0)}requestMain_(s){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(r,l)=>{if(this.requestErrored_(r,l))this.state==="HAVE_NOTHING"&&(this.started=!1);else{const d=l.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=l.responseText,l.responseHeaders&&l.responseHeaders.date?this.mainLoaded_=Date.parse(l.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Jf(this.mainPlaylistLoader_.srcUrl,l),!d)return s(l,d);this.handleMain_(),this.syncClientServerClock_(()=>s(l,d))}})}syncClientServerClock_(s){const r=UD(this.mainPlaylistLoader_.mainXml_);return r===null?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),s()):r.method==="DIRECT"?(this.mainPlaylistLoader_.clientOffset_=r.value-Date.now(),s()):void(this.request=this.vhs_.xhr({uri:Vn(this.mainPlaylistLoader_.srcUrl,r.value),method:r.method,withCredentials:this.withCredentials},(l,d)=>{if(this.request){if(l)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),s();let f;f=r.method==="HEAD"?d.responseHeaders&&d.responseHeaders.date?Date.parse(d.responseHeaders.date):this.mainLoaded_:Date.parse(d.responseText),this.mainPlaylistLoader_.clientOffset_=f-Date.now(),s()}}))}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;var s=this.mainPlaylistLoader_.main;let r=sP({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:s});s&&(r=((d,f,p)=>{let y=!0,S=oi(d,{duration:f.duration,minimumUpdatePeriod:f.minimumUpdatePeriod,timelineStarts:f.timelineStarts});for(let L=0;L<f.playlists.length;L++){var A=f.playlists[L],P=(A.sidx&&(P=zf(A.sidx),p)&&p[P]&&p[P].sidx&&E_(A,p[P].sidx,A.sidx.resolvedUri),B_(S,A,wE));P&&(S=P,y=!1)}return Td(f,(L,B,F,K)=>{var Q;L.playlists&&L.playlists.length&&(Q=L.playlists[0].id,L=B_(S,L.playlists[0],wE))&&((S=L).mediaGroups[B][F][K].playlists[0]=S.playlists[Q],y=!1)}),(y=f.minimumUpdatePeriod===d.minimumUpdatePeriod&&y)?null:S})(s,r,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=r||s;var l=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return l&&l!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=l),(!s||r&&r.minimumUpdatePeriod!==s.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(r)}updateMinimumUpdatePeriodTimeout_(){var s=this.mainPlaylistLoader_;s.createMupOnMedia_&&(s.off("loadedmetadata",s.createMupOnMedia_),s.createMupOnMedia_=null),s.minimumUpdatePeriodTimeout_&&(window.clearTimeout(s.minimumUpdatePeriodTimeout_),s.minimumUpdatePeriodTimeout_=null);let r=s.main&&s.main.minimumUpdatePeriod;r===0&&(s.media()?r=1e3*s.media().targetDuration:(s.createMupOnMedia_=s.updateMinimumUpdatePeriodTimeout_,s.one("loadedmetadata",s.createMupOnMedia_))),typeof r!="number"||r<=0?r<0&&this.logger_(`found invalid minimumUpdatePeriod of ${r}, not setting a timeout`):this.createMUPTimeout_(r)}createMUPTimeout_(s){const r=this.mainPlaylistLoader_;r.minimumUpdatePeriodTimeout_=window.setTimeout(()=>{r.minimumUpdatePeriodTimeout_=null,r.trigger("minimumUpdatePeriod"),r.createMUPTimeout_(s)},s)}refreshXml_(){this.requestMain_((s,r)=>{r&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((l,d)=>{let f=CE(l.playlists,d);return Td(l,(p,y,S,A)=>{p.playlists&&p.playlists.length&&(p=p.playlists,f=oi(f,CE(p,d)))}),f})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,l=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(s){if(!s)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();var r=this.mainPlaylistLoader_.main.playlists;const l=!this.media_||this.media_!==r[s];if(l?this.media_=r[s]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const d=()=>{this.media().endList||(this.mediaUpdateTimeout=window.setTimeout(()=>{this.trigger("mediaupdatetimeout"),d()},F_(this.media(),Boolean(l))))};d()}this.trigger("loadedplaylist")}}var Yi={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};function AE(a){return a.on=a.addEventListener,a.off=a.removeEventListener,a}const rP=a=>{var s=new Uint8Array(new ArrayBuffer(a.length));for(let r=0;r<a.length;r++)s[r]=a.charCodeAt(r);return s.buffer};function kE(a){return function(){const s=function(d){try{return URL.createObjectURL(new Blob([d],{type:"application/javascript"}))}catch{var f=new BlobBuilder;return f.append(d),URL.createObjectURL(f.getBlob())}}(a);var r=AE(new Worker(s));r.objURL=s;const l=r.terminate;return r.on=r.addEventListener,r.off=r.removeEventListener,r.terminate=function(){return URL.revokeObjectURL(s),l.call(this)},r}}function IE(a){return`var browserWorkerPolyFill = ${AE.toString()};
browserWorkerPolyFill(self);
`+a}function OE(a){return a.toString().replace(/^function.+?{/,"").slice(0,-1)}var aP=kE(IE(OE(function(){function a(){this.init=function(){var _={};this.on=function(E,k){_[E]||(_[E]=[]),_[E]=_[E].concat(k)},this.off=function(E,k){return!!_[E]&&(k=_[E].indexOf(k),_[E]=_[E].slice(),_[E].splice(k,1),-1<k)},this.trigger=function(E){var k,C,D,U=_[E];if(U)if(arguments.length===2)for(C=U.length,k=0;k<C;++k)U[k].call(this,arguments[1]);else{for(D=[],k=arguments.length,k=1;k<arguments.length;++k)D.push(arguments[k]);for(C=U.length,k=0;k<C;++k)U[k].apply(this,D)}},this.dispose=function(){_={}}}}var s,r,l,d,f,p,y,S,A,P,L,B,F,K,Q,oe,te,ce,de,xe,ge,Me,xt,qe,nt,Tt,gt,Ci,st,Lt,Nt,Vi,cn,Ge,ze,$t,Wt,Di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Yn<"u"?Yn:typeof self<"u"?self:{},En=(a.prototype.pipe=function(_){return this.on("data",function(E){_.push(E)}),this.on("done",function(E){_.flush(E)}),this.on("partialdone",function(E){_.partialFlush(E)}),this.on("endedtimeline",function(E){_.endTimeline(E)}),this.on("reset",function(E){_.reset(E)}),_},a.prototype.push=function(_){this.trigger("data",_)},a.prototype.flush=function(_){this.trigger("done",_)},a.prototype.partialFlush=function(_){this.trigger("partialdone",_)},a.prototype.endTimeline=function(_){this.trigger("endedtimeline",_)},a.prototype.reset=function(_){this.trigger("reset",_)},a),Zt=Math.pow(2,32),As={getUint64:function(k){var E,k=new DataView(k.buffer,k.byteOffset,k.byteLength);return k.getBigUint64?(E=k.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(E):E:k.getUint32(0)*Zt+k.getUint32(4)},MAX_UINT32:Zt},Ei=As.MAX_UINT32;if(ge={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array<"u"){for(var Gt in ge)ge.hasOwnProperty(Gt)&&(ge[Gt]=[Gt.charCodeAt(0),Gt.charCodeAt(1),Gt.charCodeAt(2),Gt.charCodeAt(3)]);Me=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),qe=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),xt=new Uint8Array([0,0,0,1]),Z_=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ey=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),nt={video:Z_,audio:ey},Ci=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),gt=new Uint8Array([0,0,0,0,0,0,0,0]),st=new Uint8Array([0,0,0,0,0,0,0,0]),Lt=st,Nt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Vi=st,Tt=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}s=function(_){for(var E,k=[],C=0,D=1;D<arguments.length;D++)k.push(arguments[D]);for(D=k.length;D--;)C+=k[D].byteLength;for(E=new Uint8Array(C+8),new DataView(E.buffer,E.byteOffset,E.byteLength).setUint32(0,E.byteLength),E.set(_,4),D=0,C=8;D<k.length;D++)E.set(k[D],C),C+=k[D].byteLength;return E},r=function(){return s(ge.dinf,s(ge.dref,Ci))},l=function(_){return s(ge.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,_.audioobjecttype<<3|_.samplingfrequencyindex>>>1,_.samplingfrequencyindex<<7|_.channelcount<<3,6,1,2]))},K=function(_){return s(ge.hdlr,nt[_])},F=function(_){var E=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,_.duration>>>24&255,_.duration>>>16&255,_.duration>>>8&255,255&_.duration,85,196,0,0]);return _.samplerate&&(E[12]=_.samplerate>>>24&255,E[13]=_.samplerate>>>16&255,E[14]=_.samplerate>>>8&255,E[15]=255&_.samplerate),s(ge.mdhd,E)},B=function(_){return s(ge.mdia,F(_),K(_.type),p(_))},f=function(_){return s(ge.mfhd,new Uint8Array([0,0,0,0,(4278190080&_)>>24,(16711680&_)>>16,(65280&_)>>8,255&_]))},p=function(_){return s(ge.minf,_.type==="video"?s(ge.vmhd,Tt):s(ge.smhd,gt),r(),oe(_))},S=function(_){for(var E=_.length,k=[];E--;)k[E]=de(_[E]);return s.apply(null,[ge.mvex].concat(k))},A=function(_){return _=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&_)>>24,(16711680&_)>>16,(65280&_)>>8,255&_,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]),s(ge.mvhd,_)},Q=function(_){for(var E,k=_.samples||[],C=new Uint8Array(4+k.length),D=0;D<k.length;D++)E=k[D].flags,C[D+4]=E.dependsOn<<4|E.isDependedOn<<2|E.hasRedundancy;return s(ge.sdtp,C)},oe=function(_){return s(ge.stbl,te(_),s(ge.stts,Vi),s(ge.stsc,Lt),s(ge.stsz,Nt),s(ge.stco,st))},te=function(_){return s(ge.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),(_.type==="video"?cn:Ge)(_))},cn=function(_){for(var E,k,C=_.sps||[],D=_.pps||[],U=[],H=[],G=0;G<C.length;G++)U.push((65280&C[G].byteLength)>>>8),U.push(255&C[G].byteLength),U=U.concat(Array.prototype.slice.call(C[G]));for(G=0;G<D.length;G++)H.push((65280&D[G].byteLength)>>>8),H.push(255&D[G].byteLength),H=H.concat(Array.prototype.slice.call(D[G]));return E=[ge.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&_.width)>>8,255&_.width,(65280&_.height)>>8,255&_.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s(ge.avcC,new Uint8Array([1,_.profileIdc,_.profileCompatibility,_.levelIdc,255].concat([C.length],U,[D.length],H))),s(ge.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],_.sarRatio&&(k=_.sarRatio[0],_=_.sarRatio[1],E.push(s(ge.pasp,new Uint8Array([(4278190080&k)>>24,(16711680&k)>>16,(65280&k)>>8,255&k,(4278190080&_)>>24,(16711680&_)>>16,(65280&_)>>8,255&_])))),s.apply(null,E)},Ge=function(_){return s(ge.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&_.channelcount)>>8,255&_.channelcount,(65280&_.samplesize)>>8,255&_.samplesize,0,0,0,0,(65280&_.samplerate)>>8,255&_.samplerate,0,0]),l(_))},L=function(_){return _=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&_.id)>>24,(16711680&_.id)>>16,(65280&_.id)>>8,255&_.id,0,0,0,0,(4278190080&_.duration)>>24,(16711680&_.duration)>>16,(65280&_.duration)>>8,255&_.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&_.width)>>8,255&_.width,0,0,(65280&_.height)>>8,255&_.height,0,0]),s(ge.tkhd,_)},ce=function(_){var E,k=s(ge.tfhd,new Uint8Array([0,0,0,58,(4278190080&_.id)>>24,(16711680&_.id)>>16,(65280&_.id)>>8,255&_.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),D=Math.floor(_.baseMediaDecodeTime/Ei),C=Math.floor(_.baseMediaDecodeTime%Ei),D=s(ge.tfdt,new Uint8Array([1,0,0,0,D>>>24&255,D>>>16&255,D>>>8&255,255&D,C>>>24&255,C>>>16&255,C>>>8&255,255&C]));return _.type==="audio"?(E=xe(_,92),s(ge.traf,k,D,E)):(C=Q(_),E=xe(_,C.length+92),s(ge.traf,k,D,E,C))},P=function(_){return _.duration=_.duration||4294967295,s(ge.trak,L(_),B(_))},de=function(_){var E=new Uint8Array([0,0,0,0,(4278190080&_.id)>>24,(16711680&_.id)>>16,(65280&_.id)>>8,255&_.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return _.type!=="video"&&(E[E.length-1]=0),s(ge.trex,E)},ze=function(_,E){var k=0,C=0,D=0,U=0;return _.length&&(_[0].duration!==void 0&&(k=1),_[0].size!==void 0&&(C=2),_[0].flags!==void 0&&(D=4),_[0].compositionTimeOffset!==void 0)&&(U=8),[0,0,k|C|D|U,1,(4278190080&_.length)>>>24,(16711680&_.length)>>>16,(65280&_.length)>>>8,255&_.length,(4278190080&E)>>>24,(16711680&E)>>>16,(65280&E)>>>8,255&E]},$t=function(_,E){var k,C,D,U,H=_.samples||[];for(E+=20+16*H.length,_=ze(H,E),(C=new Uint8Array(_.length+16*H.length)).set(_),k=_.length,U=0;U<H.length;U++)D=H[U],C[k++]=(4278190080&D.duration)>>>24,C[k++]=(16711680&D.duration)>>>16,C[k++]=(65280&D.duration)>>>8,C[k++]=255&D.duration,C[k++]=(4278190080&D.size)>>>24,C[k++]=(16711680&D.size)>>>16,C[k++]=(65280&D.size)>>>8,C[k++]=255&D.size,C[k++]=D.flags.isLeading<<2|D.flags.dependsOn,C[k++]=D.flags.isDependedOn<<6|D.flags.hasRedundancy<<4|D.flags.paddingValue<<1|D.flags.isNonSyncSample,C[k++]=61440&D.flags.degradationPriority,C[k++]=15&D.flags.degradationPriority,C[k++]=(4278190080&D.compositionTimeOffset)>>>24,C[k++]=(16711680&D.compositionTimeOffset)>>>16,C[k++]=(65280&D.compositionTimeOffset)>>>8,C[k++]=255&D.compositionTimeOffset;return s(ge.trun,C)},Wt=function(_,E){var k,C,D,U,H=_.samples||[];for(E+=20+8*H.length,_=ze(H,E),(k=new Uint8Array(_.length+8*H.length)).set(_),C=_.length,U=0;U<H.length;U++)D=H[U],k[C++]=(4278190080&D.duration)>>>24,k[C++]=(16711680&D.duration)>>>16,k[C++]=(65280&D.duration)>>>8,k[C++]=255&D.duration,k[C++]=(4278190080&D.size)>>>24,k[C++]=(16711680&D.size)>>>16,k[C++]=(65280&D.size)>>>8,k[C++]=255&D.size;return s(ge.trun,k)},xe=function(_,E){return(_.type==="audio"?Wt:$t)(_,E)};function zt(_,E){var k=MP();return k.dataOffset=E,k.compositionTimeOffset=_.pts-_.dts,k.duration=_.duration,k.size=4*_.length,k.size+=_.byteLength,_.keyFrame&&(k.flags.dependsOn=2,k.flags.isNonSyncSample=0),k}function At(_){for(var E=[];_--;)E.push(0);return E}function pt(_){_=_||{},pt.prototype.init.call(this),this.parse708captions_=typeof _.parse708captions!="boolean"||_.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Si(0,0),new Si(0,1),new Si(1,0),new Si(1,1)],this.parse708captions_&&(this.cc708Stream_=new li({captionServices:_.captionServices})),this.reset(),this.ccStreams_.forEach(function(E){E.on("data",this.trigger.bind(this,"data")),E.on("partialdone",this.trigger.bind(this,"partialdone")),E.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))}function Wn(_){return 32<=_&&_<=127||160<=_&&_<=255}function dn(_){this.windowNum=_,this.reset()}function Jr(_,E,k){this.serviceNum=_,this.text="",this.currentWindow=new dn(-1),this.windows=[],this.stream=k,typeof E=="string"&&this.createTextDecoder(E)}function op(_){return _===null?"":(_=$P[_]||_,String.fromCharCode(_))}function Ro(){for(var _=[],E=dp+1;E--;)_.push("");return _}function Y_(_,E){var k=1;for(E<_&&(k=-1);Math.abs(E-_)>VP;)_+=k*HP;return _}function Q_(_){var E,k;Q_.prototype.init.call(this),this.type_=_||"shared",this.push=function(C){this.type_!=="shared"&&C.type!==this.type_||(k===void 0&&(k=C.dts),C.dts=Y_(C.dts,k),C.pts=Y_(C.pts,k),E=C.dts,this.trigger("data",C))},this.flush=function(){k=E,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){E=k=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}var J_,Z_={ftyp:d=function(){return s(ge.ftyp,Me,xt,Me,qe)},mdat:function(_){return s(ge.mdat,_)},moof:function(_,E){for(var k=[],C=E.length;C--;)k[C]=ce(E[C]);return s.apply(null,[ge.moof,f(_)].concat(k))},moov:y=function(_){for(var E=_.length,k=[];E--;)k[E]=P(_[E]);return s.apply(null,[ge.moov,A(4294967295)].concat(k).concat(S(_)))},initSegment:function(k){var E=d(),k=y(k),C=new Uint8Array(E.byteLength+k.byteLength);return C.set(E),C.set(k,E.byteLength),C}},MP=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},ey={groupNalsIntoFrames:function(_){var E,k,C=[],D=[];for(D.byteLength=0,D.nalCount=0,E=C.byteLength=D.duration=0;E<_.length;E++)(k=_[E]).nalUnitType==="access_unit_delimiter_rbsp"?(C.length&&(C.duration=k.dts-C.dts,D.byteLength+=C.byteLength,D.nalCount+=C.length,D.duration+=C.duration,D.push(C)),(C=[k]).byteLength=k.data.byteLength,C.pts=k.pts,C.dts=k.dts):(k.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(C.keyFrame=!0),C.duration=k.dts-C.dts,C.byteLength+=k.data.byteLength,C.push(k));return D.length&&(!C.duration||C.duration<=0)&&(C.duration=D[D.length-1].duration),D.byteLength+=C.byteLength,D.nalCount+=C.length,D.duration+=C.duration,D.push(C),D},groupFramesIntoGops:function(_){var E,k,C=[],D=[];for(C.byteLength=0,C.nalCount=0,C.duration=0,C.pts=_[0].pts,C.dts=_[0].dts,D.byteLength=0,D.nalCount=0,D.duration=0,D.pts=_[0].pts,D.dts=_[0].dts,E=0;E<_.length;E++)(k=_[E]).keyFrame?(C.length&&(D.push(C),D.byteLength+=C.byteLength,D.nalCount+=C.nalCount,D.duration+=C.duration),(C=[k]).nalCount=k.length,C.byteLength=k.byteLength,C.pts=k.pts,C.dts=k.dts,C.duration=k.duration):(C.duration+=k.duration,C.nalCount+=k.length,C.byteLength+=k.byteLength,C.push(k));return D.length&&C.duration<=0&&(C.duration=D[D.length-1].duration),D.byteLength+=C.byteLength,D.nalCount+=C.nalCount,D.duration+=C.duration,D.push(C),D},extendFirstKeyFrame:function(_){var E;return!_[0][0].keyFrame&&1<_.length&&(E=_.shift(),_.byteLength-=E.byteLength,_.nalCount-=E.nalCount,_[0][0].dts=E.dts,_[0][0].pts=E.pts,_[0][0].duration+=E.duration),_},generateSampleTable:function(_,E){for(var k,C,D,U=E||0,H=[],G=0;G<_.length;G++)for(C=_[G],k=0;k<C.length;k++)D=C[k],U+=(D=zt(D,U)).size,H.push(D);return H},concatenateNalData:function(_){for(var E,k,C,D,U,H=0,G=_.byteLength,ae=_.nalCount,ue=new Uint8Array(G+4*ae),Te=new DataView(ue.buffer),we=0;we<_.length;we++)for(C=_[we],E=0;E<C.length;E++)for(D=C[E],k=0;k<D.length;k++)U=D[k],Te.setUint32(H,U.data.byteLength),ue.set(U.data,H+=4),H+=U.data.byteLength;return ue},generateSampleTableForFrame:function(C,E){var k=[],C=zt(C,E||0);return k.push(C),k},concatenateNalDataForFrame:function(_){for(var E,k=0,C=_.byteLength,D=_.length,U=new Uint8Array(C+4*D),H=new DataView(U.buffer),G=0;G<_.length;G++)E=_[G],H.setUint32(k,E.data.byteLength),U.set(E.data,k+=4),k+=E.data.byteLength;return U}},Ba=[33,16,5,32,164,27],ty=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Id=function(_){return 9e4*_},Od=function(_,E){return _*E},cS=function(_){return _/9e4},up=function(_,E){return _/E},_i={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:Id,secondsToAudioTs:Od,videoTsToSeconds:cS,audioTsToSeconds:up,audioTsToVideoTs:function(_,E){return _/E*9e4},videoTsToAudioTs:function(_,E){return _/9e4*E},metadataTsToSeconds:function(_,E,k){return cS(k?_:_-E)}},UP=function(){var _,E;return J_||(_={96e3:[Ba,[227,64],At(154),[56]],88200:[Ba,[231],At(170),[56]],64e3:[Ba,[248,192],At(240),[56]],48e3:[Ba,[255,192],At(268),[55,148,128],At(54),[112]],44100:[Ba,[255,192],At(268),[55,163,128],At(84),[112]],32e3:[Ba,[255,192],At(268),[55,234],At(226),[112]],24e3:[Ba,[255,192],At(268),[55,255,128],At(268),[111,112],At(126),[224]],16e3:[Ba,[255,192],At(268),[55,255,128],At(268),[111,255],At(269),[223,108],At(195),[1,192]],12e3:[ty,At(268),[3,127,248],At(268),[6,255,240],At(268),[13,255,224],At(268),[27,253,128],At(259),[56]],11025:[ty,At(268),[3,127,248],At(268),[6,255,240],At(268),[13,255,224],At(268),[27,255,192],At(268),[55,175,128],At(108),[112]],8e3:[ty,At(268),[3,121,16],At(47),[7]]},E=_,J_=Object.keys(E).reduce(function(k,C){return k[C]=new Uint8Array(E[C].reduce(function(D,U){return D.concat(U)},[])),k},{})),J_},lp=_i,Id={prefixWithSilence:function(_,E,k,C){var D,U,H,G,ae,ue=0,Te=0;if(E.length&&(U=lp.audioTsToVideoTs(_.baseMediaDecodeTime,_.samplerate),D=Math.ceil(lp.ONE_SECOND_IN_TS/(_.samplerate/1024)),k&&C&&(U=U-Math.max(k,C),Te=(ue=Math.floor(U/D))*D),!(ue<1||Te>lp.ONE_SECOND_IN_TS/2))){for(H=(H=UP()[_.samplerate])||E[0].data,G=0;G<ue;G++)ae=E[0],E.splice(0,0,{data:H,dts:ae.dts-D,pts:ae.pts-D});return _.baseMediaDecodeTime-=Math.floor(lp.videoTsToAudioTs(Te,_.samplerate)),Te}},trimAdtsFramesByEarliestDts:function(_,E,k){return E.minSegmentDts>=k?_:(E.minSegmentDts=1/0,_.filter(function(C){return C.dts>=k&&(E.minSegmentDts=Math.min(E.minSegmentDts,C.dts),E.minSegmentPts=E.minSegmentDts,!0)}))},generateSampleTable:function(_){for(var E,k=[],C=0;C<_.length;C++)E=_[C],k.push({size:E.data.byteLength,duration:1024});return k},concatenateFrameData:function(_){for(var E,k=0,C=new Uint8Array(function(U){for(var H=0,G=0;G<U.length;G++)H+=U[G].data.byteLength;return H}(_)),D=0;D<_.length;D++)E=_[D],C.set(E.data,k),k+=E.data.byteLength;return C}},BP=_i.ONE_SECOND_IN_TS,Od={clearDtsInfo:function(_){delete _.minSegmentDts,delete _.maxSegmentDts,delete _.minSegmentPts,delete _.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(_,E){var k=_.minSegmentDts;return E||(k-=_.timelineStartInfo.dts),E=_.timelineStartInfo.baseMediaDecodeTime,E+=k,E=Math.max(0,E),_.type==="audio"&&(E*=_.samplerate/BP,E=Math.floor(E)),E},collectDtsInfo:function(_,E){typeof E.pts=="number"&&(_.timelineStartInfo.pts===void 0&&(_.timelineStartInfo.pts=E.pts),_.minSegmentPts===void 0?_.minSegmentPts=E.pts:_.minSegmentPts=Math.min(_.minSegmentPts,E.pts),_.maxSegmentPts===void 0?_.maxSegmentPts=E.pts:_.maxSegmentPts=Math.max(_.maxSegmentPts,E.pts)),typeof E.dts=="number"&&(_.timelineStartInfo.dts===void 0&&(_.timelineStartInfo.dts=E.dts),_.minSegmentDts===void 0?_.minSegmentDts=E.dts:_.minSegmentDts=Math.min(_.minSegmentDts,E.dts),_.maxSegmentDts===void 0?_.maxSegmentDts=E.dts:_.maxSegmentDts=Math.max(_.maxSegmentDts,E.dts))}},up={parseSei:function(_){for(var E=0,k={payloadType:-1,payloadSize:0},C=0,D=0;E<_.byteLength&&_[E]!==128;){for(;_[E]===255;)C+=255,E++;for(C+=_[E++];_[E]===255;)D+=255,E++;if(D+=_[E++],!k.payload&&C===4){if(String.fromCharCode(_[E+3],_[E+4],_[E+5],_[E+6])==="GA94"){k.payloadType=C,k.payloadSize=D,k.payload=_.subarray(E,E+D);break}k.payload=void 0}E+=D,D=C=0}return k},parseUserData:function(_){return _.payload[0]!==181||(_.payload[1]<<8|_.payload[2])!=49||String.fromCharCode(_.payload[3],_.payload[4],_.payload[5],_.payload[6])!=="GA94"||_.payload[7]!==3?null:_.payload.subarray(8,_.payload.length-1)},parseCaptionPackets:function(_,E){var k,C,D,U,H=[];if(64&E[0])for(C=31&E[0],k=0;k<C;k++)U={type:3&E[2+(D=3*k)],pts:_},4&E[2+D]&&(U.ccData=E[3+D]<<8|E[4+D],H.push(U));return H},discardEmulationPreventionBytes:function(_){for(var E=_.byteLength,k=[],C=1;C<E-2;)_[C]===0&&_[C+1]===0&&_[C+2]===3?(k.push(C+2),C+=2):C++;if(k.length===0)return _;for(var D=E-k.length,U=new Uint8Array(D),H=0,C=0;C<D;H++,C++)H===k[0]&&(H++,k.shift()),U[C]=_[H];return U},USER_DATA_REGISTERED_ITU_T_T35:4},ru=En,cp=up,FP=((pt.prototype=new ru).push=function(_){var E;_.nalUnitType==="sei_rbsp"&&(E=cp.parseSei(_.escapedRBSP)).payload&&E.payloadType===cp.USER_DATA_REGISTERED_ITU_T_T35&&(E=cp.parseUserData(E))&&(_.dts<this.latestDts_?this.ignoreNextEqualDts_=!0:_.dts===this.latestDts_&&this.ignoreNextEqualDts_?(this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1)):(E=cp.parseCaptionPackets(_.pts,E),this.captionPackets_=this.captionPackets_.concat(E),this.latestDts_!==_.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=_.dts))},pt.prototype.flushCCStreams=function(_){this.ccStreams_.forEach(function(E){return _==="flush"?E.flush():E.partialFlush()},this)},pt.prototype.flushStream=function(_){this.captionPackets_.length&&(this.captionPackets_.forEach(function(E,k){E.presortIndex=k}),this.captionPackets_.sort(function(E,k){return E.pts===k.pts?E.presortIndex-k.presortIndex:E.pts-k.pts}),this.captionPackets_.forEach(function(E){E.type<2?this.dispatchCea608Packet(E):this.dispatchCea708Packet(E)},this),this.captionPackets_.length=0),this.flushCCStreams(_)},pt.prototype.flush=function(){return this.flushStream("flush")},pt.prototype.partialFlush=function(){return this.flushStream("partialFlush")},pt.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(_){_.reset()})},pt.prototype.dispatchCea608Packet=function(_){this.setsTextOrXDSActive(_)?this.activeCea608Channel_[_.type]=null:this.setsChannel1Active(_)?this.activeCea608Channel_[_.type]=0:this.setsChannel2Active(_)&&(this.activeCea608Channel_[_.type]=1),this.activeCea608Channel_[_.type]!==null&&this.ccStreams_[(_.type<<1)+this.activeCea608Channel_[_.type]].push(_)},pt.prototype.setsChannel1Active=function(_){return(30720&_.ccData)==4096},pt.prototype.setsChannel2Active=function(_){return(30720&_.ccData)==6144},pt.prototype.setsTextOrXDSActive=function(_){return(28928&_.ccData)==256||(30974&_.ccData)==4138||(30974&_.ccData)==6186},pt.prototype.dispatchCea708Packet=function(_){this.parse708captions_&&this.cc708Stream_.push(_)},{127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600}),li=(dn.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},dn.prototype.getText=function(){return this.rows.join(`
`)},dn.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},dn.prototype.newLine=function(_){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(_),0<this.rows.length&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},dn.prototype.isEmpty=function(){return this.rows.length===0||this.rows.length===1&&this.rows[0]===""},dn.prototype.addText=function(_){this.rows[this.rowIdx]+=_},dn.prototype.backspace=function(){var _;this.isEmpty()||(_=this.rows[this.rowIdx],this.rows[this.rowIdx]=_.substr(0,_.length-1))},Jr.prototype.init=function(_,E){this.startPts=_;for(var k=0;k<8;k++)this.windows[k]=new dn(k),typeof E=="function"&&(this.windows[k].beforeRowOverflow=E)},Jr.prototype.setCurrentWindow=function(_){this.currentWindow=this.windows[_]},Jr.prototype.createTextDecoder=function(_){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(_)}catch(E){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+_+" encoding. "+E})}},function(_){_=_||{},li.prototype.init.call(this);var E,k=this,C=_.captionServices||{},D={};Object.keys(C).forEach(U=>{E=C[U],/^SERVICE/.test(U)&&(D[U]=E.encoding)}),this.serviceEncodings=D,this.current708Packet=null,this.services={},this.push=function(U){(U.type===3||k.current708Packet===null)&&k.new708Packet(),k.add708Bytes(U)}}),$P=(li.prototype=new ru,li.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},li.prototype.add708Bytes=function(_){var k=_.ccData,E=k>>>8,k=255&k;this.current708Packet.ptsVals.push(_.pts),this.current708Packet.data.push(E),this.current708Packet.data.push(k)},li.prototype.push708Packet=function(){var _,E=this.current708Packet,k=E.data,C=null,D=0,U=k[D++];for(E.seq=U>>6,E.sizeCode=63&U;D<k.length;D++)_=31&(U=k[D++]),(C=U>>5)===7&&0<_&&(C=k[D++]),this.pushServiceBlock(C,D,_),0<_&&(D+=_-1)},li.prototype.pushServiceBlock=function(_,E,k){for(var C,D=E,U=this.current708Packet.data,H=(H=this.services[_])||this.initService(_,D);D<E+k&&D<U.length;D++)C=U[D],Wn(C)?D=this.handleText(D,H):C===24?D=this.multiByteCharacter(D,H):C===16?D=this.extendedCommands(D,H):128<=C&&C<=135?D=this.setCurrentWindow(D,H):152<=C&&C<=159?D=this.defineWindow(D,H):C===136?D=this.clearWindows(D,H):C===140?D=this.deleteWindows(D,H):C===137?D=this.displayWindows(D,H):C===138?D=this.hideWindows(D,H):C===139?D=this.toggleWindows(D,H):C===151?D=this.setWindowAttributes(D,H):C===144?D=this.setPenAttributes(D,H):C===145?D=this.setPenColor(D,H):C===146?D=this.setPenLocation(D,H):C===143?H=this.reset(D,H):C===8?H.currentWindow.backspace():C===12?H.currentWindow.clearText():C===13?H.currentWindow.pendingNewLine=!0:C===14?H.currentWindow.clearText():C===141&&D++},li.prototype.extendedCommands=function(_,E){var k=this.current708Packet.data[++_];return _=Wn(k)?this.handleText(_,E,{isExtended:!0}):_},li.prototype.getPts=function(_){return this.current708Packet.ptsVals[Math.floor(_/2)]},li.prototype.initService=function(_,E){var k,C="SERVICE"+_,D=this;return C in this.serviceEncodings&&(k=this.serviceEncodings[C]),this.services[_]=new Jr(_,k,D),this.services[_].init(this.getPts(E),function(U){D.flushDisplayed(U,D.services[_])}),this.services[_]},li.prototype.handleText=function(_,E,U){var C,D=U&&U.isExtended,U=U&&U.isMultiByte,ue=this.current708Packet.data,H=D?4096:0,G=ue[_],ue=ue[_+1],ae=E.currentWindow,ue=E.textDecoder_&&!D?(U?(C=[G,ue],_++):C=[G],E.textDecoder_.decode(new Uint8Array(C))):(U=FP[D=H|G]||D,4096&D&&D===U?"":String.fromCharCode(U));return ae.pendingNewLine&&!ae.isEmpty()&&ae.newLine(this.getPts(_)),ae.pendingNewLine=!1,ae.addText(ue),_},li.prototype.multiByteCharacter=function(_,E){var C=this.current708Packet.data,k=C[_+1],C=C[_+2];return _=Wn(k)&&Wn(C)?this.handleText(++_,E,{isMultiByte:!0}):_},li.prototype.setCurrentWindow=function(_,E){var k=this.current708Packet.data[_];return E.setCurrentWindow(7&k),_},li.prototype.defineWindow=function(_,C){var k=this.current708Packet.data,D=k[_],C=(C.setCurrentWindow(7&D),C.currentWindow),D=k[++_];return C.visible=(32&D)>>5,C.rowLock=(16&D)>>4,C.columnLock=(8&D)>>3,C.priority=7&D,D=k[++_],C.relativePositioning=(128&D)>>7,C.anchorVertical=127&D,D=k[++_],C.anchorHorizontal=D,D=k[++_],C.anchorPoint=(240&D)>>4,C.rowCount=15&D,D=k[++_],C.columnCount=63&D,D=k[++_],C.windowStyle=(56&D)>>3,C.penStyle=7&D,C.virtualRowCount=C.rowCount+1,_},li.prototype.setWindowAttributes=function(_,C){var k=this.current708Packet.data,C=(k[_],C.currentWindow.winAttr),D=k[++_];return C.fillOpacity=(192&D)>>6,C.fillRed=(48&D)>>4,C.fillGreen=(12&D)>>2,C.fillBlue=3&D,D=k[++_],C.borderType=(192&D)>>6,C.borderRed=(48&D)>>4,C.borderGreen=(12&D)>>2,C.borderBlue=3&D,D=k[++_],C.borderType+=(128&D)>>5,C.wordWrap=(64&D)>>6,C.printDirection=(48&D)>>4,C.scrollDirection=(12&D)>>2,C.justify=3&D,D=k[++_],C.effectSpeed=(240&D)>>4,C.effectDirection=(12&D)>>2,C.displayEffect=3&D,_},li.prototype.flushDisplayed=function(_,E){for(var k=[],C=0;C<8;C++)E.windows[C].visible&&!E.windows[C].isEmpty()&&k.push(E.windows[C].getText());E.endPts=_,E.text=k.join(`

`),this.pushCaption(E),E.startPts=_},li.prototype.pushCaption=function(_){_.text!==""&&(this.trigger("data",{startPts:_.startPts,endPts:_.endPts,text:_.text,stream:"cc708_"+_.serviceNum}),_.text="",_.startPts=_.endPts)},li.prototype.displayWindows=function(_,E){var k=this.current708Packet.data[++_],C=this.getPts(_);this.flushDisplayed(C,E);for(var D=0;D<8;D++)k&1<<D&&(E.windows[D].visible=1);return _},li.prototype.hideWindows=function(_,E){var k=this.current708Packet.data[++_],C=this.getPts(_);this.flushDisplayed(C,E);for(var D=0;D<8;D++)k&1<<D&&(E.windows[D].visible=0);return _},li.prototype.toggleWindows=function(_,E){var k=this.current708Packet.data[++_],C=this.getPts(_);this.flushDisplayed(C,E);for(var D=0;D<8;D++)k&1<<D&&(E.windows[D].visible^=1);return _},li.prototype.clearWindows=function(_,E){var k=this.current708Packet.data[++_],C=this.getPts(_);this.flushDisplayed(C,E);for(var D=0;D<8;D++)k&1<<D&&E.windows[D].clearText();return _},li.prototype.deleteWindows=function(_,E){var k=this.current708Packet.data[++_],C=this.getPts(_);this.flushDisplayed(C,E);for(var D=0;D<8;D++)k&1<<D&&E.windows[D].reset();return _},li.prototype.setPenAttributes=function(_,C){var k=this.current708Packet.data,C=(k[_],C.currentWindow.penAttr),D=k[++_];return C.textTag=(240&D)>>4,C.offset=(12&D)>>2,C.penSize=3&D,D=k[++_],C.italics=(128&D)>>7,C.underline=(64&D)>>6,C.edgeType=(56&D)>>3,C.fontStyle=7&D,_},li.prototype.setPenColor=function(_,C){var k=this.current708Packet.data,C=(k[_],C.currentWindow.penColor),D=k[++_];return C.fgOpacity=(192&D)>>6,C.fgRed=(48&D)>>4,C.fgGreen=(12&D)>>2,C.fgBlue=3&D,D=k[++_],C.bgOpacity=(192&D)>>6,C.bgRed=(48&D)>>4,C.bgGreen=(12&D)>>2,C.bgBlue=3&D,D=k[++_],C.edgeRed=(48&D)>>4,C.edgeGreen=(12&D)>>2,C.edgeBlue=3&D,_},li.prototype.setPenLocation=function(_,E){var k=this.current708Packet.data,C=(k[_],E.currentWindow.penLoc);return E.currentWindow.pendingNewLine=!0,E=k[++_],C.row=15&E,E=k[++_],C.column=63&E,_},li.prototype.reset=function(_,E){var k=this.getPts(_);return this.flushDisplayed(k,E),this.initService(E.serviceNum,_)},{42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496}),dp=14,jP=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Si=function(_,E){Si.prototype.init.call(this),this.field_=_||0,this.dataChannel_=E||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(k){var C,D,U,H,G=32639&k.ccData;G===this.lastControlCode_?this.lastControlCode_=null:((61440&G)==4096?this.lastControlCode_=G:G!==this.PADDING_&&(this.lastControlCode_=null),C=G>>>8,D=255&G,G!==this.PADDING_&&(G===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":G===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(k.pts),this.flushDisplayed(k.pts),H=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=H,this.startPts_=k.pts):G===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(k.pts)):G===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(k.pts)):G===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(k.pts)):G===this.CARRIAGE_RETURN_?(this.clearFormatting(k.pts),this.flushDisplayed(k.pts),this.shiftRowsUp_(),this.startPts_=k.pts):G===this.BACKSPACE_?this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):G===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(k.pts),this.displayed_=Ro()):G===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=Ro():G===this.RESUME_DIRECT_CAPTIONING_?(this.mode_!=="paintOn"&&(this.flushDisplayed(k.pts),this.displayed_=Ro()),this.mode_="paintOn",this.startPts_=k.pts):this.isSpecialCharacter(C,D)?(U=op((C=(3&C)<<8)|D),this[this.mode_](k.pts,U),this.column_++):this.isExtCharacter(C,D)?(this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),U=op((C=(3&C)<<8)|D),this[this.mode_](k.pts,U),this.column_++):this.isMidRowCode(C,D)?(this.clearFormatting(k.pts),this[this.mode_](k.pts," "),this.column_++,(14&D)==14&&this.addFormatting(k.pts,["i"]),(1&D)==1&&this.addFormatting(k.pts,["u"])):this.isOffsetControlCode(C,D)?this.column_+=3&D:this.isPAC(C,D)?(H=jP.indexOf(7968&G),this.mode_==="rollUp"&&(H-this.rollUpRows_+1<0&&(H=this.rollUpRows_-1),this.setRollUp(k.pts,H)),H!==this.row_&&(this.clearFormatting(k.pts),this.row_=H),1&D&&this.formatting_.indexOf("u")===-1&&this.addFormatting(k.pts,["u"]),(16&G)==16&&(this.column_=4*((14&G)>>1)),this.isColorPAC(D)&&(14&D)==14&&this.addFormatting(k.pts,["i"])):this.isNormalChar(C)&&(D===0&&(D=null),U=op(C),U+=op(D),this[this.mode_](k.pts,U),this.column_+=U.length)))}},ru=(Si.prototype=new ru,Si.prototype.flushDisplayed=function(_){var E=this.displayed_.map(function(k,C){try{return k.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+C+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");E.length&&this.trigger("data",{startPts:this.startPts_,endPts:_,text:E,stream:this.name_})},Si.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Ro(),this.nonDisplayed_=Ro(),this.lastControlCode_=null,this.column_=0,this.row_=dp,this.rollUpRows_=2,this.formatting_=[]},Si.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Si.prototype.isSpecialCharacter=function(_,E){return _===this.EXT_&&48<=E&&E<=63},Si.prototype.isExtCharacter=function(_,E){return(_===this.EXT_+1||_===this.EXT_+2)&&32<=E&&E<=63},Si.prototype.isMidRowCode=function(_,E){return _===this.EXT_&&32<=E&&E<=47},Si.prototype.isOffsetControlCode=function(_,E){return _===this.OFFSET_&&33<=E&&E<=35},Si.prototype.isPAC=function(_,E){return _>=this.BASE_&&_<this.BASE_+8&&64<=E&&E<=127},Si.prototype.isColorPAC=function(_){return 64<=_&&_<=79||96<=_&&_<=127},Si.prototype.isNormalChar=function(_){return 32<=_&&_<=127},Si.prototype.setRollUp=function(_,E){if(this.mode_!=="rollUp"&&(this.row_=dp,this.mode_="rollUp",this.flushDisplayed(_),this.nonDisplayed_=Ro(),this.displayed_=Ro()),E!==void 0&&E!==this.row_)for(var k=0;k<this.rollUpRows_;k++)this.displayed_[E-k]=this.displayed_[this.row_-k],this.displayed_[this.row_-k]="";E===void 0&&(E=this.row_),this.topRow_=E-this.rollUpRows_+1},Si.prototype.addFormatting=function(_,E){this.formatting_=this.formatting_.concat(E),E=E.reduce(function(k,C){return k+"<"+C+">"},""),this[this.mode_](_,E)},Si.prototype.clearFormatting=function(_){var E;this.formatting_.length&&(E=this.formatting_.reverse().reduce(function(k,C){return k+"</"+C+">"},""),this.formatting_=[],this[this.mode_](_,E))},Si.prototype.popOn=function(_,E){var k=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=k+=E},Si.prototype.rollUp=function(_,E){var k=this.displayed_[this.row_];this.displayed_[this.row_]=k+=E},Si.prototype.shiftRowsUp_=function(){for(var _=0;_<this.topRow_;_++)this.displayed_[_]="";for(_=this.row_+1;_<dp+1;_++)this.displayed_[_]="";for(_=this.topRow_;_<this.row_;_++)this.displayed_[_]=this.displayed_[_+1];this.displayed_[this.row_]=""},Si.prototype.paintOn=function(_,E){var k=this.displayed_[this.row_];this.displayed_[this.row_]=k+=E},{CaptionStream:pt,Cea608Stream:Si,Cea708Stream:li}),hp={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Mo=En,HP=8589934592,VP=4294967296;Q_.prototype=new Mo;function dS(_,E,k){for(var C="",D=E;D<k;D++)C+="%"+("00"+_[D].toString(16)).slice(-2);return C}function Sd(_,E,k){return decodeURIComponent(dS(_,E,k))}function xd(_,E,k){return unescape(dS(_,E,k))}function fp(_){return _[0]<<21|_[1]<<14|_[2]<<7|_[3]}var pp,iy,mp,Mo=Q_,qP=Y_,yr=En,WP=hp,gp=(_,E,k)=>{if(_){for(var C=k;C<_.length;C++)if(_[C]===E)return C}return-1},_p=3,yp={APIC:function(_){var E,k=1;_.data[0]!==_p||(E=gp(_.data,0,1))<0||(_.mimeType=xd(_.data,1,E),_.pictureType=_.data[k=E+1],(E=gp(_.data,0,++k))<0)||(_.description=Sd(_.data,k,E),k=E+1,_.mimeType==="-->"?_.url=xd(_.data,k,_.data.length):_.pictureData=_.data.subarray(k,_.data.length))},"T*":function(_){_.data[0]===_p&&(_.value=Sd(_.data,1,_.data.length).replace(/\0*$/,""),_.values=_.value.split("\0"))},TXXX:function(_){var E;_.data[0]===_p&&(E=gp(_.data,0,1))!==-1&&(_.description=Sd(_.data,1,E),_.value=Sd(_.data,E+1,_.data.length).replace(/\0*$/,""),_.data=_.value)},"W*":function(_){_.url=xd(_.data,0,_.data.length).replace(/\0.*$/,"")},WXXX:function(_){var E;_.data[0]===_p&&(E=gp(_.data,0,1))!==-1&&(_.description=Sd(_.data,1,E),_.url=xd(_.data,E+1,_.data.length).replace(/\0.*$/,""))},PRIV:function(_){for(var E=0;E<_.data.length;E++)if(_.data[E]===0){_.owner=xd(_.data,0,E);break}_.privateData=_.data.subarray(E+1),_.data=_.privateData}},sy=function(_){var E,k={descriptor:_&&_.descriptor},C=0,D=[],U=0;if(sy.prototype.init.call(this),this.dispatchType=WP.METADATA_STREAM_TYPE.toString(16),k.descriptor)for(E=0;E<k.descriptor.length;E++)this.dispatchType+=("00"+k.descriptor[E].toString(16)).slice(-2);this.push=function(H){var G,ae,ue,Te,we,ot,at;if(H.type==="timed-metadata"){if(H.dataAlignmentIndicator&&(U=0,D.length=0),D.length===0&&(H.data.length<10||H.data[0]!=="I".charCodeAt(0)||H.data[1]!=="D".charCodeAt(0)||H.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(D.push(H),U+=H.data.byteLength,D.length===1&&(C=fp(H.data.subarray(6,10)),C+=10),!(U<C)){for(G={data:new Uint8Array(C),frames:[],pts:D[0].pts,dts:D[0].dts},Te=0;Te<C;)G.data.set(D[0].data.subarray(0,C-Te),Te),Te+=D[0].data.byteLength,U-=D[0].data.byteLength,D.shift();ae=10,64&G.data[5]&&(ae=(ae+=4)+fp(G.data.subarray(10,14)),C-=fp(G.data.subarray(16,20)));do if((ue=fp(G.data.subarray(ae+4,ae+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}while((at={id:String.fromCharCode(G.data[ae],G.data[ae+1],G.data[ae+2],G.data[ae+3]),data:G.data.subarray(ae+10,ae+ue+10)}).key=at.id,yp[at.id]?yp[at.id](at):at.id[0]==="T"?yp["T*"](at):at.id[0]==="W"&&yp["W*"](at),at.owner==="com.apple.streaming.transportStreamTimestamp"&&(ot=(1&(we=at.data)[3])<<30|we[4]<<22|we[5]<<14|we[6]<<6|we[7]>>>2,ot=(ot*=4)+(3&we[7]),at.timeStamp=ot,G.pts===void 0&&G.dts===void 0&&(G.pts=at.timeStamp,G.dts=at.timeStamp),this.trigger("timestamp",at)),G.frames.push(at),(ae=ae+10+ue)<C);this.trigger("data",G)}}}},yr=(sy.prototype=new yr,sy),Fa=En,wd=ru,Gn=hp,ny=function(){var _=new Uint8Array(188),E=0;ny.prototype.init.call(this),this.push=function(k){var C,D=0,U=188;for(E?((C=new Uint8Array(k.byteLength+E)).set(_.subarray(0,E)),C.set(k,E),E=0):C=k;U<C.byteLength;)C[D]===71&&C[U]===71?(this.trigger("data",C.subarray(D,U)),D+=188,U+=188):(D++,U++);D<C.byteLength&&(_.set(C.subarray(D),0),E=C.byteLength-D)},this.flush=function(){E===188&&_[0]===71&&(this.trigger("data",_),E=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){E=0,this.trigger("reset")}},hS=(ny.prototype=new Fa,(pp=function(){var _,E,k,C;pp.prototype.init.call(this),(C=this).packetsWaitingForPmt=[],this.programMapTable=void 0,_=function(D,U){var H=0;U.payloadUnitStartIndicator&&(H+=D[H]+1),(U.type==="pat"?E:k)(D.subarray(H),U)},E=function(D,U){U.section_number=D[7],U.last_section_number=D[8],C.pmtPid=(31&D[10])<<8|D[11],U.pmtPid=C.pmtPid},k=function(D,U){var H,G;if(1&D[5]){for(C.programMapTable={video:null,audio:null,"timed-metadata":{}},H=3+((15&D[1])<<8|D[2])-4,G=12+((15&D[10])<<8|D[11]);G<H;){var ae=D[G],ue=(31&D[G+1])<<8|D[G+2];ae===Gn.H264_STREAM_TYPE&&C.programMapTable.video===null?C.programMapTable.video=ue:ae===Gn.ADTS_STREAM_TYPE&&C.programMapTable.audio===null?C.programMapTable.audio=ue:ae===Gn.METADATA_STREAM_TYPE&&(C.programMapTable["timed-metadata"][ue]=ae),G+=5+((15&D[G+3])<<8|D[G+4])}U.programMapTable=C.programMapTable}},this.push=function(D){var U={},H=4;if(U.payloadUnitStartIndicator=!!(64&D[1]),U.pid=31&D[1],U.pid<<=8,U.pid|=D[2],1<(48&D[3])>>>4&&(H+=D[H]+1),U.pid===0)U.type="pat",_(D.subarray(H),U),this.trigger("data",U);else if(U.pid===this.pmtPid)for(U.type="pmt",_(D.subarray(H),U),this.trigger("data",U);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([D,H,U]):this.processPes_(D,H,U)},this.processPes_=function(D,U,H){H.pid===this.programMapTable.video?H.streamType=Gn.H264_STREAM_TYPE:H.pid===this.programMapTable.audio?H.streamType=Gn.ADTS_STREAM_TYPE:H.streamType=this.programMapTable["timed-metadata"][H.pid],H.type="pes",H.data=D.subarray(U),this.trigger("data",H)}}).prototype=new Fa,pp.STREAM_TYPES={h264:27,adts:15},(iy=function(){function _(ae,ue,Te){var we,ot=new Uint8Array(ae.size),at={type:ue},lt=0,Pi=0;if(ae.data.length&&!(ae.size<9)){for(at.trackId=ae.data[0].pid,lt=0;lt<ae.data.length;lt++)we=ae.data[lt],ot.set(we.data,Pi),Pi+=we.data.byteLength;G(ot,at),ue=ue==="video"||at.packetLength<=ae.size,(Te||ue)&&(ae.size=0,ae.data.length=0),ue&&k.trigger("data",at)}}var E,k=this,C=!1,D={data:[],size:0},U={data:[],size:0},H={data:[],size:0},G=function(ae,ue){var Te=ae[0]<<16|ae[1]<<8|ae[2];ue.data=new Uint8Array,Te==1&&(ue.packetLength=6+(ae[4]<<8|ae[5]),ue.dataAlignmentIndicator=(4&ae[6])!=0,192&(Te=ae[7])&&(ue.pts=(14&ae[9])<<27|(255&ae[10])<<20|(254&ae[11])<<12|(255&ae[12])<<5|(254&ae[13])>>>3,ue.pts*=4,ue.pts+=(6&ae[13])>>>1,ue.dts=ue.pts,64&Te)&&(ue.dts=(14&ae[14])<<27|(255&ae[15])<<20|(254&ae[16])<<12|(255&ae[17])<<5|(254&ae[18])>>>3,ue.dts*=4,ue.dts+=(6&ae[18])>>>1),ue.data=ae.subarray(9+ae[8]))};iy.prototype.init.call(this),this.push=function(ae){({pat:function(){},pes:function(){var ue,Te;switch(ae.streamType){case Gn.H264_STREAM_TYPE:ue=D,Te="video";break;case Gn.ADTS_STREAM_TYPE:ue=U,Te="audio";break;case Gn.METADATA_STREAM_TYPE:ue=H,Te="timed-metadata";break;default:return}ae.payloadUnitStartIndicator&&_(ue,Te,!0),ue.data.push(ae),ue.size+=ae.data.byteLength},pmt:function(){var ue={type:"metadata",tracks:[]};(E=ae.programMapTable).video!==null&&ue.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.video,codec:"avc",type:"video"}),E.audio!==null&&ue.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.audio,codec:"adts",type:"audio"}),C=!0,k.trigger("data",ue)}})[ae.type]()},this.reset=function(){D.size=0,D.data.length=0,U.size=0,U.data.length=0,this.trigger("reset")},this.flushStreams_=function(){_(D,"video"),_(U,"audio"),_(H,"timed-metadata")},this.flush=function(){var ae;!C&&E&&(ae={type:"metadata",tracks:[]},E.video!==null&&ae.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.video,codec:"avc",type:"video"}),E.audio!==null&&ae.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.audio,codec:"adts",type:"audio"}),k.trigger("data",ae)),C=!1,this.flushStreams_(),this.trigger("done")}}).prototype=new Fa,{PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:ny,TransportParseStream:pp,ElementaryStream:iy,TimestampRolloverStream:Mo,CaptionStream:wd.CaptionStream,Cea608Stream:wd.Cea608Stream,Cea708Stream:wd.Cea708Stream,MetadataStream:yr});for(mp in Gn)Gn.hasOwnProperty(mp)&&(hS[mp]=Gn[mp]);var ry,fS,Fa=hS,Mo=En,GP=_i.ONE_SECOND_IN_TS,pS=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ay=function(_){var E,k=0;ay.prototype.init.call(this),this.skipWarn_=function(C,D){this.trigger("log",{level:"warn",message:`adts skiping bytes ${C} to ${D} in frame ${k} outside syncword`})},this.push=function(C){var D,U,H,G,ae,ue,Te=0;if(_||(k=0),C.type==="audio"){for(E&&E.length?(H=E,(E=new Uint8Array(H.byteLength+C.data.byteLength)).set(H),E.set(C.data,H.byteLength)):E=C.data;Te+7<E.length;)if(E[Te]!==255||(246&E[Te+1])!=240)typeof ue!="number"&&(ue=Te),Te++;else{if(typeof ue=="number"&&(this.skipWarn_(ue,Te),ue=null),U=2*(1&~E[Te+1]),D=(3&E[Te+3])<<11|E[Te+4]<<3|(224&E[Te+5])>>5,ae=(G=1024*(1+(3&E[Te+6])))*GP/pS[(60&E[Te+2])>>>2],E.byteLength-Te<D)break;this.trigger("data",{pts:C.pts+k*ae,dts:C.dts+k*ae,sampleCount:G,audioobjecttype:1+(E[Te+2]>>>6&3),channelcount:(1&E[Te+2])<<2|(192&E[Te+3])>>>6,samplerate:pS[(60&E[Te+2])>>>2],samplingfrequencyindex:(60&E[Te+2])>>>2,samplesize:16,data:E.subarray(Te+7+U,Te+D)}),k++,Te+=D}typeof ue=="number"&&(this.skipWarn_(ue,Te),ue=null),E=E.subarray(Te)}},this.flush=function(){k=0,this.trigger("done")},this.reset=function(){E=void 0,this.trigger("reset")},this.endTimeline=function(){E=void 0,this.trigger("endedtimeline")}},wd=(ay.prototype=new Mo,ay),yr=En,zP=function(_){var E=_.byteLength,k=0,C=0;this.length=function(){return 8*E},this.bitsAvailable=function(){return 8*E+C},this.loadWord=function(){var D=_.byteLength-E,U=new Uint8Array(4),H=Math.min(4,E);if(H===0)throw new Error("no bytes available");U.set(_.subarray(D,D+H)),k=new DataView(U.buffer).getUint32(0),C=8*H,E-=H},this.skipBits=function(D){var U;D<C||(D=(D-=C)-8*(U=Math.floor(D/8)),E-=U,this.loadWord()),k<<=D,C-=D},this.readBits=function(D){var U=Math.min(C,D),H=k>>>32-U;return 0<(C-=U)?k<<=U:0<E&&this.loadWord(),0<(U=D-U)?H<<U|this.readBits(U):H},this.skipLeadingZeros=function(){for(var D=0;D<C;++D)if(k&2147483648>>>D)return k<<=D,C-=D,D;return this.loadWord(),D+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var D=this.skipLeadingZeros();return this.readBits(D+1)-1},this.readExpGolomb=function(){var D=this.readUnsignedExpGolomb();return 1&D?1+D>>>1:-1*(D>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},oy=function(){var _,E,k=0;oy.prototype.init.call(this),this.push=function(C){for(var D,U=(E=E?((D=new Uint8Array(E.byteLength+C.data.byteLength)).set(E),D.set(C.data,E.byteLength),D):C.data).byteLength;k<U-3;k++)if(E[k+2]===1){_=k+5;break}for(;_<U;)switch(E[_]){case 0:if(E[_-1]!==0)_+=2;else if(E[_-2]!==0)_++;else{for(k+3!==_-2&&this.trigger("data",E.subarray(k+3,_-2));E[++_]!==1&&_<U;);k=_-2,_+=3}break;case 1:E[_-1]!==0||E[_-2]!==0||(this.trigger("data",E.subarray(k+3,_-2)),k=_-2),_+=3;break;default:_+=3}E=E.subarray(k),_-=k,k=0},this.reset=function(){E=null,k=0,this.trigger("reset")},this.flush=function(){E&&3<E.byteLength&&this.trigger("data",E.subarray(k+3)),E=null,k=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}};oy.prototype=new yr,fS={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(ry=function(){var _,E,k,C,D,U,H,G=new oy;ry.prototype.init.call(this),(_=this).push=function(ae){ae.type==="video"&&(E=ae.trackId,k=ae.pts,C=ae.dts,G.push(ae))},G.on("data",function(ae){var ue={trackId:E,pts:k,dts:C,data:ae,nalUnitTypeCode:31&ae[0]};switch(ue.nalUnitTypeCode){case 5:ue.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:ue.nalUnitType="sei_rbsp",ue.escapedRBSP=D(ae.subarray(1));break;case 7:ue.nalUnitType="seq_parameter_set_rbsp",ue.escapedRBSP=D(ae.subarray(1)),ue.config=U(ue.escapedRBSP);break;case 8:ue.nalUnitType="pic_parameter_set_rbsp";break;case 9:ue.nalUnitType="access_unit_delimiter_rbsp"}_.trigger("data",ue)}),G.on("done",function(){_.trigger("done")}),G.on("partialdone",function(){_.trigger("partialdone")}),G.on("reset",function(){_.trigger("reset")}),G.on("endedtimeline",function(){_.trigger("endedtimeline")}),this.flush=function(){G.flush()},this.partialFlush=function(){G.partialFlush()},this.reset=function(){G.reset()},this.endTimeline=function(){G.endTimeline()},H=function(ae,ue){for(var Te=8,we=8,ot=0;ot<ae;ot++)Te=(we=we!==0?(Te+ue.readExpGolomb()+256)%256:we)===0?Te:we},D=function(ae){for(var ue=ae.byteLength,Te=[],we=1;we<ue-2;)ae[we]===0&&ae[we+1]===0&&ae[we+2]===3?(Te.push(we+2),we+=2):we++;if(Te.length===0)return ae;for(var ot=ue-Te.length,at=new Uint8Array(ot),lt=0,we=0;we<ot;lt++,we++)lt===Te[0]&&(lt++,Te.shift()),at[we]=ae[lt];return at},U=function(ta){var ue,Te,we,ot,at,lt,Pi=0,os=0,Qi=0,qi=0,xi=[1,1],St=new zP(ta),ta=St.readUnsignedByte(),py=St.readUnsignedByte(),Ld=St.readUnsignedByte();if(St.skipUnsignedExpGolomb(),fS[ta]&&((Te=St.readUnsignedExpGolomb())===3&&St.skipBits(1),St.skipUnsignedExpGolomb(),St.skipUnsignedExpGolomb(),St.skipBits(1),St.readBoolean()))for(at=Te!==3?8:12,lt=0;lt<at;lt++)St.readBoolean()&&H(lt<6?16:64,St);if(St.skipUnsignedExpGolomb(),(Te=St.readUnsignedExpGolomb())===0)St.readUnsignedExpGolomb();else if(Te===1)for(St.skipBits(1),St.skipExpGolomb(),St.skipExpGolomb(),ue=St.readUnsignedExpGolomb(),lt=0;lt<ue;lt++)St.skipExpGolomb();if(St.skipUnsignedExpGolomb(),St.skipBits(1),Te=St.readUnsignedExpGolomb(),we=St.readUnsignedExpGolomb(),(ot=St.readBits(1))===0&&St.skipBits(1),St.skipBits(1),St.readBoolean()&&(Pi=St.readUnsignedExpGolomb(),os=St.readUnsignedExpGolomb(),Qi=St.readUnsignedExpGolomb(),qi=St.readUnsignedExpGolomb()),St.readBoolean()&&St.readBoolean()){switch(St.readUnsignedByte()){case 1:xi=[1,1];break;case 2:xi=[12,11];break;case 3:xi=[10,11];break;case 4:xi=[16,11];break;case 5:xi=[40,33];break;case 6:xi=[24,11];break;case 7:xi=[20,11];break;case 8:xi=[32,11];break;case 9:xi=[80,33];break;case 10:xi=[18,11];break;case 11:xi=[15,11];break;case 12:xi=[64,33];break;case 13:xi=[160,99];break;case 14:xi=[4,3];break;case 15:xi=[3,2];break;case 16:xi=[2,1];break;case 255:xi=[St.readUnsignedByte()<<8|St.readUnsignedByte(),St.readUnsignedByte()<<8|St.readUnsignedByte()]}xi&&(xi[0],xi[1])}return{profileIdc:ta,levelIdc:Ld,profileCompatibility:py,width:16*(Te+1)-2*Pi-2*os,height:(2-ot)*(we+1)*16-2*Qi-2*qi,sarRatio:xi}}}).prototype=new yr;function mS(_){return _[0]<<21|_[1]<<14|_[2]<<7|_[3]}var Mo=ry,KP=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],gS=function(_,E){var k=0<=(k=_[E+6]<<21|_[E+7]<<14|_[E+8]<<7|_[E+9])?k:0;return(16&_[E+5])>>4?20+k:10+k},_S=function(_,E){return _.length-E<10||_[E]!=="I".charCodeAt(0)||_[E+1]!=="D".charCodeAt(0)||_[E+2]!=="3".charCodeAt(0)?E:(E+=gS(_,E),_S(_,E))},XP=function(_,E,k){for(var C="",D=E;D<k;D++)C+="%"+("00"+_[D].toString(16)).slice(-2);return C},yr={isLikelyAacData:function(_){var E=_S(_,0);return _.length>=E+2&&(255&_[E])==255&&(240&_[E+1])==240&&(22&_[E+1])==16},parseId3TagSize:gS,parseAdtsSize:function(_,E){var k=(224&_[E+5])>>5,C=_[E+4]<<3;return 6144&_[E+3]|C|k},parseType:function(_,E){return _[E]==="I".charCodeAt(0)&&_[E+1]==="D".charCodeAt(0)&&_[E+2]==="3".charCodeAt(0)?"timed-metadata":!0&_[E]&&(240&_[E+1])==240?"audio":null},parseSampleRate:function(_){for(var E=0;E+5<_.length;){if(_[E]===255&&(246&_[E+1])==240)return KP[(60&_[E+2])>>>2];E++}return null},parseAacTimestamp:function(_){var E,k=10;64&_[5]&&(k=(k+=4)+mS(_.subarray(10,14)));do{if((E=mS(_.subarray(k+4,k+8)))<1)return null;if(String.fromCharCode(_[k],_[k+1],_[k+2],_[k+3])==="PRIV"){for(var C,D,U=_.subarray(k+10,k+E+10),H=0;H<U.byteLength;H++)if(U[H]===0){if(unescape(XP(U,0,H))==="com.apple.streaming.transportStreamTimestamp")return D=(1&(C=U.subarray(H+1))[3])<<30|C[4]<<22|C[5]<<14|C[6]<<6|C[7]>>>2,(D*=4)+(3&C[7]);break}}}while((k=k+10+E)<_.byteLength);return null}},au=En,yS=yr,ly=function(){var _=new Uint8Array,E=0;ly.prototype.init.call(this),this.setTimestamp=function(k){E=k},this.push=function(k){var C,D,U=0,H=0;for(_.length?(D=_.length,(_=new Uint8Array(k.byteLength+D)).set(_.subarray(0,D)),_.set(k,D)):_=k;3<=_.length-H;)if(_[H]==="I".charCodeAt(0)&&_[H+1]==="D".charCodeAt(0)&&_[H+2]==="3".charCodeAt(0)){if(_.length-H<10||H+(U=yS.parseId3TagSize(_,H))>_.length)break;C={type:"timed-metadata",data:_.subarray(H,H+U)},this.trigger("data",C),H+=U}else if((255&_[H])==255&&(240&_[H+1])==240){if(_.length-H<7||H+(U=yS.parseAdtsSize(_,H))>_.length)break;C={type:"audio",data:_.subarray(H,H+U),pts:E,dts:E},this.trigger("data",C),H+=U}else H++;D=_.length-H,_=0<D?_.subarray(H):new Uint8Array},this.reset=function(){_=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){_=new Uint8Array,this.trigger("endedtimeline")}};ly.prototype=new au;function vS(_,E){for(var k=Object.keys(E),C=0;C<k.length;C++){var D=k[C];D!=="headOfPipeline"&&E[D].on&&E[D].on("log",eL.bind(_,D))}}function TS(_,E){var k;if(_.length===E.length){for(k=0;k<_.length;k++)if(_[k]!==E[k])return;return 1}}function bS(_,E,k,C,D,U){return{start:{dts:_,pts:_+(k-E)},end:{dts:_+(C-E),pts:_+(D-k)},prependedContentDuration:U,baseMediaDecodeTime:_}}var uy,cy,Cd,au=En,Ad=Z_,kd=ey,vp=Id,zn=Od,Zr=Fa,Tp=_i,ES=wd,YP=Mo,QP=ly,JP=yr.isLikelyAacData,ZP=_i.ONE_SECOND_IN_TS,SS=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],xS=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],eL=function(_,E){E.stream=_,this.trigger("log",E)},bp=function(_,E){var k=[],C=0,D=0,U=1/0,H=(E=E||{}).firstSequenceNumber||0;bp.prototype.init.call(this),this.push=function(G){zn.collectDtsInfo(_,G),_&&SS.forEach(function(ae){_[ae]=G[ae]}),k.push(G)},this.setEarliestDts=function(G){C=G},this.setVideoBaseMediaDecodeTime=function(G){U=G},this.setAudioAppendStart=function(G){D=G},this.flush=function(){var G,ae,ue,Te,we;k.length!==0&&(G=vp.trimAdtsFramesByEarliestDts(k,_,C),_.baseMediaDecodeTime=zn.calculateTrackBaseMediaDecodeTime(_,E.keepOriginalTimestamps),we=vp.prefixWithSilence(_,G,D,U),_.samples=vp.generateSampleTable(G),ue=Ad.mdat(vp.concatenateFrameData(G)),k=[],Te=Ad.moof(H,[_]),ae=new Uint8Array(Te.byteLength+ue.byteLength),H++,ae.set(Te),ae.set(ue,Te.byteLength),zn.clearDtsInfo(_),ue=Math.ceil(1024*ZP/_.samplerate),G.length&&(Te=G.length*ue,this.trigger("segmentTimingInfo",bS(Tp.audioTsToVideoTs(_.baseMediaDecodeTime,_.samplerate),G[0].dts,G[0].pts,G[0].dts+Te,G[0].pts+Te,we||0)),this.trigger("timingInfo",{start:G[0].pts,end:G[0].pts+Te})),this.trigger("data",{track:_,boxes:ae})),this.trigger("done","AudioSegmentStream")},this.reset=function(){zn.clearDtsInfo(_),k=[],this.trigger("reset")}};bp.prototype=new au,(uy=function(_,E){var k,C,D=[],U=[],H=(E=E||{}).firstSequenceNumber||0;uy.prototype.init.call(this),delete _.minPTS,this.gopCache_=[],this.push=function(G){zn.collectDtsInfo(_,G),G.nalUnitType!=="seq_parameter_set_rbsp"||k||(k=G.config,_.sps=[G.data],xS.forEach(function(ae){_[ae]=k[ae]},this)),G.nalUnitType!=="pic_parameter_set_rbsp"||C||(C=G.data,_.pps=[G.data]),D.push(G)},this.flush=function(){for(var G,ae,ue,Te=0;D.length&&D[0].nalUnitType!=="access_unit_delimiter_rbsp";)D.shift();if(D.length!==0){if(G=kd.groupNalsIntoFrames(D),(G=kd.groupFramesIntoGops(G))[0][0].keyFrame||((we=this.getGopForFusion_(D[0],_))?(Te=we.duration,G.unshift(we),G.byteLength+=we.byteLength,G.nalCount+=we.nalCount,G.pts=we.pts,G.dts=we.dts,G.duration+=we.duration):G=kd.extendFirstKeyFrame(G)),U.length){var we=E.alignGopsAtEnd?this.alignGopsAtEnd_(G):this.alignGopsAtStart_(G);if(!we)return this.gopCache_.unshift({gop:G.pop(),pps:_.pps,sps:_.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),D=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");zn.clearDtsInfo(_),G=we}zn.collectDtsInfo(_,G),_.samples=kd.generateSampleTable(G),we=Ad.mdat(kd.concatenateNalData(G)),_.baseMediaDecodeTime=zn.calculateTrackBaseMediaDecodeTime(_,E.keepOriginalTimestamps),this.trigger("processedGopsInfo",G.map(function(ot){return{pts:ot.pts,dts:ot.dts,byteLength:ot.byteLength}})),ae=G[0],ue=G[G.length-1],this.trigger("segmentTimingInfo",bS(_.baseMediaDecodeTime,ae.dts,ae.pts,ue.dts+ue.duration,ue.pts+ue.duration,Te)),this.trigger("timingInfo",{start:G[0].pts,end:G[G.length-1].pts+G[G.length-1].duration}),this.gopCache_.unshift({gop:G.pop(),pps:_.pps,sps:_.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),D=[],this.trigger("baseMediaDecodeTime",_.baseMediaDecodeTime),this.trigger("timelineStartInfo",_.timelineStartInfo),ae=Ad.moof(H,[_]),ue=new Uint8Array(ae.byteLength+we.byteLength),H++,ue.set(ae),ue.set(we,ae.byteLength),this.trigger("data",{track:_,boxes:ue})}this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),D=[],this.gopCache_.length=0,U.length=0,this.trigger("reset")},this.resetStream_=function(){zn.clearDtsInfo(_),C=k=void 0},this.getGopForFusion_=function(G){for(var ae,ue,Te,we=1/0,ot=0;ot<this.gopCache_.length;ot++)ue=(Te=this.gopCache_[ot]).gop,_.pps&&TS(_.pps[0],Te.pps[0])&&_.sps&&TS(_.sps[0],Te.sps[0])&&(ue.dts<_.timelineStartInfo.dts||-1e4<=(ue=G.dts-ue.dts-ue.duration)&&ue<=45e3&&(!ae||ue<we)&&(ae=Te,we=ue));return ae?ae.gop:null},this.alignGopsAtStart_=function(G){for(var ae,ue,Te,we,ot=G.byteLength,at=G.nalCount,lt=G.duration,Pi=ae=0;Pi<U.length&&ae<G.length&&(ue=U[Pi],Te=G[ae],ue.pts!==Te.pts);)Te.pts>ue.pts?Pi++:(ae++,ot-=Te.byteLength,at-=Te.nalCount,lt-=Te.duration);return ae===0?G:ae===G.length?null:((we=G.slice(ae)).byteLength=ot,we.duration=lt,we.nalCount=at,we.pts=we[0].pts,we.dts=we[0].dts,we)},this.alignGopsAtEnd_=function(G){for(var ae,ue,Te,we,ot=U.length-1,at=G.length-1,lt=null,Pi=!1;0<=ot&&0<=at;){if(ae=U[ot],ue=G[at],ae.pts===ue.pts){Pi=!0;break}ae.pts>ue.pts?ot--:(ot===U.length-1&&(lt=at),at--)}return Pi||lt!==null?(Te=Pi?at:lt)===0?G:(we=(Te=G.slice(Te)).reduce(function(os,Qi){return os.byteLength+=Qi.byteLength,os.duration+=Qi.duration,os.nalCount+=Qi.nalCount,os},{byteLength:0,duration:0,nalCount:0}),Te.byteLength=we.byteLength,Te.duration=we.duration,Te.nalCount=we.nalCount,Te.pts=Te[0].pts,Te.dts=Te[0].dts,Te):null},this.alignGopsWith=function(G){U=G}}).prototype=new au,((Cd=function(_,E){this.numberOfTracks=0,this.metadataStream=E,typeof(_=_||{}).remux<"u"?this.remuxTracks=!!_.remux:this.remuxTracks=!0,typeof _.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=_.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Cd.prototype.init.call(this),this.push=function(k){return k.text?this.pendingCaptions.push(k):k.frames?this.pendingMetadata.push(k):(this.pendingTracks.push(k.track),this.pendingBytes+=k.boxes.byteLength,k.track.type==="video"&&(this.videoTrack=k.track,this.pendingBoxes.push(k.boxes)),void(k.track.type==="audio"&&(this.audioTrack=k.track,this.pendingBoxes.unshift(k.boxes))))}}).prototype=new au).flush=function(_){var E,k,C,D=0,U={captions:[],captionStreams:{},metadata:[],info:{}},H=0;if(this.pendingTracks.length<this.numberOfTracks){if(_!=="VideoSegmentStream"&&_!=="AudioSegmentStream"||this.remuxTracks)return;if(this.pendingTracks.length===0)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(H=this.videoTrack.timelineStartInfo.pts,xS.forEach(function(G){U.info[G]=this.videoTrack[G]},this)):this.audioTrack&&(H=this.audioTrack.timelineStartInfo.pts,SS.forEach(function(G){U.info[G]=this.audioTrack[G]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?U.type=this.pendingTracks[0].type:U.type="combined",this.emittedTracks+=this.pendingTracks.length,_=Ad.initSegment(this.pendingTracks),U.initSegment=new Uint8Array(_.byteLength),U.initSegment.set(_),U.data=new Uint8Array(this.pendingBytes),C=0;C<this.pendingBoxes.length;C++)U.data.set(this.pendingBoxes[C],D),D+=this.pendingBoxes[C].byteLength;for(C=0;C<this.pendingCaptions.length;C++)(E=this.pendingCaptions[C]).startTime=Tp.metadataTsToSeconds(E.startPts,H,this.keepOriginalTimestamps),E.endTime=Tp.metadataTsToSeconds(E.endPts,H,this.keepOriginalTimestamps),U.captionStreams[E.stream]=!0,U.captions.push(E);for(C=0;C<this.pendingMetadata.length;C++)(k=this.pendingMetadata[C]).cueTime=Tp.metadataTsToSeconds(k.pts,H,this.keepOriginalTimestamps),U.metadata.push(k);for(U.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",U),C=0;C<U.captions.length;C++)E=U.captions[C],this.trigger("caption",E);for(C=0;C<U.metadata.length;C++)k=U.metadata[C],this.trigger("id3Frame",k)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Cd.prototype.setRemux=function(_){this.remuxTracks=_},(cy=function(_){var E,k,C=this,D=!0;cy.prototype.init.call(this),_=_||{},this.baseMediaDecodeTime=_.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var U={};(this.transmuxPipeline_=U).type="aac",U.metadataStream=new Zr.MetadataStream,U.aacStream=new QP,U.audioTimestampRolloverStream=new Zr.TimestampRolloverStream("audio"),U.timedMetadataTimestampRolloverStream=new Zr.TimestampRolloverStream("timed-metadata"),U.adtsStream=new ES,U.coalesceStream=new Cd(_,U.metadataStream),U.headOfPipeline=U.aacStream,U.aacStream.pipe(U.audioTimestampRolloverStream).pipe(U.adtsStream),U.aacStream.pipe(U.timedMetadataTimestampRolloverStream).pipe(U.metadataStream).pipe(U.coalesceStream),U.metadataStream.on("timestamp",function(H){U.aacStream.setTimestamp(H.timeStamp)}),U.aacStream.on("data",function(H){H.type!=="timed-metadata"&&H.type!=="audio"||U.audioSegmentStream||(k=k||{timelineStartInfo:{baseMediaDecodeTime:C.baseMediaDecodeTime},codec:"adts",type:"audio"},U.coalesceStream.numberOfTracks++,U.audioSegmentStream=new bp(k,_),U.audioSegmentStream.on("log",C.getLogTrigger_("audioSegmentStream")),U.audioSegmentStream.on("timingInfo",C.trigger.bind(C,"audioTimingInfo")),U.adtsStream.pipe(U.audioSegmentStream).pipe(U.coalesceStream),C.trigger("trackinfo",{hasAudio:!!k,hasVideo:!!E}))}),U.coalesceStream.on("data",this.trigger.bind(this,"data")),U.coalesceStream.on("done",this.trigger.bind(this,"done")),vS(this,U)},this.setupTsPipeline=function(){var U={};(this.transmuxPipeline_=U).type="ts",U.metadataStream=new Zr.MetadataStream,U.packetStream=new Zr.TransportPacketStream,U.parseStream=new Zr.TransportParseStream,U.elementaryStream=new Zr.ElementaryStream,U.timestampRolloverStream=new Zr.TimestampRolloverStream,U.adtsStream=new ES,U.h264Stream=new YP,U.captionStream=new Zr.CaptionStream(_),U.coalesceStream=new Cd(_,U.metadataStream),U.headOfPipeline=U.packetStream,U.packetStream.pipe(U.parseStream).pipe(U.elementaryStream).pipe(U.timestampRolloverStream),U.timestampRolloverStream.pipe(U.h264Stream),U.timestampRolloverStream.pipe(U.adtsStream),U.timestampRolloverStream.pipe(U.metadataStream).pipe(U.coalesceStream),U.h264Stream.pipe(U.captionStream).pipe(U.coalesceStream),U.elementaryStream.on("data",function(H){var G;if(H.type==="metadata"){for(G=H.tracks.length;G--;)E||H.tracks[G].type!=="video"?k||H.tracks[G].type!=="audio"||((k=H.tracks[G]).timelineStartInfo.baseMediaDecodeTime=C.baseMediaDecodeTime):(E=H.tracks[G]).timelineStartInfo.baseMediaDecodeTime=C.baseMediaDecodeTime;E&&!U.videoSegmentStream&&(U.coalesceStream.numberOfTracks++,U.videoSegmentStream=new uy(E,_),U.videoSegmentStream.on("log",C.getLogTrigger_("videoSegmentStream")),U.videoSegmentStream.on("timelineStartInfo",function(ae){k&&!_.keepOriginalTimestamps&&(k.timelineStartInfo=ae,U.audioSegmentStream.setEarliestDts(ae.dts-C.baseMediaDecodeTime))}),U.videoSegmentStream.on("processedGopsInfo",C.trigger.bind(C,"gopInfo")),U.videoSegmentStream.on("segmentTimingInfo",C.trigger.bind(C,"videoSegmentTimingInfo")),U.videoSegmentStream.on("baseMediaDecodeTime",function(ae){k&&U.audioSegmentStream.setVideoBaseMediaDecodeTime(ae)}),U.videoSegmentStream.on("timingInfo",C.trigger.bind(C,"videoTimingInfo")),U.h264Stream.pipe(U.videoSegmentStream).pipe(U.coalesceStream)),k&&!U.audioSegmentStream&&(U.coalesceStream.numberOfTracks++,U.audioSegmentStream=new bp(k,_),U.audioSegmentStream.on("log",C.getLogTrigger_("audioSegmentStream")),U.audioSegmentStream.on("timingInfo",C.trigger.bind(C,"audioTimingInfo")),U.audioSegmentStream.on("segmentTimingInfo",C.trigger.bind(C,"audioSegmentTimingInfo")),U.adtsStream.pipe(U.audioSegmentStream).pipe(U.coalesceStream)),C.trigger("trackinfo",{hasAudio:!!k,hasVideo:!!E})}}),U.coalesceStream.on("data",this.trigger.bind(this,"data")),U.coalesceStream.on("id3Frame",function(H){H.dispatchType=U.metadataStream.dispatchType,C.trigger("id3Frame",H)}),U.coalesceStream.on("caption",this.trigger.bind(this,"caption")),U.coalesceStream.on("done",this.trigger.bind(this,"done")),vS(this,U)},this.setBaseMediaDecodeTime=function(U){var H=this.transmuxPipeline_;_.keepOriginalTimestamps||(this.baseMediaDecodeTime=U),k&&(k.timelineStartInfo.dts=void 0,k.timelineStartInfo.pts=void 0,zn.clearDtsInfo(k),H.audioTimestampRolloverStream)&&H.audioTimestampRolloverStream.discontinuity(),E&&(H.videoSegmentStream&&(H.videoSegmentStream.gopCache_=[]),E.timelineStartInfo.dts=void 0,E.timelineStartInfo.pts=void 0,zn.clearDtsInfo(E),H.captionStream.reset()),H.timestampRolloverStream&&H.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(U){k&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(U)},this.setRemux=function(U){var H=this.transmuxPipeline_;_.remux=U,H&&H.coalesceStream&&H.coalesceStream.setRemux(U)},this.alignGopsWith=function(U){E&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(U)},this.getLogTrigger_=function(U){var H=this;return function(G){G.stream=U,H.trigger("log",G)}},this.push=function(U){var H;D&&((H=JP(U))&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():H||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline(),D=!1),this.transmuxPipeline_.headOfPipeline.push(U)},this.flush=function(){D=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new au;function wS(_){var E="";return(E+=String.fromCharCode(_[0]))+String.fromCharCode(_[1])+String.fromCharCode(_[2])+String.fromCharCode(_[3])}function dy(_,E){var k,C,D,U=[];if(!E.length)return null;for(k=0;k<_.byteLength;)C=rL(_[k]<<24|_[k+1]<<16|_[k+2]<<8|_[k+3]),D=aL(_.subarray(k+4,k+8)),C=1<C?k+C:_.byteLength,D===E[0]&&(E.length===1?U.push(_.subarray(k+8,C)):(D=dy(_.subarray(k+8,C),E.slice(1))).length&&(U=U.concat(D))),k=C;return U}function tL(_){var E={version:_[0],flags:new Uint8Array(_.subarray(1,4))};return E.baseMediaDecodeTime=E.version===1?lL(_.subarray(4)):oL(_[4]<<24|_[5]<<16|_[6]<<8|_[7]),E}function iL(_){var E,k={version:_[0],flags:new Uint8Array(_.subarray(1,4)),samples:[]},C=new DataView(_.buffer,_.byteOffset,_.byteLength),D=1&k.flags[2],U=4&k.flags[2],H=1&k.flags[1],G=2&k.flags[1],ae=4&k.flags[1],ue=8&k.flags[1],Te=C.getUint32(4),we=8;for(D&&(k.dataOffset=C.getInt32(we),we+=4),U&&Te&&(E={flags:AS(_.subarray(we,we+4))},we+=4,H&&(E.duration=C.getUint32(we),we+=4),G&&(E.size=C.getUint32(we),we+=4),ue&&(E.compositionTimeOffset=k.version===1?C.getInt32(we):C.getUint32(we),we+=4),k.samples.push(E),Te--);Te--;)E={},H&&(E.duration=C.getUint32(we),we+=4),G&&(E.size=C.getUint32(we),we+=4),ae&&(E.flags=AS(_.subarray(we,we+4)),we+=4),ue&&(E.compositionTimeOffset=k.version===1?C.getInt32(we):C.getUint32(we),we+=4),k.samples.push(E);return k}function sL(_){var E=new DataView(_.buffer,_.byteOffset,_.byteLength),k=1&(_={version:_[0],flags:new Uint8Array(_.subarray(1,4)),trackId:E.getUint32(4)}).flags[2],C=2&_.flags[2],D=8&_.flags[2],U=16&_.flags[2],H=32&_.flags[2],G=65536&_.flags[0],ae=131072&_.flags[0],ue=8;return k&&(ue+=4,_.baseDataOffset=E.getUint32(12),ue+=4),C&&(_.sampleDescriptionIndex=E.getUint32(ue),ue+=4),D&&(_.defaultSampleDuration=E.getUint32(ue),ue+=4),U&&(_.defaultSampleSize=E.getUint32(ue),ue+=4),H&&(_.defaultSampleFlags=E.getUint32(ue)),G&&(_.durationIsEmpty=!0),!k&&ae&&(_.baseDataOffsetIsMoof=!0),_}function CS(_){var E=31&_[1];return E<<8|_[2]}function Ep(_){return!!(64&_[1])}function Sp(_){var E=0;return 1<(48&_[3])>>>4&&(E+=_[4]+1),E}function hy(_){switch(_){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}var nL=cy,En=function(_){return _>>>0},Id=function(_){return("00"+_.toString(16)).slice(-2)},rL=En,aL=wS,oL=En,lL=As.getUint64,AS=function(_){return{isLeading:(12&_[0])>>>2,dependsOn:3&_[0],isDependedOn:(192&_[1])>>>6,hasRedundancy:(48&_[1])>>>4,paddingValue:(14&_[1])>>>1,isNonSyncSample:1&_[1],degradationPriority:_[2]<<8|_[3]}},Od=typeof window<"u"?window:typeof Di<"u"?Di:typeof self<"u"?self:{},Fa=Od,uL=up.discardEmulationPreventionBytes,cL=ru.CaptionStream,Dd=dy,dL=tL,hL=iL,fL=sL,kS=Fa,pL=function(C,E){var k=Dd(C,["moof","traf"]),C=Dd(C,["mdat"]),D={},U=[];return C.forEach(function(H,G){G=k[G],U.push({mdat:H,traf:G})}),U.forEach(function(os){var G,ae,ue,Te,we,ot=os.mdat,os=os.traf,at=Dd(os,["tfhd"]),at=fL(at[0]),lt=at.trackId,Pi=Dd(os,["tfdt"]),Pi=0<Pi.length?dL(Pi[0]).baseMediaDecodeTime:0,os=Dd(os,["trun"]);E===lt&&0<os.length&&(G=Pi,ae=at.defaultSampleDuration||0,ue=at.defaultSampleSize||0,Te=at.trackId,we=[],os.forEach(function(Qi){Qi=hL(Qi).samples,Qi.forEach(function(qi){qi.duration===void 0&&(qi.duration=ae),qi.size===void 0&&(qi.size=ue),qi.trackId=Te,qi.dts=G,qi.compositionTimeOffset===void 0&&(qi.compositionTimeOffset=0),typeof G=="bigint"?(qi.pts=G+kS.BigInt(qi.compositionTimeOffset),G+=kS.BigInt(qi.duration)):(qi.pts=G+qi.compositionTimeOffset,G+=qi.duration)}),we=we.concat(Qi)}),Pi=function(Qi,qi,xi){for(var St,ta,py=new DataView(Qi.buffer,Qi.byteOffset,Qi.byteLength),Ld={logs:[],seiNals:[]},ia=0;ia+4<Qi.length;ia+=St)if(St=py.getUint32(ia),ia+=4,!(St<=0))switch(31&Qi[ia]){case 6:var $a=Qi.subarray(ia+1,ia+1+St),wp=function(wL,PS){for(var LS=wL,my=0;my<PS.length;my++){var gy=PS[my];if(LS<gy.size)return gy;LS-=gy.size}return null}(ia,qi),$a={nalUnitType:"sei_rbsp",size:St,data:$a,escapedRBSP:uL($a),trackId:xi};if(wp)$a.pts=wp.pts,$a.dts=wp.dts,ta=wp;else{if(!ta){Ld.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ia+" for trackId "+xi+". See mux.js#223."});break}$a.pts=ta.pts,$a.dts=ta.dts}Ld.seiNals.push($a)}return Ld}(ot,we,lt),D[lt]||(D[lt]={seiNals:[],logs:[]}),D[lt].seiNals=D[lt].seiNals.concat(Pi.seiNals),D[lt].logs=D[lt].logs.concat(Pi.logs))}),D},mL=function(){var _,E,k,C,D,U,H=!1;this.isInitialized=function(){return H},this.init=function(G){_=new cL,H=!0,U=!!G&&G.isPartial,_.on("data",function(ae){ae.startTime=ae.startPts/C,ae.endTime=ae.endPts/C,D.captions.push(ae),D.captionStreams[ae.stream]=!0}),_.on("log",function(ae){D.logs.push(ae)})},this.isNewInit=function(G,ae){return!(G&&G.length===0||ae&&typeof ae=="object"&&Object.keys(ae).length===0||k===G[0]&&C===ae[k])},this.parse=function(G,ae,ue){var Te,we;if(!this.isInitialized()||!ae||!ue)return null;if(this.isNewInit(ae,ue))k=ae[0],C=ue[k];else if(k===null||!C)return E.push(G),null;for(;0<E.length;){var ot=E.shift();this.parse(ot,ae,ue)}return G=G,we=C,(Te=(Te=k)===null?null:{seiNals:(G=pL(G,Te)[Te]||{}).seiNals,logs:G.logs,timescale:we})&&Te.logs&&(D.logs=D.logs.concat(Te.logs)),Te!==null&&Te.seiNals?(this.pushNals(Te.seiNals),this.flushStream(),D):D.logs.length?{logs:D.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(G){if(!this.isInitialized()||!G||G.length===0)return null;G.forEach(function(ae){_.push(ae)})},this.flushStream=function(){if(!this.isInitialized())return null;U?_.partialFlush():_.flush()},this.clearParsedCaptions=function(){D.captions=[],D.captionStreams={},D.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;_.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){E=[],C=k=null,D?this.clearParsedCaptions():D={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},IS=En,Pd=Id,ea=dy,xp=wS,gL=As.getUint64,_L=Fa,yL=function(_){var E=_[0]===0?12:20;return IS(_[E]<<24|_[1+E]<<16|_[2+E]<<8|_[3+E])},vL=function(_,E){return E=ea(E,["moof","traf"]).reduce(function(k,H){var D=ea(H,["tfhd"])[0],D=IS(D[4]<<24|D[5]<<16|D[6]<<8|D[7]),D=_[D]||9e4,H=ea(H,["tfdt"])[0],U=new DataView(H.buffer,H.byteOffset,H.byteLength),H=H[0]===1?gL(H.subarray(4,12)):U.getUint32(4);let G;return typeof H=="bigint"?G=H/_L.BigInt(D):typeof H!="number"||isNaN(H)||(G=H/D),k=(G=G<Number.MAX_SAFE_INTEGER?Number(G):G)<k?G:k},1/0),typeof E=="bigint"||isFinite(E)?E:0},TL=function(E){var E=ea(E,["moov","trak"]),k=[];return E.forEach(function(C){var D,U={},G=ea(C,["tkhd"])[0],H=(G&&(H=(G=new DataView(G.buffer,G.byteOffset,G.byteLength)).getUint8(0),U.id=H===0?G.getUint32(12):G.getUint32(20)),ea(C,["mdia","hdlr"])[0]),H=(H&&(G=xp(H.subarray(8,12)),U.type=G==="vide"?"video":G==="soun"?"audio":G),ea(C,["mdia","minf","stbl","stsd"])[0]),G=(H&&(G=H.subarray(8),U.codec=xp(G.subarray(4,8)),H=ea(G,[U.codec])[0])&&(/^[asm]vc[1-9]$/i.test(U.codec)?(D=H.subarray(78),xp(D.subarray(4,8))==="avcC"&&11<D.length?(U.codec+=".",U.codec+=Pd(D[9]),U.codec+=Pd(D[10]),U.codec+=Pd(D[11])):U.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(U.codec)?(D=H.subarray(28),xp(D.subarray(4,8))==="esds"&&20<D.length&&D[19]!==0?(U.codec+="."+Pd(D[19]),U.codec+="."+Pd(D[20]>>>2&63).replace(/^0/,"")):U.codec="mp4a.40.2"):U.codec=U.codec.toLowerCase()),ea(C,["mdia","mdhd"])[0]);G&&(U.timescale=yL(G)),k.push(U)}),k},fy=hp,OS=hp,ou=qP,si={},Uo=(si.ts={parseType:function(_,E){return _=CS(_),_===0?"pat":_===E?"pmt":E?"pes":null},parsePat:function(_){var E=Ep(_),k=4+Sp(_);return E&&(k+=_[k]+1),(31&_[k+10])<<8|_[k+11]},parsePmt:function(_){var E={},k=Ep(_),C=4+Sp(_);if(k&&(C+=_[C]+1),1&_[C+5]){for(var D=3+((15&_[C+1])<<8|_[C+2])-4,U=12+((15&_[C+10])<<8|_[C+11]);U<D;){var H=C+U;E[(31&_[H+1])<<8|_[H+2]]=_[H],U+=5+((15&_[H+3])<<8|_[H+4])}return E}},parsePayloadUnitStartIndicator:Ep,parsePesType:function(_,E){switch(E[CS(_)]){case fy.H264_STREAM_TYPE:return"video";case fy.ADTS_STREAM_TYPE:return"audio";case fy.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(_){var E,k,C;return!Ep(_)||(E=4+Sp(_))>=_.byteLength?null:(k=null,192&(C=_[E+7])&&((k={}).pts=(14&_[E+9])<<27|(255&_[E+10])<<20|(254&_[E+11])<<12|(255&_[E+12])<<5|(254&_[E+13])>>>3,k.pts*=4,k.pts+=(6&_[E+13])>>>1,k.dts=k.pts,64&C)&&(k.dts=(14&_[E+14])<<27|(255&_[E+15])<<20|(254&_[E+16])<<12|(255&_[E+17])<<5|(254&_[E+18])>>>3,k.dts*=4,k.dts+=(6&_[E+18])>>>1),k)},videoPacketContainsKeyFrame:function(_){for(var E=4+Sp(_),k=_.subarray(E),C=0,D=0,U=!1;D<k.byteLength-3;D++)if(k[D+2]===1){C=D+5;break}for(;C<k.byteLength;)switch(k[C]){case 0:if(k[C-1]!==0)C+=2;else if(k[C-2]!==0)C++;else{for(D+3!==C-2&&hy(31&k[D+3])==="slice_layer_without_partitioning_rbsp_idr"&&(U=!0);k[++C]!==1&&C<k.length;);D=C-2,C+=3}break;case 1:k[C-1]!==0||k[C-2]!==0||(hy(31&k[D+3])==="slice_layer_without_partitioning_rbsp_idr"&&(U=!0),D=C-2),C+=3;break;default:C+=3}return k=k.subarray(D),C-=D,D=0,U=k&&3<k.byteLength&&hy(31&k[D+3])==="slice_layer_without_partitioning_rbsp_idr"?!0:U}},si.aac=yr,_i.ONE_SECOND_IN_TS),bL=function(_,E){for(var k,C=0,D=188;D<_.byteLength;)if(_[C]===71&&_[D]===71){switch(k=_.subarray(C,D),si.ts.parseType(k,E.pid)){case"pat":E.pid=si.ts.parsePat(k);break;case"pmt":var U=si.ts.parsePmt(k);E.table=E.table||{},Object.keys(U).forEach(function(H){E.table[H]=U[H]})}C+=188,D+=188}else C++,D++},EL=function(_,E,k){for(var C,D,U,H,G=0,ae=188,ue=!1;ae<=_.byteLength;)if(_[G]!==71||_[ae]!==71&&ae!==_.byteLength)G++,ae++;else{if(C=_.subarray(G,ae),si.ts.parseType(C,E.pid)==="pes"&&(D=si.ts.parsePesType(C,E.table),U=si.ts.parsePayloadUnitStartIndicator(C),D==="audio")&&U&&(H=si.ts.parsePesTime(C))&&(H.type="audio",k.audio.push(H),ue=!0),ue)break;G+=188,ae+=188}for(G=(ae=_.byteLength)-188,ue=!1;0<=G;)if(_[G]!==71||_[ae]!==71&&ae!==_.byteLength)G--,ae--;else{if(C=_.subarray(G,ae),si.ts.parseType(C,E.pid)==="pes"&&(D=si.ts.parsePesType(C,E.table),U=si.ts.parsePayloadUnitStartIndicator(C),D==="audio")&&U&&(H=si.ts.parsePesTime(C))&&(H.type="audio",k.audio.push(H),ue=!0),ue)break;G-=188,ae-=188}},SL=function(_,E,k){for(var C,D,U,H,G,ae,ue,Te,we=0,ot=188,at=!1,lt={data:[],size:0};ot<_.byteLength;)if(_[we]===71&&_[ot]===71){if(C=_.subarray(we,ot),si.ts.parseType(C,E.pid)==="pes"&&(D=si.ts.parsePesType(C,E.table),U=si.ts.parsePayloadUnitStartIndicator(C),D==="video"&&(U&&!at&&(H=si.ts.parsePesTime(C))&&(H.type="video",k.video.push(H),at=!0),!k.firstKeyFrame))){if(U&&lt.size!==0){for(G=new Uint8Array(lt.size),ae=0;lt.data.length;)ue=lt.data.shift(),G.set(ue,ae),ae+=ue.byteLength;si.ts.videoPacketContainsKeyFrame(G)&&(Te=si.ts.parsePesTime(G))&&(k.firstKeyFrame=Te,k.firstKeyFrame.type="video"),lt.size=0}lt.data.push(C),lt.size+=C.byteLength}if(at&&k.firstKeyFrame)break;we+=188,ot+=188}else we++,ot++;for(we=(ot=_.byteLength)-188,at=!1;0<=we;)if(_[we]===71&&_[ot]===71){if(C=_.subarray(we,ot),si.ts.parseType(C,E.pid)==="pes"&&(D=si.ts.parsePesType(C,E.table),U=si.ts.parsePayloadUnitStartIndicator(C),D==="video")&&U&&(H=si.ts.parsePesTime(C))&&(H.type="video",k.video.push(H),at=!0),at)break;we-=188,ot-=188}else we--,ot--},xL=function(U,E){var k,C,D,U=(si.aac.isLikelyAacData(U)?function(H){for(var G,ae,ue=!1,Te=0,we=null,ot=null,at=0,lt=0;3<=H.length-lt;){switch(si.aac.parseType(H,lt)){case"timed-metadata":H.length-lt<10||(at=si.aac.parseId3TagSize(H,lt))>H.length?ue=!0:(ot===null&&(G=H.subarray(lt,lt+at),ot=si.aac.parseAacTimestamp(G)),lt+=at);break;case"audio":H.length-lt<7||(at=si.aac.parseAdtsSize(H,lt))>H.length?ue=!0:(we===null&&(G=H.subarray(lt,lt+at),we=si.aac.parseSampleRate(G)),Te++,lt+=at);break;default:lt++}if(ue)return null}return we===null||ot===null?null:{audio:[{type:"audio",dts:ot,pts:ot},{type:"audio",dts:ot+1024*Te*(ae=Uo/we),pts:ot+1024*Te*ae}]}}:function(H){var G,ae={pid:null,table:null},ue={};for(G in bL(H,ae),ae.table)if(ae.table.hasOwnProperty(G))switch(ae.table[G]){case OS.H264_STREAM_TYPE:ue.video=[],SL(H,ae,ue),ue.video.length===0&&delete ue.video;break;case OS.ADTS_STREAM_TYPE:ue.audio=[],EL(H,ae,ue),ue.audio.length===0&&delete ue.audio}return ue})(U);return U&&(U.audio||U.video)?(E=E,(k=U).audio&&k.audio.length&&(typeof(C=E)<"u"&&!isNaN(C)||(C=k.audio[0].dts),k.audio.forEach(function(H){H.dts=ou(H.dts,C),H.pts=ou(H.pts,C),H.dtsTime=H.dts/Uo,H.ptsTime=H.pts/Uo})),k.video&&k.video.length&&(typeof(D=E)<"u"&&!isNaN(D)||(D=k.video[0].dts),k.video.forEach(function(H){H.dts=ou(H.dts,D),H.pts=ou(H.pts,D),H.dtsTime=H.dts/Uo,H.ptsTime=H.pts/Uo}),k.firstKeyFrame)&&((E=k.firstKeyFrame).dts=ou(E.dts,D),E.pts=ou(E.pts,D),E.dtsTime=E.dts/Uo,E.ptsTime=E.pts/Uo),U):null};class DS{constructor(E,k){this.options=k||{},this.self=E,this.init()}init(){var E,k;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new nL(this.options),E=this.self,(k=this.transmuxer).on("data",function(C){var D=C.initSegment,D=(C.initSegment={data:D.buffer,byteOffset:D.byteOffset,byteLength:D.byteLength},C.data);C.data=D.buffer,E.postMessage({action:"data",segment:C,byteOffset:D.byteOffset,byteLength:D.byteLength},[C.data])}),k.on("done",function(C){E.postMessage({action:"done"})}),k.on("gopInfo",function(C){E.postMessage({action:"gopInfo",gopInfo:C})}),k.on("videoSegmentTimingInfo",function(C){var D={start:{decode:_i.videoTsToSeconds(C.start.dts),presentation:_i.videoTsToSeconds(C.start.pts)},end:{decode:_i.videoTsToSeconds(C.end.dts),presentation:_i.videoTsToSeconds(C.end.pts)},baseMediaDecodeTime:_i.videoTsToSeconds(C.baseMediaDecodeTime)};C.prependedContentDuration&&(D.prependedContentDuration=_i.videoTsToSeconds(C.prependedContentDuration)),E.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:D})}),k.on("audioSegmentTimingInfo",function(C){var D={start:{decode:_i.videoTsToSeconds(C.start.dts),presentation:_i.videoTsToSeconds(C.start.pts)},end:{decode:_i.videoTsToSeconds(C.end.dts),presentation:_i.videoTsToSeconds(C.end.pts)},baseMediaDecodeTime:_i.videoTsToSeconds(C.baseMediaDecodeTime)};C.prependedContentDuration&&(D.prependedContentDuration=_i.videoTsToSeconds(C.prependedContentDuration)),E.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:D})}),k.on("id3Frame",function(C){E.postMessage({action:"id3Frame",id3Frame:C})}),k.on("caption",function(C){E.postMessage({action:"caption",caption:C})}),k.on("trackinfo",function(C){E.postMessage({action:"trackinfo",trackInfo:C})}),k.on("audioTimingInfo",function(C){E.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:_i.videoTsToSeconds(C.start),end:_i.videoTsToSeconds(C.end)}})}),k.on("videoTimingInfo",function(C){E.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:_i.videoTsToSeconds(C.start),end:_i.videoTsToSeconds(C.end)}})}),k.on("log",function(C){E.postMessage({action:"log",log:C})})}pushMp4Captions(C){this.captionParser||(this.captionParser=new mL,this.captionParser.init());var k=new Uint8Array(C.data,C.byteOffset,C.byteLength),C=this.captionParser.parse(k,C.trackIds,C.timescales);this.self.postMessage({action:"mp4Captions",captions:C&&C.captions||[],logs:C&&C.logs||[],data:k.buffer},[k.buffer])}probeMp4StartTime({timescales:E,data:k}){E=vL(E,k),this.self.postMessage({action:"probeMp4StartTime",startTime:E,data:k},[k.buffer])}probeMp4Tracks({data:E}){var k=TL(E);this.self.postMessage({action:"probeMp4Tracks",tracks:k,data:E},[E.buffer])}probeTs({data:E,baseStartTime:k}){k=typeof k!="number"||isNaN(k)?void 0:k*_i.ONE_SECOND_IN_TS,k=xL(E,k);let C=null;k&&((C={hasVideo:k.video&&k.video.length===2||!1,hasAudio:k.audio&&k.audio.length===2||!1}).hasVideo&&(C.videoStart=k.video[0].ptsTime),C.hasAudio)&&(C.audioStart=k.audio[0].ptsTime),this.self.postMessage({action:"probeTs",result:C,data:E},[E.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(E){E=new Uint8Array(E.data,E.byteOffset,E.byteLength),this.transmuxer.push(E)}reset(){this.transmuxer.reset()}setTimestampOffset(E){E=E.timestampOffset||0,this.transmuxer.setBaseMediaDecodeTime(Math.round(_i.secondsToVideoTs(E)))}setAudioAppendStart(E){this.transmuxer.setAudioAppendStart(Math.ceil(_i.secondsToVideoTs(E.appendStart)))}setRemux(E){this.transmuxer.setRemux(E.remux)}flush(E){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(E){this.transmuxer.alignGopsWith(E.gopsToAlignWith.slice())}}self.onmessage=function(_){_.data.action==="init"&&_.data.options?this.messageHandlers=new DS(self,_.data.options):(this.messageHandlers||(this.messageHandlers=new DS(self)),_.data&&_.data.action&&_.data.action!=="init"&&this.messageHandlers[_.data.action]&&this.messageHandlers[_.data.action](_.data))}})));const oP=(a,A,r)=>{var{type:l,initSegment:d,captions:P,captionStreams:f,metadata:p,videoFrameDtsTime:y,videoFramePtsTime:S}=a.data.segment,A=(A.buffer.push({captions:P,captionStreams:f,metadata:p}),a.data.segment.boxes||{data:a.data.segment.data}),P={type:l,data:new Uint8Array(A.data,A.data.byteOffset,A.data.byteLength),initSegment:new Uint8Array(d.data,d.byteOffset,d.byteLength)};typeof y<"u"&&(P.videoFrameDtsTime=y),typeof S<"u"&&(P.videoFramePtsTime=S),r(P)},lP=({transmuxedData:a,callback:s})=>{a.buffer=[],s(a)},uP=(a,s)=>{s.gopInfo=a.data.gopInfo},DE=a=>{const{transmuxer:s,bytes:r,audioAppendStart:l,gopsToAlignWith:d,remux:f,onData:p,onTrackInfo:y,onAudioTimingInfo:S,onVideoTimingInfo:A,onVideoSegmentTimingInfo:P,onAudioSegmentTimingInfo:L,onId3:B,onCaptions:F,onDone:K,onEndedTimeline:Q,onTransmuxerLog:oe,isEndOfTimeline:te}=a,ce={buffer:[]};let de=te;var xe,ge;s.onmessage=Me=>{s.currentTransmux!==a||(Me.data.action==="data"&&oP(Me,ce,p),Me.data.action==="trackinfo"&&y(Me.data.trackInfo),Me.data.action==="gopInfo"&&uP(Me,ce),Me.data.action==="audioTimingInfo"&&S(Me.data.audioTimingInfo),Me.data.action==="videoTimingInfo"&&A(Me.data.videoTimingInfo),Me.data.action==="videoSegmentTimingInfo"&&P(Me.data.videoSegmentTimingInfo),Me.data.action==="audioSegmentTimingInfo"&&L(Me.data.audioSegmentTimingInfo),Me.data.action==="id3Frame"&&B([Me.data.id3Frame],Me.data.id3Frame.dispatchType),Me.data.action==="caption"&&F(Me.data.caption),Me.data.action==="endedtimeline"&&(de=!1,Q()),Me.data.action==="log"&&oe(Me.data.log),Me.data.type!=="transmuxed")||de||(s.onmessage=null,lP({transmuxedData:ce,callback:K}),PE(s))},l&&s.postMessage({action:"setAudioAppendStart",appendStart:l}),Array.isArray(d)&&s.postMessage({action:"alignGopsWith",gopsToAlignWith:d}),typeof f<"u"&&s.postMessage({action:"setRemux",remux:f}),r.byteLength&&(xe=r instanceof ArrayBuffer?r:r.buffer,ge=r instanceof ArrayBuffer?0:r.byteOffset,s.postMessage({action:"push",data:xe,byteOffset:ge,byteLength:r.byteLength},[xe])),te&&s.postMessage({action:"endTimeline"}),s.postMessage({action:"flush"})},PE=a=>{a.currentTransmux=null,a.transmuxQueue.length&&(a.currentTransmux=a.transmuxQueue.shift(),typeof a.currentTransmux=="function"?a.currentTransmux():DE(a.currentTransmux))},LE=(a,s)=>{a.postMessage({action:s}),PE(a)},cP=(a,s)=>{s.currentTransmux?s.transmuxQueue.push(LE.bind(null,s,a)):(s.currentTransmux=a,LE(s,a))},dP=a=>{a.transmuxer.currentTransmux?a.transmuxer.transmuxQueue.push(a):(a.transmuxer.currentTransmux=a,DE(a))};var NE=a=>{cP("reset",a)},hP=a=>{const s=new aP,r=(s.currentTransmux=null,s.transmuxQueue=[],s.terminate);return s.terminate=()=>(s.currentTransmux=null,s.transmuxQueue.length=0,r.call(s)),s.postMessage({action:"init",options:a}),s};function ip(a){const s=a.transmuxer,r=a.endAction||a.action,l=a.callback;var d,f=qr({},a,{endAction:null,transmuxer:null,callback:null});const p=y=>{y.data.action===r&&(s.removeEventListener("message",p),y.data.data&&(y.data.data=new Uint8Array(y.data.data,a.byteOffset||0,a.byteLength||y.data.data.byteLength),a.data)&&(a.data=y.data.data),l(y.data))};s.addEventListener("message",p),a.data?(d=a.data instanceof ArrayBuffer,f.byteOffset=d?0:a.data.byteOffset,f.byteLength=a.data.byteLength,d=[d?a.data:a.data.buffer],s.postMessage(f,d)):s.postMessage(f)}function RE(a){let s=0;return a.audio&&s++,a.video&&s++,s}function bd(a,s){var r=s.attributes||{},l=np(function(d){if(d=d.attributes||{},d.CODECS)return hr(d.CODECS)}(s)||[]);return!$E(a,s)||l.audio||((d,p)=>{if(!$E(d,p))return!0;var p=p.attributes||{},y=d.mediaGroups.AUDIO[p.AUDIO];for(const S in y)if(!y[S].uri&&!y[S].playlists)return!0;return!1})(a,s)||(s=np(function(d,f){if(d.mediaGroups.AUDIO&&f){var p=d.mediaGroups.AUDIO[f];if(p){for(var y in p)if(y=p[y],y.default&&y.playlists)return hr(y.playlists[0].attributes.CODECS)}}return null}(a,r.AUDIO)||[])).audio&&(l.audio=s.audio),l}function sp(a,s){return(a=a&&window.getComputedStyle(a))?a[s]:""}function V_(a,s){let r,l;return r=(r=a.attributes.BANDWIDTH?a.attributes.BANDWIDTH:r)||window.Number.MAX_VALUE,l=(l=s.attributes.BANDWIDTH?s.attributes.BANDWIDTH:l)||window.Number.MAX_VALUE,r-l}const gr={FAILURE:2,TIMEOUT:-101,ABORTED:-102},q_=a=>{a.forEach(s=>{s.abort()})},fP=a=>({bandwidth:a.bandwidth,bytesReceived:a.bytesReceived||0,roundTripTime:a.roundTripTime||0}),pP=a=>{var s=a.target,s={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-s.requestTime||0};return s.bytesReceived=a.loaded,s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3),s},W_=(a,s)=>s.timedout?{status:s.status,message:"HLS request timed-out at URL: "+s.uri,code:gr.TIMEOUT,xhr:s}:s.aborted?{status:s.status,message:"HLS request aborted at URL: "+s.uri,code:gr.ABORTED,xhr:s}:a?{status:s.status,message:"HLS request errored at URL: "+s.uri,code:gr.FAILURE,xhr:s}:s.responseType==="arraybuffer"&&s.response.byteLength===0?{status:s.status,message:"Empty HLS response at URL: "+s.uri,code:gr.FAILURE,xhr:s}:null,ME=(a,s,r)=>(p,d)=>{var f=d.response,p=W_(p,d);if(p)return r(p,a);if(f.byteLength!==16)return r({status:d.status,message:"Invalid HLS key at URL: "+d.uri,code:gr.FAILURE,xhr:d},a);var p=new DataView(f),y=new Uint32Array([p.getUint32(0),p.getUint32(4),p.getUint32(8),p.getUint32(12)]);for(let S=0;S<s.length;S++)s[S].bytes=y;return r(null,a)},UE=(a,s)=>{var r,l=k_(a.map.bytes);if(l!=="mp4")return r=a.map.resolvedUri||a.map.uri,s({internal:!0,message:`Found unsupported ${l||"unknown"} container for initialization segment at URL: `+r,code:gr.FAILURE});ip({action:"probeMp4Tracks",data:a.map.bytes,transmuxer:a.transmuxer,callback:({tracks:d,data:f})=>(a.map.bytes=f,d.forEach(function(p){a.map.tracks=a.map.tracks||{},a.map.tracks[p.type]||typeof(a.map.tracks[p.type]=p).id=="number"&&p.timescale&&(a.map.timescales=a.map.timescales||{},a.map.timescales[p.id]=p.timescale)}),s(null))})},mP=({segment:a,bytes:s,trackInfoFn:r,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:p,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:A,dataFn:P,doneFn:L,onTransmuxerLog:B})=>{var F=a.map&&a.map.tracks||{};const K=Boolean(F.audio&&F.video);let Q=l.bind(null,a,"audio","start");const oe=l.bind(null,a,"audio","end");let te=l.bind(null,a,"video","start");const ce=l.bind(null,a,"video","end");ip({action:"probeTs",transmuxer:a.transmuxer,data:s,baseStartTime:a.baseStartTime,callback:de=>{a.bytes=s=de.data,de=de.result,de&&(r(a,{hasAudio:de.hasAudio,hasVideo:de.hasVideo,isMuxed:K}),r=null,de.hasAudio&&!K&&Q(de.audioStart),de.hasVideo&&te(de.videoStart),Q=null,te=null),dP({bytes:s,transmuxer:a.transmuxer,audioAppendStart:a.audioAppendStart,gopsToAlignWith:a.gopsToAlignWith,remux:K,onData:xe=>{xe.type=xe.type==="combined"?"video":xe.type,P(a,xe)},onTrackInfo:xe=>{r&&(K&&(xe.isMuxed=!0),r(a,xe))},onAudioTimingInfo:xe=>{Q&&typeof xe.start<"u"&&(Q(xe.start),Q=null),oe&&typeof xe.end<"u"&&oe(xe.end)},onVideoTimingInfo:xe=>{te&&typeof xe.start<"u"&&(te(xe.start),te=null),ce&&typeof xe.end<"u"&&ce(xe.end)},onVideoSegmentTimingInfo:xe=>{d(xe)},onAudioSegmentTimingInfo:xe=>{f(xe)},onId3:(xe,ge)=>{p(a,xe,ge)},onCaptions:xe=>{y(a,[xe])},isEndOfTimeline:S,onEndedTimeline:()=>{A()},onTransmuxerLog:B,onDone:xe=>{L&&(xe.type=xe.type==="combined"?"video":xe.type,L(null,a,xe))}})}})},BE=({segment:a,bytes:s,trackInfoFn:r,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:p,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:A,dataFn:P,doneFn:L,onTransmuxerLog:B})=>{let F=new Uint8Array(s);if(K=F,0<Yb(K,["moof"]).length){a.isFmp4=!0;const Q=a.map.tracks,oe={isFmp4:!0,hasVideo:!!Q.video,hasAudio:!!Q.audio},te=(Q.audio&&Q.audio.codec&&Q.audio.codec!=="enca"&&(oe.audioCodec=Q.audio.codec),Q.video&&Q.video.codec&&Q.video.codec!=="encv"&&(oe.videoCodec=Q.video.codec),Q.video&&Q.audio&&(oe.isMuxed=!0),r(a,oe),ce=>{P(a,{data:F,type:oe.hasAudio&&!oe.isMuxed?"audio":"video"}),ce&&ce.length&&y(a,ce),L(null,a,{})});ip({action:"probeMp4StartTime",timescales:a.map.timescales,data:F,transmuxer:a.transmuxer,callback:({data:ce,startTime:de})=>{s=ce.buffer,a.bytes=F=ce,oe.hasAudio&&!oe.isMuxed&&l(a,"audio","start",de),oe.hasVideo&&l(a,"video","start",de),Q.video&&ce.byteLength&&a.transmuxer?ip({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:a.transmuxer,data:F,timescales:a.map.timescales,trackIds:[Q.video.id],callback:xe=>{s=xe.data.buffer,a.bytes=F=xe.data,xe.logs.forEach(function(ge){B(oi(ge,{stream:"mp4CaptionParser"}))}),te(xe.captions)}}):te()}})}else{var K;a.transmuxer?(typeof a.container>"u"&&(a.container=k_(F)),a.container!=="ts"&&a.container!=="aac"?(r(a,{hasAudio:!1,hasVideo:!1}),L(null,a,{})):mP({segment:a,bytes:s,trackInfoFn:r,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:p,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:A,dataFn:P,doneFn:L,onTransmuxerLog:B})):L(null,a,{})}},FE=function({id:a,key:s,encryptedBytes:r,decryptionWorker:l},d){const f=y=>{y.data.source===a&&(l.removeEventListener("message",f),y=y.data.decrypted,d(new Uint8Array(y.bytes,y.byteOffset,y.byteLength)))};l.addEventListener("message",f);let p;p=s.bytes.slice?s.bytes.slice():new Uint32Array(Array.prototype.slice.call(s.bytes)),l.postMessage(TE({source:a,encrypted:r,key:p,iv:s.iv}),[r.buffer,p.buffer])},gP=({decryptionWorker:a,segment:s,trackInfoFn:r,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:p,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:A,dataFn:P,doneFn:L,onTransmuxerLog:B})=>{FE({id:s.requestId,key:s.key,encryptedBytes:s.encryptedBytes,decryptionWorker:a},F=>{s.bytes=F,BE({segment:s,bytes:s.bytes,trackInfoFn:r,timingInfoFn:l,videoSegmentTimingInfoFn:d,audioSegmentTimingInfoFn:f,id3Fn:p,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:A,dataFn:P,doneFn:L,onTransmuxerLog:B})})},_P=({xhr:a,xhrOptions:s,decryptionWorker:xe,segment:l,abortFn:d,progressFn:f,trackInfoFn:p,timingInfoFn:y,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:A,id3Fn:P,captionsFn:ge,isEndOfTimeline:gt,endedTimelineFn:F,dataFn:K,doneFn:Q,onTransmuxerLog:oe})=>{const te=[];var ce,de,xe=(({activeXhrs:st,decryptionWorker:Lt,trackInfoFn:Nt,timingInfoFn:Vi,videoSegmentTimingInfoFn:cn,audioSegmentTimingInfoFn:Ge,id3Fn:ze,captionsFn:$t,isEndOfTimeline:Wt,endedTimelineFn:Di,dataFn:Zt,doneFn:As,onTransmuxerLog:Ei})=>{let Gt=0,zt=!1;return(At,pt)=>{if(!zt){if(At)return zt=!0,q_(st),As(At,pt);if((Gt+=1)===st.length){const Wn=function(){if(pt.encryptedBytes)return gP({decryptionWorker:Lt,segment:pt,trackInfoFn:Nt,timingInfoFn:Vi,videoSegmentTimingInfoFn:cn,audioSegmentTimingInfoFn:Ge,id3Fn:ze,captionsFn:$t,isEndOfTimeline:Wt,endedTimelineFn:Di,dataFn:Zt,doneFn:As,onTransmuxerLog:Ei});BE({segment:pt,bytes:pt.bytes,trackInfoFn:Nt,timingInfoFn:Vi,videoSegmentTimingInfoFn:cn,audioSegmentTimingInfoFn:Ge,id3Fn:ze,captionsFn:$t,isEndOfTimeline:Wt,endedTimelineFn:Di,dataFn:Zt,doneFn:As,onTransmuxerLog:Ei})};if(pt.endOfAllRequests=Date.now(),pt.map&&pt.map.encryptedBytes&&!pt.map.bytes)return FE({decryptionWorker:Lt,id:pt.requestId+"-init",encryptedBytes:pt.map.encryptedBytes,key:pt.map.key},dn=>{pt.map.bytes=dn,UE(pt,Jr=>{if(Jr)return q_(st),As(Jr,pt);Wn()})});Wn()}}}})({activeXhrs:te,decryptionWorker:xe,trackInfoFn:p,timingInfoFn:y,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:A,id3Fn:P,captionsFn:ge,isEndOfTimeline:gt,endedTimelineFn:F,dataFn:K,doneFn:Q,onTransmuxerLog:oe}),ge=(l.key&&!l.key.bytes&&(p=[l.key],l.map&&!l.map.bytes&&l.map.key&&l.map.key.resolvedUri===l.key.resolvedUri&&p.push(l.map.key),y=a(oi(s,{uri:l.key.resolvedUri,responseType:"arraybuffer"}),ME(l,p,xe)),te.push(y)),l.map&&!l.map.bytes&&(!l.map.key||l.key&&l.key.resolvedUri===l.map.key.resolvedUri||(S=a(oi(s,{uri:l.map.key.resolvedUri,responseType:"arraybuffer"}),ME(l,[l.map.key],xe)),te.push(S)),A=oi(s,{uri:l.map.resolvedUri,responseType:"arraybuffer",headers:j_(l.map)}),{segment:ce,finishProcessingFn:de}=[{segment:l,finishProcessingFn:xe}][0],P=a(A,(Nt,Lt)=>{var Nt=W_(Nt,Lt);return Nt?de(Nt,ce):(Nt=new Uint8Array(Lt.response),ce.map.key?(ce.map.encryptedBytes=Nt,de(null,ce)):(ce.map.bytes=Nt,void UE(ce,function(Vi){if(Vi)return Vi.xhr=Lt,Vi.status=Lt.status,de(Vi,ce);de(null,ce)})))}),te.push(P)),oi(s,{uri:l.part&&l.part.resolvedUri||l.resolvedUri,responseType:"arraybuffer",headers:j_(l)}));({segment:Me,finishProcessingFn:xt,responseType:qe}={segment:l,finishProcessingFn:xe,responseType:ge.responseType});var Me,xt,qe,nt,Tt,gt=a(ge,(Nt,Lt)=>{var Nt=W_(Nt,Lt);return Nt?xt(Nt,Me):(Nt=qe!=="arraybuffer"&&Lt.responseText?rP(Lt.responseText.substring(Me.lastReachedChar||0)):Lt.response,Me.stats=fP(Lt),Me.key?Me.encryptedBytes=new Uint8Array(Nt):Me.bytes=new Uint8Array(Nt),xt(null,Me))});gt.addEventListener("progress",({segment:nt,progressFn:Tt}=[{segment:l,progressFn:f}][0],st=>{var Lt=st.target;if(!Lt.aborted)return nt.stats=oi(nt.stats,pP(st)),!nt.stats.firstBytesReceivedAt&&nt.stats.bytesReceived&&(nt.stats.firstBytesReceivedAt=Date.now()),Tt(st,nt)})),te.push(gt);const Ci={};return te.forEach(st=>{var Lt,Nt;st.addEventListener("loadend",({loadendState:Lt,abortFn:Nt}=[{loadendState:Ci,abortFn:d}][0],Vi=>{Vi.target.aborted&&Nt&&!Lt.calledAbortFn&&(Nt(),Lt.calledAbortFn=!0)}))}),()=>q_(te)},yP=qn("CodecUtils"),$E=(a,s)=>(s=s.attributes||{},a&&a.mediaGroups&&a.mediaGroups.AUDIO&&s.AUDIO&&a.mediaGroups.AUDIO[s.AUDIO]),np=function(a){const s={};return a.forEach(({mediaType:r,type:l,details:d})=>{s[r]=s[r]||[],s[r].push(ib(""+l+d))}),Object.keys(s).forEach(function(r){1<s[r].length?(yP(`multiple ${r} codecs found as attributes: ${s[r].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),s[r]=null):s[r]=s[r][0]}),s},G_=qn("PlaylistSelector"),jE=function(a){var s;if(a&&a.playlist)return s=a.playlist,JSON.stringify({id:s.id,bandwidth:a.bandwidth,width:a.width,height:a.height,codecs:s.attributes&&s.attributes.CODECS||""})},iu=function(a,s){const r=a.slice();a.sort(function(l,d){var f=s(l,d);return f===0?r.indexOf(l)-r.indexOf(d):f})};function HE(a,s,r,l,d,f){if(a){var p={bandwidth:s,width:r,height:l,limitRenditionByPlayerDimensions:d};let A=a.playlists,P=(Ws.isAudioOnly(a)&&(A=f.getAudioTrackPlaylists_(),p.audioOnly=!0),A.map(F=>{var K=F.attributes&&F.attributes.RESOLUTION&&F.attributes.RESOLUTION.width,Q=F.attributes&&F.attributes.RESOLUTION&&F.attributes.RESOLUTION.height,oe=F.attributes&&F.attributes.BANDWIDTH;return{bandwidth:oe||window.Number.MAX_VALUE,width:K,height:Q,playlist:F}})),L=(iu(P,(F,K)=>F.bandwidth-K.bandwidth),(P=P.filter(F=>!Ws.isIncompatible(F.playlist))).filter(F=>Ws.isEnabled(F.playlist)));a=(L=L.length?L:P.filter(F=>!Ws.isDisabled(F.playlist))).filter(F=>F.bandwidth*Yi.BANDWIDTH_VARIANCE<s);let B=a[a.length-1];var y=a.filter(F=>F.bandwidth===B.bandwidth)[0];if(d===!1){const F=y||L[0]||P[0];if(F&&F.playlist){let K=y?"bandwidthBestRep":"sortedPlaylistReps";return L[0]&&(K="enabledPlaylistReps"),G_(`choosing ${jE(F)} using ${K} with options`,p),F.playlist}}else{var S,d=a.filter(de=>de.width&&de.height),a=(iu(d,(de,xe)=>de.width-xe.width),d.filter(de=>de.width===r&&de.height===l)),a=(B=a[a.length-1],a.filter(de=>de.bandwidth===B.bandwidth)[0]);let Q,oe;a||(S=(Q=d.filter(de=>de.width>r||de.height>l)).filter(de=>de.width===Q[0].width&&de.height===Q[0].height),B=S[S.length-1],oe=S.filter(de=>de.bandwidth===B.bandwidth)[0]);let te;f.leastPixelDiffSelector&&(S=d.map(de=>(de.pixelDiff=Math.abs(de.width-r)+Math.abs(de.height-l),de)),iu(S,(de,xe)=>de.pixelDiff===xe.pixelDiff?xe.bandwidth-de.bandwidth:de.pixelDiff-xe.pixelDiff),te=S[0]);const ce=te||oe||a||y||L[0]||P[0];if(ce&&ce.playlist){let de="sortedPlaylistReps";return te?de="leastPixelDiffRep":oe?de="resolutionPlusOneRep":a?de="resolutionBestRep":y?de="bandwidthBestRep":L[0]&&(de="enabledPlaylistReps"),G_(`choosing ${jE(ce)} using ${de} with options`,p),ce.playlist}}return G_("could not choose a playlist with options",p),null}}function VE(){var a=this.useDevicePixelRatio&&window.devicePixelRatio||1;return HE(this.playlists.main,this.systemBandwidth,parseInt(sp(this.tech_.el(),"width"),10)*a,parseInt(sp(this.tech_.el(),"height"),10)*a,this.limitRenditionByPlayerDimensions,this.playlistController_)}function Ed(a,s,r){let l;var d;if(r&&r.cues)for(l=r.cues.length;l--;)(d=r.cues[l]).startTime>=a&&d.endTime<=s&&r.removeCue(d)}const vP=({inbandTextTracks:a,metadataArray:s,timestampOffset:r,videoDuration:l})=>{if(s){const p=window.WebKitDataCue||window.VTTCue,y=a.metadataTrack_;if(y&&(s.forEach(S=>{const A=S.cueTime+r;!(typeof A!="number"||window.isNaN(A)||A<0)&&A<1/0&&S.frames.forEach(P=>{var L,B=new p(A,A,P.value||P.url||P.data||"");B.frame=P,B.value=P,L=B,Object.defineProperties(L.frame,{id:{get(){return fe.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),L.value.key}},value:{get(){return fe.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),L.value.data}},privateData:{get(){return fe.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),L.value.data}}}),y.addCue(B)})}),y.cues)&&y.cues.length){var d=y.cues,f=[];for(let P=0;P<d.length;P++)d[P]&&f.push(d[P]);const S=f.reduce((P,L)=>{var B=P[L.startTime]||[];return B.push(L),P[L.startTime]=B,P},{}),A=Object.keys(S).sort((P,L)=>Number(P)-Number(L));A.forEach((P,L)=>{P=S[P];const B=Number(A[L+1])||l;P.forEach(F=>{F.endTime=B})})}}},qE=a=>typeof a=="number"&&isFinite(a),su=F=>{var{startOfSegment:s,duration:r,segment:l,part:d,playlist:{mediaSequence:f,id:p,segments:P=[]},mediaIndex:y,partIndex:S,timeline:A}=F,P=P.length-1;let L="mediaIndex/partIndex increment";F.getMediaInfoForTime?L=`getMediaInfoForTime (${F.getMediaInfoForTime})`:F.isSyncRequest&&(L="getSyncSegmentCandidate (isSyncRequest)"),F.independent&&(L+=" with independent "+F.independent);var B=typeof S=="number",F=F.segment.uri?"segment":"pre-segment",K=B?aE({preloadSegment:l})-1:0;return F+` [${f+y}/${f+P}]`+(B?` part [${S}/${K}]`:"")+` segment start/end [${l.start} => ${l.end}]`+(B?` part start/end [${d.start} => ${d.end}]`:"")+` startOfSegment [${s}] duration [${r}] timeline [${A}] selected by [${L}] playlist [${p}]`},WE=a=>a+"TimingInfo",GE=({timelineChangeController:a,currentTimeline:s,segmentTimeline:r,loaderType:l,audioDisabled:d})=>!(s===r||(l==="audio"?(s=a.lastTimelineChange({type:"main"}))&&s.to===r:l!=="main"||!d||(s=a.pendingTimelineChange({type:"audio"}))&&s.to===r)),zE=({segmentDuration:a,maxDuration:s})=>!!a&&Math.round(a)>s+Ua,TP=(a,s)=>{var r,l,d;return s==="hls"&&(s=(f=>{let p=0;return["video","audio"].forEach(function(y){if(y=f[y+"TimingInfo"],y){var{start:y,end:S}=y;let P;typeof y=="bigint"||typeof S=="bigint"?P=window.BigInt(S)-window.BigInt(y):typeof y=="number"&&typeof S=="number"&&(P=S-y),typeof P<"u"&&P>p&&(p=P)}}),p=typeof p=="bigint"&&p<Number.MAX_SAFE_INTEGER?Number(p):p})({audioTimingInfo:a.audioTimingInfo,videoTimingInfo:a.videoTimingInfo}))&&(r=a.playlist.targetDuration,l=zE({segmentDuration:s,maxDuration:2*r}),d=zE({segmentDuration:s,maxDuration:r}),s=`Segment with index ${a.mediaIndex} from playlist ${a.playlist.id} has a duration of ${s} when the reported duration is ${a.duration} and the target duration is ${r}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`,l||d)?{severity:l?"warn":"info",message:s}:null};class z_ extends fe.EventTarget{constructor(s,r=0){if(super(),!s)throw new TypeError("Initialization settings are required");if(typeof s.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!s.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=s.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=s.hasPlayed,this.currentTime_=s.currentTime,this.seekable_=s.seekable,this.seeking_=s.seeking,this.duration_=s.duration,this.mediaSource_=s.mediaSource,this.vhs_=s.vhs,this.loaderType_=s.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=s.segmentMetadataTrack,this.goalBufferLength_=s.goalBufferLength,this.sourceType_=s.sourceType,this.sourceUpdater_=s.sourceUpdater,this.inbandTextTracks_=s.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=s.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=s.parse708captions,this.useDtsForTimestampOffset_=s.useDtsForTimestampOffset,this.captionServices_=s.captionServices,this.exactManifestTimings=s.exactManifestTimings,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=11<=fe.browser.IE_VERSION,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=s.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=s.decrypter,this.syncController_=s.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=qn(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(l){l!==this.state_&&(this.logger_(this.state_+" -> "+l),this.state_=l,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return hP({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(s){this.audioDisabled_=!s,s?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){this.state!=="WAITING"?this.pendingSegment_&&(this.pendingSegment_=null):(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_())}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,window.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(s){return this.state!=="APPENDING"||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==s:(this.state="READY",!0)}error(s){return typeof s<"u"&&(this.logger_("error occurred:",s),this.error_=s),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&NE(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){var s=this.getMediaInfo_();if(!this.sourceUpdater_||!s)return qs();if(this.loaderType_==="main"){var{hasAudio:s,hasVideo:r,isMuxed:l}=s;if(r&&s&&!this.audioDisabled_&&!l)return this.sourceUpdater_.buffered();if(r)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(s,r=!1){if(!s)return null;var l=tp(s);let d=this.initSegments_[l];return r&&!d&&s.bytes&&(this.initSegments_[l]=d={resolvedUri:s.resolvedUri,byterange:s.byterange,bytes:s.bytes,tracks:s.tracks,timescales:s.timescales}),d||s}segmentKey(s,r=!1){if(!s)return null;var l=bE(s);let d=this.keyCache_[l];return this.cacheEncryptionKeys_&&r&&!d&&s.bytes&&(this.keyCache_[l]=d={resolvedUri:s.resolvedUri,bytes:s.bytes}),r={resolvedUri:(d||s).resolvedUri},d&&(r.bytes=d.bytes),r}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return this.state==="INIT"&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY"))}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(s,r={}){if(s){var l,d=this.playlist_,f=this.pendingSegment_;this.playlist_=s,this.xhrOptions_=r,this.state==="INIT"&&(s.syncInfo={mediaSequence:s.mediaSequence,time:0},this.loaderType_==="main")&&this.syncController_.setDateTimeMappingForStart(s);let p=null;if(d&&(d.id?p=d.id:d.uri&&(p=d.uri)),this.logger_(`playlist update [${p} => ${s.id||s.uri}]`),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();d&&d.uri===s.uri?(r=s.mediaSequence-d.mediaSequence,this.logger_(`live window shift [${r}]`),this.mediaIndex!==null&&(this.mediaIndex-=r,this.mediaIndex<0?(this.mediaIndex=null,this.partIndex=null):(l=this.playlist_.segments[this.mediaIndex],!this.partIndex||l.parts&&l.parts.length&&l.parts[this.partIndex]||(l=this.mediaIndex,this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=l))),f&&(f.mediaIndex-=r,f.mediaIndex<0?(f.mediaIndex=null,f.partIndex=null):(0<=f.mediaIndex&&(f.segment=s.segments[f.mediaIndex]),0<=f.partIndex&&f.segment.parts&&(f.part=f.segment.parts[f.partIndex]))),this.syncController_.saveExpiredSegmentInfo(d,s)):(this.mediaIndex!==null&&(s.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate"))}}pause(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(s){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,s),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&NE(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(s,r,l=()=>{},d=!1){if((r=r===1/0?this.duration_():r)<=s)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){let p=1;var f=()=>{--p===0&&l()};!d&&this.audioDisabled_||(p++,this.sourceUpdater_.removeAudio(s,r,f)),!d&&this.loaderType_!=="main"||(this.gopBuffer_=((y,F,A,P)=>{var L=Math.ceil((F-P)*Qf),B=Math.ceil((A-P)*Qf),F=y.slice();let K=y.length;for(;K--&&!(y[K].pts<=B););if(K!==-1){let Q=K+1;for(;Q--&&!(y[Q].pts<=L););Q=Math.max(Q,0),F.splice(Q,K-Q+1)}return F})(this.gopBuffer_,s,r,this.timeMapping_),p++,this.sourceUpdater_.removeVideo(s,r,f));for(const y in this.inbandTextTracks_)Ed(s,r,this.inbandTextTracks_[y]);Ed(s,r,this.segmentMetadataTrack_),f()}else this.logger_("skipping remove because no source updater or starting media info")}monitorBuffer_(){this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){var s;this.sourceUpdater_.updating()||(s=this.chooseNextRequest_())&&(typeof s.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:s.timeline})),this.loadSegment_(s))}isEndOfStream_(s=this.mediaIndex,r=this.playlist_,l=this.partIndex){var d;return!(!r||!this.mediaSource_)&&(d=typeof s=="number"&&r.segments[s],s=s+1===r.segments.length,l=!d||!d.parts||l+1===d.parts.length,r.endList)&&this.mediaSource_.readyState==="open"&&s&&l}chooseNextRequest_(){var s=this.buffered_(),p=tE(s)||0,s=D_(s,this.currentTime_()),f=!this.hasPlayed_()&&1<=s,r=s>=this.goalBufferLength_(),l=this.playlist_.segments;if(!l.length||f||r)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var d,f={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)},p=(f.isSyncRequest?f.mediaIndex=function(A,P,L){P=P||[];var B=[];let F=0;for(let Q=0;Q<P.length;Q++){var K=P[Q];if(A===K.timeline&&(B.push(Q),(F+=K.duration)>L))return Q}return B.length===0?0:B[B.length-1]}(this.currentTimeline_,l,p):this.mediaIndex!==null?(r=l[this.mediaIndex],d=typeof this.partIndex=="number"?this.partIndex:-1,f.startOfSegment=r.end||p,r.parts&&r.parts[d+1]?(f.mediaIndex=this.mediaIndex,f.partIndex=d+1):f.mediaIndex=this.mediaIndex+1):({segmentIndex:r,startTime:d,partIndex:S}=Ws.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?p:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),f.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+p:"currentTime "+this.currentTime_(),f.mediaIndex=r,f.startOfSegment=d,f.partIndex=S),l[f.mediaIndex]);let y=p&&typeof f.partIndex=="number"&&p.parts&&p.parts[f.partIndex];if(!p||typeof f.partIndex=="number"&&!y)return null;typeof f.partIndex!="number"&&p.parts&&(f.partIndex=0,y=p.parts[0]),s||!y||y.independent||(f.partIndex===0?(d=(r=l[f.mediaIndex-1]).parts&&r.parts.length&&r.parts[r.parts.length-1])&&d.independent&&(--f.mediaIndex,f.partIndex=r.parts.length-1,f.independent="previous segment"):p.parts[f.partIndex-1].independent&&(--f.partIndex,f.independent="previous part"));var S=this.mediaSource_&&this.mediaSource_.readyState==="ended";return f.mediaIndex>=l.length-1&&S&&!this.seeking_()?null:this.generateSegmentInfo_(f)}generateSegmentInfo_(r){var{independent:r,playlist:l,mediaIndex:A,startOfSegment:d,isSyncRequest:L,partIndex:P,forceTimestampOffset:f,getMediaInfoForTime:p}=r,y=l.segments[A],S=typeof P=="number"&&y.parts[P],A={requestId:"segment-loader-"+Math.random(),uri:S&&S.resolvedUri||y.resolvedUri,mediaIndex:A,partIndex:S?P:null,isSyncRequest:L,startOfSegment:d,playlist:l,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:y.timeline,duration:S&&S.duration||y.duration,segment:y,part:S,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:p,independent:r},P=typeof f<"u"?f:this.isPendingTimestampOffset_,L=(A.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:y.timeline,currentTimeline:this.currentTimeline_,startOfSegment:d,buffered:this.buffered_(),overrideCheck:P}),tE(this.sourceUpdater_.audioBuffered()));return typeof L=="number"&&(A.audioAppendStart=L-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(A.gopsToAlignWith=((B,F,K)=>{if(typeof F>"u"||F===null||!B.length)return[];var Q=Math.ceil((F-K+3)*Qf);let oe;for(oe=0;oe<B.length&&!(B[oe].pts>Q);oe++);return B.slice(oe)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),A}timestampOffsetForSegment_(s){return{segmentTimeline:s,currentTimeline:r,startOfSegment:l,buffered:d,overrideCheck:f}=[s][0],f||s!==r?!(s<r)&&d.length?d.end(d.length-1):l:null;var r,l,d,f}earlyAbortWhenNeeded_(s){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(s.firstBytesReceivedAt||Date.now())<1e3)){var r=this.currentTime_(),l=s.bandwidth,d=this.pendingSegment_.duration,s=Ws.estimateSegmentRequestTime(d,l,this.playlist_,s.bytesReceived),f=([f,p,y=1]=[this.buffered_(),r,this.vhs_.tech_.playbackRate()],((f.length?f.end(f.length-1):0)-p)/y-1);if(!(s<=f)){var p=function(de){const{main:P,currentTime:L,bandwidth:B,duration:F,segmentDuration:K,timeUntilRebuffer:Q,currentTimeline:oe,syncController:te}=de;de=P.playlists.filter(ge=>!Ws.isIncompatible(ge));let ce=de.filter(Ws.isEnabled);var de=(ce=ce.length?ce:de.filter(ge=>!Ws.isDisabled(ge))).filter(Ws.hasAttribute.bind(null,"BANDWIDTH")).map(ge=>{var Me=te.getSyncPoint(ge,F,oe,L)?1:2;return{playlist:ge,rebufferingImpact:Ws.estimateSegmentRequestTime(K,B,ge)*Me-Q}}),xe=de.filter(ge=>ge.rebufferingImpact<=0);return iu(xe,(ge,Me)=>V_(Me.playlist,ge.playlist)),xe.length?xe[0]:(iu(de,(ge,Me)=>ge.rebufferingImpact-Me.rebufferingImpact),de[0]||null)}({main:this.vhs_.playlists.main,currentTime:r,bandwidth:l,duration:this.duration_(),segmentDuration:d,timeUntilRebuffer:f,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(p){var y=s-f-p.rebufferingImpact;let A=.5;f<=Ua&&(A=1),!p.playlist||p.playlist.uri===this.playlist_.uri||y<A||(this.bandwidth=p.playlist.attributes.BANDWIDTH*Yi.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}}handleAbort_(s){this.logger_("Aborting "+su(s)),this.mediaRequestsAborted+=1}handleProgress_(s,r){this.earlyAbortWhenNeeded_(r.stats),this.checkForAbort_(r.requestId)||this.trigger("progress")}handleTrackInfo_(s,r){this.earlyAbortWhenNeeded_(s.stats),this.checkForAbort_(s.requestId)||this.checkForIllegalMediaSwitch(r)||(function(l,d){if(!l&&!d||!l&&d||l&&!d)return!1;if(l!==d){var f=Object.keys(l).sort(),p=Object.keys(d).sort();if(f.length!==p.length)return!1;for(let S=0;S<f.length;S++){var y=f[S];if(y!==p[S]||l[y]!==d[y])return!1}}return!0}(this.currentMediaInfo_,r=r||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=r,this.currentMediaInfo_=r,this.logger_("trackinfo update",r),this.trigger("trackinfo")),this.checkForAbort_(s.requestId))||(this.pendingSegment_.trackInfo=r,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())}handleTimingInfo_(s,r,l,d){var f;this.earlyAbortWhenNeeded_(s.stats),this.checkForAbort_(s.requestId)||((s=this.pendingSegment_)[f=WE(r)]=s[f]||{},s[f][l]=d,this.logger_(`timinginfo: ${r} - ${l} - `+d),this.hasEnoughInfoToAppend_()&&this.processCallQueue_())}handleCaptions_(s,r){if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId))if(r.length===0)this.logger_("SegmentLoader received no captions from a caption event");else if(this.pendingSegment_.hasAppendedData_){const l=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),d={};r.forEach(f=>{d[f.stream]=d[f.stream]||{startTime:1/0,captions:[],endTime:0};var p=d[f.stream];p.startTime=Math.min(p.startTime,f.startTime+l),p.endTime=Math.max(p.endTime,f.endTime+l),p.captions.push(f)}),Object.keys(d).forEach(f=>{var{startTime:p,endTime:y,captions:S}=d[f],A=this.inbandTextTracks_,P=(this.logger_(`adding cues from ${p} -> ${y} for `+f),A),L=this.vhs_.tech_,B=f;if(!P[B]){L.trigger({type:"usage",name:"vhs-608"});let oe=B;/^cc708_/.test(B)&&(oe="SERVICE"+B.split("_")[1]);var K=L.textTracks().getTrackById(oe);if(K)P[B]=K;else{let ce=B,de=B,xe=!1;K=(L.options_.vhs&&L.options_.vhs.captionServices||{})[oe],K&&(ce=K.label,de=K.language,xe=K.default),P[B]=L.addRemoteTextTrack({kind:"captions",id:oe,default:xe,label:ce,language:de},!1).track}}Ed(p,y,A[f]);var{inbandTextTracks:F,captionArray:K,timestampOffset:Q}={captionArray:S,inbandTextTracks:A,timestampOffset:l};if(K){const oe=window.WebKitDataCue||window.VTTCue;K.forEach(te=>{var ce=te.stream;F[ce].addCue(new oe(te.startTime+Q,te.endTime+Q,te.text))})}}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,s,r))}handleId3_(s,r,l){var d,f,p,y;this.earlyAbortWhenNeeded_(s.stats),this.checkForAbort_(s.requestId)||(this.pendingSegment_.hasAppendedData_?(d=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),f=this.inbandTextTracks_,p=l,y=this.vhs_.tech_,f.metadataTrack_||(f.metadataTrack_=y.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,f.metadataTrack_.inBandMetadataTrackDispatchType=p),vP({inbandTextTracks:this.inbandTextTracks_,metadataArray:r,timestampOffset:d,videoDuration:this.duration_()})):this.metadataQueue_.id3.push(this.handleId3_.bind(this,s,r,l)))}processMetadataQueue_(){this.metadataQueue_.id3.forEach(s=>s()),this.metadataQueue_.caption.forEach(s=>s()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){var s=this.callQueue_;this.callQueue_=[],s.forEach(r=>r())}processLoadQueue_(){var s=this.loadQueue_;this.loadQueue_=[],s.forEach(r=>r())}hasEnoughInfoToLoad_(){var s;return this.loaderType_!=="audio"||!(!(s=this.pendingSegment_)||this.getCurrentMediaInfo_()&&GE({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:s.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(s=this.pendingSegment_){return s&&s.trackInfo||this.currentMediaInfo_}getMediaInfo_(s=this.pendingSegment_){return this.getCurrentMediaInfo_(s)||this.startingMediaInfo_}hasEnoughInfoToAppend_(){var s,r,l,d;return!!this.sourceUpdater_.ready()&&!(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_||(s=this.pendingSegment_,r=this.getCurrentMediaInfo_(),!s)||!r||({hasAudio:r,hasVideo:l,isMuxed:d}=r,l&&!s.videoTimingInfo)||r&&!this.audioDisabled_&&!d&&!s.audioTimingInfo||GE({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:s.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(s,r){if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId))if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())this.callQueue_.push(this.handleData_.bind(this,s,r));else{var l=this.pendingSegment_;if(this.setTimeMapping_(l.timeline),this.updateMediaSecondsLoaded_(l.part||l.segment),this.mediaSource_.readyState!=="closed"){if(s.map&&(s.map=this.initSegmentForMap(s.map,!0),l.segment.map=s.map),s.key&&this.segmentKey(s.key,!0),l.isFmp4=s.isFmp4,l.timingInfo=l.timingInfo||{},l.isFmp4)this.trigger("fmp4"),l.timingInfo.start=l[WE(r.type)].start;else{s=this.getCurrentMediaInfo_(),s=this.loaderType_==="main"&&s&&s.hasVideo;let d;s&&(d=l.videoTimingInfo.start),l.timingInfo.start=this.trueSegmentStart_({currentStart:l.timingInfo.start,playlist:l.playlist,mediaIndex:l.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:s,firstVideoFrameTimeForData:d,videoTimingInfo:l.videoTimingInfo,audioTimingInfo:l.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(l,r.type),this.updateSourceBufferTimestampOffset_(l),l.isSyncRequest){if(this.updateTimingInfoEnd_(l),this.syncController_.saveSegmentTimingInfo({segmentInfo:l,shouldSaveTimelineMapping:this.loaderType_==="main"}),s=this.chooseNextRequest_(),s.mediaIndex!==l.mediaIndex||s.partIndex!==l.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}l.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(l,r)}}}updateAppendInitSegmentStatus(s,r){this.loaderType_!=="main"||typeof s.timestampOffset!="number"||s.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[r]!==s.playlist&&(this.appendInitSegment_[r]=!0)}getInitSegmentAndUpdateState_({type:s,initSegment:r,map:l,playlist:d}){if(l){var f=tp(l);if(this.activeInitSegmentId_===f)return null;r=this.initSegmentForMap(l,!0).bytes,this.activeInitSegmentId_=f}return r&&this.appendInitSegment_[s]?(this.playlistOfLastInitSegment_[s]=d,this.appendInitSegment_[s]=!1,this.activeInitSegmentId_=null,r):null}handleQuotaExceededError_({segmentInfo:s,type:r,bytes:l},d){var f=this.sourceUpdater_.audioBuffered(),p=this.sourceUpdater_.videoBuffered(),y=(1<f.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+No(f).join(", ")),1<p.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+No(p).join(", ")),f.length?f.start(0):0),S=f.length?f.end(f.length-1):0,A=p.length?p.start(0):0,P=p.length?p.end(p.length-1):0;S-y<=1&&P-A<=1?(this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${l.byteLength}, audio buffer: ${No(f).join(", ")}, video buffer: ${No(p).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error")):(this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:s,type:r,bytes:l})),S=this.currentTime_()-1,this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+S),this.remove(0,S,()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=window.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},1e3)},!0))}handleAppendError_({segmentInfo:s,type:r,bytes:l},d){d&&(d.code===22?this.handleQuotaExceededError_({segmentInfo:s,type:r,bytes:l}):(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",d),this.error(`${r} append of ${l.length}b failed for segment #${s.mediaIndex} in playlist `+s.playlist.id),this.trigger("appenderror")))}appendToSourceBuffer_({segmentInfo:s,type:r,initSegment:l,data:d,bytes:f}){if(!f){var p=[d];let y=d.byteLength;l&&(p.unshift(l),y+=l.byteLength),f=(S=>{let A=0,P;return S.bytes&&(P=new Uint8Array(S.bytes),S.segments.forEach(L=>{P.set(L,A),A+=L.byteLength})),P})({bytes:y,segments:p})}this.sourceUpdater_.appendBuffer({segmentInfo:s,type:r,bytes:f},this.handleAppendError_.bind(this,{segmentInfo:s,type:r,bytes:f}))}handleSegmentTimingInfo_(s,r,l){this.pendingSegment_&&r===this.pendingSegment_.requestId&&((r=this.pendingSegment_.segment)[s=s+"TimingInfo"]||(r[s]={}),r[s].transmuxerPrependedSeconds=l.prependedContentDuration||0,r[s].transmuxedPresentationStart=l.start.presentation,r[s].transmuxedDecodeStart=l.start.decode,r[s].transmuxedPresentationEnd=l.end.presentation,r[s].transmuxedDecodeEnd=l.end.decode,r[s].baseMediaDecodeTime=l.baseMediaDecodeTime)}appendData_(s,r){var{type:l,data:d}=r;d&&d.byteLength&&(l==="audio"&&this.audioDisabled_||(r=this.getInitSegmentAndUpdateState_({type:l,initSegment:r.initSegment,playlist:s.playlist,map:s.isFmp4?s.segment.map:null}),this.appendToSourceBuffer_({segmentInfo:s,type:l,initSegment:r,data:d})))}loadSegment_(s){this.state="WAITING",this.pendingSegment_=s,this.trimBackBuffer_(s),typeof s.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(s):this.loadQueue_.push(()=>{var r=qr({},s,{forceTimestampOffset:!0});qr(s,this.generateSegmentInfo_(r)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(s)})}updateTransmuxerAndRequestSegment_(s){this.shouldUpdateTransmuxerTimestampOffset_(s.timestampOffset)&&(this.gopBuffer_.length=0,s.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:s.timestampOffset}));var r=this.createSimplifiedSegmentObj_(s),f=this.isEndOfStream_(s.mediaIndex,s.playlist,s.partIndex),l=this.mediaIndex!==null,d=s.timeline!==this.currentTimeline_&&0<s.timeline,f=f||l&&d;this.logger_("Requesting "+su(s)),r.map&&!r.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),s.abortRequests=_P({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:r,abortFn:this.handleAbort_.bind(this,s),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",s.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",s.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:f,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:p,level:y,stream:S})=>{this.logger_(su(s)+` logged from transmuxer stream ${S} as a ${y}: `+p)}})}trimBackBuffer_(s){var r=((l,d,f)=>{let p=d-Yi.BACK_BUFFER_LENGTH;return l.length&&(p=Math.max(p,l.start(0))),Math.min(d-f,p)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<r&&this.remove(0,r)}createSimplifiedSegmentObj_(s){var r=s.segment,l=s.part,l={resolvedUri:(l||r).resolvedUri,byterange:(l||r).byterange,requestId:s.requestId,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,part:s.part},d=s.playlist.segments[s.mediaIndex-1];return d&&d.timeline===r.timeline&&(d.videoTimingInfo?l.baseStartTime=d.videoTimingInfo.transmuxedDecodeEnd:d.audioTimingInfo&&(l.baseStartTime=d.audioTimingInfo.transmuxedDecodeEnd)),r.key&&(d=r.key.iv||new Uint32Array([0,0,0,s.mediaIndex+s.playlist.mediaSequence]),l.key=this.segmentKey(r.key),l.key.iv=d),r.map&&(l.map=this.initSegmentForMap(r.map)),l}saveTransferStats_(s){this.mediaRequests+=1,s&&(this.mediaBytesTransferred+=s.bytesReceived,this.mediaTransferDuration+=s.roundTripTime)}saveBandwidthRelatedStats_(s,r){this.pendingSegment_.byteLength=r.bytesReceived,s<1/60?this.logger_("Ignoring segment's bandwidth because its duration of "+s+" is less than the min to record "+1/60):(this.bandwidth=r.bandwidth,this.roundTrip=r.roundTripTime)}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(s,r,l){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,s,r,l));else if(this.saveTransferStats_(r.stats),this.pendingSegment_&&r.requestId===this.pendingSegment_.requestId){if(s)return this.pendingSegment_=null,this.state="READY",s.code===gr.ABORTED?void 0:(this.pause(),s.code===gr.TIMEOUT?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(s),void this.trigger("error")));s=this.pendingSegment_,this.saveBandwidthRelatedStats_(s.duration,r.stats),s.endOfAllRequests=r.endOfAllRequests,l.gopInfo&&(this.gopBuffer_=((d,f,p)=>{if(!f.length)return d;if(p)return f.slice();var y=f[0].pts;let S=0;for(S;S<d.length&&!(d[S].pts>=y);S++);return d.slice(0,S).concat(f)})(this.gopBuffer_,l.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(s)}}setTimeMapping_(s){s=this.syncController_.mappingForTimeline(s),s!==null&&(this.timeMapping_=s)}updateMediaSecondsLoaded_(s){typeof s.start=="number"&&typeof s.end=="number"?this.mediaSecondsLoaded+=s.end-s.start:this.mediaSecondsLoaded+=s.duration}shouldUpdateTransmuxerTimestampOffset_(s){return s!==null&&(this.loaderType_==="main"&&s!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&s!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_({currentStart:s,playlist:r,mediaIndex:l,firstVideoFrameTimeForData:d,currentVideoTimestampOffset:f,useVideoTimingInfo:p,videoTimingInfo:y,audioTimingInfo:S}){return typeof s<"u"?s:p?(s=r.segments[l-1],l!==0&&s&&typeof s.start<"u"&&s.end===d+f?y.start:d):S.start}waitForAppendsToComplete_(s){var r,l,d=this.getCurrentMediaInfo_(s);d?({hasAudio:d,hasVideo:l,isMuxed:r}=d,l=this.loaderType_==="main"&&l,d=!this.audioDisabled_&&d&&!r,s.waitingOnAppends=0,s.hasAppendedData_?(l&&s.waitingOnAppends++,d&&s.waitingOnAppends++,l&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,s)),d&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,s))):(s.timingInfo||typeof s.timestampOffset!="number"||(this.isPendingTimestampOffset_=!0),s.timingInfo={start:0},s.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(s),this.processMetadataQueue_()),this.checkAppendsDone_(s))):(this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error"))}checkAppendsDone_(s){this.checkForAbort_(s.requestId)||(s.waitingOnAppends--,s.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(s){l=this.loaderType_,r=this.getCurrentMediaInfo_(),s=s;var r,l=l==="main"&&r&&s?s.hasAudio||s.hasVideo?r.hasVideo&&!s.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!r.hasVideo&&s.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null;return!!l&&(this.error({message:l,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(s){if(s.timestampOffset!==null&&typeof s.timingInfo.start=="number"&&!s.changedTimestampOffset&&this.loaderType_==="main"){let r=!1;s.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:s.segment.videoTimingInfo,audioTimingInfo:s.segment.audioTimingInfo,timingInfo:s.timingInfo}),s.changedTimestampOffset=!0,s.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(s.timestampOffset),r=!0),s.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(s.timestampOffset),r=!0),r&&this.trigger("timestampoffset")}}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:s,audioTimingInfo:r,timingInfo:l}){return this.useDtsForTimestampOffset_?s&&typeof s.transmuxedDecodeStart=="number"?s.transmuxedDecodeStart:r&&typeof r.transmuxedDecodeStart=="number"?r.transmuxedDecodeStart:l.start:l.start}updateTimingInfoEnd_(s){s.timingInfo=s.timingInfo||{};var r=this.getMediaInfo_(),r=this.loaderType_==="main"&&r&&r.hasVideo&&s.videoTimingInfo?s.videoTimingInfo:s.audioTimingInfo;r&&(s.timingInfo.end=typeof r.end=="number"?r.end:r.start+s.duration)}handleAppendsDone_(){var s,r,l;this.pendingSegment_&&this.trigger("appendsdone"),this.pendingSegment_?(s=this.pendingSegment_,this.updateTimingInfoEnd_(s),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:this.loaderType_==="main"}),(r=TP(s,this.sourceType_))&&(r.severity==="warn"?fe.log.warn(r.message):this.logger_(r.message)),this.recordThroughput_(s),this.pendingSegment_=null,this.state="READY",s.isSyncRequest&&(this.trigger("syncinfoupdate"),!s.hasAppendedData_)?this.logger_("Throwing away un-appended sync request "+su(s)):(this.logger_("Appended "+su(s)),this.addSegmentMetadataCue_(s),this.fetchAtBuffer_=!0,this.currentTimeline_!==s.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:s.timeline}),this.loaderType_!=="main"||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:s.timeline})),this.currentTimeline_=s.timeline,this.trigger("syncinfoupdate"),r=s.segment,l=s.part,r=r.end&&this.currentTime_()-r.end>3*s.playlist.targetDuration,l=l&&l.end&&this.currentTime_()-l.end>3*s.playlist.partTargetDuration,r||l?(this.logger_(`bad ${r?"segment":"part"} `+su(s)),this.resetEverything()):(this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=s.mediaIndex,this.partIndex=s.partIndex,this.isEndOfStream_(s.mediaIndex,s.playlist,s.partIndex)&&this.endOfStream(),this.trigger("appended"),s.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()))):(this.state="READY",this.paused()||this.monitorBuffer_())}recordThroughput_(s){var r,l;s.duration<1/60?this.logger_("Ignoring segment's throughput because its duration of "+s.duration+" is less than the min to record "+1/60):(r=this.throughput.rate,l=Date.now()-s.endOfAllRequests+1,s=Math.floor(s.byteLength/l*8*1e3),this.throughput.rate+=(s-r)/++this.throughput.count)}addSegmentMetadataCue_(s){var r,l,d,f;this.segmentMetadataTrack_&&(r=(f=s.segment).start,l=f.end,qE(r))&&qE(l)&&(Ed(r,l,this.segmentMetadataTrack_),d=window.WebKitDataCue||window.VTTCue,f={custom:f.custom,dateTimeObject:f.dateTimeObject,dateTimeString:f.dateTimeString,bandwidth:s.playlist.attributes.BANDWIDTH,resolution:s.playlist.attributes.RESOLUTION,codecs:s.playlist.attributes.CODECS,byteLength:s.byteLength,uri:s.uri,timeline:s.timeline,playlist:s.playlist.id,start:r,end:l},(s=new d(r,l,JSON.stringify(f))).value=f,this.segmentMetadataTrack_.addCue(s))}}function Yr(){}function KE(a){return typeof a!="string"?a:a.replace(/./,s=>s.toUpperCase())}const bP=["video","audio"],K_=(a,s)=>{var r=s[a+"Buffer"];return r&&r.updating||s.queuePending[a]},nu=(a,s)=>{if(s.queue.length!==0){let r=0,l=s.queue[r];if(l.type==="mediaSource")s.updating()||s.mediaSource.readyState==="closed"||(s.queue.shift(),l.action(s),l.doneFn&&l.doneFn(),nu("audio",s),nu("video",s));else if(a!=="mediaSource"&&s.ready()&&s.mediaSource.readyState!=="closed"&&!K_(a,s)){if(l.type!==a){if((r=((d,f)=>{for(let y=0;y<f.length;y++){var p=f[y];if(p.type==="mediaSource")return null;if(p.type===d)return y}return null})(a,s.queue))===null)return;l=s.queue[r]}s.queue.splice(r,1),(s.queuePending[a]=l).action(a,s),l.doneFn||(s.queuePending[a]=null,nu(a,s))}}},XE=(a,s)=>{var r=s[a+"Buffer"],l=KE(a);r&&(r.removeEventListener("updateend",s[`on${l}UpdateEnd_`]),r.removeEventListener("error",s[`on${l}Error_`]),s.codecs[a]=null,s[a+"Buffer"]=null)},_r=(a,s)=>a&&s&&Array.prototype.indexOf.call(a.sourceBuffers,s)!==-1,ln={appendBuffer:(a,s,r)=>(l,d)=>{var f=d[l+"Buffer"];if(_r(d.mediaSource,f)){d.logger_(`Appending segment ${s.mediaIndex}'s ${a.length} bytes to ${l}Buffer`);try{f.appendBuffer(a)}catch(p){d.logger_(`Error with code ${p.code} `+(p.code===22?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${s.mediaIndex} to ${l}Buffer`),d.queuePending[l]=null,r(p)}}},remove:(a,s)=>(r,l)=>{var d=l[r+"Buffer"];if(_r(l.mediaSource,d)){l.logger_(`Removing ${a} to ${s} from ${r}Buffer`);try{d.remove(a,s)}catch{l.logger_(`Remove ${a} to ${s} from ${r}Buffer failed`)}}},timestampOffset:a=>(s,r)=>{var l=r[s+"Buffer"];_r(r.mediaSource,l)&&(r.logger_(`Setting ${s}timestampOffset to `+a),l.timestampOffset=a)},callback:a=>(s,r)=>{a()},endOfStream:a=>s=>{if(s.mediaSource.readyState==="open"){s.logger_(`Calling mediaSource endOfStream(${a||""})`);try{s.mediaSource.endOfStream(a)}catch(r){fe.log.warn("Failed to call media source endOfStream",r)}}},duration:a=>s=>{s.logger_("Setting mediaSource duration to "+a);try{s.mediaSource.duration=a}catch(r){fe.log.warn("Failed to set media source duration",r)}},abort:()=>(a,s)=>{if(s.mediaSource.readyState==="open"){var r=s[a+"Buffer"];if(_r(s.mediaSource,r)){s.logger_(`calling abort on ${a}Buffer`);try{r.abort()}catch(l){fe.log.warn(`Failed to abort on ${a}Buffer`,l)}}}},addSourceBuffer:(a,s)=>r=>{var l=KE(a),d=sd(s),d=(r.logger_(`Adding ${a}Buffer with codec ${s} to mediaSource`),r.mediaSource.addSourceBuffer(d));d.addEventListener("updateend",r[`on${l}UpdateEnd_`]),d.addEventListener("error",r[`on${l}Error_`]),r.codecs[a]=s,r[a+"Buffer"]=d},removeSourceBuffer:a=>s=>{var r=s[a+"Buffer"];if(XE(a,s),_r(s.mediaSource,r)){s.logger_(`Removing ${a}Buffer with codec ${s.codecs[a]} from mediaSource`);try{s.mediaSource.removeSourceBuffer(r)}catch(l){fe.log.warn(`Failed to removeSourceBuffer ${a}Buffer`,l)}}},changeType:a=>(s,r)=>{var l=r[s+"Buffer"],d=sd(a);_r(r.mediaSource,l)&&r.codecs[s]!==a&&(r.logger_(`changing ${s}Buffer codec from ${r.codecs[s]} to `+a),l.changeType(d),r.codecs[s]=a)}},un=({type:a,sourceUpdater:s,action:r,doneFn:l,name:d})=>{s.queue.push({type:a,action:r,doneFn:l,name:d}),nu(a,s)},YE=(a,s)=>r=>{var l;s.queuePending[a]&&(l=s.queuePending[a].doneFn,s.queuePending[a]=null,l)&&l(s[a+"Error_"]),nu(a,s)};class QE extends fe.EventTarget{constructor(s){super(),this.mediaSource=s,this.sourceopenListener_=()=>nu("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=qn("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=YE("video",this),this.onAudioUpdateEnd_=YE("audio",this),this.onVideoError_=r=>{this.videoError_=r},this.onAudioError_=r=>{this.audioError_=r},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(s){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(s),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(s,r){un({type:"mediaSource",sourceUpdater:this,action:ln.addSourceBuffer(s,r),name:"addSourceBuffer"})}abort(s){un({type:s,sourceUpdater:this,action:ln.abort(s),name:"abort"})}removeSourceBuffer(s){this.canRemoveSourceBuffer()?un({type:"mediaSource",sourceUpdater:this,action:ln.removeSourceBuffer(s),name:"removeSourceBuffer"}):fe.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!fe.browser.IE_VERSION&&!fe.browser.IS_FIREFOX&&window.MediaSource&&window.MediaSource.prototype&&typeof window.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return window.SourceBuffer&&window.SourceBuffer.prototype&&typeof window.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(s,r){this.canChangeType()?un({type:s,sourceUpdater:this,action:ln.changeType(r),name:"changeType"}):fe.log.error("changeType is not supported!")}addOrChangeSourceBuffers(s){if(!s||typeof s!="object"||Object.keys(s).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(s).forEach(r=>{var l=s[r];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(r,l);this.canChangeType()&&this.changeType(r,l)})}appendBuffer(s,r){var{segmentInfo:l,type:d,bytes:f}=s;this.processedAppend_=!0,d==="audio"&&this.videoBuffer&&!this.videoAppendQueued_?(this.delayedAudioAppendQueue_.push([s,r]),this.logger_(`delayed audio append of ${f.length} until video append`)):(s=r,un({type:d,sourceUpdater:this,action:ln.appendBuffer(f,l||{mediaIndex:-1},s),doneFn:r,name:"appendBuffer"}),d==="video"&&(this.videoAppendQueued_=!0,this.delayedAudioAppendQueue_.length)&&(f=this.delayedAudioAppendQueue_.slice(),this.logger_(`queuing delayed audio ${f.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,f.forEach(p=>{this.appendBuffer.apply(this,p)})))}audioBuffered(){return _r(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered||qs()}videoBuffered(){return _r(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered||qs()}buffered(){var s=_r(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,r=_r(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;if(r&&!s)return this.audioBuffered();if(s&&!r)return this.videoBuffered();{var l=this.audioBuffered(),d=this.videoBuffered();let y=null,S=null,A=0;var f=[],p=[];if(!(l&&l.length&&d&&d.length))return qs();let P=l.length;for(;P--;)f.push({time:l.start(P),type:"start"}),f.push({time:l.end(P),type:"end"});for(P=d.length;P--;)f.push({time:d.start(P),type:"start"}),f.push({time:d.end(P),type:"end"});for(f.sort(function(L,B){return L.time-B.time}),P=0;P<f.length;P++)f[P].type==="start"?++A===2&&(y=f[P].time):f[P].type==="end"&&--A===1&&(S=f[P].time),y!==null&&S!==null&&(p.push([y,S]),y=null,S=null);return qs(p)}}setDuration(s,r=Yr){un({type:"mediaSource",sourceUpdater:this,action:ln.duration(s),name:"duration",doneFn:r})}endOfStream(s=null,r=Yr){typeof s!="string"&&(s=void 0),un({type:"mediaSource",sourceUpdater:this,action:ln.endOfStream(s),name:"endOfStream",doneFn:r})}removeAudio(s,r,l=Yr){this.audioBuffered().length&&this.audioBuffered().end(0)!==0?un({type:"audio",sourceUpdater:this,action:ln.remove(s,r),doneFn:l,name:"remove"}):l()}removeVideo(s,r,l=Yr){this.videoBuffered().length&&this.videoBuffered().end(0)!==0?un({type:"video",sourceUpdater:this,action:ln.remove(s,r),doneFn:l,name:"remove"}):l()}updating(){return!(!K_("audio",this)&&!K_("video",this))}audioTimestampOffset(s){return typeof s<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==s&&(un({type:"audio",sourceUpdater:this,action:ln.timestampOffset(s),name:"timestampOffset"}),this.audioTimestampOffset_=s),this.audioTimestampOffset_}videoTimestampOffset(s){return typeof s<"u"&&this.videoBuffer&&this.videoTimestampOffset!==s&&(un({type:"video",sourceUpdater:this,action:ln.timestampOffset(s),name:"timestampOffset"}),this.videoTimestampOffset_=s),this.videoTimestampOffset_}audioQueueCallback(s){this.audioBuffer&&un({type:"audio",sourceUpdater:this,action:ln.callback(s),name:"callback"})}videoQueueCallback(s){this.videoBuffer&&un({type:"video",sourceUpdater:this,action:ln.callback(s),name:"callback"})}dispose(){this.trigger("dispose"),bP.forEach(s=>{this.abort(s),this.canRemoveSourceBuffer()?this.removeSourceBuffer(s):this[s+"QueueCallback"](()=>XE(s,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const JE=a=>decodeURIComponent(escape(String.fromCharCode.apply(null,a))),ZE=new Uint8Array(`

`.split("").map(a=>a.charCodeAt(0)));class EP extends z_{constructor(s,r={}){super(s,r),this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=s.featuresNativeTextTracks,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){var s;return this.subtitlesTrack_&&this.subtitlesTrack_.cues&&this.subtitlesTrack_.cues.length?qs([[(s=this.subtitlesTrack_.cues)[0].startTime,s[s.length-1].startTime]]):qs()}initSegmentForMap(s,r=!1){if(!s)return null;var l=tp(s);let d=this.initSegments_[l];return r&&!d&&s.bytes&&(r=ZE.byteLength+s.bytes.byteLength,(r=new Uint8Array(r)).set(s.bytes),r.set(ZE,s.bytes.byteLength),this.initSegments_[l]=d={resolvedUri:s.resolvedUri,byterange:s.byterange,bytes:r}),d||s}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(s){return typeof s<"u"&&(this.subtitlesTrack_=s,this.state==="INIT"&&this.couldBeginLoading_())&&this.init_(),this.subtitlesTrack_}remove(s,r){Ed(s,r,this.subtitlesTrack_)}fillBuffer_(){var s=this.chooseNextRequest_();s&&(this.syncController_.timestampOffsetForTimeline(s.timeline)===null?(this.syncController_.one("timestampoffset",()=>{this.state="READY",this.paused()||this.monitorBuffer_()}),this.state="WAITING_ON_TIMELINE"):this.loadSegment_(s))}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(s){for(;s&&s.segment.empty;){if(s.mediaIndex+1>=s.playlist.segments.length){s=null;break}s=this.generateSegmentInfo_({playlist:s.playlist,mediaIndex:s.mediaIndex+1,startOfSegment:s.startOfSegment+s.duration,isSyncRequest:s.isSyncRequest})}return s}stopForError(s){this.error(s),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(s,r,l){if(this.subtitlesTrack_)if(this.saveTransferStats_(r.stats),this.pendingSegment_)if(s)s.code===gr.TIMEOUT&&this.handleTimeout_(),s.code===gr.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(s);else{var d=this.pendingSegment_,f=(this.saveBandwidthRelatedStats_(d.duration,r.stats),r.key&&this.segmentKey(r.key,!0),this.state="APPENDING",this.trigger("appending"),d.segment);if(f.map&&(f.map.bytes=r.map.bytes),d.bytes=r.bytes,typeof window.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){let A;const P=()=>{this.subtitlesTrack_.tech_.off("vttjsloaded",A),this.stopForError({message:"Error loading vtt.js"})};A=()=>{this.subtitlesTrack_.tech_.off("vttjserror",P),this.segmentRequestFinished_(s,r,l)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",A),this.subtitlesTrack_.tech_.one("vttjserror",P)}else{f.requested=!0;try{this.parseVTTCues_(d)}catch(A){return void this.stopForError({message:A.message})}if(this.updateTimeMapping_(d,this.syncController_.timelines[d.timeline],this.playlist_),d.cues.length?d.timingInfo={start:d.cues[0].startTime,end:d.cues[d.cues.length-1].endTime}:d.timingInfo={start:d.startOfSegment,end:d.startOfSegment+d.duration},d.isSyncRequest)this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";else{d.byteLength=d.bytes.byteLength,this.mediaSecondsLoaded+=f.duration,d.cues.forEach(A=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new window.VTTCue(A.startTime,A.endTime,A.text):A)});var p=this.subtitlesTrack_,y=p.cues;if(y)for(let A=0;A<y.length;A++){var S=[];let P=0;for(let L=0;L<y.length;L++)y[A].startTime===y[L].startTime&&y[A].endTime===y[L].endTime&&y[A].text===y[L].text&&1<++P&&S.push(y[L]);S.length&&S.forEach(L=>p.removeCue(L))}this.handleAppendsDone_()}}}else this.state="READY",this.mediaRequestsAborted+=1;else this.state="READY"}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(s){let r,l=!1;typeof window.TextDecoder=="function"?r=new window.TextDecoder("utf8"):(r=window.WebVTT.StringDecoder(),l=!0);var d=new window.WebVTT.Parser(window,window.vttjs,r);if(s.cues=[],s.timestampmap={MPEGTS:0,LOCAL:0},d.oncue=s.cues.push.bind(s.cues),d.ontimestampmap=p=>{s.timestampmap=p},d.onparsingerror=p=>{fe.log.warn("Error encountered when parsing cues: "+p.message)},s.segment.map){let p=s.segment.map.bytes;l&&(p=JE(p)),d.parse(p)}let f=s.bytes;l&&(f=JE(f)),d.parse(f),d.flush()}updateTimeMapping_(s,r,l){var d=s.segment;if(r)if(s.cues.length){var f=s.timestampmap;const p=f.MPEGTS/Qf-f.LOCAL+r.mapping;s.cues.forEach(y=>{y.startTime+=p,y.endTime+=p}),l.syncInfo||(f=s.cues[0].startTime,r=s.cues[s.cues.length-1].startTime,l.syncInfo={mediaSequence:l.mediaSequence+s.mediaIndex,time:Math.min(f,r-d.duration)})}else d.empty=!0}}const eS=[{name:"VOD",run:(a,s,r,l,d)=>r!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(a,s,r,l,d)=>{if(!Object.keys(a.timelineToDatetimeMappings).length)return null;let f=null,p=null;var y=L_(s);d=d||0;for(let L=0;L<y.length;L++){var S=y[s.endList||d===0?L:y.length-(L+1)],A=S.segment,P=a.timelineToDatetimeMappings[A.timeline];if(P&&A.dateTimeObject){let B=A.dateTimeObject.getTime()/1e3+P;if(A.parts&&typeof S.partIndex=="number")for(let F=0;F<S.partIndex;F++)B+=A.parts[F].duration;if(P=Math.abs(d-B),p!==null&&(P===0||p<P))break;p=P,f={time:B,segmentIndex:S.segmentIndex,partIndex:S.partIndex}}}return f}},{name:"Segment",run:(a,s,r,l,d)=>{let f=null,p=null;d=d||0;var y=L_(s);for(let L=0;L<y.length;L++){var S=y[s.endList||d===0?L:y.length-(L+1)],A=S.segment,P=S.part&&S.part.start||A&&A.start;if(A.timeline===l&&typeof P<"u"){if(A=Math.abs(d-P),p!==null&&p<A)break;(!f||p===null||p>=A)&&(p=A,f={time:P,segmentIndex:S.segmentIndex,partIndex:S.partIndex})}}return f}},{name:"Discontinuity",run:(a,s,r,l,d)=>{let f=null;if(d=d||0,s.discontinuityStarts&&s.discontinuityStarts.length){let A=null;for(let P=0;P<s.discontinuityStarts.length;P++){var p=s.discontinuityStarts[P],y=s.discontinuitySequence+P+1,y=a.discontinuities[y];if(y){var S=Math.abs(d-y.time);if(A!==null&&A<S)break;(!f||A===null||A>=S)&&(A=S,f={time:y.time,segmentIndex:p,partIndex:null})}}}return f}},{name:"Playlist",run:(a,s,r,l,d)=>s.syncInfo?{time:s.syncInfo.time,segmentIndex:s.syncInfo.mediaSequence-s.mediaSequence,partIndex:null}:null}];class SP extends fe.EventTarget{constructor(s=0){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=qn("SyncController")}getSyncPoint(s,r,l,d){return s=this.runStrategies_(s,r,l,d),s.length?this.selectSyncPoint_(s,{key:"time",value:d}):null}getExpiredTime(s,r){return s&&s.segments&&(r=this.runStrategies_(s,r,s.discontinuitySequence,0)).length?(0<(r=this.selectSyncPoint_(r,{key:"segmentIndex",value:0})).segmentIndex&&(r.time*=-1),Math.abs(r.time+yd({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:r.segmentIndex,endIndex:0}))):null}runStrategies_(s,r,l,d){var f=[];for(let S=0;S<eS.length;S++){var p=eS[S],y=p.run(this,s,r,l,d);y&&(y.strategy=p.name,f.push({strategy:p.name,syncPoint:y}))}return f}selectSyncPoint_(s,r){let l=s[0].syncPoint,d=Math.abs(s[0].syncPoint[r.key]-r.value),f=s[0].strategy;for(let y=1;y<s.length;y++){var p=Math.abs(s[y].syncPoint[r.key]-r.value);p<d&&(d=p,l=s[y].syncPoint,f=s[y].strategy)}return this.logger_(`syncPoint for [${r.key}: ${r.value}] chosen with strategy [${f}]: [time:${l.time}, segmentIndex:`+l.segmentIndex+(typeof l.partIndex=="number"?",partIndex:"+l.partIndex:"")+"]"),l}saveExpiredSegmentInfo(s,r){var l=r.mediaSequence-s.mediaSequence;if(86400<l)fe.log.warn(`Not saving expired segment info. Media sequence gap ${l} is too large.`);else for(let f=l-1;0<=f;f--){var d=s.segments[f];if(d&&typeof d.start<"u"){r.syncInfo={mediaSequence:s.mediaSequence+f,time:d.start},this.logger_(`playlist refresh sync: [time:${r.syncInfo.time}, mediaSequence: ${r.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(s){var r;this.timelineToDatetimeMappings={},s.segments&&s.segments.length&&s.segments[0].dateTimeObject&&(r=(s=s.segments[0]).dateTimeObject.getTime()/1e3,this.timelineToDatetimeMappings[s.timeline]=-r)}saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:r}){var d=this.calculateSegmentTimeMapping_(s,s.timingInfo,r),l=s.segment,d=(d&&(this.saveDiscontinuitySyncInfo_(s),s.playlist.syncInfo||(s.playlist.syncInfo={mediaSequence:s.playlist.mediaSequence+s.mediaIndex,time:l.start})),l.dateTimeObject);l.discontinuity&&r&&d&&(this.timelineToDatetimeMappings[l.timeline]=-d.getTime()/1e3)}timestampOffsetForTimeline(s){return typeof this.timelines[s]>"u"?null:this.timelines[s].time}mappingForTimeline(s){return typeof this.timelines[s]>"u"?null:this.timelines[s].mapping}calculateSegmentTimeMapping_(s,r,l){var d=s.segment,f=s.part;let p=this.timelines[s.timeline],y,S;if(typeof s.timestampOffset=="number")p={time:s.startOfSegment,mapping:s.startOfSegment-r.start},l&&(this.timelines[s.timeline]=p,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${s.timeline}: [time: ${p.time}] [mapping: ${p.mapping}]`)),y=s.startOfSegment;else{if(!p)return!1;y=r.start+p.mapping}return S=r.end+p.mapping,f&&(f.start=y,f.end=S),(!d.start||y<d.start)&&(d.start=y),d.end=S,!0}saveDiscontinuitySyncInfo_(s){var r=s.playlist,l=s.segment;if(l.discontinuity)this.discontinuities[l.timeline]={time:l.start,accuracy:0};else if(r.discontinuityStarts&&r.discontinuityStarts.length)for(let S=0;S<r.discontinuityStarts.length;S++){var d=r.discontinuityStarts[S],f=r.discontinuitySequence+S+1,p=d-s.mediaIndex,y=Math.abs(p);if(!this.discontinuities[f]||this.discontinuities[f].accuracy>y){let A;A=p<0?l.start-yd({defaultDuration:r.targetDuration,durationList:r.segments,startIndex:s.mediaIndex,endIndex:d}):l.end+yd({defaultDuration:r.targetDuration,durationList:r.segments,startIndex:s.mediaIndex+1,endIndex:d}),this.discontinuities[f]={time:A,accuracy:y}}}}dispose(){this.trigger("dispose"),this.off()}}class xP extends fe.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(s){this.pendingTimelineChanges_[s]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:s,from:r,to:l}){return typeof r=="number"&&typeof l=="number"&&(this.pendingTimelineChanges_[s]={type:s,from:r,to:l},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[s]}lastTimelineChange({type:s,from:r,to:l}){return typeof r=="number"&&typeof l=="number"&&(this.lastTimelineChanges_[s]={type:s,from:r,to:l},delete this.pendingTimelineChanges_[s],this.trigger("timelinechange")),this.lastTimelineChanges_[s]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}var wP=kE(IE(OE(function(){var a=function(){function S(){this.listeners={}}var A=S.prototype;return A.on=function(P,L){this.listeners[P]||(this.listeners[P]=[]),this.listeners[P].push(L)},A.off=function(P,L){return!!this.listeners[P]&&(L=this.listeners[P].indexOf(L),this.listeners[P]=this.listeners[P].slice(0),this.listeners[P].splice(L,1),-1<L)},A.trigger=function(P){var L=this.listeners[P];if(L)if(arguments.length===2)for(var B=L.length,F=0;F<B;++F)L[F].call(this,arguments[1]);else for(var K=Array.prototype.slice.call(arguments,1),Q=L.length,oe=0;oe<Q;++oe)L[oe].apply(this,K)},A.dispose=function(){this.listeners={}},A.pipe=function(P){this.on("data",function(L){P.push(L)})},S}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */let s=null;class r{constructor(A){s=s||function(){var de=[[[],[],[],[],[]],[[],[],[],[],[]]],xe=de[0],ge=de[1],Me=xe[4],xt=ge[4];let qe,nt,Tt;var gt,Ci,st,Lt,Nt=[],Vi=[];let cn,Ge;for(qe=0;qe<256;qe++)Vi[(Nt[qe]=qe<<1^283*(qe>>7))^qe]=qe;for(nt=Tt=0;!Me[nt];nt^=gt||1,Tt=Vi[Tt]||1)for(Lt=(Lt=Tt^Tt<<1^Tt<<2^Tt<<3^Tt<<4)>>8^255&Lt^99,st=Nt[Ci=Nt[gt=Nt[xt[Me[nt]=Lt]=nt]]],Ge=16843009*st^65537*Ci^257*gt^16843008*nt,cn=257*Nt[Lt]^16843008*Lt,qe=0;qe<4;qe++)xe[qe][nt]=cn=cn<<24^cn>>>8,ge[qe][Lt]=Ge=Ge<<24^Ge>>>8;for(qe=0;qe<5;qe++)xe[qe]=xe[qe].slice(0),ge[qe]=ge[qe].slice(0);return de}(),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];let P,L,B;var F=this._tables[0][4],K=this._tables[1],Q=A.length;let oe=1;if(Q!==4&&Q!==6&&Q!==8)throw new Error("Invalid aes key size");var te=A.slice(0),ce=[];for(this._key=[te,ce],P=Q;P<4*Q+28;P++)B=te[P-1],(P%Q==0||Q===8&&P%Q==4)&&(B=F[B>>>24]<<24^F[B>>16&255]<<16^F[B>>8&255]<<8^F[255&B],P%Q==0)&&(B=B<<8^B>>>24^oe<<24,oe=oe<<1^283*(oe>>7)),te[P]=te[P-Q]^B;for(L=0;P;L++,P--)B=te[3&L?P:P-4],P<=4||L<4?ce[L]=B:ce[L]=K[0][F[B>>>24]]^K[1][F[B>>16&255]]^K[2][F[B>>8&255]]^K[3][F[255&B]]}decrypt(Tt,P,L,B,F,K){var Q,oe,te=this._key[1];let ce=Tt^te[0],de=B^te[1],xe=L^te[2],ge=P^te[3],Me;var xt=te.length/4-2;let qe,nt=4;var Tt=this._tables[1],gt=Tt[0],Ci=Tt[1],st=Tt[2],Lt=Tt[3],Nt=Tt[4];for(qe=0;qe<xt;qe++)Me=gt[ce>>>24]^Ci[de>>16&255]^st[xe>>8&255]^Lt[255&ge]^te[nt],Q=gt[de>>>24]^Ci[xe>>16&255]^st[ge>>8&255]^Lt[255&ce]^te[nt+1],oe=gt[xe>>>24]^Ci[ge>>16&255]^st[ce>>8&255]^Lt[255&de]^te[nt+2],ge=gt[ge>>>24]^Ci[ce>>16&255]^st[de>>8&255]^Lt[255&xe]^te[nt+3],nt+=4,ce=Me,de=Q,xe=oe;for(qe=0;qe<4;qe++)F[(3&-qe)+K]=Nt[ce>>>24]<<24^Nt[de>>16&255]<<16^Nt[xe>>8&255]<<8^Nt[255&ge]^te[nt++],Me=ce,ce=de,de=xe,xe=ge,ge=Me}}class l extends a{constructor(){super(a),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(A){this.jobs.push(A),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}function d(S){return S<<24|(65280&S)<<8|(16711680&S)>>8|S>>>24}class f{constructor(A,P,L,B){var F=f.STEP,K=new Int32Array(A.buffer);const Q=new Uint8Array(A.byteLength);let oe=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(K.subarray(oe,oe+F),P,L,Q)),oe=F;oe<K.length;oe+=F)L=new Uint32Array([d(K[oe-4]),d(K[oe-3]),d(K[oe-2]),d(K[oe-1])]),this.asyncStream_.push(this.decryptChunk_(K.subarray(oe,oe+F),P,L,Q));this.asyncStream_.push(function(){var te;/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */B(null,(te=Q).subarray(0,te.byteLength-te[te.byteLength-1]))})}static get STEP(){return 32e3}decryptChunk_(A,P,L,B){return function(){var F=function(K,xt,oe){var te,ce,de,xe,ge=new Int32Array(K.buffer,K.byteOffset,K.byteLength>>2),Me=new r(Array.prototype.slice.call(xt)),xt=new Uint8Array(K.byteLength),qe=new Int32Array(xt.buffer);let nt,Tt,gt,Ci,st;for(nt=oe[0],Tt=oe[1],gt=oe[2],Ci=oe[3],st=0;st<ge.length;st+=4)te=d(ge[st]),ce=d(ge[st+1]),de=d(ge[st+2]),xe=d(ge[st+3]),Me.decrypt(te,ce,de,xe,qe,st),qe[st]=d(qe[st]^nt),qe[st+1]=d(qe[st+1]^Tt),qe[st+2]=d(qe[st+2]^gt),qe[st+3]=d(qe[st+3]^Ci),nt=te,Tt=ce,gt=de,Ci=xe;return xt}(A,P,L);B.set(F,A.byteOffset)}}}var p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Yn<"u"?Yn:typeof self<"u"?self:{},p=typeof window<"u"?window:typeof p<"u"?p:typeof self<"u"?self:{},p=p.BigInt||Number;p("0x1"),p("0x100"),p("0x10000"),p("0x1000000"),p("0x100000000"),p("0x10000000000"),p("0x1000000000000"),p("0x100000000000000"),p("0x10000000000000000"),p=new Uint16Array([65484]),(p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength))[0]!==255&&p[0];function y(S){const A={};return Object.keys(S).forEach(P=>{var L,B=S[P];L=B,(ArrayBuffer.isView==="function"?ArrayBuffer.isView(L):L&&L.buffer instanceof ArrayBuffer)?A[P]={bytes:B.buffer,byteOffset:B.byteOffset,byteLength:B.byteLength}:A[P]=B}),A}self.onmessage=function(P){const A=P.data;var P=new Uint8Array(A.encrypted.bytes,A.encrypted.byteOffset,A.encrypted.byteLength),L=new Uint32Array(A.key.bytes,A.key.byteOffset,A.key.byteLength/4),B=new Uint32Array(A.iv.bytes,A.iv.byteOffset,A.iv.byteLength/4);new f(P,L,B,function(F,K){self.postMessage(y({source:A.source,decrypted:K}),[K.buffer])})}})));const rp=(a,s)=>{a.abort(),a.pause(),s&&s.activePlaylistLoader&&(s.activePlaylistLoader.pause(),s.activePlaylistLoader=null)},tS=(a,s)=>{(s.activePlaylistLoader=a).load()},ap={AUDIO:(a,s)=>()=>{var{segmentLoaders:{[a]:d},mediaTypes:{[a]:r},excludePlaylist:l}=s,d=(rp(d,r),r.activeTrack()),f=r.activeGroup(),f=(f.filter(y=>y.default)[0]||f[0]).id,p=r.tracks[f];if(d===p)l({error:{message:"Problem encountered loading the default audio track."}});else{fe.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const y in r.tracks)r.tracks[y].enabled=r.tracks[y]===p;r.onTrackChanged()}},SUBTITLES:(a,s)=>()=>{var{segmentLoaders:{[a]:l},mediaTypes:{[a]:r}}=s,l=(fe.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),rp(l,r),r.activeTrack());l&&(l.mode="disabled"),r.onTrackChanged()}},iS={AUDIO:(a,s,r)=>{if(!s)return;const{tech:l,requestOptions:d,segmentLoaders:{[a]:f}}=r;s.on("loadedmetadata",()=>{var p=s.media();f.playlist(p,d),(!l.paused()||p.endList&&l.preload()!=="none")&&f.load()}),s.on("loadedplaylist",()=>{f.playlist(s.media(),d),l.paused()||f.load()}),s.on("error",ap[a](a,r))},SUBTITLES:(a,s,r)=>{const{tech:l,requestOptions:d,segmentLoaders:{[a]:f},mediaTypes:{[a]:p}}=r;s.on("loadedmetadata",()=>{var y=s.media();f.playlist(y,d),f.track(p.activeTrack()),(!l.paused()||y.endList&&l.preload()!=="none")&&f.load()}),s.on("loadedplaylist",()=>{f.playlist(s.media(),d),l.paused()||f.load()}),s.on("error",ap[a](a,r))}},CP={AUDIO:(a,s)=>{var r,{vhs:l,sourceType:d,segmentLoaders:{[a]:f},requestOptions:p,main:{mediaGroups:y},mediaTypes:{[a]:{groups:S,tracks:A,logger_:P}},mainPlaylistLoader:L}=s,B=vd(L.main);y[a]&&Object.keys(y[a]).length!==0||(y[a]={main:{default:{default:!0}}},B&&(y[a].main.default.playlists=L.main.playlists));for(const F in y[a]){S[F]||(S[F]=[]);for(const K in y[a][F]){let Q=y[a][F][K],oe;oe=B?(P(`AUDIO group '${F}' label '${K}' is a main playlist`),Q.isMainPlaylist=!0,null):d==="vhs-json"&&Q.playlists?new tu(Q.playlists[0],l,p):Q.resolvedUri?new tu(Q.resolvedUri,l,p):Q.playlists&&d==="dash"?new H_(Q.playlists[0],l,p,L):null,Q=oi({id:K,playlistLoader:oe},Q),iS[a](a,Q.playlistLoader,s),S[F].push(Q),typeof A[K]>"u"&&(r=new fe.AudioTrack({id:K,kind:(te=>{let ce=te.default?"main":"alternative";return ce=te.characteristics&&0<=te.characteristics.indexOf("public.accessibility.describes-video")?"main-desc":ce})(Q),enabled:!1,language:Q.language,default:Q.default,label:K}),A[K]=r)}}f.on("error",ap[a](a,s))},SUBTITLES:(a,s)=>{var r,{tech:l,vhs:d,sourceType:f,segmentLoaders:{[a]:p},requestOptions:y,main:{mediaGroups:S},mediaTypes:{[a]:{groups:A,tracks:P}},mainPlaylistLoader:L}=s;for(const B in S[a]){A[B]||(A[B]=[]);for(const F in S[a][B])if(!S[a][B][F].forced){let K=S[a][B][F],Q;if(f==="hls")Q=new tu(K.resolvedUri,d,y);else if(f==="dash"){if(!K.playlists.filter(oe=>oe.excludeUntil!==1/0).length)return;Q=new H_(K.playlists[0],d,y,L)}else f==="vhs-json"&&(Q=new tu(K.playlists?K.playlists[0]:K.resolvedUri,d,y));K=oi({id:F,playlistLoader:Q},K),iS[a](a,K.playlistLoader,s),A[B].push(K),typeof P[F]>"u"&&(r=l.addRemoteTextTrack({id:F,kind:"subtitles",default:K.default&&K.autoselect,language:K.language,label:F},!1).track,P[F]=r)}}p.on("error",ap[a](a,s))},"CLOSED-CAPTIONS":(a,s)=>{var{tech:r,main:{mediaGroups:l},mediaTypes:{[a]:{groups:d,tracks:f}}}=s;for(const S in l[a]){d[S]||(d[S]=[]);for(const A in l[a][S]){var p=l[a][S][A];if(/^(?:CC|SERVICE)/.test(p.instreamId)){var y=r.options_.vhs&&r.options_.vhs.captionServices||{};let P={label:A,language:p.language,instreamId:p.instreamId,default:p.default&&p.autoselect};(P=y[P.instreamId]?oi(P,y[P.instreamId]):P).default===void 0&&delete P.default,d[S].push(oi({id:A},p)),typeof f[A]>"u"&&(y=r.addRemoteTextTrack({id:P.instreamId,kind:"captions",default:P.default,language:P.language,label:P.label},!1).track,f[A]=y)}}}}},sS=(a,s)=>{for(let r=0;r<a.length;r++)if(M_(s,a[r])||a[r].playlists&&sS(a[r].playlists,s))return!0;return!1},AP={AUDIO:(a,s)=>()=>{var{[a]:{tracks:r}}=s.mediaTypes;for(const l in r)if(r[l].enabled)return r[l];return null},SUBTITLES:(a,s)=>()=>{var{[a]:{tracks:r}}=s.mediaTypes;for(const l in r)if(r[l].mode==="showing"||r[l].mode==="hidden")return r[l];return null}},kP=a=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(A=>{CP[A](A,a)});const{mediaTypes:s,mainPlaylistLoader:r,tech:l,vhs:d,segmentLoaders:{AUDIO:f,main:p}}=a;["AUDIO","SUBTITLES"].forEach(A=>{var P,L,B,F,K,Q,oe,te,ce,de;s[A].activeGroup=(P=A,L=a,xe=>{var{mainPlaylistLoader:ge,mediaTypes:{[P]:{groups:Me}}}=L,xt=ge.media();if(!xt)return null;let qe=null;xt.attributes[P]&&(qe=Me[xt.attributes[P]]);var nt=Object.keys(Me);if(!qe)if(P==="AUDIO"&&1<nt.length&&vd(L.main))for(let gt=0;gt<nt.length;gt++){var Tt=Me[nt[gt]];if(sS(Tt,xt)){qe=Tt;break}}else Me.main?qe=Me.main:nt.length===1&&(qe=Me[nt[0]]);return typeof xe>"u"?qe:xe!==null&&qe&&qe.filter(gt=>gt.id===xe.id)[0]||null}),s[A].activeTrack=AP[A](A,a),s[A].onGroupChanged=(B=A,F=a,()=>{var{segmentLoaders:{[B]:xe,main:ge},mediaTypes:{[B]:Me}}=F,xt=Me.activeTrack(),qe=Me.getActiveGroup(),nt=Me.activePlaylistLoader,Tt=Me.lastGroup_;qe&&Tt&&qe.id===Tt.id||(Me.lastGroup_=qe,Me.lastTrack_=xt,rp(xe,Me),qe&&!qe.isMainPlaylist&&(qe.playlistLoader?(xe.resyncLoader(),tS(qe.playlistLoader,Me)):nt&&ge.resetEverything()))}),s[A].onGroupChanging=(K=A,Q=a,()=>{var{segmentLoaders:{[K]:xe},mediaTypes:{[K]:ge}}=Q;ge.lastGroup_=null,xe.abort(),xe.pause()}),s[A].onTrackChanged=(oe=A,te=a,()=>{var xe,ge,{mainPlaylistLoader:Me,segmentLoaders:{[oe]:xt,main:qe},mediaTypes:{[oe]:nt}}=te,Tt=nt.activeTrack(),gt=nt.getActiveGroup(),Ci=nt.activePlaylistLoader,st=nt.lastTrack_;if((!st||!Tt||st.id!==Tt.id)&&(nt.lastGroup_=gt,nt.lastTrack_=Tt,rp(xt,nt),gt)){if(gt.isMainPlaylist)return!Tt||!st||Tt.id===st.id||(ge=(xe=te.vhs.playlistController_).selectPlaylist(),xe.media()===ge)?void 0:(nt.logger_(`track change. Switching main audio from ${st.id} to `+Tt.id),Me.pause(),qe.resetEverything(),void xe.fastQualityChange_(ge));if(oe==="AUDIO"){if(!gt.playlistLoader)return qe.setAudio(!0),void qe.resetEverything();xt.setAudio(!0),qe.setAudio(!1)}Ci===gt.playlistLoader||(xt.track&&xt.track(Tt),xt.resetEverything()),tS(gt.playlistLoader,nt)}}),s[A].getActiveGroup=([ce,de]=[A,a.mediaTypes],()=>{var xe=de[ce].activeTrack();return xe?de[ce].activeGroup(xe):null})});var y=s.AUDIO.activeGroup();y&&(y=(y.filter(A=>A.default)[0]||y[0]).id,s.AUDIO.tracks[y].enabled=!0,s.AUDIO.onGroupChanged(),s.AUDIO.onTrackChanged(),(s.AUDIO.getActiveGroup().playlistLoader?(p.setAudio(!1),f):p).setAudio(!0)),r.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(A=>s[A].onGroupChanged())}),r.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(A=>s[A].onGroupChanging())});const S=()=>{s.AUDIO.onTrackChanged(),l.trigger({type:"usage",name:"vhs-audio-change"})};l.audioTracks().addEventListener("change",S),l.remoteTextTracks().addEventListener("change",s.SUBTITLES.onTrackChanged),d.on("dispose",()=>{l.audioTracks().removeEventListener("change",S),l.remoteTextTracks().removeEventListener("change",s.SUBTITLES.onTrackChanged)}),l.clearTracks("audio");for(const A in s.AUDIO.tracks)l.audioTracks().addTrack(s.AUDIO.tracks[A])};let Qr;const IP=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"];class OP extends fe.EventTarget{constructor(s){super();var{src:r,withCredentials:l,tech:d,bandwidth:f,externVhs:p,useCueTags:y,playlistExclusionDuration:S,enableLowInitialPlaylist:A,sourceType:P,cacheEncryptionKeys:L,bufferBasedABR:B,leastPixelDiffSelector:F,captionServices:K}=s;if(!r)throw new Error("A non-empty playlist URL or JSON manifest string is required");let Q=s.maxPlaylistRetries;Q!==null&&typeof Q<"u"||(Q=1/0),Qr=p,this.bufferBasedABR=Boolean(B),this.leastPixelDiffSelector=Boolean(F),this.withCredentials=l,this.tech_=d,this.vhs_=d.vhs,this.sourceType_=P,this.useCueTags_=y,this.playlistExclusionDuration=S,this.maxPlaylistRetries=Q,this.enableLowInitialPlaylist=A,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:l,maxPlaylistRetries:Q,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{const oe={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(te=>{oe[te]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Yr,activeTrack:Yr,getActiveGroup:Yr,onGroupChanged:Yr,onTrackChanged:Yr,lastTrack_:null,logger_:qn(`MediaGroups[${te}]`)}}),oe})(),this.mediaSource=new window.MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=qs(),this.hasPlayed_=!1,this.syncController_=new SP(s),this.segmentMetadataTrack_=d.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new wP,this.sourceUpdater_=new QE(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new xP,p={vhs:this.vhs_,parse708captions:s.parse708captions,useDtsForTimestampOffset:s.useDtsForTimestampOffset,captionServices:K,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:f,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:L,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:s.exactManifestTimings},this.mainPlaylistLoader_=new(this.sourceType_==="dash"?H_:tu)(r,this.vhs_,this.requestOptions_),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new z_(oi(p,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),s),this.audioSegmentLoader_=new z_(oi(p,{loaderType:"audio"}),s),this.subtitleSegmentLoader_=new EP(oi(p,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks}),s),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),IP.forEach(oe=>{this[oe+"_"]=function(te){return this.audioSegmentLoader_[te]+this.mainSegmentLoader_[te]}.bind(this,oe)}),this.logger_=qn("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1,B=this.tech_.preload()==="none"?"play":"loadstart",this.tech_.one(B,()=>{const oe=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-oe,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){var s=this.mainAppendsToLoadedData_(),r=this.audioAppendsToLoadedData_();return s===-1||r===-1?-1:s+r}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(s="abr"){var r=this.selectPlaylist();r&&this.shouldSwitchToMedia_(r)&&this.switchMedia_(r,s)}switchMedia_(s,r,l){var d=this.media(),d=d&&(d.id||d.uri),f=s.id||s.uri;d&&d!==f&&(this.logger_(`switch media ${d} -> ${f} from `+r),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+r})),this.mainPlaylistLoader_.media(s,l)}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=window.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(window.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){var s=this.main(),r=s&&s.playlists||[];if(!s||!s.mediaGroups||!s.mediaGroups.AUDIO)return r;var l=s.mediaGroups.AUDIO,d=Object.keys(l);let f;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)f=this.mediaTypes_.AUDIO.activeTrack();else{var p=l.main||d.length&&l[d[0]];for(const P in p)if(p[P].default){f={label:P};break}}if(!f)return r;var y=[];for(const P in l)if(l[P][f.label]){var S=l[P][f.label];if(S.playlists&&S.playlists.length)y.push.apply(y,S.playlists);else if(S.uri)y.push(S);else if(s.playlists.length)for(let L=0;L<s.playlists.length;L++){var A=s.playlists[L];A.attributes&&A.attributes.AUDIO&&A.attributes.AUDIO===P&&y.push(A)}}return y.length?y:r}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{var s=this.mainPlaylistLoader_.media(),r=1.5*s.targetDuration*1e3;R_(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=r,s.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.mainSegmentLoader_.load()),kP({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),s),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let s=this.mainPlaylistLoader_.media();if(!s){this.excludeUnsupportedVariants_();let r;if(!(r=(r=this.enableLowInitialPlaylist?this.selectInitialPlaylist():r)||this.selectPlaylist())||!this.shouldSwitchToMedia_(r)||(this.initialMedia_=r,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;s=this.initialMedia_}this.handleUpdatedMediaPlaylist(s)}),this.mainPlaylistLoader_.on("error",()=>{var s=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:s.playlist,error:s})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{var s=this.mainPlaylistLoader_.media(),r=1.5*s.targetDuration*1e3;R_(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=r,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{var s=this.mainPlaylistLoader_.media();s.lastExcludeReason_!=="playlist-unchanged"&&this.stuckAtPlaylistEnd_(s)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(s){this.useCueTags_&&this.updateAdCues_(s),this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.updateDuration(!s.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(s,r){var l=s.mediaGroups||{};let d=!0;s=Object.keys(l.AUDIO);for(const f in l.AUDIO)for(const p in l.AUDIO[f])l.AUDIO[f][p].uri||(d=!1);d&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(l.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Qr.Playlist.isAes(r)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),s.length&&1<Object.keys(l.AUDIO[s[0]]).length&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(d){var l=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,r=this.tech_.currentTime(),f=this.bufferLowWaterLine(),p=this.bufferHighWaterLine(),{currentPlaylist:r,buffered:l,currentTime:d,nextPlaylist:f,bufferLowWaterLine:p,bufferHighWaterLine:y,duration:S,bufferBasedABR:A,log:P}=[{buffered:this.tech_.buffered(),currentTime:r,currentPlaylist:l,nextPlaylist:d,bufferLowWaterLine:f,bufferHighWaterLine:p,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_}][0];if(f){var L=`allowing switch ${r&&r.id||"null"} -> `+f.id;if(!r)return P(L+" as current playlist is not set"),!0;if(f.id!==r.id){var B=Boolean(eu(l,d).length);if(!r.endList)return B||typeof r.partTargetDuration!="number"?(P(L+" as current playlist is live"),!0):(P(`not ${L} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);if(B=D_(l,d),l=A?Yi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Yi.MAX_BUFFER_LOW_WATER_LINE,S<l)return P(L+` as duration < max low water line (${S} < ${l})`),!0;if(d=f.attributes.BANDWIDTH,S=r.attributes.BANDWIDTH,d<S&&(!A||B<y)){let F=L+` as next bandwidth < current bandwidth (${d} < ${S})`;return A&&(F+=` and forwardBuffer < bufferHighWaterLine (${B} < ${y})`),P(F),!0}if((!A||S<d)&&p<=B){let F=L+` as forwardBuffer >= bufferLowWaterLine (${B} >= ${p})`;return A&&(F+=` and next bandwidth > current bandwidth (${d} > ${S})`),P(F),!0}P(`not ${L} as no switching criteria met`)}}else fe.log.warn("We received no playlist to switch to. Please check your stream.");return!1}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{var r=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:r.playlist,error:r})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",r=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:120}))});var s=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();var r=this.getCodecsOrExclude_();r&&this.sourceUpdater_.addOrChangeSourceBuffers(r)};this.mainSegmentLoader_.on("trackinfo",s),this.audioSegmentLoader_.on("trackinfo",s),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(s=this.selectPlaylist()){s===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(s,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{fe.browser.IE_VERSION||fe.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())}))}play(){var s;if(!this.setupFirstPlay())return this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load(),s=this.tech_.seekable(),this.tech_.duration()===1/0&&this.tech_.currentTime()<s.start(0)?this.tech_.setCurrentTime(s.end(s.length-1)):void 0}setupFirstPlay(){var s=this.mainPlaylistLoader_.media();if(!s||this.tech_.paused()||this.hasPlayed_)return!1;if(!s.endList){const r=this.seekable();if(!r.length)return!1;if(fe.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay"),this.tech_.setCurrentTime(r.end(0)),this.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(r.end(0))}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){var s;this.tryToCreateSourceBuffers_(),this.tech_.autoplay()&&typeof(s=this.tech_.play())<"u"&&typeof s.then=="function"&&s.then(null,r=>{}),this.trigger("sourceopen")}handleSourceEnded_(){var s,r;this.inbandTextTracks_.metadataTrack_&&(s=this.inbandTextTracks_.metadataTrack_.cues)&&s.length&&(r=this.duration(),s[s.length-1].endTime=isNaN(r)||Math.abs(r)===1/0?Number.MAX_VALUE:r)}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let s=this.mainSegmentLoader_.ended_;var r;this.mediaTypes_.AUDIO.activePlaylistLoader&&(r=this.mainSegmentLoader_.getCurrentMediaInfo_(),s=(r&&!r.hasVideo||s)&&this.audioSegmentLoader_.ended_),s&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(s){var r,l;return!!this.seekable().length&&(r=this.syncController_.getExpiredTime(s,this.duration()))!==null&&(s=Qr.Playlist.playlistEnd(s,r),r=this.tech_.currentTime(),(l=this.tech_.buffered()).length?(l=l.end(l.length-1))-r<=mr&&s-l<=mr:s-r<=mr)}excludePlaylist({playlistToExclude:s=this.mainPlaylistLoader_.media(),error:r={},playlistExclusionDuration:l}){if(s=s||this.mainPlaylistLoader_.media(),l=l||r.playlistExclusionDuration||this.playlistExclusionDuration,s){s.playlistErrors_++;var p=this.mainPlaylistLoader_.main.playlists,d=p.filter(ep),d=d.length===1&&d[0]===s;if(p.length===1&&l!==1/0)return fe.log.warn(`Problem encountered with playlist ${s.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(d);if(d){let S=!1;p.forEach(A=>{var P;A!==s&&typeof(P=A.excludeUntil)<"u"&&P!==1/0&&(S=!0,delete A.excludeUntil)}),S&&(fe.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let y;y=s.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*l,s.excludeUntil=y,r.reason&&(s.lastExcludeReason_=r.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});var f,p=this.selectPlaylist();if(p)return l=r.internal?this.logger_:fe.log.warn,f=r.message?" "+r.message:"",l(`${r.internal?"Internal problem":"Problem"} encountered with playlist ${s.id}.`+f+` Switching to playlist ${p.id}.`),p.attributes.AUDIO!==s.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),p.attributes.SUBTITLES!==s.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),l=p.targetDuration/2*1e3||5e3,f=typeof p.lastRequest=="number"&&Date.now()-p.lastRequest<=l,this.switchMedia_(p,"exclude",d||f);this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error")}else this.error=r,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network")}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(s,r){const l=[];var d=s==="all",f=(!d&&s!=="main"||l.push(this.mainPlaylistLoader_),[]);!d&&s!=="audio"||f.push("AUDIO"),!d&&s!=="subtitle"||(f.push("CLOSED-CAPTIONS"),f.push("SUBTITLES")),f.forEach(p=>{p=this.mediaTypes_[p]&&this.mediaTypes_[p].activePlaylistLoader,p&&l.push(p)}),["main","audio","subtitle"].forEach(p=>{var y=this[p+"SegmentLoader_"];!y||s!==p&&s!=="all"||l.push(y)}),l.forEach(p=>r.forEach(y=>{typeof p[y]=="function"&&p[y]()}))}setCurrentTime(s){var r=eu(this.tech_.buffered(),s);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?r&&r.length?s:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}duration(){var s;return this.mainPlaylistLoader_&&(s=this.mainPlaylistLoader_.media())?s.endList?this.mediaSource?this.mediaSource.duration:Qr.Playlist.duration(s):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let s;if(this.mainPlaylistLoader_){var r=this.mainPlaylistLoader_.media();if(r){var l=this.syncController_.getExpiredTime(r,this.duration());if(l!==null){var d=this.mainPlaylistLoader_.main,f=Qr.Playlist.seekable(r,l,Qr.Playlist.liveEdgeDelay(d,r));if(f.length!==0){if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(r=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),(l=this.syncController_.getExpiredTime(r,this.duration()))===null||(s=Qr.Playlist.seekable(r,l,Qr.Playlist.liveEdgeDelay(d,r))).length===0))return;let p,y;this.seekable_&&this.seekable_.length&&(p=this.seekable_.end(0),y=this.seekable_.start(0)),!s||s.start(0)>f.end(0)||f.start(0)>s.end(0)?this.seekable_=f:this.seekable_=qs([[(s.start(0)>f.start(0)?s:f).start(0),(s.end(0)<f.end(0)?s:f).end(0)]]),this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===p&&this.seekable_.start(0)===y||(this.logger_(`seekable updated [${nE(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}}}}}updateDuration(s){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open")this.updateDuration_=this.updateDuration.bind(this,s),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);else{if(s)return(s=this.seekable()).length?void((isNaN(this.mediaSource.duration)||this.mediaSource.duration<s.end(s.length-1))&&this.sourceUpdater_.setDuration(s.end(s.length-1))):void 0;s=this.tech_.buffered();let r=Qr.Playlist.duration(this.mainPlaylistLoader_.media());0<s.length&&(r=Math.max(r,s.end(s.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(s=>{var r=this.mediaTypes_[s].groups;for(const l in r)r[l].forEach(d=>{d.playlistLoader&&d.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){var r=!!this.mediaTypes_.AUDIO.activePlaylistLoader,s=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),r=!r||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return s&&r}getCodecsOrExclude_(){const s={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};s.video=s.main;var r=bd(this.main(),this.media());const l={};var d=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(s.main.hasVideo&&(l.video=r.video||s.main.videoCodec||"avc1.4d400d"),s.main.isMuxed&&(l.video+=","+(r.audio||s.main.audioCodec||sb)),(s.main.hasAudio&&!s.main.isMuxed||s.audio.hasAudio||d)&&(l.audio=r.audio||s.main.audioCodec||s.audio.audioCodec||sb,s.audio.isFmp4=(s.main.hasAudio&&!s.main.isMuxed?s.main:s.audio).isFmp4),l.audio||l.video){const f={};let p;if(["video","audio"].forEach(function(y){var S,A;l.hasOwnProperty(y)&&(S=s[y].isFmp4,A=l[y],!(S?Mf:l_)(A))&&(S=s[y].isFmp4?"browser":"muxer",f[S]=f[S]||[],f[S].push(l[y]),y==="audio"&&(p=S))}),d&&p&&this.media().attributes.AUDIO){const y=this.media().attributes.AUDIO;this.main().playlists.forEach(S=>{(S.attributes&&S.attributes.AUDIO)===y&&S!==this.media()&&(S.excludeUntil=1/0)}),this.logger_(`excluding audio group ${y} as ${p} does not support codec(s): "${l.audio}"`)}if(!Object.keys(f).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const y=[];if(["video","audio"].forEach(S=>{var A=(hr(this.sourceUpdater_.codecs[S]||"")[0]||{}).type,P=(hr(l[S]||"")[0]||{}).type;A&&P&&A.toLowerCase()!==P.toLowerCase()&&y.push(`"${this.sourceUpdater_.codecs[S]}" -> "${l[S]}"`)}),y.length)return void this.excludePlaylist({playlistToExclude:this.media(),error:{message:`Codec switching not supported: ${y.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0})}return l}r=Object.keys(f).reduce((y,S)=>(y&&(y+=", "),y+=`${S} does not support codec(s): "${f[S].join(",")}"`),"")+".",this.excludePlaylist({playlistToExclude:this.media(),error:{internal:!0,message:r},playlistExclusionDuration:1/0})}else this.excludePlaylist({playlistToExclude:this.media(),error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0})}tryToCreateSourceBuffers_(){var s;this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||this.areMediaTypesKnown_()&&(s=this.getCodecsOrExclude_())&&(this.sourceUpdater_.createSourceBuffers(s),s=[s.video,s.audio].filter(Boolean).join(","),this.excludeIncompatibleVariants_(s))}excludeUnsupportedVariants_(){const s=this.main().playlists,r=[];Object.keys(s).forEach(p=>{var d,f,p=s[p];r.indexOf(p.id)===-1&&(r.push(p.id),f=[],!(d=bd(this.main,p)).audio||l_(d.audio)||Mf(d.audio)||f.push("audio codec "+d.audio),!d.video||l_(d.video)||Mf(d.video)||f.push("video codec "+d.video),d.text&&d.text==="stpp.ttml.im1t"&&f.push("text codec "+d.text),f.length)&&(p.excludeUntil=1/0,this.logger_(`excluding ${p.id} for unsupported: `+f.join(", ")))})}excludeIncompatibleVariants_(s){const r=[],l=this.main().playlists;s=np(hr(s));const d=RE(s),f=s.video&&hr(s.video)[0]||null,p=s.audio&&hr(s.audio)[0]||null;Object.keys(l).forEach(L=>{var S,A,P,L=l[L];r.indexOf(L.id)===-1&&L.excludeUntil!==1/0&&(r.push(L.id),S=[],P=bd(this.mainPlaylistLoader_.main,L),A=RE(P),P.audio||P.video)&&(A!==d&&S.push(`codec count "${A}" !== "${d}"`),this.sourceUpdater_.canChangeType()||(A=P.video&&hr(P.video)[0]||null,P=P.audio&&hr(P.audio)[0]||null,A&&f&&A.type.toLowerCase()!==f.type.toLowerCase()&&S.push(`video codec "${A.type}" !== "${f.type}"`),P&&p&&P.type.toLowerCase()!==p.type.toLowerCase()&&S.push(`audio codec "${P.type}" !== "${p.type}"`)),S.length)&&(L.excludeUntil=1/0,this.logger_(`excluding ${L.id}: `+S.join(" && ")))})}updateAdCues_(s){let r=0;var f=this.seekable(),[l,d,f=0]=(f.length&&(r=f.start(0)),[s,this.cueTagsTrack_,r]);if(l.segments){let A=f,P;for(let L=0;L<l.segments.length;L++){var p,y,S=l.segments[L];if(P=P||function(B,F){var K=B.cues;for(let oe=0;oe<K.length;oe++){var Q=K[oe];if(F>=Q.adStartTime&&F<=Q.adEndTime)return Q}return null}(d,A+S.duration/2)){if("cueIn"in S){P.endTime=A,P.adEndTime=A,A+=S.duration,P=null;continue}if(A<P.endTime){A+=S.duration;continue}P.endTime+=S.duration}else"cueOut"in S&&((P=new window.VTTCue(A,A+S.duration,S.cueOut)).adStartTime=A,P.adEndTime=A+parseFloat(S.cueOut),d.addCue(P)),"cueOutCont"in S&&([p,y]=S.cueOutCont.split("/").map(parseFloat),(P=new window.VTTCue(A,A+S.duration,"")).adStartTime=A-p,P.adEndTime=P.adStartTime+y,d.addCue(P));A+=S.duration}}}goalBufferLength(){var s=this.tech_.currentTime(),r=Yi.GOAL_BUFFER_LENGTH,l=Yi.GOAL_BUFFER_LENGTH_RATE,d=Math.max(r,Yi.MAX_GOAL_BUFFER_LENGTH);return Math.min(r+s*l,d)}bufferLowWaterLine(){var s=this.tech_.currentTime(),r=Yi.BUFFER_LOW_WATER_LINE,l=Yi.BUFFER_LOW_WATER_LINE_RATE,d=Math.max(r,Yi.MAX_BUFFER_LOW_WATER_LINE),f=Math.max(r,Yi.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(r+s*l,this.bufferBasedABR?f:d)}bufferHighWaterLine(){return Yi.BUFFER_HIGH_WATER_LINE}}class DP{constructor(s,r,l){var d,f,p,y,S=s.playlistController_,A=S.fastQualityChange_.bind(S);r.attributes&&(d=r.attributes.RESOLUTION,this.width=d&&d.width,this.height=d&&d.height,this.bandwidth=r.attributes.BANDWIDTH,this.frameRate=r.attributes["FRAME-RATE"]),this.codecs=bd(S.main(),r),this.playlist=r,this.id=l,this.enabled=(f=s.playlists,p=r.id,y=A,P=>{var L=f.main.playlists[p],B=N_(L),F=ep(L);return typeof P>"u"?F:(P?delete L.disabled:L.disabled=!0,P===F||B||(y(),P?f.trigger("renditionenabled"):f.trigger("renditiondisabled")),P)})}}const nS=["seeking","seeked","pause","playing","error"];class PP{constructor(s){this.playlistController_=s.playlistController,this.tech_=s.tech,this.seekable=s.seekable,this.allowSeeksWithinUnsafeLiveWindow=s.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=s.liveRangeSafeTimeDelta,this.media=s.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=qn("PlaybackWatcher"),this.logger_("initialize");const r=()=>this.monitorCurrentTime_(),l=()=>this.monitorCurrentTime_(),d=()=>this.techWaiting_(),f=()=>this.resetTimeUpdate_(),p=this.playlistController_,y=["main","subtitle","audio"],S={},A=(y.forEach(P=>{S[P]={reset:()=>this.resetSegmentDownloads_(P),updateend:()=>this.checkSegmentDownloads_(P)},p[P+"SegmentLoader_"].on("appendsdone",S[P].updateend),p[P+"SegmentLoader_"].on("playlistupdate",S[P].reset),this.tech_.on(["seeked","seeking"],S[P].reset)}),P=>{["main","audio"].forEach(L=>{p[L+"SegmentLoader_"][P]("appended",this.seekingAppendCheck_)})});this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),A("off"))},this.clearSeekingAppendCheck_=()=>A("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),A("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",d),this.tech_.on(nS,f),this.tech_.on("canplay",l),this.tech_.one("play",r),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",d),this.tech_.off(nS,f),this.tech_.off("canplay",l),this.tech_.off("play",r),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),y.forEach(P=>{p[P+"SegmentLoader_"].off("appendsdone",S[P].updateend),p[P+"SegmentLoader_"].off("playlistupdate",S[P].reset),this.tech_.off(["seeked","seeking"],S[P].reset)}),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=window.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(s){var r=this.playlistController_[s+"SegmentLoader_"];0<this[s+"StalledDownloads_"]&&this.logger_(`resetting possible stalled download count for ${s} loader`),this[s+"StalledDownloads_"]=0,this[s+"Buffered_"]=r.buffered_()}checkSegmentDownloads_(s){var r=this.playlistController_,l=r[s+"SegmentLoader_"],d=l.buffered_(),f=function(p,y){if(p!==y){if(!p&&y||!y&&p||p.length!==y.length)return!0;for(let S=0;S<p.length;S++)if(p.start(S)!==y.start(S)||p.end(S)!==y.end(S))return!0}return!1}(this[s+"Buffered_"],d);this[s+"Buffered_"]=d,f?this.resetSegmentDownloads_(s):(this[s+"StalledDownloads_"]++,this.logger_(`found #${this[s+"StalledDownloads_"]} ${s} appends that did not increase buffer (possible stalled download)`,{playlistId:l.playlist_&&l.playlist_.id,buffered:No(d)}),this[s+"StalledDownloads_"]<10||(this.logger_(s+" loader stalled download exclusion"),this.resetSegmentDownloads_(s),this.tech_.trigger({type:"usage",name:`vhs-${s}-download-exclusion`}),s!=="subtitle"&&r.excludePlaylist({error:{message:`Excessive ${s} segment downloading detected.`},playlistExclusionDuration:1/0})))}checkCurrentTime_(){var s,r;if(!this.tech_.paused()&&!this.tech_.seeking())return s=this.tech_.currentTime(),r=this.tech_.buffered(),this.lastRecordedTime===s&&(!r.length||s+mr>=r.end(r.length-1))?this.techWaiting_():void(5<=this.consecutiveUpdates&&s===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):s===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=s))}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;var s=this.seekable(),r=this.tech_.currentTime();let l;if(this.afterSeekableWindow_(s,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(f=s.end(s.length-1),l=f),this.beforeSeekableWindow_(s,r)&&(f=s.start(0),l=f+(f===s.end(0)?0:mr)),typeof l<"u")this.logger_(`Trying to seek outside of seekable at time ${r} with seekable range ${nE(s)}. Seeking to `+l+".");else{var f=this.playlistController_.sourceUpdater_,s=this.tech_.buffered(),d=f.audioBuffer?f.audioBuffered():null,f=f.videoBuffer?f.videoBuffered():null,p=this.media(),y=p.partTargetDuration||2*(p.targetDuration-Ua),S=[d,f];for(let P=0;P<S.length;P++)if(S[P]&&D_(S[P],r)<y)return!1;if((p=Zf(s,r)).length===0)return!1;l=p.start(0)+mr,this.logger_(`Buffered region starts (${p.start(0)})  just beyond seek point (${r}). Seeking to ${l}.`)}return this.tech_.setCurrentTime(l),!0}waiting_(){var s,r;this.techWaiting_()||(s=this.tech_.currentTime(),r=this.tech_.buffered(),(r=eu(r,s)).length&&s+3<=r.end(0)&&(this.resetTimeUpdate_(),this.tech_.setCurrentTime(s),this.logger_(`Stopped at ${s} while inside a buffered region [${r.start(0)} -> ${r.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})))}techWaiting_(){var s,r=this.seekable(),l=this.tech_.currentTime();return!!this.tech_.seeking()||(this.beforeSeekableWindow_(r,l)?(r=r.end(r.length-1),this.logger_(`Fell out of live window at time ${l}. Seeking to live point (seekable end) `+r),this.resetTimeUpdate_(),this.tech_.setCurrentTime(r),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0):(r=this.tech_.vhs.playlistController_.sourceUpdater_,s=this.tech_.buffered(),this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:l})?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(l),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0):0<(r=Zf(s,l)).length&&(this.logger_(`Stopped at ${l} and seeking to `+r.start(0)),this.resetTimeUpdate_(),this.skipTheGap_(l),!0)))}afterSeekableWindow_(s,r,l,d=!1){if(!s.length)return!1;let f=s.end(s.length-1)+mr;var p=!l.endList;return r>(f=p&&d?s.end(s.length-1)+3*l.targetDuration:f)}beforeSeekableWindow_(s,r){return!!(s.length&&0<s.start(0)&&r<s.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:s,audioBuffered:r,currentTime:l}){if(s){let p;var d,f;return s.length&&r.length?(d=eu(s,l-3),f=eu(s,l),(r=eu(r,l)).length&&!f.length&&d.length&&(p={start:d.end(0),end:r.end(0)})):Zf(s,l).length||(p=this.gapFromVideoUnderflow_(s,l)),!!p&&(this.logger_(`Encountered a gap in video from ${p.start} to ${p.end}. Seeking to current time `+l),!0)}}skipTheGap_(s){var l=this.tech_.buffered(),r=this.tech_.currentTime(),l=Zf(l,r);this.resetTimeUpdate_(),l.length!==0&&r===s&&(this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",s,"nextRange start:",l.start(0)),this.tech_.setCurrentTime(l.start(0)+Ua),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(s,r){var l=function(p){if(p.length<2)return qs();var y=[];for(let P=1;P<p.length;P++){var S=p.end(P-1),A=p.start(P);y.push([S,A])}return qs(y)}(s);for(let p=0;p<l.length;p++){var d=l.start(p),f=l.end(p);if(r-d<4&&2<r-d)return{start:d,end:f}}return null}}const LP={errorInterval:30,getSource(a){return a(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},rS=function(a,s){let r=0,l=0;function d(A){A!=null&&(l=a.duration()!==1/0&&a.currentTime()||0,a.one("loadedmetadata",S),a.src(A),a.trigger({type:"usage",name:"vhs-error-reload"}),a.play())}function f(){if(Date.now()-r<1e3*y.errorInterval)a.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(y.getSource&&typeof y.getSource=="function")return r=Date.now(),y.getSource.call(a,d);fe.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function p(){a.off("loadedmetadata",S),a.off("error",f),a.off("dispose",p)}const y=oi(LP,s),S=(a.ready(()=>{a.trigger({type:"usage",name:"vhs-error-reload-initialized"})}),function(){l&&a.currentTime(l)});a.on("error",f),a.on("dispose",p),a.reloadSourceOnError=function(A){p(),rS(a,A)}};function aS(a,s){var r=s.media();let l=-1;for(let d=0;d<a.length;d++)if(a[d].id===r.id){l=d;break}a.selectedIndex_=l,a.trigger({selectedIndex:l,type:"change"})}const Cs={PlaylistLoader:tu,Playlist:Ws,utils:Y,STANDARD_PLAYLIST_SELECTOR:VE,INITIAL_PLAYLIST_SELECTOR:function(){var a=this.playlists.main.playlists.filter(Ws.isEnabled),a=(iu(a,(s,r)=>V_(s,r)),a.filter(s=>!!bd(this.playlists.main,s).video));return a[0]||null},lastBandwidthSelector:VE,movingAverageBandwidthSelector:function(a){let s=-1,r=-1;if(a<0||1<a)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var l=this.useDevicePixelRatio&&window.devicePixelRatio||1;return s<0&&(s=this.systemBandwidth,r=this.systemBandwidth),0<this.systemBandwidth&&this.systemBandwidth!==r&&(s=a*this.systemBandwidth+(1-a)*s,r=this.systemBandwidth),HE(this.playlists.main,s,parseInt(sp(this.tech_.el(),"width"),10)*l,parseInt(sp(this.tech_.el(),"height"),10)*l,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:V_,comparePlaylistResolution:function(a,s){let r,l;return r=(r=a.attributes.RESOLUTION&&a.attributes.RESOLUTION.width?a.attributes.RESOLUTION.width:r)||window.Number.MAX_VALUE,l=(l=s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width?s.attributes.RESOLUTION.width:l)||window.Number.MAX_VALUE,r===l&&a.attributes.BANDWIDTH&&s.attributes.BANDWIDTH?a.attributes.BANDWIDTH-s.attributes.BANDWIDTH:r-l},xhr:vE()},oS=(Object.keys(Yi).forEach(a=>{Object.defineProperty(Cs,a,{get(){return fe.log.warn(`using Vhs.${a} is UNSAFE be sure you know what you are doing`),Yi[a]},set(s){fe.log.warn(`using Vhs.${a} is UNSAFE be sure you know what you are doing`),typeof s!="number"||s<0?fe.log.warn(`value of Vhs.${a} must be greater than or equal to 0`):Yi[a]=s}})}),"videojs-vhs"),NP=(Cs.canPlaySource=function(){return fe.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},({player:a,sourceKeySystems:s,audioMedia:f,mainPlaylists:l})=>{if(!a.eme.initializeMediaKeys)return Promise.resolve();var d,f=f?l.concat([f]):l,f=(l=f,d=Object.keys(s),l.reduce((S,A)=>{var P;return A.contentProtection&&(P=d.reduce((L,B)=>{var F=A.contentProtection[B];return F&&F.pssh&&(L[B]={pssh:F.pssh}),L},{}),Object.keys(P).length)&&S.push(P),S},[]));const p=[],y=[];return f.forEach(S=>{y.push(new Promise((A,P)=>{a.tech_.one("keysessioncreated",A)})),p.push(new Promise((A,P)=>{a.eme.initializeMediaKeys({keySystems:S},L=>{L?P(L):A()})}))}),Promise.race([Promise.all(p),Promise.race(y)])}),RP=({player:a,sourceKeySystems:s,media:r,audioMedia:l})=>(s=((d,f,p)=>{if(!d)return d;let y={};f&&f.attributes&&f.attributes.CODECS&&(y=np(hr(f.attributes.CODECS))),p&&p.attributes&&p.attributes.CODECS&&(y.audio=p.attributes.CODECS);var S=sd(y.video),A=sd(y.audio),P={};for(const L in d)P[L]={},A&&(P[L].audioContentType=A),S&&(P[L].videoContentType=S),f.contentProtection&&f.contentProtection[L]&&f.contentProtection[L].pssh&&(P[L].pssh=f.contentProtection[L].pssh),typeof d[L]=="string"&&(P[L].url=d[L]);return oi(d,P)})(s,r,l),!(!s||(a.currentSource().keySystems=s)&&!a.eme&&(fe.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),1))),lS=()=>{if(!window.localStorage)return null;var a=window.localStorage.getItem(oS);if(!a)return null;try{return JSON.parse(a)}catch{return null}};Cs.supportsNativeHls=function(){if(!document||!document.createElement)return!1;const a=document.createElement("video");return!!fe.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(s){return/maybe|probably/i.test(a.canPlayType(s))})}(),Cs.supportsNativeDash=!!(document&&document.createElement&&fe.getTech("Html5").isSupported())&&/maybe|probably/i.test(document.createElement("video").canPlayType("application/dash+xml")),Cs.supportsTypeNatively=a=>a==="hls"?Cs.supportsNativeHls:a==="dash"&&Cs.supportsNativeDash,Cs.isSupported=function(){return fe.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};class uS extends fe.getComponent("Component"){constructor(s,r,l){if(super(r,l.vhs),typeof l.initialBandwidth=="number"&&(this.options_.bandwidth=l.initialBandwidth),this.logger_=qn("VhsHandler"),r.options_&&r.options_.playerId&&(l=fe.getPlayer(r.options_.playerId),this.player_=l),this.tech_=r,this.source_=s,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks)r.overrideNativeAudioTracks(!0),r.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(document,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],d=>{var f=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;f&&f.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){var s;this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=300),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage&&((s=lS())&&s.bandwidth&&(this.options_.bandwidth=s.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),s)&&s.throughput&&(this.options_.throughput=s.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"})),typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Yi.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Yi.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(r=>{typeof this.source_[r]<"u"&&(this.options_[r]=this.source_[r])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(s,r){s&&(this.setOptions_(),this.options_.src=(s=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(s.substring(s.indexOf(",")+1)):s,this.options_.tech=this.tech_,this.options_.externVhs=Cs,this.options_.sourceType=ZT(r),this.options_.seekTo=l=>{this.tech_.setCurrentTime(l)},this.playlistController_=new OP(this.options_),s=oi({liveRangeSafeTimeDelta:mr},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_}),this.playbackWatcher_=new PP(s),this.playlistController_.on("error",()=>{var l=fe.players[this.tech_.options_.playerId];let d=this.playlistController_.error;typeof d!="object"||d.code?typeof d=="string"&&(d={message:d,code:3}):d.code=3,l.error(d)}),r=this.options_.bufferBasedABR?Cs.movingAverageBandwidthSelector(.55):Cs.STANDARD_PLAYLIST_SELECTOR,this.playlistController_.selectPlaylist=(this.selectPlaylist||r).bind(this),this.playlistController_.selectInitialPlaylist=Cs.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(l){this.playlistController_.selectPlaylist=l.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(l){this.playlistController_.mainSegmentLoader_.throughput.rate=l,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let l=this.playlistController_.mainSegmentLoader_.bandwidth;var d=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return this.options_.useNetworkInformationApi&&d&&(d=1e3*d.downlink*1e3,l=1e7<=d&&1e7<=l?Math.max(l,d):d),l},set(l){this.playlistController_.mainSegmentLoader_.bandwidth=l,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){var l=1/(this.bandwidth||1);let d;return d=0<this.throughput?1/this.throughput:0,Math.floor(1/(l+d))},set(){fe.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>No(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>No(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{if(this.options_.useBandwidthFromLocalStorage){var l={bandwidth:this.bandwidth,throughput:Math.round(this.throughput)};if(window.localStorage){var d=(d=lS())?oi(d,l):l;try{window.localStorage.setItem(oS,JSON.stringify(d))}catch{return}}}}),this.playlistController_.on("selectedinitialmedia",()=>{var l;(l=this).representations=()=>{var d=l.playlistController_.main(),d=vd(d)?l.playlistController_.getAudioTrackPlaylists_():d.playlists;return d?d.filter(f=>!N_(f)).map((f,p)=>new DP(l,f,f.id)):[]}}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el())&&(this.mediaSourceUrl_=window.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){var s=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),NP({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:s&&s.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(r=>{this.logger_("error while creating EME key session",r),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){var s=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,s=RP({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:s&&s.media()});this.player_.tech_.on("keystatuschange",r=>{if(r.status==="output-restricted"&&(r=this.playlistController_.main(),r&&r.playlists)){const l=[];r.playlists.forEach(d=>{d&&d.attributes&&d.attributes.RESOLUTION&&720<=d.attributes.RESOLUTION.height&&(!d.excludeUntil||d.excludeUntil<1/0)&&(d.excludeUntil=1/0,l.push(d))}),l.length&&(fe.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...l),this.playlistController_.fastQualityChange_())}}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),fe.browser.IE_VERSION!==11&&s?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){var s=fe.players[this.tech_.options_.playerId];s&&s.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=s.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{var r,l;r=this.qualityLevels_,(l=this).representations().forEach(d=>{r.addQualityLevel(d)}),aS(r,l.playlists)}),this.playlists.on("mediachange",()=>{aS(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":"3.0.0","mux.js":"6.2.0","mpd-parser":"1.0.1","m3u8-parser":"6.0.0","aes-decrypter":"4.0.1"}}version(){return this.constructor.version()}canChangeType(){return QE.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(s){this.playlistController_.setCurrentTime(s)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&window.URL.revokeObjectURL&&(window.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(s,r){return eP({playlist:this.playlistController_.media(),time:s,callback:r})}seekToProgramTime(s,r,l=!0,d=2){return xE({programTime:s,playlist:this.playlistController_.media(),retryCount:d,pauseAfterSeek:l,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:r})}}const X_={name:"videojs-http-streaming",VERSION:"3.0.0",canHandleSource(a,s={}){return s=oi(fe.options,s),X_.canPlayType(a.type,s)},handleSource(a,s,r={}){return r=oi(fe.options,r),s.vhs=new uS(a,s,r),s.vhs.xhr=vE(),s.vhs.src(a.src,a.type),s.vhs},canPlayType(l,r={}){var{vhs:{overrideNative:r=!fe.browser.IS_ANY_SAFARI}={}}=oi(fe.options,r),l=ZT(l);return l&&(!Cs.supportsTypeNatively(l)||r)?"maybe":""}};return Mf("avc1.4d400d,mp4a.40.2")&&fe.getTech("Html5").registerSourceHandler(X_,0),fe.VhsHandler=uS,fe.VhsSourceHandler=X_,fe.Vhs=Cs,fe.use||fe.registerComponent("Vhs",Cs),fe.options.vhs=fe.options.vhs||{},fe.getPlugin&&fe.getPlugin("reloadSourceOnError")||fe.registerPlugin("reloadSourceOnError",function(a){rS(this,a)}),fe})})(b3);function kT(t,e){const i=Object.create(null),n=t.split(",");for(let o=0;o<n.length;o++)i[n[o]]=!0;return e?o=>!!i[o.toLowerCase()]:o=>!!i[o]}function IT(t){if(vt(t)){const e={};for(let i=0;i<t.length;i++){const n=t[i],o=Wi(n)?w3(n):IT(n);if(o)for(const u in o)e[u]=o[u]}return e}else{if(Wi(t))return t;if(pi(t))return t}}const E3=/;(?![^(]*\))/g,S3=/:([^]+)/,x3=/\/\*.*?\*\//gs;function w3(t){const e={};return t.replace(x3,"").split(E3).forEach(i=>{if(i){const n=i.split(S3);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function OT(t){let e="";if(Wi(t))e=t;else if(vt(t))for(let i=0;i<t.length;i++){const n=OT(t[i]);n&&(e+=n+" ")}else if(pi(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const C3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",A3=kT(C3);function RI(t){return!!t||t===""}function k3(t,e){if(t.length!==e.length)return!1;let i=!0;for(let n=0;i&&n<t.length;n++)i=bg(t[n],e[n]);return i}function bg(t,e){if(t===e)return!0;let i=Fw(t),n=Fw(e);if(i||n)return i&&n?t.getTime()===e.getTime():!1;if(i=vh(t),n=vh(e),i||n)return t===e;if(i=vt(t),n=vt(e),i||n)return i&&n?k3(t,e):!1;if(i=pi(t),n=pi(e),i||n){if(!i||!n)return!1;const o=Object.keys(t).length,u=Object.keys(e).length;if(o!==u)return!1;for(const c in t){const h=t.hasOwnProperty(c),m=e.hasOwnProperty(c);if(h&&!m||!h&&m||!bg(t[c],e[c]))return!1}}return String(t)===String(e)}function I3(t,e){return t.findIndex(i=>bg(i,e))}const ra=t=>Wi(t)?t:t==null?"":vt(t)||pi(t)&&(t.toString===BI||!Ot(t.toString))?JSON.stringify(t,MI,2):String(t),MI=(t,e)=>e&&e.__v_isRef?MI(t,e.value):Mu(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[n,o])=>(i[`${n} =>`]=o,i),{})}:Sg(e)?{[`Set(${e.size})`]:[...e.values()]}:pi(e)&&!vt(e)&&!FI(e)?String(e):e,yi={},Ru=[],ir=()=>{},O3=()=>!1,D3=/^on[^a-z]/,Eg=t=>D3.test(t),DT=t=>t.startsWith("onUpdate:"),Ts=Object.assign,PT=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},P3=Object.prototype.hasOwnProperty,jt=(t,e)=>P3.call(t,e),vt=Array.isArray,Mu=t=>Hh(t)==="[object Map]",Sg=t=>Hh(t)==="[object Set]",Fw=t=>Hh(t)==="[object Date]",Ot=t=>typeof t=="function",Wi=t=>typeof t=="string",vh=t=>typeof t=="symbol",pi=t=>t!==null&&typeof t=="object",UI=t=>pi(t)&&Ot(t.then)&&Ot(t.catch),BI=Object.prototype.toString,Hh=t=>BI.call(t),L3=t=>Hh(t).slice(8,-1),FI=t=>Hh(t)==="[object Object]",LT=t=>Wi(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,em=kT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),xg=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},N3=/-(\w)/g,sc=xg(t=>t.replace(N3,(e,i)=>i?i.toUpperCase():"")),R3=/\B([A-Z])/g,vc=xg(t=>t.replace(R3,"-$1").toLowerCase()),$I=xg(t=>t.charAt(0).toUpperCase()+t.slice(1)),Qy=xg(t=>t?`on${$I(t)}`:""),Th=(t,e)=>!Object.is(t,e),tm=(t,e)=>{for(let i=0;i<t.length;i++)t[i](e)},Bm=(t,e,i)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:i})},jI=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let $w;const M3=()=>$w||($w=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Xn;class U3{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Xn,!e&&Xn&&(this.index=(Xn.scopes||(Xn.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const i=Xn;try{return Xn=this,e()}finally{Xn=i}}}on(){Xn=this}off(){Xn=this.parent}stop(e){if(this._active){let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.scopes)for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this._active=!1}}}function B3(t,e=Xn){e&&e.active&&e.effects.push(t)}function F3(){return Xn}const NT=t=>{const e=new Set(t);return e.w=0,e.n=0,e},HI=t=>(t.w&so)>0,VI=t=>(t.n&so)>0,$3=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=so},j3=t=>{const{deps:e}=t;if(e.length){let i=0;for(let n=0;n<e.length;n++){const o=e[n];HI(o)&&!VI(o)?o.delete(t):e[i++]=o,o.w&=~so,o.n&=~so}e.length=i}},V0=new WeakMap;let Yd=0,so=1;const q0=30;let Jn;const tl=Symbol(""),W0=Symbol("");class RT{constructor(e,i=null,n){this.fn=e,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,B3(this,n)}run(){if(!this.active)return this.fn();let e=Jn,i=Ka;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Jn,Jn=this,Ka=!0,so=1<<++Yd,Yd<=q0?$3(this):jw(this),this.fn()}finally{Yd<=q0&&j3(this),so=1<<--Yd,Jn=this.parent,Ka=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Jn===this?this.deferStop=!0:this.active&&(jw(this),this.onStop&&this.onStop(),this.active=!1)}}function jw(t){const{deps:e}=t;if(e.length){for(let i=0;i<e.length;i++)e[i].delete(t);e.length=0}}let Ka=!0;const qI=[];function Tc(){qI.push(Ka),Ka=!1}function bc(){const t=qI.pop();Ka=t===void 0?!0:t}function Qs(t,e,i){if(Ka&&Jn){let n=V0.get(t);n||V0.set(t,n=new Map);let o=n.get(i);o||n.set(i,o=NT()),WI(o)}}function WI(t,e){let i=!1;Yd<=q0?VI(t)||(t.n|=so,i=!HI(t)):i=!t.has(Jn),i&&(t.add(Jn),Jn.deps.push(t))}function Sa(t,e,i,n,o,u){const c=V0.get(t);if(!c)return;let h=[];if(e==="clear")h=[...c.values()];else if(i==="length"&&vt(t)){const m=Number(n);c.forEach((v,T)=>{(T==="length"||T>=m)&&h.push(v)})}else switch(i!==void 0&&h.push(c.get(i)),e){case"add":vt(t)?LT(i)&&h.push(c.get("length")):(h.push(c.get(tl)),Mu(t)&&h.push(c.get(W0)));break;case"delete":vt(t)||(h.push(c.get(tl)),Mu(t)&&h.push(c.get(W0)));break;case"set":Mu(t)&&h.push(c.get(tl));break}if(h.length===1)h[0]&&G0(h[0]);else{const m=[];for(const v of h)v&&m.push(...v);G0(NT(m))}}function G0(t,e){const i=vt(t)?t:[...t];for(const n of i)n.computed&&Hw(n);for(const n of i)n.computed||Hw(n)}function Hw(t,e){(t!==Jn||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const H3=kT("__proto__,__v_isRef,__isVue"),GI=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(vh)),V3=MT(),q3=MT(!1,!0),W3=MT(!0),Vw=G3();function G3(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...i){const n=Kt(this);for(let u=0,c=this.length;u<c;u++)Qs(n,"get",u+"");const o=n[e](...i);return o===-1||o===!1?n[e](...i.map(Kt)):o}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...i){Tc();const n=Kt(this)[e].apply(this,i);return bc(),n}}),t}function z3(t){const e=Kt(this);return Qs(e,"has",t),e.hasOwnProperty(t)}function MT(t=!1,e=!1){return function(n,o,u){if(o==="__v_isReactive")return!t;if(o==="__v_isReadonly")return t;if(o==="__v_isShallow")return e;if(o==="__v_raw"&&u===(t?e?u6:QI:e?YI:XI).get(n))return n;const c=vt(n);if(!t){if(c&&jt(Vw,o))return Reflect.get(Vw,o,u);if(o==="hasOwnProperty")return z3}const h=Reflect.get(n,o,u);return(vh(o)?GI.has(o):H3(o))||(t||Qs(n,"get",o),e)?h:ys(h)?c&&LT(o)?h:h.value:pi(h)?t?JI(h):Vh(h):h}}const K3=zI(),X3=zI(!0);function zI(t=!1){return function(i,n,o,u){let c=i[n];if(nc(c)&&ys(c)&&!ys(o))return!1;if(!t&&(!Fm(o)&&!nc(o)&&(c=Kt(c),o=Kt(o)),!vt(i)&&ys(c)&&!ys(o)))return c.value=o,!0;const h=vt(i)&&LT(n)?Number(n)<i.length:jt(i,n),m=Reflect.set(i,n,o,u);return i===Kt(u)&&(h?Th(o,c)&&Sa(i,"set",n,o):Sa(i,"add",n,o)),m}}function Y3(t,e){const i=jt(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&i&&Sa(t,"delete",e,void 0),n}function Q3(t,e){const i=Reflect.has(t,e);return(!vh(e)||!GI.has(e))&&Qs(t,"has",e),i}function J3(t){return Qs(t,"iterate",vt(t)?"length":tl),Reflect.ownKeys(t)}const KI={get:V3,set:K3,deleteProperty:Y3,has:Q3,ownKeys:J3},Z3={get:W3,set(t,e){return!0},deleteProperty(t,e){return!0}},e6=Ts({},KI,{get:q3,set:X3}),UT=t=>t,wg=t=>Reflect.getPrototypeOf(t);function jp(t,e,i=!1,n=!1){t=t.__v_raw;const o=Kt(t),u=Kt(e);i||(e!==u&&Qs(o,"get",e),Qs(o,"get",u));const{has:c}=wg(o),h=n?UT:i?$T:bh;if(c.call(o,e))return h(t.get(e));if(c.call(o,u))return h(t.get(u));t!==o&&t.get(e)}function Hp(t,e=!1){const i=this.__v_raw,n=Kt(i),o=Kt(t);return e||(t!==o&&Qs(n,"has",t),Qs(n,"has",o)),t===o?i.has(t):i.has(t)||i.has(o)}function Vp(t,e=!1){return t=t.__v_raw,!e&&Qs(Kt(t),"iterate",tl),Reflect.get(t,"size",t)}function qw(t){t=Kt(t);const e=Kt(this);return wg(e).has.call(e,t)||(e.add(t),Sa(e,"add",t,t)),this}function Ww(t,e){e=Kt(e);const i=Kt(this),{has:n,get:o}=wg(i);let u=n.call(i,t);u||(t=Kt(t),u=n.call(i,t));const c=o.call(i,t);return i.set(t,e),u?Th(e,c)&&Sa(i,"set",t,e):Sa(i,"add",t,e),this}function Gw(t){const e=Kt(this),{has:i,get:n}=wg(e);let o=i.call(e,t);o||(t=Kt(t),o=i.call(e,t)),n&&n.call(e,t);const u=e.delete(t);return o&&Sa(e,"delete",t,void 0),u}function zw(){const t=Kt(this),e=t.size!==0,i=t.clear();return e&&Sa(t,"clear",void 0,void 0),i}function qp(t,e){return function(n,o){const u=this,c=u.__v_raw,h=Kt(c),m=e?UT:t?$T:bh;return!t&&Qs(h,"iterate",tl),c.forEach((v,T)=>n.call(o,m(v),m(T),u))}}function Wp(t,e,i){return function(...n){const o=this.__v_raw,u=Kt(o),c=Mu(u),h=t==="entries"||t===Symbol.iterator&&c,m=t==="keys"&&c,v=o[t](...n),T=i?UT:e?$T:bh;return!e&&Qs(u,"iterate",m?W0:tl),{next(){const{value:O,done:R}=v.next();return R?{value:O,done:R}:{value:h?[T(O[0]),T(O[1])]:T(O),done:R}},[Symbol.iterator](){return this}}}}function Va(t){return function(...e){return t==="delete"?!1:this}}function t6(){const t={get(u){return jp(this,u)},get size(){return Vp(this)},has:Hp,add:qw,set:Ww,delete:Gw,clear:zw,forEach:qp(!1,!1)},e={get(u){return jp(this,u,!1,!0)},get size(){return Vp(this)},has:Hp,add:qw,set:Ww,delete:Gw,clear:zw,forEach:qp(!1,!0)},i={get(u){return jp(this,u,!0)},get size(){return Vp(this,!0)},has(u){return Hp.call(this,u,!0)},add:Va("add"),set:Va("set"),delete:Va("delete"),clear:Va("clear"),forEach:qp(!0,!1)},n={get(u){return jp(this,u,!0,!0)},get size(){return Vp(this,!0)},has(u){return Hp.call(this,u,!0)},add:Va("add"),set:Va("set"),delete:Va("delete"),clear:Va("clear"),forEach:qp(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{t[u]=Wp(u,!1,!1),i[u]=Wp(u,!0,!1),e[u]=Wp(u,!1,!0),n[u]=Wp(u,!0,!0)}),[t,i,e,n]}const[i6,s6,n6,r6]=t6();function BT(t,e){const i=e?t?r6:n6:t?s6:i6;return(n,o,u)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(jt(i,o)&&o in n?i:n,o,u)}const a6={get:BT(!1,!1)},o6={get:BT(!1,!0)},l6={get:BT(!0,!1)},XI=new WeakMap,YI=new WeakMap,QI=new WeakMap,u6=new WeakMap;function c6(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function d6(t){return t.__v_skip||!Object.isExtensible(t)?0:c6(L3(t))}function Vh(t){return nc(t)?t:FT(t,!1,KI,a6,XI)}function h6(t){return FT(t,!1,e6,o6,YI)}function JI(t){return FT(t,!0,Z3,l6,QI)}function FT(t,e,i,n,o){if(!pi(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const u=o.get(t);if(u)return u;const c=d6(t);if(c===0)return t;const h=new Proxy(t,c===2?n:i);return o.set(t,h),h}function Uu(t){return nc(t)?Uu(t.__v_raw):!!(t&&t.__v_isReactive)}function nc(t){return!!(t&&t.__v_isReadonly)}function Fm(t){return!!(t&&t.__v_isShallow)}function ZI(t){return Uu(t)||nc(t)}function Kt(t){const e=t&&t.__v_raw;return e?Kt(e):t}function eO(t){return Bm(t,"__v_skip",!0),t}const bh=t=>pi(t)?Vh(t):t,$T=t=>pi(t)?JI(t):t;function tO(t){Ka&&Jn&&(t=Kt(t),WI(t.dep||(t.dep=NT())))}function iO(t,e){t=Kt(t);const i=t.dep;i&&G0(i)}function ys(t){return!!(t&&t.__v_isRef===!0)}function f6(t){return sO(t,!1)}function p6(t){return sO(t,!0)}function sO(t,e){return ys(t)?t:new m6(t,e)}class m6{constructor(e,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?e:Kt(e),this._value=i?e:bh(e)}get value(){return tO(this),this._value}set value(e){const i=this.__v_isShallow||Fm(e)||nc(e);e=i?e:Kt(e),Th(e,this._rawValue)&&(this._rawValue=e,this._value=i?e:bh(e),iO(this))}}function Xa(t){return ys(t)?t.value:t}const g6={get:(t,e,i)=>Xa(Reflect.get(t,e,i)),set:(t,e,i,n)=>{const o=t[e];return ys(o)&&!ys(i)?(o.value=i,!0):Reflect.set(t,e,i,n)}};function nO(t){return Uu(t)?t:new Proxy(t,g6)}var rO;class _6{constructor(e,i,n,o){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this[rO]=!1,this._dirty=!0,this.effect=new RT(e,()=>{this._dirty||(this._dirty=!0,iO(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const e=Kt(this);return tO(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}rO="__v_isReadonly";function y6(t,e,i=!1){let n,o;const u=Ot(t);return u?(n=t,o=ir):(n=t.get,o=t.set),new _6(n,o,u||!o,i)}function Ya(t,e,i,n){let o;try{o=n?t(...n):t()}catch(u){Cg(u,e,i)}return o}function In(t,e,i,n){if(Ot(t)){const u=Ya(t,e,i,n);return u&&UI(u)&&u.catch(c=>{Cg(c,e,i)}),u}const o=[];for(let u=0;u<t.length;u++)o.push(In(t[u],e,i,n));return o}function Cg(t,e,i,n=!0){const o=e?e.vnode:null;if(e){let u=e.parent;const c=e.proxy,h=i;for(;u;){const v=u.ec;if(v){for(let T=0;T<v.length;T++)if(v[T](t,c,h)===!1)return}u=u.parent}const m=e.appContext.config.errorHandler;if(m){Ya(m,null,10,[t,c,h]);return}}v6(t,i,o,n)}function v6(t,e,i,n=!0){console.error(t)}let Eh=!1,z0=!1;const gs=[];let Sr=0;const Bu=[];let aa=null,qo=0;const aO=Promise.resolve();let jT=null;function oO(t){const e=jT||aO;return t?e.then(this?t.bind(this):t):e}function T6(t){let e=Sr+1,i=gs.length;for(;e<i;){const n=e+i>>>1;Sh(gs[n])<t?e=n+1:i=n}return e}function HT(t){(!gs.length||!gs.includes(t,Eh&&t.allowRecurse?Sr+1:Sr))&&(t.id==null?gs.push(t):gs.splice(T6(t.id),0,t),lO())}function lO(){!Eh&&!z0&&(z0=!0,jT=aO.then(cO))}function b6(t){const e=gs.indexOf(t);e>Sr&&gs.splice(e,1)}function E6(t){vt(t)?Bu.push(...t):(!aa||!aa.includes(t,t.allowRecurse?qo+1:qo))&&Bu.push(t),lO()}function Kw(t,e=Eh?Sr+1:0){for(;e<gs.length;e++){const i=gs[e];i&&i.pre&&(gs.splice(e,1),e--,i())}}function uO(t){if(Bu.length){const e=[...new Set(Bu)];if(Bu.length=0,aa){aa.push(...e);return}for(aa=e,aa.sort((i,n)=>Sh(i)-Sh(n)),qo=0;qo<aa.length;qo++)aa[qo]();aa=null,qo=0}}const Sh=t=>t.id==null?1/0:t.id,S6=(t,e)=>{const i=Sh(t)-Sh(e);if(i===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return i};function cO(t){z0=!1,Eh=!0,gs.sort(S6);const e=ir;try{for(Sr=0;Sr<gs.length;Sr++){const i=gs[Sr];i&&i.active!==!1&&Ya(i,null,14)}}finally{Sr=0,gs.length=0,uO(),Eh=!1,jT=null,(gs.length||Bu.length)&&cO()}}function x6(t,e,...i){if(t.isUnmounted)return;const n=t.vnode.props||yi;let o=i;const u=e.startsWith("update:"),c=u&&e.slice(7);if(c&&c in n){const T=`${c==="modelValue"?"model":c}Modifiers`,{number:O,trim:R}=n[T]||yi;R&&(o=i.map(M=>Wi(M)?M.trim():M)),O&&(o=i.map(jI))}let h,m=n[h=Qy(e)]||n[h=Qy(sc(e))];!m&&u&&(m=n[h=Qy(vc(e))]),m&&In(m,t,6,o);const v=n[h+"Once"];if(v){if(!t.emitted)t.emitted={};else if(t.emitted[h])return;t.emitted[h]=!0,In(v,t,6,o)}}function dO(t,e,i=!1){const n=e.emitsCache,o=n.get(t);if(o!==void 0)return o;const u=t.emits;let c={},h=!1;if(!Ot(t)){const m=v=>{const T=dO(v,e,!0);T&&(h=!0,Ts(c,T))};!i&&e.mixins.length&&e.mixins.forEach(m),t.extends&&m(t.extends),t.mixins&&t.mixins.forEach(m)}return!u&&!h?(pi(t)&&n.set(t,null),null):(vt(u)?u.forEach(m=>c[m]=null):Ts(c,u),pi(t)&&n.set(t,c),c)}function Ag(t,e){return!t||!Eg(e)?!1:(e=e.slice(2).replace(/Once$/,""),jt(t,e[0].toLowerCase()+e.slice(1))||jt(t,vc(e))||jt(t,e))}let Cn=null,hO=null;function $m(t){const e=Cn;return Cn=t,hO=t&&t.type.__scopeId||null,e}function fO(t,e=Cn,i){if(!e||t._n)return t;const n=(...o)=>{n._d&&sC(-1);const u=$m(e);let c;try{c=t(...o)}finally{$m(u),n._d&&sC(1)}return c};return n._n=!0,n._c=!0,n._d=!0,n}function Jy(t){const{type:e,vnode:i,proxy:n,withProxy:o,props:u,propsOptions:[c],slots:h,attrs:m,emit:v,render:T,renderCache:O,data:R,setupState:M,ctx:z,inheritAttrs:j}=t;let q,W;const ee=$m(t);try{if(i.shapeFlag&4){const re=o||n;q=Er(T.call(re,re,O,u,M,R,z)),W=m}else{const re=e;q=Er(re.length>1?re(u,{attrs:m,slots:h,emit:v}):re(u,null)),W=e.props?m:w6(m)}}catch(re){ah.length=0,Cg(re,t,1),q=gn(ga)}let se=q;if(W&&j!==!1){const re=Object.keys(W),{shapeFlag:ie}=se;re.length&&ie&7&&(c&&re.some(DT)&&(W=C6(W,c)),se=no(se,W))}return i.dirs&&(se=no(se),se.dirs=se.dirs?se.dirs.concat(i.dirs):i.dirs),i.transition&&(se.transition=i.transition),q=se,$m(ee),q}const w6=t=>{let e;for(const i in t)(i==="class"||i==="style"||Eg(i))&&((e||(e={}))[i]=t[i]);return e},C6=(t,e)=>{const i={};for(const n in t)(!DT(n)||!(n.slice(9)in e))&&(i[n]=t[n]);return i};function A6(t,e,i){const{props:n,children:o,component:u}=t,{props:c,children:h,patchFlag:m}=e,v=u.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&m>=0){if(m&1024)return!0;if(m&16)return n?Xw(n,c,v):!!c;if(m&8){const T=e.dynamicProps;for(let O=0;O<T.length;O++){const R=T[O];if(c[R]!==n[R]&&!Ag(v,R))return!0}}}else return(o||h)&&(!h||!h.$stable)?!0:n===c?!1:n?c?Xw(n,c,v):!0:!!c;return!1}function Xw(t,e,i){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const u=n[o];if(e[u]!==t[u]&&!Ag(i,u))return!0}return!1}function k6({vnode:t,parent:e},i){for(;e&&e.subTree===t;)(t=e.vnode).el=i,e=e.parent}const I6=t=>t.__isSuspense;function O6(t,e){e&&e.pendingBranch?vt(t)?e.effects.push(...t):e.effects.push(t):E6(t)}function im(t,e){if(Bi){let i=Bi.provides;const n=Bi.parent&&Bi.parent.provides;n===i&&(i=Bi.provides=Object.create(n)),i[t]=e}}function ma(t,e,i=!1){const n=Bi||Cn;if(n){const o=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return i&&Ot(e)?e.call(n.proxy):e}}const Gp={};function sm(t,e,i){return pO(t,e,i)}function pO(t,e,{immediate:i,deep:n,flush:o,onTrack:u,onTrigger:c}=yi){const h=F3()===(Bi==null?void 0:Bi.scope)?Bi:null;let m,v=!1,T=!1;if(ys(t)?(m=()=>t.value,v=Fm(t)):Uu(t)?(m=()=>t,n=!0):vt(t)?(T=!0,v=t.some(se=>Uu(se)||Fm(se)),m=()=>t.map(se=>{if(ys(se))return se.value;if(Uu(se))return Yo(se);if(Ot(se))return Ya(se,h,2)})):Ot(t)?e?m=()=>Ya(t,h,2):m=()=>{if(!(h&&h.isUnmounted))return O&&O(),In(t,h,3,[R])}:m=ir,e&&n){const se=m;m=()=>Yo(se())}let O,R=se=>{O=W.onStop=()=>{Ya(se,h,4)}},M;if(wh)if(R=ir,e?i&&In(e,h,3,[m(),T?[]:void 0,R]):m(),o==="sync"){const se=wH();M=se.__watcherHandles||(se.__watcherHandles=[])}else return ir;let z=T?new Array(t.length).fill(Gp):Gp;const j=()=>{if(W.active)if(e){const se=W.run();(n||v||(T?se.some((re,ie)=>Th(re,z[ie])):Th(se,z)))&&(O&&O(),In(e,h,3,[se,z===Gp?void 0:T&&z[0]===Gp?[]:z,R]),z=se)}else W.run()};j.allowRecurse=!!e;let q;o==="sync"?q=j:o==="post"?q=()=>Gs(j,h&&h.suspense):(j.pre=!0,h&&(j.id=h.uid),q=()=>HT(j));const W=new RT(m,q);e?i?j():z=W.run():o==="post"?Gs(W.run.bind(W),h&&h.suspense):W.run();const ee=()=>{W.stop(),h&&h.scope&&PT(h.scope.effects,W)};return M&&M.push(ee),ee}function D6(t,e,i){const n=this.proxy,o=Wi(t)?t.includes(".")?mO(n,t):()=>n[t]:t.bind(n,n);let u;Ot(e)?u=e:(u=e.handler,i=e);const c=Bi;rc(this);const h=pO(o,u.bind(n),i);return c?rc(c):nl(),h}function mO(t,e){const i=e.split(".");return()=>{let n=t;for(let o=0;o<i.length&&n;o++)n=n[i[o]];return n}}function Yo(t,e){if(!pi(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),ys(t))Yo(t.value,e);else if(vt(t))for(let i=0;i<t.length;i++)Yo(t[i],e);else if(Sg(t)||Mu(t))t.forEach(i=>{Yo(i,e)});else if(FI(t))for(const i in t)Yo(t[i],e);return t}function P6(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return TO(()=>{t.isMounted=!0}),bO(()=>{t.isUnmounting=!0}),t}const xn=[Function,Array],L6={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xn,onEnter:xn,onAfterEnter:xn,onEnterCancelled:xn,onBeforeLeave:xn,onLeave:xn,onAfterLeave:xn,onLeaveCancelled:xn,onBeforeAppear:xn,onAppear:xn,onAfterAppear:xn,onAppearCancelled:xn},setup(t,{slots:e}){const i=yH(),n=P6();let o;return()=>{const u=e.default&&_O(e.default(),!0);if(!u||!u.length)return;let c=u[0];if(u.length>1){for(const j of u)if(j.type!==ga){c=j;break}}const h=Kt(t),{mode:m}=h;if(n.isLeaving)return Zy(c);const v=Yw(c);if(!v)return Zy(c);const T=K0(v,h,n,i);X0(v,T);const O=i.subTree,R=O&&Yw(O);let M=!1;const{getTransitionKey:z}=v.type;if(z){const j=z();o===void 0?o=j:j!==o&&(o=j,M=!0)}if(R&&R.type!==ga&&(!Wo(v,R)||M)){const j=K0(R,h,n,i);if(X0(R,j),m==="out-in")return n.isLeaving=!0,j.afterLeave=()=>{n.isLeaving=!1,i.update.active!==!1&&i.update()},Zy(c);m==="in-out"&&v.type!==ga&&(j.delayLeave=(q,W,ee)=>{const se=gO(n,R);se[String(R.key)]=R,q._leaveCb=()=>{W(),q._leaveCb=void 0,delete T.delayedLeave},T.delayedLeave=ee})}return c}}},N6=L6;function gO(t,e){const{leavingVNodes:i}=t;let n=i.get(e.type);return n||(n=Object.create(null),i.set(e.type,n)),n}function K0(t,e,i,n){const{appear:o,mode:u,persisted:c=!1,onBeforeEnter:h,onEnter:m,onAfterEnter:v,onEnterCancelled:T,onBeforeLeave:O,onLeave:R,onAfterLeave:M,onLeaveCancelled:z,onBeforeAppear:j,onAppear:q,onAfterAppear:W,onAppearCancelled:ee}=e,se=String(t.key),re=gO(i,t),ie=(Ie,Be)=>{Ie&&In(Ie,n,9,Be)},ye=(Ie,Be)=>{const Ve=Be[1];ie(Ie,Be),vt(Ie)?Ie.every(We=>We.length<=1)&&Ve():Ie.length<=1&&Ve()},Pe={mode:u,persisted:c,beforeEnter(Ie){let Be=h;if(!i.isMounted)if(o)Be=j||h;else return;Ie._leaveCb&&Ie._leaveCb(!0);const Ve=re[se];Ve&&Wo(t,Ve)&&Ve.el._leaveCb&&Ve.el._leaveCb(),ie(Be,[Ie])},enter(Ie){let Be=m,Ve=v,We=T;if(!i.isMounted)if(o)Be=q||m,Ve=W||v,We=ee||T;else return;let it=!1;const Le=Ie._enterCb=ct=>{it||(it=!0,ct?ie(We,[Ie]):ie(Ve,[Ie]),Pe.delayedLeave&&Pe.delayedLeave(),Ie._enterCb=void 0)};Be?ye(Be,[Ie,Le]):Le()},leave(Ie,Be){const Ve=String(t.key);if(Ie._enterCb&&Ie._enterCb(!0),i.isUnmounting)return Be();ie(O,[Ie]);let We=!1;const it=Ie._leaveCb=Le=>{We||(We=!0,Be(),Le?ie(z,[Ie]):ie(M,[Ie]),Ie._leaveCb=void 0,re[Ve]===t&&delete re[Ve])};re[Ve]=t,R?ye(R,[Ie,it]):it()},clone(Ie){return K0(Ie,e,i,n)}};return Pe}function Zy(t){if(kg(t))return t=no(t),t.children=null,t}function Yw(t){return kg(t)?t.children?t.children[0]:void 0:t}function X0(t,e){t.shapeFlag&6&&t.component?X0(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function _O(t,e=!1,i){let n=[],o=0;for(let u=0;u<t.length;u++){let c=t[u];const h=i==null?c.key:String(i)+String(c.key!=null?c.key:u);c.type===pn?(c.patchFlag&128&&o++,n=n.concat(_O(c.children,e,h))):(e||c.type!==ga)&&n.push(h!=null?no(c,{key:h}):c)}if(o>1)for(let u=0;u<n.length;u++)n[u].patchFlag=-2;return n}function yO(t){return Ot(t)?{setup:t,name:t.name}:t}const nm=t=>!!t.type.__asyncLoader,kg=t=>t.type.__isKeepAlive;function R6(t,e){vO(t,"a",e)}function M6(t,e){vO(t,"da",e)}function vO(t,e,i=Bi){const n=t.__wdc||(t.__wdc=()=>{let o=i;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(Ig(e,n,i),i){let o=i.parent;for(;o&&o.parent;)kg(o.parent.vnode)&&U6(n,e,i,o),o=o.parent}}function U6(t,e,i,n){const o=Ig(e,t,n,!0);EO(()=>{PT(n[e],o)},i)}function Ig(t,e,i=Bi,n=!1){if(i){const o=i[t]||(i[t]=[]),u=e.__weh||(e.__weh=(...c)=>{if(i.isUnmounted)return;Tc(),rc(i);const h=In(e,i,t,c);return nl(),bc(),h});return n?o.unshift(u):o.push(u),u}}const Ca=t=>(e,i=Bi)=>(!wh||t==="sp")&&Ig(t,(...n)=>e(...n),i),B6=Ca("bm"),TO=Ca("m"),F6=Ca("bu"),$6=Ca("u"),bO=Ca("bum"),EO=Ca("um"),j6=Ca("sp"),H6=Ca("rtg"),V6=Ca("rtc");function q6(t,e=Bi){Ig("ec",t,e)}function W6(t,e){const i=Cn;if(i===null)return t;const n=Pg(i)||i.proxy,o=t.dirs||(t.dirs=[]);for(let u=0;u<e.length;u++){let[c,h,m,v=yi]=e[u];c&&(Ot(c)&&(c={mounted:c,updated:c}),c.deep&&Yo(h),o.push({dir:c,instance:n,value:h,oldValue:void 0,arg:m,modifiers:v}))}return t}function Fo(t,e,i,n){const o=t.dirs,u=e&&e.dirs;for(let c=0;c<o.length;c++){const h=o[c];u&&(h.oldValue=u[c].value);let m=h.dir[n];m&&(Tc(),In(m,i,8,[t.el,h,t,e]),bc())}}const G6=Symbol();function SO(t,e,i,n){let o;const u=i&&i[n];if(vt(t)||Wi(t)){o=new Array(t.length);for(let c=0,h=t.length;c<h;c++)o[c]=e(t[c],c,void 0,u&&u[c])}else if(typeof t=="number"){o=new Array(t);for(let c=0;c<t;c++)o[c]=e(c+1,c,void 0,u&&u[c])}else if(pi(t))if(t[Symbol.iterator])o=Array.from(t,(c,h)=>e(c,h,void 0,u&&u[h]));else{const c=Object.keys(t);o=new Array(c.length);for(let h=0,m=c.length;h<m;h++){const v=c[h];o[h]=e(t[v],v,h,u&&u[h])}}else o=[];return i&&(i[n]=o),o}const Y0=t=>t?LO(t)?Pg(t)||t.proxy:Y0(t.parent):null,rh=Ts(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Y0(t.parent),$root:t=>Y0(t.root),$emit:t=>t.emit,$options:t=>VT(t),$forceUpdate:t=>t.f||(t.f=()=>HT(t.update)),$nextTick:t=>t.n||(t.n=oO.bind(t.proxy)),$watch:t=>D6.bind(t)}),e0=(t,e)=>t!==yi&&!t.__isScriptSetup&&jt(t,e),z6={get({_:t},e){const{ctx:i,setupState:n,data:o,props:u,accessCache:c,type:h,appContext:m}=t;let v;if(e[0]!=="$"){const M=c[e];if(M!==void 0)switch(M){case 1:return n[e];case 2:return o[e];case 4:return i[e];case 3:return u[e]}else{if(e0(n,e))return c[e]=1,n[e];if(o!==yi&&jt(o,e))return c[e]=2,o[e];if((v=t.propsOptions[0])&&jt(v,e))return c[e]=3,u[e];if(i!==yi&&jt(i,e))return c[e]=4,i[e];Q0&&(c[e]=0)}}const T=rh[e];let O,R;if(T)return e==="$attrs"&&Qs(t,"get",e),T(t);if((O=h.__cssModules)&&(O=O[e]))return O;if(i!==yi&&jt(i,e))return c[e]=4,i[e];if(R=m.config.globalProperties,jt(R,e))return R[e]},set({_:t},e,i){const{data:n,setupState:o,ctx:u}=t;return e0(o,e)?(o[e]=i,!0):n!==yi&&jt(n,e)?(n[e]=i,!0):jt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(u[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:n,appContext:o,propsOptions:u}},c){let h;return!!i[c]||t!==yi&&jt(t,c)||e0(e,c)||(h=u[0])&&jt(h,c)||jt(n,c)||jt(rh,c)||jt(o.config.globalProperties,c)},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:jt(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};let Q0=!0;function K6(t){const e=VT(t),i=t.proxy,n=t.ctx;Q0=!1,e.beforeCreate&&Qw(e.beforeCreate,t,"bc");const{data:o,computed:u,methods:c,watch:h,provide:m,inject:v,created:T,beforeMount:O,mounted:R,beforeUpdate:M,updated:z,activated:j,deactivated:q,beforeDestroy:W,beforeUnmount:ee,destroyed:se,unmounted:re,render:ie,renderTracked:ye,renderTriggered:Pe,errorCaptured:Ie,serverPrefetch:Be,expose:Ve,inheritAttrs:We,components:it,directives:Le,filters:ct}=e;if(v&&X6(v,n,null,t.appContext.config.unwrapInjectedRef),c)for(const Ze in c){const _t=c[Ze];Ot(_t)&&(n[Ze]=_t.bind(i))}if(o){const Ze=o.call(i,i);pi(Ze)&&(t.data=Vh(Ze))}if(Q0=!0,u)for(const Ze in u){const _t=u[Ze],Vt=Ot(_t)?_t.bind(i,i):Ot(_t.get)?_t.get.bind(i,i):ir,mi=!Ot(_t)&&Ot(_t.set)?_t.set.bind(i):ir,ei=wn({get:Vt,set:mi});Object.defineProperty(n,Ze,{enumerable:!0,configurable:!0,get:()=>ei.value,set:Ft=>ei.value=Ft})}if(h)for(const Ze in h)xO(h[Ze],n,i,Ze);if(m){const Ze=Ot(m)?m.call(i):m;Reflect.ownKeys(Ze).forEach(_t=>{im(_t,Ze[_t])})}T&&Qw(T,t,"c");function Qe(Ze,_t){vt(_t)?_t.forEach(Vt=>Ze(Vt.bind(i))):_t&&Ze(_t.bind(i))}if(Qe(B6,O),Qe(TO,R),Qe(F6,M),Qe($6,z),Qe(R6,j),Qe(M6,q),Qe(q6,Ie),Qe(V6,ye),Qe(H6,Pe),Qe(bO,ee),Qe(EO,re),Qe(j6,Be),vt(Ve))if(Ve.length){const Ze=t.exposed||(t.exposed={});Ve.forEach(_t=>{Object.defineProperty(Ze,_t,{get:()=>i[_t],set:Vt=>i[_t]=Vt})})}else t.exposed||(t.exposed={});ie&&t.render===ir&&(t.render=ie),We!=null&&(t.inheritAttrs=We),it&&(t.components=it),Le&&(t.directives=Le)}function X6(t,e,i=ir,n=!1){vt(t)&&(t=J0(t));for(const o in t){const u=t[o];let c;pi(u)?"default"in u?c=ma(u.from||o,u.default,!0):c=ma(u.from||o):c=ma(u),ys(c)&&n?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>c.value,set:h=>c.value=h}):e[o]=c}}function Qw(t,e,i){In(vt(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,i)}function xO(t,e,i,n){const o=n.includes(".")?mO(i,n):()=>i[n];if(Wi(t)){const u=e[t];Ot(u)&&sm(o,u)}else if(Ot(t))sm(o,t.bind(i));else if(pi(t))if(vt(t))t.forEach(u=>xO(u,e,i,n));else{const u=Ot(t.handler)?t.handler.bind(i):e[t.handler];Ot(u)&&sm(o,u,t)}}function VT(t){const e=t.type,{mixins:i,extends:n}=e,{mixins:o,optionsCache:u,config:{optionMergeStrategies:c}}=t.appContext,h=u.get(e);let m;return h?m=h:!o.length&&!i&&!n?m=e:(m={},o.length&&o.forEach(v=>jm(m,v,c,!0)),jm(m,e,c)),pi(e)&&u.set(e,m),m}function jm(t,e,i,n=!1){const{mixins:o,extends:u}=e;u&&jm(t,u,i,!0),o&&o.forEach(c=>jm(t,c,i,!0));for(const c in e)if(!(n&&c==="expose")){const h=Y6[c]||i&&i[c];t[c]=h?h(t[c],e[c]):e[c]}return t}const Y6={data:Jw,props:Ho,emits:Ho,methods:Ho,computed:Ho,beforeCreate:Is,created:Is,beforeMount:Is,mounted:Is,beforeUpdate:Is,updated:Is,beforeDestroy:Is,beforeUnmount:Is,destroyed:Is,unmounted:Is,activated:Is,deactivated:Is,errorCaptured:Is,serverPrefetch:Is,components:Ho,directives:Ho,watch:J6,provide:Jw,inject:Q6};function Jw(t,e){return e?t?function(){return Ts(Ot(t)?t.call(this,this):t,Ot(e)?e.call(this,this):e)}:e:t}function Q6(t,e){return Ho(J0(t),J0(e))}function J0(t){if(vt(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function Is(t,e){return t?[...new Set([].concat(t,e))]:e}function Ho(t,e){return t?Ts(Ts(Object.create(null),t),e):e}function J6(t,e){if(!t)return e;if(!e)return t;const i=Ts(Object.create(null),t);for(const n in e)i[n]=Is(t[n],e[n]);return i}function Z6(t,e,i,n=!1){const o={},u={};Bm(u,Dg,1),t.propsDefaults=Object.create(null),wO(t,e,o,u);for(const c in t.propsOptions[0])c in o||(o[c]=void 0);i?t.props=n?o:h6(o):t.type.props?t.props=o:t.props=u,t.attrs=u}function eH(t,e,i,n){const{props:o,attrs:u,vnode:{patchFlag:c}}=t,h=Kt(o),[m]=t.propsOptions;let v=!1;if((n||c>0)&&!(c&16)){if(c&8){const T=t.vnode.dynamicProps;for(let O=0;O<T.length;O++){let R=T[O];if(Ag(t.emitsOptions,R))continue;const M=e[R];if(m)if(jt(u,R))M!==u[R]&&(u[R]=M,v=!0);else{const z=sc(R);o[z]=Z0(m,h,z,M,t,!1)}else M!==u[R]&&(u[R]=M,v=!0)}}}else{wO(t,e,o,u)&&(v=!0);let T;for(const O in h)(!e||!jt(e,O)&&((T=vc(O))===O||!jt(e,T)))&&(m?i&&(i[O]!==void 0||i[T]!==void 0)&&(o[O]=Z0(m,h,O,void 0,t,!0)):delete o[O]);if(u!==h)for(const O in u)(!e||!jt(e,O))&&(delete u[O],v=!0)}v&&Sa(t,"set","$attrs")}function wO(t,e,i,n){const[o,u]=t.propsOptions;let c=!1,h;if(e)for(let m in e){if(em(m))continue;const v=e[m];let T;o&&jt(o,T=sc(m))?!u||!u.includes(T)?i[T]=v:(h||(h={}))[T]=v:Ag(t.emitsOptions,m)||(!(m in n)||v!==n[m])&&(n[m]=v,c=!0)}if(u){const m=Kt(i),v=h||yi;for(let T=0;T<u.length;T++){const O=u[T];i[O]=Z0(o,m,O,v[O],t,!jt(v,O))}}return c}function Z0(t,e,i,n,o,u){const c=t[i];if(c!=null){const h=jt(c,"default");if(h&&n===void 0){const m=c.default;if(c.type!==Function&&Ot(m)){const{propsDefaults:v}=o;i in v?n=v[i]:(rc(o),n=v[i]=m.call(null,e),nl())}else n=m}c[0]&&(u&&!h?n=!1:c[1]&&(n===""||n===vc(i))&&(n=!0))}return n}function CO(t,e,i=!1){const n=e.propsCache,o=n.get(t);if(o)return o;const u=t.props,c={},h=[];let m=!1;if(!Ot(t)){const T=O=>{m=!0;const[R,M]=CO(O,e,!0);Ts(c,R),M&&h.push(...M)};!i&&e.mixins.length&&e.mixins.forEach(T),t.extends&&T(t.extends),t.mixins&&t.mixins.forEach(T)}if(!u&&!m)return pi(t)&&n.set(t,Ru),Ru;if(vt(u))for(let T=0;T<u.length;T++){const O=sc(u[T]);Zw(O)&&(c[O]=yi)}else if(u)for(const T in u){const O=sc(T);if(Zw(O)){const R=u[T],M=c[O]=vt(R)||Ot(R)?{type:R}:Object.assign({},R);if(M){const z=iC(Boolean,M.type),j=iC(String,M.type);M[0]=z>-1,M[1]=j<0||z<j,(z>-1||jt(M,"default"))&&h.push(O)}}}const v=[c,h];return pi(t)&&n.set(t,v),v}function Zw(t){return t[0]!=="$"}function eC(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function tC(t,e){return eC(t)===eC(e)}function iC(t,e){return vt(e)?e.findIndex(i=>tC(i,t)):Ot(e)&&tC(e,t)?0:-1}const AO=t=>t[0]==="_"||t==="$stable",qT=t=>vt(t)?t.map(Er):[Er(t)],tH=(t,e,i)=>{if(e._n)return e;const n=fO((...o)=>qT(e(...o)),i);return n._c=!1,n},kO=(t,e,i)=>{const n=t._ctx;for(const o in t){if(AO(o))continue;const u=t[o];if(Ot(u))e[o]=tH(o,u,n);else if(u!=null){const c=qT(u);e[o]=()=>c}}},IO=(t,e)=>{const i=qT(e);t.slots.default=()=>i},iH=(t,e)=>{if(t.vnode.shapeFlag&32){const i=e._;i?(t.slots=Kt(e),Bm(e,"_",i)):kO(e,t.slots={})}else t.slots={},e&&IO(t,e);Bm(t.slots,Dg,1)},sH=(t,e,i)=>{const{vnode:n,slots:o}=t;let u=!0,c=yi;if(n.shapeFlag&32){const h=e._;h?i&&h===1?u=!1:(Ts(o,e),!i&&h===1&&delete o._):(u=!e.$stable,kO(e,o)),c=e}else e&&(IO(t,e),c={default:1});if(u)for(const h in o)!AO(h)&&!(h in c)&&delete o[h]};function OO(){return{app:null,config:{isNativeTag:O3,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nH=0;function rH(t,e){return function(n,o=null){Ot(n)||(n=Object.assign({},n)),o!=null&&!pi(o)&&(o=null);const u=OO(),c=new Set;let h=!1;const m=u.app={_uid:nH++,_component:n,_props:o,_container:null,_context:u,_instance:null,version:CH,get config(){return u.config},set config(v){},use(v,...T){return c.has(v)||(v&&Ot(v.install)?(c.add(v),v.install(m,...T)):Ot(v)&&(c.add(v),v(m,...T))),m},mixin(v){return u.mixins.includes(v)||u.mixins.push(v),m},component(v,T){return T?(u.components[v]=T,m):u.components[v]},directive(v,T){return T?(u.directives[v]=T,m):u.directives[v]},mount(v,T,O){if(!h){const R=gn(n,o);return R.appContext=u,T&&e?e(R,v):t(R,v,O),h=!0,m._container=v,v.__vue_app__=m,Pg(R.component)||R.component.proxy}},unmount(){h&&(t(null,m._container),delete m._container.__vue_app__)},provide(v,T){return u.provides[v]=T,m}};return m}}function ev(t,e,i,n,o=!1){if(vt(t)){t.forEach((R,M)=>ev(R,e&&(vt(e)?e[M]:e),i,n,o));return}if(nm(n)&&!o)return;const u=n.shapeFlag&4?Pg(n.component)||n.component.proxy:n.el,c=o?null:u,{i:h,r:m}=t,v=e&&e.r,T=h.refs===yi?h.refs={}:h.refs,O=h.setupState;if(v!=null&&v!==m&&(Wi(v)?(T[v]=null,jt(O,v)&&(O[v]=null)):ys(v)&&(v.value=null)),Ot(m))Ya(m,h,12,[c,T]);else{const R=Wi(m),M=ys(m);if(R||M){const z=()=>{if(t.f){const j=R?jt(O,m)?O[m]:T[m]:m.value;o?vt(j)&&PT(j,u):vt(j)?j.includes(u)||j.push(u):R?(T[m]=[u],jt(O,m)&&(O[m]=T[m])):(m.value=[u],t.k&&(T[t.k]=m.value))}else R?(T[m]=c,jt(O,m)&&(O[m]=c)):M&&(m.value=c,t.k&&(T[t.k]=c))};c?(z.id=-1,Gs(z,i)):z()}}}const Gs=O6;function aH(t){return oH(t)}function oH(t,e){const i=M3();i.__VUE__=!0;const{insert:n,remove:o,patchProp:u,createElement:c,createText:h,createComment:m,setText:v,setElementText:T,parentNode:O,nextSibling:R,setScopeId:M=ir,insertStaticContent:z}=t,j=(X,ne,pe,_e=null,Ce=null,Re=null,Fe=!1,Oe=null,Se=!!ne.dynamicChildren)=>{if(X===ne)return;X&&!Wo(X,ne)&&(_e=Ue(X),Ft(X,Ce,Re,!0),X=null),ne.patchFlag===-2&&(Se=!1,ne.dynamicChildren=null);const{type:ke,ref:et,shapeFlag:Je}=ne;switch(ke){case Og:q(X,ne,pe,_e);break;case ga:W(X,ne,pe,_e);break;case t0:X==null&&ee(ne,pe,_e,Fe);break;case pn:it(X,ne,pe,_e,Ce,Re,Fe,Oe,Se);break;default:Je&1?ie(X,ne,pe,_e,Ce,Re,Fe,Oe,Se):Je&6?Le(X,ne,pe,_e,Ce,Re,Fe,Oe,Se):(Je&64||Je&128)&&ke.process(X,ne,pe,_e,Ce,Re,Fe,Oe,Se,Ct)}et!=null&&Ce&&ev(et,X&&X.ref,Re,ne||X,!ne)},q=(X,ne,pe,_e)=>{if(X==null)n(ne.el=h(ne.children),pe,_e);else{const Ce=ne.el=X.el;ne.children!==X.children&&v(Ce,ne.children)}},W=(X,ne,pe,_e)=>{X==null?n(ne.el=m(ne.children||""),pe,_e):ne.el=X.el},ee=(X,ne,pe,_e)=>{[X.el,X.anchor]=z(X.children,ne,pe,_e,X.el,X.anchor)},se=({el:X,anchor:ne},pe,_e)=>{let Ce;for(;X&&X!==ne;)Ce=R(X),n(X,pe,_e),X=Ce;n(ne,pe,_e)},re=({el:X,anchor:ne})=>{let pe;for(;X&&X!==ne;)pe=R(X),o(X),X=pe;o(ne)},ie=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se)=>{Fe=Fe||ne.type==="svg",X==null?ye(ne,pe,_e,Ce,Re,Fe,Oe,Se):Be(X,ne,Ce,Re,Fe,Oe,Se)},ye=(X,ne,pe,_e,Ce,Re,Fe,Oe)=>{let Se,ke;const{type:et,props:Je,shapeFlag:tt,transition:rt,dirs:mt}=X;if(Se=X.el=c(X.type,Re,Je&&Je.is,Je),tt&8?T(Se,X.children):tt&16&&Ie(X.children,Se,null,_e,Ce,Re&&et!=="foreignObject",Fe,Oe),mt&&Fo(X,null,_e,"created"),Pe(Se,X,X.scopeId,Fe,_e),Je){for(const Pt in Je)Pt!=="value"&&!em(Pt)&&u(Se,Pt,null,Je[Pt],Re,X.children,_e,Ce,He);"value"in Je&&u(Se,"value",null,Je.value),(ke=Je.onVnodeBeforeMount)&&vr(ke,_e,X)}mt&&Fo(X,null,_e,"beforeMount");const Dt=(!Ce||Ce&&!Ce.pendingBranch)&&rt&&!rt.persisted;Dt&&rt.beforeEnter(Se),n(Se,ne,pe),((ke=Je&&Je.onVnodeMounted)||Dt||mt)&&Gs(()=>{ke&&vr(ke,_e,X),Dt&&rt.enter(Se),mt&&Fo(X,null,_e,"mounted")},Ce)},Pe=(X,ne,pe,_e,Ce)=>{if(pe&&M(X,pe),_e)for(let Re=0;Re<_e.length;Re++)M(X,_e[Re]);if(Ce){let Re=Ce.subTree;if(ne===Re){const Fe=Ce.vnode;Pe(X,Fe,Fe.scopeId,Fe.slotScopeIds,Ce.parent)}}},Ie=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se=0)=>{for(let ke=Se;ke<X.length;ke++){const et=X[ke]=Oe?Ga(X[ke]):Er(X[ke]);j(null,et,ne,pe,_e,Ce,Re,Fe,Oe)}},Be=(X,ne,pe,_e,Ce,Re,Fe)=>{const Oe=ne.el=X.el;let{patchFlag:Se,dynamicChildren:ke,dirs:et}=ne;Se|=X.patchFlag&16;const Je=X.props||yi,tt=ne.props||yi;let rt;pe&&$o(pe,!1),(rt=tt.onVnodeBeforeUpdate)&&vr(rt,pe,ne,X),et&&Fo(ne,X,pe,"beforeUpdate"),pe&&$o(pe,!0);const mt=Ce&&ne.type!=="foreignObject";if(ke?Ve(X.dynamicChildren,ke,Oe,pe,_e,mt,Re):Fe||_t(X,ne,Oe,null,pe,_e,mt,Re,!1),Se>0){if(Se&16)We(Oe,ne,Je,tt,pe,_e,Ce);else if(Se&2&&Je.class!==tt.class&&u(Oe,"class",null,tt.class,Ce),Se&4&&u(Oe,"style",Je.style,tt.style,Ce),Se&8){const Dt=ne.dynamicProps;for(let Pt=0;Pt<Dt.length;Pt++){const ai=Dt[Pt],es=Je[ai],en=tt[ai];(en!==es||ai==="value")&&u(Oe,ai,es,en,Ce,X.children,pe,_e,He)}}Se&1&&X.children!==ne.children&&T(Oe,ne.children)}else!Fe&&ke==null&&We(Oe,ne,Je,tt,pe,_e,Ce);((rt=tt.onVnodeUpdated)||et)&&Gs(()=>{rt&&vr(rt,pe,ne,X),et&&Fo(ne,X,pe,"updated")},_e)},Ve=(X,ne,pe,_e,Ce,Re,Fe)=>{for(let Oe=0;Oe<ne.length;Oe++){const Se=X[Oe],ke=ne[Oe],et=Se.el&&(Se.type===pn||!Wo(Se,ke)||Se.shapeFlag&70)?O(Se.el):pe;j(Se,ke,et,null,_e,Ce,Re,Fe,!0)}},We=(X,ne,pe,_e,Ce,Re,Fe)=>{if(pe!==_e){if(pe!==yi)for(const Oe in pe)!em(Oe)&&!(Oe in _e)&&u(X,Oe,pe[Oe],null,Fe,ne.children,Ce,Re,He);for(const Oe in _e){if(em(Oe))continue;const Se=_e[Oe],ke=pe[Oe];Se!==ke&&Oe!=="value"&&u(X,Oe,ke,Se,Fe,ne.children,Ce,Re,He)}"value"in _e&&u(X,"value",pe.value,_e.value)}},it=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se)=>{const ke=ne.el=X?X.el:h(""),et=ne.anchor=X?X.anchor:h("");let{patchFlag:Je,dynamicChildren:tt,slotScopeIds:rt}=ne;rt&&(Oe=Oe?Oe.concat(rt):rt),X==null?(n(ke,pe,_e),n(et,pe,_e),Ie(ne.children,pe,et,Ce,Re,Fe,Oe,Se)):Je>0&&Je&64&&tt&&X.dynamicChildren?(Ve(X.dynamicChildren,tt,pe,Ce,Re,Fe,Oe),(ne.key!=null||Ce&&ne===Ce.subTree)&&DO(X,ne,!0)):_t(X,ne,pe,et,Ce,Re,Fe,Oe,Se)},Le=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se)=>{ne.slotScopeIds=Oe,X==null?ne.shapeFlag&512?Ce.ctx.activate(ne,pe,_e,Fe,Se):ct(ne,pe,_e,Ce,Re,Fe,Se):Ht(X,ne,Se)},ct=(X,ne,pe,_e,Ce,Re,Fe)=>{const Oe=X.component=_H(X,_e,Ce);if(kg(X)&&(Oe.ctx.renderer=Ct),vH(Oe),Oe.asyncDep){if(Ce&&Ce.registerDep(Oe,Qe),!X.el){const Se=Oe.subTree=gn(ga);W(null,Se,ne,pe)}return}Qe(Oe,X,ne,pe,Ce,Re,Fe)},Ht=(X,ne,pe)=>{const _e=ne.component=X.component;if(A6(X,ne,pe))if(_e.asyncDep&&!_e.asyncResolved){Ze(_e,ne,pe);return}else _e.next=ne,b6(_e.update),_e.update();else ne.el=X.el,_e.vnode=ne},Qe=(X,ne,pe,_e,Ce,Re,Fe)=>{const Oe=()=>{if(X.isMounted){let{next:et,bu:Je,u:tt,parent:rt,vnode:mt}=X,Dt=et,Pt;$o(X,!1),et?(et.el=mt.el,Ze(X,et,Fe)):et=mt,Je&&tm(Je),(Pt=et.props&&et.props.onVnodeBeforeUpdate)&&vr(Pt,rt,et,mt),$o(X,!0);const ai=Jy(X),es=X.subTree;X.subTree=ai,j(es,ai,O(es.el),Ue(es),X,Ce,Re),et.el=ai.el,Dt===null&&k6(X,ai.el),tt&&Gs(tt,Ce),(Pt=et.props&&et.props.onVnodeUpdated)&&Gs(()=>vr(Pt,rt,et,mt),Ce)}else{let et;const{el:Je,props:tt}=ne,{bm:rt,m:mt,parent:Dt}=X,Pt=nm(ne);if($o(X,!1),rt&&tm(rt),!Pt&&(et=tt&&tt.onVnodeBeforeMount)&&vr(et,Dt,ne),$o(X,!0),Je&&je){const ai=()=>{X.subTree=Jy(X),je(Je,X.subTree,X,Ce,null)};Pt?ne.type.__asyncLoader().then(()=>!X.isUnmounted&&ai()):ai()}else{const ai=X.subTree=Jy(X);j(null,ai,pe,_e,X,Ce,Re),ne.el=ai.el}if(mt&&Gs(mt,Ce),!Pt&&(et=tt&&tt.onVnodeMounted)){const ai=ne;Gs(()=>vr(et,Dt,ai),Ce)}(ne.shapeFlag&256||Dt&&nm(Dt.vnode)&&Dt.vnode.shapeFlag&256)&&X.a&&Gs(X.a,Ce),X.isMounted=!0,ne=pe=_e=null}},Se=X.effect=new RT(Oe,()=>HT(ke),X.scope),ke=X.update=()=>Se.run();ke.id=X.uid,$o(X,!0),ke()},Ze=(X,ne,pe)=>{ne.component=X;const _e=X.vnode.props;X.vnode=ne,X.next=null,eH(X,ne.props,_e,pe),sH(X,ne.children,pe),Tc(),Kw(),bc()},_t=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se=!1)=>{const ke=X&&X.children,et=X?X.shapeFlag:0,Je=ne.children,{patchFlag:tt,shapeFlag:rt}=ne;if(tt>0){if(tt&128){mi(ke,Je,pe,_e,Ce,Re,Fe,Oe,Se);return}else if(tt&256){Vt(ke,Je,pe,_e,Ce,Re,Fe,Oe,Se);return}}rt&8?(et&16&&He(ke,Ce,Re),Je!==ke&&T(pe,Je)):et&16?rt&16?mi(ke,Je,pe,_e,Ce,Re,Fe,Oe,Se):He(ke,Ce,Re,!0):(et&8&&T(pe,""),rt&16&&Ie(Je,pe,_e,Ce,Re,Fe,Oe,Se))},Vt=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se)=>{X=X||Ru,ne=ne||Ru;const ke=X.length,et=ne.length,Je=Math.min(ke,et);let tt;for(tt=0;tt<Je;tt++){const rt=ne[tt]=Se?Ga(ne[tt]):Er(ne[tt]);j(X[tt],rt,pe,null,Ce,Re,Fe,Oe,Se)}ke>et?He(X,Ce,Re,!0,!1,Je):Ie(ne,pe,_e,Ce,Re,Fe,Oe,Se,Je)},mi=(X,ne,pe,_e,Ce,Re,Fe,Oe,Se)=>{let ke=0;const et=ne.length;let Je=X.length-1,tt=et-1;for(;ke<=Je&&ke<=tt;){const rt=X[ke],mt=ne[ke]=Se?Ga(ne[ke]):Er(ne[ke]);if(Wo(rt,mt))j(rt,mt,pe,null,Ce,Re,Fe,Oe,Se);else break;ke++}for(;ke<=Je&&ke<=tt;){const rt=X[Je],mt=ne[tt]=Se?Ga(ne[tt]):Er(ne[tt]);if(Wo(rt,mt))j(rt,mt,pe,null,Ce,Re,Fe,Oe,Se);else break;Je--,tt--}if(ke>Je){if(ke<=tt){const rt=tt+1,mt=rt<et?ne[rt].el:_e;for(;ke<=tt;)j(null,ne[ke]=Se?Ga(ne[ke]):Er(ne[ke]),pe,mt,Ce,Re,Fe,Oe,Se),ke++}}else if(ke>tt)for(;ke<=Je;)Ft(X[ke],Ce,Re,!0),ke++;else{const rt=ke,mt=ke,Dt=new Map;for(ke=mt;ke<=tt;ke++){const Gi=ne[ke]=Se?Ga(ne[ke]):Er(ne[ke]);Gi.key!=null&&Dt.set(Gi.key,ke)}let Pt,ai=0;const es=tt-mt+1;let en=!1,Xt=0;const tn=new Array(es);for(ke=0;ke<es;ke++)tn[ke]=0;for(ke=rt;ke<=Je;ke++){const Gi=X[ke];if(ai>=es){Ft(Gi,Ce,Re,!0);continue}let Fi;if(Gi.key!=null)Fi=Dt.get(Gi.key);else for(Pt=mt;Pt<=tt;Pt++)if(tn[Pt-mt]===0&&Wo(Gi,ne[Pt])){Fi=Pt;break}Fi===void 0?Ft(Gi,Ce,Re,!0):(tn[Fi-mt]=ke+1,Fi>=Xt?Xt=Fi:en=!0,j(Gi,ne[Fi],pe,null,Ce,Re,Fe,Oe,Se),ai++)}const us=en?lH(tn):Ru;for(Pt=us.length-1,ke=es-1;ke>=0;ke--){const Gi=mt+ke,Fi=ne[Gi],co=Gi+1<et?ne[Gi+1].el:_e;tn[ke]===0?j(null,Fi,pe,co,Ce,Re,Fe,Oe,Se):en&&(Pt<0||ke!==us[Pt]?ei(Fi,pe,co,2):Pt--)}}},ei=(X,ne,pe,_e,Ce=null)=>{const{el:Re,type:Fe,transition:Oe,children:Se,shapeFlag:ke}=X;if(ke&6){ei(X.component.subTree,ne,pe,_e);return}if(ke&128){X.suspense.move(ne,pe,_e);return}if(ke&64){Fe.move(X,ne,pe,Ct);return}if(Fe===pn){n(Re,ne,pe);for(let Je=0;Je<Se.length;Je++)ei(Se[Je],ne,pe,_e);n(X.anchor,ne,pe);return}if(Fe===t0){se(X,ne,pe);return}if(_e!==2&&ke&1&&Oe)if(_e===0)Oe.beforeEnter(Re),n(Re,ne,pe),Gs(()=>Oe.enter(Re),Ce);else{const{leave:Je,delayLeave:tt,afterLeave:rt}=Oe,mt=()=>n(Re,ne,pe),Dt=()=>{Je(Re,()=>{mt(),rt&&rt()})};tt?tt(Re,mt,Dt):Dt()}else n(Re,ne,pe)},Ft=(X,ne,pe,_e=!1,Ce=!1)=>{const{type:Re,props:Fe,ref:Oe,children:Se,dynamicChildren:ke,shapeFlag:et,patchFlag:Je,dirs:tt}=X;if(Oe!=null&&ev(Oe,null,pe,X,!0),et&256){ne.ctx.deactivate(X);return}const rt=et&1&&tt,mt=!nm(X);let Dt;if(mt&&(Dt=Fe&&Fe.onVnodeBeforeUnmount)&&vr(Dt,ne,X),et&6)be(X.component,pe,_e);else{if(et&128){X.suspense.unmount(pe,_e);return}rt&&Fo(X,null,ne,"beforeUnmount"),et&64?X.type.remove(X,ne,pe,Ce,Ct,_e):ke&&(Re!==pn||Je>0&&Je&64)?He(ke,ne,pe,!1,!0):(Re===pn&&Je&384||!Ce&&et&16)&&He(Se,ne,pe),_e&&Mt(X)}(mt&&(Dt=Fe&&Fe.onVnodeUnmounted)||rt)&&Gs(()=>{Dt&&vr(Dt,ne,X),rt&&Fo(X,null,ne,"unmounted")},pe)},Mt=X=>{const{type:ne,el:pe,anchor:_e,transition:Ce}=X;if(ne===pn){Qt(pe,_e);return}if(ne===t0){re(X);return}const Re=()=>{o(pe),Ce&&!Ce.persisted&&Ce.afterLeave&&Ce.afterLeave()};if(X.shapeFlag&1&&Ce&&!Ce.persisted){const{leave:Fe,delayLeave:Oe}=Ce,Se=()=>Fe(pe,Re);Oe?Oe(X.el,Re,Se):Se()}else Re()},Qt=(X,ne)=>{let pe;for(;X!==ne;)pe=R(X),o(X),X=pe;o(ne)},be=(X,ne,pe)=>{const{bum:_e,scope:Ce,update:Re,subTree:Fe,um:Oe}=X;_e&&tm(_e),Ce.stop(),Re&&(Re.active=!1,Ft(Fe,X,ne,pe)),Oe&&Gs(Oe,ne),Gs(()=>{X.isUnmounted=!0},ne),ne&&ne.pendingBranch&&!ne.isUnmounted&&X.asyncDep&&!X.asyncResolved&&X.suspenseId===ne.pendingId&&(ne.deps--,ne.deps===0&&ne.resolve())},He=(X,ne,pe,_e=!1,Ce=!1,Re=0)=>{for(let Fe=Re;Fe<X.length;Fe++)Ft(X[Fe],ne,pe,_e,Ce)},Ue=X=>X.shapeFlag&6?Ue(X.component.subTree):X.shapeFlag&128?X.suspense.next():R(X.anchor||X.el),Xe=(X,ne,pe)=>{X==null?ne._vnode&&Ft(ne._vnode,null,null,!0):j(ne._vnode||null,X,ne,null,null,null,pe),Kw(),uO(),ne._vnode=X},Ct={p:j,um:Ft,m:ei,r:Mt,mt:ct,mc:Ie,pc:_t,pbc:Ve,n:Ue,o:t};let Jt,je;return e&&([Jt,je]=e(Ct)),{render:Xe,hydrate:Jt,createApp:rH(Xe,Jt)}}function $o({effect:t,update:e},i){t.allowRecurse=e.allowRecurse=i}function DO(t,e,i=!1){const n=t.children,o=e.children;if(vt(n)&&vt(o))for(let u=0;u<n.length;u++){const c=n[u];let h=o[u];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=o[u]=Ga(o[u]),h.el=c.el),i||DO(c,h)),h.type===Og&&(h.el=c.el)}}function lH(t){const e=t.slice(),i=[0];let n,o,u,c,h;const m=t.length;for(n=0;n<m;n++){const v=t[n];if(v!==0){if(o=i[i.length-1],t[o]<v){e[n]=o,i.push(n);continue}for(u=0,c=i.length-1;u<c;)h=u+c>>1,t[i[h]]<v?u=h+1:c=h;v<t[i[u]]&&(u>0&&(e[n]=i[u-1]),i[u]=n)}}for(u=i.length,c=i[u-1];u-- >0;)i[u]=c,c=e[c];return i}const uH=t=>t.__isTeleport,pn=Symbol(void 0),Og=Symbol(void 0),ga=Symbol(void 0),t0=Symbol(void 0),ah=[];let Zn=null;function il(t=!1){ah.push(Zn=t?null:[])}function cH(){ah.pop(),Zn=ah[ah.length-1]||null}let xh=1;function sC(t){xh+=t}function dH(t){return t.dynamicChildren=xh>0?Zn||Ru:null,cH(),xh>0&&Zn&&Zn.push(t),t}function sl(t,e,i,n,o,u){return dH(kt(t,e,i,n,o,u,!0))}function tv(t){return t?t.__v_isVNode===!0:!1}function Wo(t,e){return t.type===e.type&&t.key===e.key}const Dg="__vInternal",PO=({key:t})=>t??null,rm=({ref:t,ref_key:e,ref_for:i})=>t!=null?Wi(t)||ys(t)||Ot(t)?{i:Cn,r:t,k:e,f:!!i}:t:null;function kt(t,e=null,i=null,n=0,o=null,u=t===pn?0:1,c=!1,h=!1){const m={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&PO(e),ref:e&&rm(e),scopeId:hO,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Cn};return h?(WT(m,i),u&128&&t.normalize(m)):i&&(m.shapeFlag|=Wi(i)?8:16),xh>0&&!c&&Zn&&(m.patchFlag>0||u&6)&&m.patchFlag!==32&&Zn.push(m),m}const gn=hH;function hH(t,e=null,i=null,n=0,o=null,u=!1){if((!t||t===G6)&&(t=ga),tv(t)){const h=no(t,e,!0);return i&&WT(h,i),xh>0&&!u&&Zn&&(h.shapeFlag&6?Zn[Zn.indexOf(t)]=h:Zn.push(h)),h.patchFlag|=-2,h}if(SH(t)&&(t=t.__vccOpts),e){e=fH(e);let{class:h,style:m}=e;h&&!Wi(h)&&(e.class=OT(h)),pi(m)&&(ZI(m)&&!vt(m)&&(m=Ts({},m)),e.style=IT(m))}const c=Wi(t)?1:I6(t)?128:uH(t)?64:pi(t)?4:Ot(t)?2:0;return kt(t,e,i,n,o,c,u,!0)}function fH(t){return t?ZI(t)||Dg in t?Ts({},t):t:null}function no(t,e,i=!1){const{props:n,ref:o,patchFlag:u,children:c}=t,h=e?pH(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:h,key:h&&PO(h),ref:e&&e.ref?i&&o?vt(o)?o.concat(rm(e)):[o,rm(e)]:rm(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:c,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==pn?u===-1?16:u|16:u,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&no(t.ssContent),ssFallback:t.ssFallback&&no(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function ku(t=" ",e=0){return gn(Og,null,t,e)}function Er(t){return t==null||typeof t=="boolean"?gn(ga):vt(t)?gn(pn,null,t.slice()):typeof t=="object"?Ga(t):gn(Og,null,String(t))}function Ga(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:no(t)}function WT(t,e){let i=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(vt(e))i=16;else if(typeof e=="object")if(n&65){const o=e.default;o&&(o._c&&(o._d=!1),WT(t,o()),o._c&&(o._d=!0));return}else{i=32;const o=e._;!o&&!(Dg in e)?e._ctx=Cn:o===3&&Cn&&(Cn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ot(e)?(e={default:e,_ctx:Cn},i=32):(e=String(e),n&64?(i=16,e=[ku(e)]):i=8);t.children=e,t.shapeFlag|=i}function pH(...t){const e={};for(let i=0;i<t.length;i++){const n=t[i];for(const o in n)if(o==="class")e.class!==n.class&&(e.class=OT([e.class,n.class]));else if(o==="style")e.style=IT([e.style,n.style]);else if(Eg(o)){const u=e[o],c=n[o];c&&u!==c&&!(vt(u)&&u.includes(c))&&(e[o]=u?[].concat(u,c):c)}else o!==""&&(e[o]=n[o])}return e}function vr(t,e,i,n=null){In(t,e,7,[i,n])}const mH=OO();let gH=0;function _H(t,e,i){const n=t.type,o=(e?e.appContext:t.appContext)||mH,u={uid:gH++,vnode:t,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new U3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:CO(n,o),emitsOptions:dO(n,o),emit:null,emitted:null,propsDefaults:yi,inheritAttrs:n.inheritAttrs,ctx:yi,data:yi,props:yi,attrs:yi,slots:yi,refs:yi,setupState:yi,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=e?e.root:u,u.emit=x6.bind(null,u),t.ce&&t.ce(u),u}let Bi=null;const yH=()=>Bi||Cn,rc=t=>{Bi=t,t.scope.on()},nl=()=>{Bi&&Bi.scope.off(),Bi=null};function LO(t){return t.vnode.shapeFlag&4}let wh=!1;function vH(t,e=!1){wh=e;const{props:i,children:n}=t.vnode,o=LO(t);Z6(t,i,o,e),iH(t,n);const u=o?TH(t,e):void 0;return wh=!1,u}function TH(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=eO(new Proxy(t.ctx,z6));const{setup:n}=i;if(n){const o=t.setupContext=n.length>1?EH(t):null;rc(t),Tc();const u=Ya(n,t,0,[t.props,o]);if(bc(),nl(),UI(u)){if(u.then(nl,nl),e)return u.then(c=>{nC(t,c,e)}).catch(c=>{Cg(c,t,0)});t.asyncDep=u}else nC(t,u,e)}else NO(t,e)}function nC(t,e,i){Ot(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:pi(e)&&(t.setupState=nO(e)),NO(t,i)}let rC;function NO(t,e,i){const n=t.type;if(!t.render){if(!e&&rC&&!n.render){const o=n.template||VT(t).template;if(o){const{isCustomElement:u,compilerOptions:c}=t.appContext.config,{delimiters:h,compilerOptions:m}=n,v=Ts(Ts({isCustomElement:u,delimiters:h},c),m);n.render=rC(o,v)}}t.render=n.render||ir}rc(t),Tc(),K6(t),bc(),nl()}function bH(t){return new Proxy(t.attrs,{get(e,i){return Qs(t,"get","$attrs"),e[i]}})}function EH(t){const e=n=>{t.exposed=n||{}};let i;return{get attrs(){return i||(i=bH(t))},slots:t.slots,emit:t.emit,expose:e}}function Pg(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(nO(eO(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in rh)return rh[i](t)},has(e,i){return i in e||i in rh}}))}function SH(t){return Ot(t)&&"__vccOpts"in t}const wn=(t,e)=>y6(t,e,wh);function RO(t,e,i){const n=arguments.length;return n===2?pi(e)&&!vt(e)?tv(e)?gn(t,null,[e]):gn(t,e):gn(t,null,e):(n>3?i=Array.prototype.slice.call(arguments,2):n===3&&tv(i)&&(i=[i]),gn(t,e,i))}const xH=Symbol(""),wH=()=>ma(xH),CH="3.2.47",AH="http://www.w3.org/2000/svg",Go=typeof document<"u"?document:null,aC=Go&&Go.createElement("template"),kH={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,n)=>{const o=e?Go.createElementNS(AH,t):Go.createElement(t,i?{is:i}:void 0);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>Go.createTextNode(t),createComment:t=>Go.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Go.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,n,o,u){const c=i?i.previousSibling:e.lastChild;if(o&&(o===u||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),i),!(o===u||!(o=o.nextSibling)););else{aC.innerHTML=n?`<svg>${t}</svg>`:t;const h=aC.content;if(n){const m=h.firstChild;for(;m.firstChild;)h.appendChild(m.firstChild);h.removeChild(m)}e.insertBefore(h,i)}return[c?c.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}};function IH(t,e,i){const n=t._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}function OH(t,e,i){const n=t.style,o=Wi(i);if(i&&!o){if(e&&!Wi(e))for(const u in e)i[u]==null&&iv(n,u,"");for(const u in i)iv(n,u,i[u])}else{const u=n.display;o?e!==i&&(n.cssText=i):e&&t.removeAttribute("style"),"_vod"in t&&(n.display=u)}}const oC=/\s*!important$/;function iv(t,e,i){if(vt(i))i.forEach(n=>iv(t,e,n));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const n=DH(t,e);oC.test(i)?t.setProperty(vc(n),i.replace(oC,""),"important"):t[n]=i}}const lC=["Webkit","Moz","ms"],i0={};function DH(t,e){const i=i0[e];if(i)return i;let n=sc(e);if(n!=="filter"&&n in t)return i0[e]=n;n=$I(n);for(let o=0;o<lC.length;o++){const u=lC[o]+n;if(u in t)return i0[e]=u}return e}const uC="http://www.w3.org/1999/xlink";function PH(t,e,i,n,o){if(n&&e.startsWith("xlink:"))i==null?t.removeAttributeNS(uC,e.slice(6,e.length)):t.setAttributeNS(uC,e,i);else{const u=A3(e);i==null||u&&!RI(i)?t.removeAttribute(e):t.setAttribute(e,u?"":i)}}function LH(t,e,i,n,o,u,c){if(e==="innerHTML"||e==="textContent"){n&&c(n,o,u),t[e]=i??"";return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=i;const m=i??"";(t.value!==m||t.tagName==="OPTION")&&(t.value=m),i==null&&t.removeAttribute(e);return}let h=!1;if(i===""||i==null){const m=typeof t[e];m==="boolean"?i=RI(i):i==null&&m==="string"?(i="",h=!0):m==="number"&&(i=0,h=!0)}try{t[e]=i}catch{}h&&t.removeAttribute(e)}function MO(t,e,i,n){t.addEventListener(e,i,n)}function NH(t,e,i,n){t.removeEventListener(e,i,n)}function RH(t,e,i,n,o=null){const u=t._vei||(t._vei={}),c=u[e];if(n&&c)c.value=n;else{const[h,m]=MH(e);if(n){const v=u[e]=FH(n,o);MO(t,h,v,m)}else c&&(NH(t,h,c,m),u[e]=void 0)}}const cC=/(?:Once|Passive|Capture)$/;function MH(t){let e;if(cC.test(t)){e={};let n;for(;n=t.match(cC);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):vc(t.slice(2)),e]}let s0=0;const UH=Promise.resolve(),BH=()=>s0||(UH.then(()=>s0=0),s0=Date.now());function FH(t,e){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;In($H(n,i.value),e,5,[n])};return i.value=t,i.attached=BH(),i}function $H(t,e){if(vt(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(n=>o=>!o._stopped&&n&&n(o))}else return e}const dC=/^on[a-z]/,jH=(t,e,i,n,o=!1,u,c,h,m)=>{e==="class"?IH(t,n,o):e==="style"?OH(t,i,n):Eg(e)?DT(e)||RH(t,e,i,n,c):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):HH(t,e,n,o))?LH(t,e,n,u,c,h,m):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),PH(t,e,n,o))};function HH(t,e,i,n){return n?!!(e==="innerHTML"||e==="textContent"||e in t&&dC.test(e)&&Ot(i)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||dC.test(e)&&Wi(i)?!1:e in t}const VH={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};N6.props;const hC=t=>{const e=t.props["onUpdate:modelValue"]||!1;return vt(e)?i=>tm(e,i):e},qH={deep:!0,created(t,{value:e,modifiers:{number:i}},n){const o=Sg(e);MO(t,"change",()=>{const u=Array.prototype.filter.call(t.options,c=>c.selected).map(c=>i?jI(Hm(c)):Hm(c));t._assign(t.multiple?o?new Set(u):u:u[0])}),t._assign=hC(n)},mounted(t,{value:e}){fC(t,e)},beforeUpdate(t,e,i){t._assign=hC(i)},updated(t,{value:e}){fC(t,e)}};function fC(t,e){const i=t.multiple;if(!(i&&!vt(e)&&!Sg(e))){for(let n=0,o=t.options.length;n<o;n++){const u=t.options[n],c=Hm(u);if(i)vt(e)?u.selected=I3(e,c)>-1:u.selected=e.has(c);else if(bg(Hm(u),e)){t.selectedIndex!==n&&(t.selectedIndex=n);return}}!i&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Hm(t){return"_value"in t?t._value:t.value}const WH=Ts({patchProp:jH},kH);let pC;function GH(){return pC||(pC=aH(WH))}const zH=(...t)=>{const e=GH().createApp(...t),{mount:i}=e;return e.mount=n=>{const o=KH(n);if(!o)return;const u=e._component;!Ot(u)&&!u.render&&!u.template&&(u.template=o.innerHTML),o.innerHTML="";const c=i(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),c},e};function KH(t){return Wi(t)?document.querySelector(t):t}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Eu=typeof window<"u";function XH(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const ni=Object.assign;function n0(t,e){const i={};for(const n in e){const o=e[n];i[n]=sr(o)?o.map(t):t(o)}return i}const oh=()=>{},sr=Array.isArray,YH=/\/$/,QH=t=>t.replace(YH,"");function r0(t,e,i="/"){let n,o={},u="",c="";const h=e.indexOf("#");let m=e.indexOf("?");return h<m&&h>=0&&(m=-1),m>-1&&(n=e.slice(0,m),u=e.slice(m+1,h>-1?h:e.length),o=t(u)),h>-1&&(n=n||e.slice(0,h),c=e.slice(h,e.length)),n=t5(n??e,i),{fullPath:n+(u&&"?")+u+c,path:n,query:o,hash:c}}function JH(t,e){const i=e.query?t(e.query):"";return e.path+(i&&"?")+i+(e.hash||"")}function mC(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function ZH(t,e,i){const n=e.matched.length-1,o=i.matched.length-1;return n>-1&&n===o&&ac(e.matched[n],i.matched[o])&&UO(e.params,i.params)&&t(e.query)===t(i.query)&&e.hash===i.hash}function ac(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function UO(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!e5(t[i],e[i]))return!1;return!0}function e5(t,e){return sr(t)?gC(t,e):sr(e)?gC(e,t):t===e}function gC(t,e){return sr(e)?t.length===e.length&&t.every((i,n)=>i===e[n]):t.length===1&&t[0]===e}function t5(t,e){if(t.startsWith("/"))return t;if(!t)return e;const i=e.split("/"),n=t.split("/");let o=i.length-1,u,c;for(u=0;u<n.length;u++)if(c=n[u],c!==".")if(c==="..")o>1&&o--;else break;return i.slice(0,o).join("/")+"/"+n.slice(u-(u===n.length?1:0)).join("/")}var Ch;(function(t){t.pop="pop",t.push="push"})(Ch||(Ch={}));var lh;(function(t){t.back="back",t.forward="forward",t.unknown=""})(lh||(lh={}));function i5(t){if(!t)if(Eu){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),QH(t)}const s5=/^[^#]+#/;function n5(t,e){return t.replace(s5,"#")+e}function r5(t,e){const i=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-i.left-(e.left||0),top:n.top-i.top-(e.top||0)}}const Lg=()=>({left:window.pageXOffset,top:window.pageYOffset});function a5(t){let e;if("el"in t){const i=t.el,n=typeof i=="string"&&i.startsWith("#"),o=typeof i=="string"?n?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!o)return;e=r5(o,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function _C(t,e){return(history.state?history.state.position-e:-1)+t}const sv=new Map;function o5(t,e){sv.set(t,e)}function l5(t){const e=sv.get(t);return sv.delete(t),e}let u5=()=>location.protocol+"//"+location.host;function BO(t,e){const{pathname:i,search:n,hash:o}=e,u=t.indexOf("#");if(u>-1){let h=o.includes(t.slice(u))?t.slice(u).length:1,m=o.slice(h);return m[0]!=="/"&&(m="/"+m),mC(m,"")}return mC(i,t)+n+o}function c5(t,e,i,n){let o=[],u=[],c=null;const h=({state:R})=>{const M=BO(t,location),z=i.value,j=e.value;let q=0;if(R){if(i.value=M,e.value=R,c&&c===z){c=null;return}q=j?R.position-j.position:0}else n(M);o.forEach(W=>{W(i.value,z,{delta:q,type:Ch.pop,direction:q?q>0?lh.forward:lh.back:lh.unknown})})};function m(){c=i.value}function v(R){o.push(R);const M=()=>{const z=o.indexOf(R);z>-1&&o.splice(z,1)};return u.push(M),M}function T(){const{history:R}=window;R.state&&R.replaceState(ni({},R.state,{scroll:Lg()}),"")}function O(){for(const R of u)R();u=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",T)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",T),{pauseListeners:m,listen:v,destroy:O}}function yC(t,e,i,n=!1,o=!1){return{back:t,current:e,forward:i,replaced:n,position:window.history.length,scroll:o?Lg():null}}function d5(t){const{history:e,location:i}=window,n={value:BO(t,i)},o={value:e.state};o.value||u(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function u(m,v,T){const O=t.indexOf("#"),R=O>-1?(i.host&&document.querySelector("base")?t:t.slice(O))+m:u5()+t+m;try{e[T?"replaceState":"pushState"](v,"",R),o.value=v}catch(M){console.error(M),i[T?"replace":"assign"](R)}}function c(m,v){const T=ni({},e.state,yC(o.value.back,m,o.value.forward,!0),v,{position:o.value.position});u(m,T,!0),n.value=m}function h(m,v){const T=ni({},o.value,e.state,{forward:m,scroll:Lg()});u(T.current,T,!0);const O=ni({},yC(n.value,m,null),{position:T.position+1},v);u(m,O,!1),n.value=m}return{location:n,state:o,push:h,replace:c}}function h5(t){t=i5(t);const e=d5(t),i=c5(t,e.state,e.location,e.replace);function n(u,c=!0){c||i.pauseListeners(),history.go(u)}const o=ni({location:"",base:t,go:n,createHref:n5.bind(null,t)},e,i);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>e.state.value}),o}function f5(t){return typeof t=="string"||t&&typeof t=="object"}function FO(t){return typeof t=="string"||typeof t=="symbol"}const qa={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},$O=Symbol("");var vC;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(vC||(vC={}));function oc(t,e){return ni(new Error,{type:t,[$O]:!0},e)}function na(t,e){return t instanceof Error&&$O in t&&(e==null||!!(t.type&e))}const TC="[^/]+?",p5={sensitive:!1,strict:!1,start:!0,end:!0},m5=/[.+*?^${}()[\]/\\]/g;function g5(t,e){const i=ni({},p5,e),n=[];let o=i.start?"^":"";const u=[];for(const v of t){const T=v.length?[]:[90];i.strict&&!v.length&&(o+="/");for(let O=0;O<v.length;O++){const R=v[O];let M=40+(i.sensitive?.25:0);if(R.type===0)O||(o+="/"),o+=R.value.replace(m5,"\\$&"),M+=40;else if(R.type===1){const{value:z,repeatable:j,optional:q,regexp:W}=R;u.push({name:z,repeatable:j,optional:q});const ee=W||TC;if(ee!==TC){M+=10;try{new RegExp(`(${ee})`)}catch(re){throw new Error(`Invalid custom RegExp for param "${z}" (${ee}): `+re.message)}}let se=j?`((?:${ee})(?:/(?:${ee}))*)`:`(${ee})`;O||(se=q&&v.length<2?`(?:/${se})`:"/"+se),q&&(se+="?"),o+=se,M+=20,q&&(M+=-8),j&&(M+=-20),ee===".*"&&(M+=-50)}T.push(M)}n.push(T)}if(i.strict&&i.end){const v=n.length-1;n[v][n[v].length-1]+=.7000000000000001}i.strict||(o+="/?"),i.end?o+="$":i.strict&&(o+="(?:/|$)");const c=new RegExp(o,i.sensitive?"":"i");function h(v){const T=v.match(c),O={};if(!T)return null;for(let R=1;R<T.length;R++){const M=T[R]||"",z=u[R-1];O[z.name]=M&&z.repeatable?M.split("/"):M}return O}function m(v){let T="",O=!1;for(const R of t){(!O||!T.endsWith("/"))&&(T+="/"),O=!1;for(const M of R)if(M.type===0)T+=M.value;else if(M.type===1){const{value:z,repeatable:j,optional:q}=M,W=z in v?v[z]:"";if(sr(W)&&!j)throw new Error(`Provided param "${z}" is an array but it is not repeatable (* or + modifiers)`);const ee=sr(W)?W.join("/"):W;if(!ee)if(q)R.length<2&&(T.endsWith("/")?T=T.slice(0,-1):O=!0);else throw new Error(`Missing required param "${z}"`);T+=ee}}return T||"/"}return{re:c,score:n,keys:u,parse:h,stringify:m}}function _5(t,e){let i=0;for(;i<t.length&&i<e.length;){const n=e[i]-t[i];if(n)return n;i++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function y5(t,e){let i=0;const n=t.score,o=e.score;for(;i<n.length&&i<o.length;){const u=_5(n[i],o[i]);if(u)return u;i++}if(Math.abs(o.length-n.length)===1){if(bC(n))return 1;if(bC(o))return-1}return o.length-n.length}function bC(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const v5={type:0,value:""},T5=/[a-zA-Z0-9_]/;function b5(t){if(!t)return[[]];if(t==="/")return[[v5]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(M){throw new Error(`ERR (${i})/"${v}": ${M}`)}let i=0,n=i;const o=[];let u;function c(){u&&o.push(u),u=[]}let h=0,m,v="",T="";function O(){v&&(i===0?u.push({type:0,value:v}):i===1||i===2||i===3?(u.length>1&&(m==="*"||m==="+")&&e(`A repeatable param (${v}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:v,regexp:T,repeatable:m==="*"||m==="+",optional:m==="*"||m==="?"})):e("Invalid state to consume buffer"),v="")}function R(){v+=m}for(;h<t.length;){if(m=t[h++],m==="\\"&&i!==2){n=i,i=4;continue}switch(i){case 0:m==="/"?(v&&O(),c()):m===":"?(O(),i=1):R();break;case 4:R(),i=n;break;case 1:m==="("?i=2:T5.test(m)?R():(O(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&h--);break;case 2:m===")"?T[T.length-1]=="\\"?T=T.slice(0,-1)+m:i=3:T+=m;break;case 3:O(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&h--,T="";break;default:e("Unknown state");break}}return i===2&&e(`Unfinished custom RegExp for param "${v}"`),O(),c(),o}function E5(t,e,i){const n=g5(b5(t.path),i),o=ni(n,{record:t,parent:e,children:[],alias:[]});return e&&!o.record.aliasOf==!e.record.aliasOf&&e.children.push(o),o}function S5(t,e){const i=[],n=new Map;e=xC({strict:!1,end:!0,sensitive:!1},e);function o(T){return n.get(T)}function u(T,O,R){const M=!R,z=x5(T);z.aliasOf=R&&R.record;const j=xC(e,T),q=[z];if("alias"in T){const se=typeof T.alias=="string"?[T.alias]:T.alias;for(const re of se)q.push(ni({},z,{components:R?R.record.components:z.components,path:re,aliasOf:R?R.record:z}))}let W,ee;for(const se of q){const{path:re}=se;if(O&&re[0]!=="/"){const ie=O.record.path,ye=ie[ie.length-1]==="/"?"":"/";se.path=O.record.path+(re&&ye+re)}if(W=E5(se,O,j),R?R.alias.push(W):(ee=ee||W,ee!==W&&ee.alias.push(W),M&&T.name&&!SC(W)&&c(T.name)),z.children){const ie=z.children;for(let ye=0;ye<ie.length;ye++)u(ie[ye],W,R&&R.children[ye])}R=R||W,(W.record.components&&Object.keys(W.record.components).length||W.record.name||W.record.redirect)&&m(W)}return ee?()=>{c(ee)}:oh}function c(T){if(FO(T)){const O=n.get(T);O&&(n.delete(T),i.splice(i.indexOf(O),1),O.children.forEach(c),O.alias.forEach(c))}else{const O=i.indexOf(T);O>-1&&(i.splice(O,1),T.record.name&&n.delete(T.record.name),T.children.forEach(c),T.alias.forEach(c))}}function h(){return i}function m(T){let O=0;for(;O<i.length&&y5(T,i[O])>=0&&(T.record.path!==i[O].record.path||!jO(T,i[O]));)O++;i.splice(O,0,T),T.record.name&&!SC(T)&&n.set(T.record.name,T)}function v(T,O){let R,M={},z,j;if("name"in T&&T.name){if(R=n.get(T.name),!R)throw oc(1,{location:T});j=R.record.name,M=ni(EC(O.params,R.keys.filter(ee=>!ee.optional).map(ee=>ee.name)),T.params&&EC(T.params,R.keys.map(ee=>ee.name))),z=R.stringify(M)}else if("path"in T)z=T.path,R=i.find(ee=>ee.re.test(z)),R&&(M=R.parse(z),j=R.record.name);else{if(R=O.name?n.get(O.name):i.find(ee=>ee.re.test(O.path)),!R)throw oc(1,{location:T,currentLocation:O});j=R.record.name,M=ni({},O.params,T.params),z=R.stringify(M)}const q=[];let W=R;for(;W;)q.unshift(W.record),W=W.parent;return{name:j,path:z,params:M,matched:q,meta:C5(q)}}return t.forEach(T=>u(T)),{addRoute:u,resolve:v,removeRoute:c,getRoutes:h,getRecordMatcher:o}}function EC(t,e){const i={};for(const n of e)n in t&&(i[n]=t[n]);return i}function x5(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:w5(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function w5(t){const e={},i=t.props||!1;if("component"in t)e.default=i;else for(const n in t.components)e[n]=typeof i=="boolean"?i:i[n];return e}function SC(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function C5(t){return t.reduce((e,i)=>ni(e,i.meta),{})}function xC(t,e){const i={};for(const n in t)i[n]=n in e?e[n]:t[n];return i}function jO(t,e){return e.children.some(i=>i===t||jO(t,i))}const HO=/#/g,A5=/&/g,k5=/\//g,I5=/=/g,O5=/\?/g,VO=/\+/g,D5=/%5B/g,P5=/%5D/g,qO=/%5E/g,L5=/%60/g,WO=/%7B/g,N5=/%7C/g,GO=/%7D/g,R5=/%20/g;function GT(t){return encodeURI(""+t).replace(N5,"|").replace(D5,"[").replace(P5,"]")}function M5(t){return GT(t).replace(WO,"{").replace(GO,"}").replace(qO,"^")}function nv(t){return GT(t).replace(VO,"%2B").replace(R5,"+").replace(HO,"%23").replace(A5,"%26").replace(L5,"`").replace(WO,"{").replace(GO,"}").replace(qO,"^")}function U5(t){return nv(t).replace(I5,"%3D")}function B5(t){return GT(t).replace(HO,"%23").replace(O5,"%3F")}function F5(t){return t==null?"":B5(t).replace(k5,"%2F")}function Vm(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function $5(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let o=0;o<n.length;++o){const u=n[o].replace(VO," "),c=u.indexOf("="),h=Vm(c<0?u:u.slice(0,c)),m=c<0?null:Vm(u.slice(c+1));if(h in e){let v=e[h];sr(v)||(v=e[h]=[v]),v.push(m)}else e[h]=m}return e}function wC(t){let e="";for(let i in t){const n=t[i];if(i=U5(i),n==null){n!==void 0&&(e+=(e.length?"&":"")+i);continue}(sr(n)?n.map(u=>u&&nv(u)):[n&&nv(n)]).forEach(u=>{u!==void 0&&(e+=(e.length?"&":"")+i,u!=null&&(e+="="+u))})}return e}function j5(t){const e={};for(const i in t){const n=t[i];n!==void 0&&(e[i]=sr(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return e}const H5=Symbol(""),CC=Symbol(""),zT=Symbol(""),zO=Symbol(""),rv=Symbol("");function Vd(){let t=[];function e(n){return t.push(n),()=>{const o=t.indexOf(n);o>-1&&t.splice(o,1)}}function i(){t=[]}return{add:e,list:()=>t,reset:i}}function za(t,e,i,n,o){const u=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((c,h)=>{const m=O=>{O===!1?h(oc(4,{from:i,to:e})):O instanceof Error?h(O):f5(O)?h(oc(2,{from:e,to:O})):(u&&n.enterCallbacks[o]===u&&typeof O=="function"&&u.push(O),c())},v=t.call(n&&n.instances[o],e,i,m);let T=Promise.resolve(v);t.length<3&&(T=T.then(m)),T.catch(O=>h(O))})}function a0(t,e,i,n){const o=[];for(const u of t)for(const c in u.components){let h=u.components[c];if(!(e!=="beforeRouteEnter"&&!u.instances[c]))if(V5(h)){const v=(h.__vccOpts||h)[e];v&&o.push(za(v,i,n,u,c))}else{let m=h();o.push(()=>m.then(v=>{if(!v)return Promise.reject(new Error(`Couldn't resolve component "${c}" at "${u.path}"`));const T=XH(v)?v.default:v;u.components[c]=T;const R=(T.__vccOpts||T)[e];return R&&za(R,i,n,u,c)()}))}}return o}function V5(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function AC(t){const e=ma(zT),i=ma(zO),n=wn(()=>e.resolve(Xa(t.to))),o=wn(()=>{const{matched:m}=n.value,{length:v}=m,T=m[v-1],O=i.matched;if(!T||!O.length)return-1;const R=O.findIndex(ac.bind(null,T));if(R>-1)return R;const M=kC(m[v-2]);return v>1&&kC(T)===M&&O[O.length-1].path!==M?O.findIndex(ac.bind(null,m[v-2])):R}),u=wn(()=>o.value>-1&&G5(i.params,n.value.params)),c=wn(()=>o.value>-1&&o.value===i.matched.length-1&&UO(i.params,n.value.params));function h(m={}){return W5(m)?e[Xa(t.replace)?"replace":"push"](Xa(t.to)).catch(oh):Promise.resolve()}return{route:n,href:wn(()=>n.value.href),isActive:u,isExactActive:c,navigate:h}}const q5=yO({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:AC,setup(t,{slots:e}){const i=Vh(AC(t)),{options:n}=ma(zT),o=wn(()=>({[IC(t.activeClass,n.linkActiveClass,"router-link-active")]:i.isActive,[IC(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const u=e.default&&e.default(i);return t.custom?u:RO("a",{"aria-current":i.isExactActive?t.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:o.value},u)}}}),KO=q5;function W5(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function G5(t,e){for(const i in e){const n=e[i],o=t[i];if(typeof n=="string"){if(n!==o)return!1}else if(!sr(o)||o.length!==n.length||n.some((u,c)=>u!==o[c]))return!1}return!0}function kC(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const IC=(t,e,i)=>t??e??i,z5=yO({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:i}){const n=ma(rv),o=wn(()=>t.route||n.value),u=ma(CC,0),c=wn(()=>{let v=Xa(u);const{matched:T}=o.value;let O;for(;(O=T[v])&&!O.components;)v++;return v}),h=wn(()=>o.value.matched[c.value]);im(CC,wn(()=>c.value+1)),im(H5,h),im(rv,o);const m=f6();return sm(()=>[m.value,h.value,t.name],([v,T,O],[R,M,z])=>{T&&(T.instances[O]=v,M&&M!==T&&v&&v===R&&(T.leaveGuards.size||(T.leaveGuards=M.leaveGuards),T.updateGuards.size||(T.updateGuards=M.updateGuards))),v&&T&&(!M||!ac(T,M)||!R)&&(T.enterCallbacks[O]||[]).forEach(j=>j(v))},{flush:"post"}),()=>{const v=o.value,T=t.name,O=h.value,R=O&&O.components[T];if(!R)return OC(i.default,{Component:R,route:v});const M=O.props[T],z=M?M===!0?v.params:typeof M=="function"?M(v):M:null,q=RO(R,ni({},z,e,{onVnodeUnmounted:W=>{W.component.isUnmounted&&(O.instances[T]=null)},ref:m}));return OC(i.default,{Component:q,route:v})||q}}});function OC(t,e){if(!t)return null;const i=t(e);return i.length===1?i[0]:i}const XO=z5;function K5(t){const e=S5(t.routes,t),i=t.parseQuery||$5,n=t.stringifyQuery||wC,o=t.history,u=Vd(),c=Vd(),h=Vd(),m=p6(qa);let v=qa;Eu&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const T=n0.bind(null,be=>""+be),O=n0.bind(null,F5),R=n0.bind(null,Vm);function M(be,He){let Ue,Xe;return FO(be)?(Ue=e.getRecordMatcher(be),Xe=He):Xe=be,e.addRoute(Xe,Ue)}function z(be){const He=e.getRecordMatcher(be);He&&e.removeRoute(He)}function j(){return e.getRoutes().map(be=>be.record)}function q(be){return!!e.getRecordMatcher(be)}function W(be,He){if(He=ni({},He||m.value),typeof be=="string"){const X=r0(i,be,He.path),ne=e.resolve({path:X.path},He),pe=o.createHref(X.fullPath);return ni(X,ne,{params:R(ne.params),hash:Vm(X.hash),redirectedFrom:void 0,href:pe})}let Ue;if("path"in be)Ue=ni({},be,{path:r0(i,be.path,He.path).path});else{const X=ni({},be.params);for(const ne in X)X[ne]==null&&delete X[ne];Ue=ni({},be,{params:O(be.params)}),He.params=O(He.params)}const Xe=e.resolve(Ue,He),Ct=be.hash||"";Xe.params=T(R(Xe.params));const Jt=JH(n,ni({},be,{hash:M5(Ct),path:Xe.path})),je=o.createHref(Jt);return ni({fullPath:Jt,hash:Ct,query:n===wC?j5(be.query):be.query||{}},Xe,{redirectedFrom:void 0,href:je})}function ee(be){return typeof be=="string"?r0(i,be,m.value.path):ni({},be)}function se(be,He){if(v!==be)return oc(8,{from:He,to:be})}function re(be){return Pe(be)}function ie(be){return re(ni(ee(be),{replace:!0}))}function ye(be){const He=be.matched[be.matched.length-1];if(He&&He.redirect){const{redirect:Ue}=He;let Xe=typeof Ue=="function"?Ue(be):Ue;return typeof Xe=="string"&&(Xe=Xe.includes("?")||Xe.includes("#")?Xe=ee(Xe):{path:Xe},Xe.params={}),ni({query:be.query,hash:be.hash,params:"path"in Xe?{}:be.params},Xe)}}function Pe(be,He){const Ue=v=W(be),Xe=m.value,Ct=be.state,Jt=be.force,je=be.replace===!0,X=ye(Ue);if(X)return Pe(ni(ee(X),{state:typeof X=="object"?ni({},Ct,X.state):Ct,force:Jt,replace:je}),He||Ue);const ne=Ue;ne.redirectedFrom=He;let pe;return!Jt&&ZH(n,Xe,Ue)&&(pe=oc(16,{to:ne,from:Xe}),mi(Xe,Xe,!0,!1)),(pe?Promise.resolve(pe):Be(ne,Xe)).catch(_e=>na(_e)?na(_e,2)?_e:Vt(_e):Ze(_e,ne,Xe)).then(_e=>{if(_e){if(na(_e,2))return Pe(ni({replace:je},ee(_e.to),{state:typeof _e.to=="object"?ni({},Ct,_e.to.state):Ct,force:Jt}),He||ne)}else _e=We(ne,Xe,!0,je,Ct);return Ve(ne,Xe,_e),_e})}function Ie(be,He){const Ue=se(be,He);return Ue?Promise.reject(Ue):Promise.resolve()}function Be(be,He){let Ue;const[Xe,Ct,Jt]=X5(be,He);Ue=a0(Xe.reverse(),"beforeRouteLeave",be,He);for(const X of Xe)X.leaveGuards.forEach(ne=>{Ue.push(za(ne,be,He))});const je=Ie.bind(null,be,He);return Ue.push(je),yu(Ue).then(()=>{Ue=[];for(const X of u.list())Ue.push(za(X,be,He));return Ue.push(je),yu(Ue)}).then(()=>{Ue=a0(Ct,"beforeRouteUpdate",be,He);for(const X of Ct)X.updateGuards.forEach(ne=>{Ue.push(za(ne,be,He))});return Ue.push(je),yu(Ue)}).then(()=>{Ue=[];for(const X of be.matched)if(X.beforeEnter&&!He.matched.includes(X))if(sr(X.beforeEnter))for(const ne of X.beforeEnter)Ue.push(za(ne,be,He));else Ue.push(za(X.beforeEnter,be,He));return Ue.push(je),yu(Ue)}).then(()=>(be.matched.forEach(X=>X.enterCallbacks={}),Ue=a0(Jt,"beforeRouteEnter",be,He),Ue.push(je),yu(Ue))).then(()=>{Ue=[];for(const X of c.list())Ue.push(za(X,be,He));return Ue.push(je),yu(Ue)}).catch(X=>na(X,8)?X:Promise.reject(X))}function Ve(be,He,Ue){for(const Xe of h.list())Xe(be,He,Ue)}function We(be,He,Ue,Xe,Ct){const Jt=se(be,He);if(Jt)return Jt;const je=He===qa,X=Eu?history.state:{};Ue&&(Xe||je?o.replace(be.fullPath,ni({scroll:je&&X&&X.scroll},Ct)):o.push(be.fullPath,Ct)),m.value=be,mi(be,He,Ue,je),Vt()}let it;function Le(){it||(it=o.listen((be,He,Ue)=>{if(!Qt.listening)return;const Xe=W(be),Ct=ye(Xe);if(Ct){Pe(ni(Ct,{replace:!0}),Xe).catch(oh);return}v=Xe;const Jt=m.value;Eu&&o5(_C(Jt.fullPath,Ue.delta),Lg()),Be(Xe,Jt).catch(je=>na(je,12)?je:na(je,2)?(Pe(je.to,Xe).then(X=>{na(X,20)&&!Ue.delta&&Ue.type===Ch.pop&&o.go(-1,!1)}).catch(oh),Promise.reject()):(Ue.delta&&o.go(-Ue.delta,!1),Ze(je,Xe,Jt))).then(je=>{je=je||We(Xe,Jt,!1),je&&(Ue.delta&&!na(je,8)?o.go(-Ue.delta,!1):Ue.type===Ch.pop&&na(je,20)&&o.go(-1,!1)),Ve(Xe,Jt,je)}).catch(oh)}))}let ct=Vd(),Ht=Vd(),Qe;function Ze(be,He,Ue){Vt(be);const Xe=Ht.list();return Xe.length?Xe.forEach(Ct=>Ct(be,He,Ue)):console.error(be),Promise.reject(be)}function _t(){return Qe&&m.value!==qa?Promise.resolve():new Promise((be,He)=>{ct.add([be,He])})}function Vt(be){return Qe||(Qe=!be,Le(),ct.list().forEach(([He,Ue])=>be?Ue(be):He()),ct.reset()),be}function mi(be,He,Ue,Xe){const{scrollBehavior:Ct}=t;if(!Eu||!Ct)return Promise.resolve();const Jt=!Ue&&l5(_C(be.fullPath,0))||(Xe||!Ue)&&history.state&&history.state.scroll||null;return oO().then(()=>Ct(be,He,Jt)).then(je=>je&&a5(je)).catch(je=>Ze(je,be,He))}const ei=be=>o.go(be);let Ft;const Mt=new Set,Qt={currentRoute:m,listening:!0,addRoute:M,removeRoute:z,hasRoute:q,getRoutes:j,resolve:W,options:t,push:re,replace:ie,go:ei,back:()=>ei(-1),forward:()=>ei(1),beforeEach:u.add,beforeResolve:c.add,afterEach:h.add,onError:Ht.add,isReady:_t,install(be){const He=this;be.component("RouterLink",KO),be.component("RouterView",XO),be.config.globalProperties.$router=He,Object.defineProperty(be.config.globalProperties,"$route",{enumerable:!0,get:()=>Xa(m)}),Eu&&!Ft&&m.value===qa&&(Ft=!0,re(o.location).catch(Ct=>{}));const Ue={};for(const Ct in qa)Ue[Ct]=wn(()=>m.value[Ct]);be.provide(zT,He),be.provide(zO,Vh(Ue)),be.provide(rv,m);const Xe=be.unmount;Mt.add(be),be.unmount=function(){Mt.delete(be),Mt.size<1&&(v=qa,it&&it(),it=null,m.value=qa,Ft=!1,Qe=!1),Xe()}}};return Qt}function yu(t){return t.reduce((e,i)=>e.then(()=>i()),Promise.resolve())}function X5(t,e){const i=[],n=[],o=[],u=Math.max(e.matched.length,t.matched.length);for(let c=0;c<u;c++){const h=e.matched[c];h&&(t.matched.find(v=>ac(v,h))?n.push(h):i.push(h));const m=t.matched[c];m&&(e.matched.find(v=>ac(v,m))||o.push(m))}return[i,n,o]}const Y5={class:"navbar navbar-expand-lg navbar-light bg-light"},Q5={class:"container"},J5=kt("div",{class:"footer text-center bg-light"},[kt("span",null,"  : "),kt("a",{href:"/admin",class:"link me-1"},"Wagtail"),kt("a",{href:"/django-admin",class:"link"},"Django")],-1),Z5={__name:"App",setup(t){return(e,i)=>(il(),sl(pn,null,[kt("nav",Y5,[kt("div",Q5,[gn(Xa(KO),{class:"navbar-brand",to:"/"},{default:fO(()=>[ku("MyVideo")]),_:1})])]),gn(Xa(XO)),J5],64))}},YO=(t,e)=>{const i=t.__vccOpts||t;for(const[n,o]of e)i[n]=o;return i},DC="8000-denisgr-myvideo-x5gkonzz9sw.ws-eu89.gitpod.io",eV={data(){return{videos:[]}},async created(){const t="https://"+DC+"/api/videos.json",e=await fetch(t);this.videos=await e.json()},methods:{get_url:t=>"https://"+DC+"/"+(t||"///").split("/").slice(3).join("/")}},tV={class:"container"},iV={class:"row g-3 m-3"},sV={class:"col-sm-6"},nV=["href"],rV=["src"],aV={class:"card-body"},oV=["textContent"],lV=["textContent"];function uV(t,e,i,n,o,u){return il(),sl("main",tV,[kt("div",iV,[(il(!0),sl(pn,null,SO(o.videos,c=>(il(),sl("div",sV,[kt("a",{href:`/video#id:${c.id}:`,class:"card text-decoration-none text-muted"},[kt("img",{src:u.get_url(c.image),class:"card-img-top"},null,8,rV),kt("div",aV,[kt("h5",{class:"card-title",textContent:ra(c.title)},null,8,oV),kt("p",{class:"card-text",textContent:ra(c.description)},null,8,lV)])],8,nV)]))),256))])])}const cV=YO(eV,[["render",uV]]),o0="8000-denisgr-myvideo-x5gkonzz9sw.ws-eu89.gitpod.io",dV={data(){return{videos:[],video:{},quality:"original"}},async created(){await this.load(),window.addEventListener("hashchange",()=>this.load()),this.setTime()},methods:{get_url:t=>"https://"+o0+"/"+(t||"///").split("/").slice(3).join("/"),formatDate:t=>new Date(t).toLocaleString(),load:async function(){const t=document.location.hash.match(/id:(\d*):/)[1],e="https://"+o0+"/api/videos.json",i=await fetch(e);this.videos=await i.json();const n="https://"+o0+`/api/videos/${t}.json`,o=await fetch(n);this.video=await o.json()},setUrlWithTime(){const t=Math.floor(document.querySelector("video").currentTime);document.location=`/video#id:${this.video.id}:time:${t}:`},setTime(){const t=(document.location.hash.match(/time:(\d*):/)||[0,0])[1];document.querySelector("video").currentTime=t}}},hV={class:"container"},fV={class:"row"},pV={class:"col-md-9"},mV=["src"],gV={class:"my-3 input-group flex-nowrap"},_V=kt("span",{class:"input-group-text"},": ",-1),yV={value:"original",selected:""},vV=kt("span",null,":",-1),TV=["textContent"],bV=kt("span",null,"x",-1),EV=["textContent"],SV=kt("option",{value:"360"},"360",-1),xV=kt("option",{value:"480"},"480",-1),wV=kt("option",{value:"720"},"720",-1),CV=kt("option",{value:"1080"},"1080",-1),AV=["textContent"],kV=["textContent"],IV={class:"small"},OV=kt("span",null,": ",-1),DV=["textContent"],PV={class:"col-md-3"},LV=["href"],NV=["src"],RV={class:"card-body"},MV=["textContent"],UV=["textContent"];function BV(t,e,i,n,o,u){return il(),sl("main",hV,[kt("div",fV,[kt("div",pV,[kt("video",{class:"video-js vjs-16-9 my-3",autoplay:"",controls:"",preload:"metadata",src:u.get_url(o.video["video_"+o.quality]),"data-setup":"{}"},null,8,mV),kt("div",gV,[_V,W6(kt("select",{"onUpdate:modelValue":e[0]||(e[0]=c=>o.quality=c),class:"form-select","aria-label":"Default select example"},[kt("option",yV,[ku(" "),vV,ku(" "),kt("span",{textContent:ra(o.video.original_width)},null,8,TV),ku(" "),bV,ku(" "),kt("span",{textContent:ra(o.video.original_height)},null,8,EV)]),SV,xV,wV,CV],512),[[qH,o.quality]]),kt("a",{onClick:e[1]||(e[1]=(...c)=>u.setUrlWithTime&&u.setUrlWithTime(...c)),class:"btn btn-secondary"}," ")]),kt("h1",{class:"my-1 h3",textContent:ra(o.video.title)},null,8,AV),kt("div",{class:"my-1",textContent:ra(o.video.description)},null,8,kV),kt("div",IV,[OV,kt("span",{textContent:ra(u.formatDate(o.video.first_published_at))},null,8,DV)])]),kt("div",PV,[(il(!0),sl(pn,null,SO(o.videos,c=>(il(),sl("a",{href:`/video#id:${c.id}:`,class:"card text-decoration-none text-muted my-3 rounded-0"},[kt("img",{src:u.get_url(c.image),class:"card-img-top rounded-0"},null,8,NV),kt("div",RV,[kt("span",{class:"card-title",textContent:ra(c.title)},null,8,MV),kt("p",{class:"card-text",textContent:ra(c.description)},null,8,UV)])],8,LV))),256))])])])}const FV=YO(dV,[["render",BV]]),$V=K5({history:h5("/"),routes:[{path:"/",name:"main",component:cV},{path:"/video",name:"video",component:FV}]}),QO=zH(Z5);QO.use($V);QO.mount("#app");
